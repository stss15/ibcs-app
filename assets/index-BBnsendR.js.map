{"version":3,"file":"index-BBnsendR.js","sources":["../../node_modules/react-dom/client.js","../../src/lib/config.js","../../src/lib/api.js","../../src/hooks/useSession.js","../../src/components/ui/FeedbackPanel.jsx","../../src/assets/logo.svg","../../src/pages/LoginPage.jsx","../../../shared/passwords.js","../../src/utils/classNames.js","../../src/components/ui/ContentContainer.jsx","../../src/components/ui/ResponsiveGrid.jsx","../../src/components/ui/StatCard.jsx","../../src/components/ui/StatusBanner.jsx","../../src/components/ui/Modal.jsx","../../../shared/content/lessons/intro-to-cs.js","../../../shared/liveDecks.js","../../src/pages/TeacherDashboardPage.jsx","../../src/data/curriculumManifest.json?url","../../src/hooks/useCurriculumManifest.js","../../src/context/GamificationContext.jsx","../../src/lib/progressStorage.js","../../src/components/segments/EnhancedComponents.jsx","../../src/content/b1ComputationalThinking.jsx","../../src/assets/system-architecture.svg","../../src/content/b2ProgrammingFundamentals.jsx","../../src/components/ui/ProgressBar.jsx","../../src/components/ui/StatusPill.jsx","../../src/pages/StudentDashboardPage.jsx","../../src/pages/TeacherStudentDashboardPage.jsx","../../src/pages/CurriculumMapPage.jsx","../../src/lib/ibMetadata.js","../../src/pages/IBCurriculumPage.jsx","../../../shared/igcseCurriculum.js","../../src/pages/IGCSECurriculumPage.jsx","../../src/pages/TopicPage.jsx","../../src/pages/LessonPage.jsx","../../src/pages/AdminDashboardPage.jsx","../../src/pages/AccountPage.jsx","../../src/components/Layout.jsx","../../src/components/segments/AttemptBadge.jsx","../../src/components/segments/MicroQuizSegment.jsx","../../src/utils/array.js","../../src/components/ui/ButtonGroup.jsx","../../src/components/segments/activities/MatchingActivity.jsx","../../src/components/segments/activities/OrderingActivity.jsx","../../src/components/segments/activities/DragDropActivity.jsx","../../src/components/segments/activities/GapFillActivity.jsx","../../src/components/segments/activities/ImageHotspotActivity.jsx","../../src/components/segments/activities/PlannerActivity.jsx","../../src/components/segments/activities/ClassificationActivity.jsx","../../src/components/segments/activities/CodeCompletionActivity.jsx","../../src/components/segments/activities/SpotTheErrorActivity.jsx","../../src/components/segments/activities/DiagramLabelActivity.jsx","../../src/components/segments/activities/ActivitySegment.jsx","../../src/components/segments/SegmentNav.jsx","../../src/components/segments/ContentSegment.jsx","../../src/components/segments/DemoSegment.jsx","../../src/components/segments/PythonPlaygroundSegment.jsx","../../src/components/segments/AssessmentResultsModal.jsx","../../src/components/segments/ReflectionSegment.jsx","../../src/components/segments/LiveAssessmentDashboard.jsx","../../src/context/TeacherModeContext.jsx","../../src/components/GamifiedModulePage.jsx","../../src/pages/B1ModulePage.jsx","../../src/pages/B2ModulePage.jsx","../../src/pages/Year7MapPage.jsx","../../node_modules/canvas-confetti/dist/confetti.module.mjs","../../src/components/assessments/FormativeAssessment.jsx","../../src/components/interactive/PedagogicalComponents.jsx","../../src/components/slides/SlideRenderer.jsx","../../node_modules/@instantdb/core/dist/module/utils/log.js","../../node_modules/object-hash/dist/object_hash.js","../../node_modules/@instantdb/core/dist/module/utils/weakHash.js","../../node_modules/immer/dist/immer.esm.mjs","../../node_modules/@instantdb/core/dist/module/utils/object.js","../../node_modules/@instantdb/core/dist/module/store.js","../../node_modules/@instantdb/core/dist/module/datalog.js","../../node_modules/uuid/dist/esm-browser/rng.js","../../node_modules/uuid/dist/esm-browser/stringify.js","../../node_modules/uuid/dist/esm-browser/native.js","../../node_modules/uuid/dist/esm-browser/v4.js","../../node_modules/@instantdb/core/dist/module/utils/uuid.js","../../node_modules/@instantdb/core/dist/module/instaql.js","../../node_modules/@instantdb/core/dist/module/instatx.js","../../node_modules/@instantdb/core/dist/module/instaml.js","../../node_modules/@instantdb/core/dist/module/IndexedDBStorage.js","../../node_modules/@instantdb/core/dist/module/WindowNetworkListener.js","../../node_modules/@instantdb/core/dist/module/utils/fetch.js","../../node_modules/@instantdb/core/dist/module/authAPI.js","../../node_modules/@instantdb/core/dist/module/StorageAPI.js","../../node_modules/@instantdb/core/dist/module/utils/pick.js","../../node_modules/@instantdb/core/dist/module/presence.js","../../node_modules/@instantdb/core/dist/module/utils/Deferred.js","../../node_modules/@instantdb/core/dist/module/utils/PersistedObject.js","../../node_modules/@instantdb/core/dist/module/model/instaqlResult.js","../../node_modules/@instantdb/core/dist/module/utils/json.js","../../node_modules/@instantdb/core/dist/module/Reactor.js","../../node_modules/@instantdb/core/dist/module/devtool.js","../../node_modules/@instantdb/core/dist/module/index.js","../../node_modules/@instantdb/react/dist/module/useQuery.js","../../node_modules/@instantdb/react/dist/module/useTimeout.js","../../node_modules/@instantdb/react/dist/module/InstantReact.js","../../node_modules/@instantdb/react/dist/module/InstantReactWeb.js","../../node_modules/@instantdb/react/dist/module/init.js","../../src/lib/instantdb/schema.js","../../node_modules/react-circular-progressbar/dist/index.esm.js","../../src/components/teacher/LiveDashboard.jsx","../../src/lib/services/AnalyticsService.js","../../src/lib/services/GamificationService.js","../../src/pages/Year7LiveSessionPage.jsx","../../src/App.jsx","../../src/main.jsx"],"sourcesContent":["'use strict';\n\nvar m = require('react-dom');\nif (process.env.NODE_ENV === 'production') {\n  exports.createRoot = m.createRoot;\n  exports.hydrateRoot = m.hydrateRoot;\n} else {\n  var i = m.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;\n  exports.createRoot = function(c, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.createRoot(c, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n  exports.hydrateRoot = function(c, h, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.hydrateRoot(c, h, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n}\n","const CONFIG_URL = `${import.meta.env.BASE_URL}app-config.json`;\n\nlet configPromise;\n\nexport async function loadConfig() {\n  const inline = (import.meta.env.VITE_API_BASE || \"\").trim();\n  if (inline) {\n    return { apiBase: inline.replace(/\\/$/, \"\") };\n  }\n\n  if (!configPromise) {\n    configPromise = fetch(CONFIG_URL, { mode: \"cors\" })\n      .then((response) => {\n        if (!response.ok) {\n          throw new Error(\"Failed to load app configuration\");\n        }\n        return response.json();\n      })\n      .then((data) => {\n        if (!data?.API_BASE) {\n          throw new Error(\"Configuration missing API_BASE\");\n        }\n        return {\n          apiBase: data.API_BASE.replace(/\\/$/, \"\"),\n        };\n      });\n  }\n  return configPromise;\n}\n\n\n","import { loadConfig } from \"./config.js\";\n\nasync function request(path, { method = \"GET\", token, body, headers } = {}) {\n  const { apiBase } = await loadConfig();\n  const url = `${apiBase}${path}`;\n  const init = {\n    method,\n    headers: {\n      \"content-type\": \"application/json\",\n      ...(token ? { authorization: `Bearer ${token}` } : {}),\n      ...(headers || {}),\n    },\n    body: body !== undefined ? JSON.stringify(body) : undefined,\n  };\n\n  const response = await fetch(url, init);\n  const text = await response.text();\n\n  if (!response.ok) {\n    let message = `Request failed (${response.status})`;\n    try {\n      const data = text ? JSON.parse(text) : null;\n      if (data?.error) message = data.error;\n    } catch {\n      // ignore JSON parse errors\n    }\n    const error = new Error(message);\n    error.status = response.status;\n    throw error;\n  }\n\n  if (!text) {\n    return null;\n  }\n  try {\n    return JSON.parse(text);\n  } catch {\n    return text;\n  }\n}\n\nexport async function login({ role, username, password }) {\n  return request(\"/auth/login\", {\n    method: \"POST\",\n    body: { role, username, password },\n  });\n}\n\nexport async function verify(token) {\n  return request(\"/auth/verify\", {\n    method: \"POST\",\n    body: { token },\n  });\n}\n\nexport async function getTeacherDashboard(token) {\n  return request(\"/teacher/dashboard\", {\n    method: \"GET\",\n    token,\n  });\n}\n\nexport async function createClass(token, { className, description, yearGroup }) {\n  return request(\"/teacher/classes\", {\n    method: \"POST\",\n    token,\n    body: { className, description, yearGroup },\n  });\n}\n\nexport async function createStudent(token, payload) {\n  return request(\"/teacher/students\", {\n    method: \"POST\",\n    token,\n    body: payload,\n  });\n}\n\nexport async function bulkCreateStudents(token, payload) {\n  return request(\"/teacher/students/bulk\", {\n    method: \"POST\",\n    token,\n    body: payload,\n  });\n}\n\nexport async function unlockClassStage(token, payload) {\n  return request(\"/teacher/classes/unlocks\", {\n    method: \"POST\",\n    token,\n    body: payload,\n  });\n}\n\nexport async function unlockStudentStage(token, payload) {\n  return request(\"/teacher/students/unlocks\", {\n    method: \"POST\",\n    token,\n    body: payload,\n  });\n}\n\nexport async function archiveStudent(token, payload) {\n  return request(\"/teacher/students/archive\", {\n    method: \"POST\",\n    token,\n    body: payload,\n  });\n}\n\nexport async function getClassPacing(token, classId) {\n  return request(`/teacher/classes/${encodeURIComponent(classId)}/pacing`, {\n    method: \"GET\",\n    token,\n  });\n}\n\nexport async function getStudentClassPacing(token, classId) {\n  return request(`/student/classes/${encodeURIComponent(classId)}/pacing`, {\n    method: \"GET\",\n    token,\n  });\n}\n\nexport async function joinLiveSession(token, joinCode) {\n  return request(\"/student/live-sessions/join\", {\n    method: \"POST\",\n    token,\n    body: { joinCode },\n  });\n}\n\nexport async function regenerateClassCredentials(token, classId, options = {}) {\n  const payload = {};\n  if (Array.isArray(options.studentIds) && options.studentIds.length > 0) {\n    payload.studentIds = options.studentIds;\n  }\n  return request(`/teacher/classes/${encodeURIComponent(classId)}/credentials`, {\n    method: \"POST\",\n    token,\n    body: payload,\n  });\n}\n\nexport async function getTeacherStudentDashboard(token, studentId) {\n  return request(`/teacher/students/${encodeURIComponent(studentId)}/dashboard`, {\n    method: \"GET\",\n    token,\n  });\n}\n\nexport async function updateClassPacing(token, classId, payload) {\n  return request(`/teacher/classes/${encodeURIComponent(classId)}/pacing`, {\n    method: \"POST\",\n    token,\n    body: payload,\n  });\n}\n\nexport async function exportClassProgress(token, classId) {\n  return request(`/teacher/classes/${classId}/export`, {\n    method: \"GET\",\n    token,\n  });\n}\n\nexport async function getStudentDashboard(token) {\n  return request(\"/student/dashboard\", {\n    method: \"GET\",\n    token,\n  });\n}\n\nexport async function getStudentGamification(token) {\n  return request(\"/student/gamification\", {\n    method: \"GET\",\n    token,\n  });\n}\n\nexport async function syncStudentGamification(token, gamificationData) {\n  return request(\"/student/gamification\", {\n    method: \"POST\",\n    token,\n    body: gamificationData,\n  });\n}\n\nexport async function syncStudentProgress(token, progressData) {\n  return request(\"/student/progress\", {\n    method: \"POST\",\n    token,\n    body: progressData,\n  });\n}\n\nexport async function updateLiveAssessmentStatus(token, statusData) {\n  return request(\"/student/live-assessment-status\", {\n    method: \"POST\",\n    token,\n    body: statusData,\n  });\n}\n\nexport async function getLiveAssessmentStatus(token, classId, { unitId, segmentId }) {\n  if (!classId) {\n    throw new Error(\"classId is required to fetch live assessment status\");\n  }\n  const params = new URLSearchParams();\n  if (unitId) params.append(\"unitId\", unitId);\n  if (segmentId) params.append(\"segmentId\", segmentId);\n  const query = params.toString() ? `?${params.toString()}` : \"\";\n  return request(`/teacher/classes/${encodeURIComponent(classId)}/live-assessment-status${query}`, {\n    method: \"GET\",\n    token,\n  });\n}\n\nexport async function getAdminDashboard(token) {\n  return request(\"/admin/dashboard\", {\n    method: \"GET\",\n    token,\n  });\n}\n\nexport async function createTeacher(token, payload) {\n  return request(\"/admin/teachers\", {\n    method: \"POST\",\n    token,\n    body: payload,\n  });\n}\n\nexport async function deleteTeacher(token, username) {\n  return request(`/admin/teachers/${encodeURIComponent(username)}`, {\n    method: \"DELETE\",\n    token,\n  });\n}\n\n","import { createContext, createElement, useCallback, useContext, useEffect, useMemo, useState } from \"react\";\nimport { verify } from \"../lib/api.js\";\n\nconst STORAGE_KEY = \"ibcs.session\";\nconst SessionContext = createContext(null);\n\nfunction readSession() {\n  try {\n    const raw = window.localStorage.getItem(STORAGE_KEY);\n    if (!raw) return null;\n    const parsed = JSON.parse(raw);\n    if (parsed && typeof parsed === \"object\" && parsed.token && parsed.user) {\n      return parsed;\n    }\n  } catch (error) {\n    console.warn(\"Failed to read session\", error);\n  }\n  return null;\n}\n\nfunction writeSession(value) {\n  try {\n    if (value) {\n      window.localStorage.setItem(STORAGE_KEY, JSON.stringify(value));\n    } else {\n      window.localStorage.removeItem(STORAGE_KEY);\n    }\n  } catch (error) {\n    console.warn(\"Failed to persist session\", error);\n  }\n}\n\nexport function SessionProvider({ children }) {\n  const [session, setSessionState] = useState(() => readSession());\n  const [ready, setReady] = useState(false);\n\n  const mergeUsers = useCallback((prevUser = {}, nextUser = {}) => {\n    return {\n      ...prevUser,\n      ...nextUser,\n    };\n  }, []);\n\n  useEffect(() => {\n    let cancelled = false;\n\n    async function checkSession() {\n      if (!session?.token) {\n        if (!cancelled) setReady(true);\n        return;\n      }\n      try {\n        const data = await verify(session.token);\n        if (cancelled) return;\n        if (data?.valid && data.user) {\n          setSessionState((prev) => {\n            if (!prev) return prev;\n            const mergedUser = mergeUsers(prev.user, data.user);\n            const nextSession = {\n              token: prev.token,\n              user: mergedUser,\n            };\n            writeSession(nextSession);\n            return nextSession;\n          });\n        } else {\n          writeSession(null);\n          setSessionState(null);\n        }\n      } catch (error) {\n        console.warn(\"Session verification failed\", error);\n        if (!cancelled) {\n          writeSession(null);\n          setSessionState(null);\n        }\n      } finally {\n        if (!cancelled) setReady(true);\n      }\n    }\n\n    checkSession();\n    return () => {\n      cancelled = true;\n    };\n  }, [mergeUsers, session?.token]);\n\n  const setSession = useCallback(\n    (value) => {\n      if (value && value.user) {\n        value = {\n          token: value.token,\n          user: { ...value.user },\n        };\n      }\n      writeSession(value);\n      setSessionState(value);\n    },\n    [setSessionState],\n  );\n\n  const clear = useCallback(() => {\n    writeSession(null);\n    setSessionState(null);\n  }, [setSessionState]);\n\n  const contextValue = useMemo(\n    () => ({\n      session,\n      setSession,\n      clear,\n      ready,\n    }),\n    [session, setSession, clear, ready],\n  );\n\n  return createElement(SessionContext.Provider, { value: contextValue }, children);\n}\n\nexport function useSession() {\n  const context = useContext(SessionContext);\n  if (!context) {\n    throw new Error(\"useSession must be used within a SessionProvider\");\n  }\n  return context;\n}\n","import { useEffect, useRef } from \"react\";\nimport \"./FeedbackPanel.css\";\n\n/**\n * FeedbackPanel component for displaying status messages\n * \n * @param {string} tone - Feedback tone: 'success' | 'error' | 'warning' | 'info'\n * @param {React.ReactNode} children - Feedback message content\n * @param {boolean} animated - Whether to animate on mount (default: true)\n * @param {string} className - Additional CSS classes\n */\nexport default function FeedbackPanel({ tone = \"info\", children, animated = true, className = \"\" }) {\n  const panelRef = useRef(null);\n\n  useEffect(() => {\n    if (animated && panelRef.current) {\n      // Trigger animation on mount\n      panelRef.current.classList.add(\"feedback-panel--animate\");\n      const timer = setTimeout(() => {\n        if (panelRef.current) {\n          panelRef.current.classList.remove(\"feedback-panel--animate\");\n        }\n      }, 300);\n      return () => clearTimeout(timer);\n    }\n  }, [animated]);\n\n  if (!children) return null;\n\n  const classes = [`feedback-panel`, `feedback-panel--${tone}`, className].filter(Boolean).join(\" \");\n\n  return (\n    <div ref={panelRef} className={classes} role=\"status\" aria-live=\"polite\">\n      {children}\n    </div>\n  );\n}\n\n","export default \"__VITE_ASSET__BPYvPCPi__\"","import { useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { login as loginRequest } from \"../lib/api.js\";\nimport { useSession } from \"../hooks/useSession.js\";\nimport FeedbackPanel from \"../components/ui/FeedbackPanel.jsx\";\nimport logo from \"../assets/logo.svg\";\nimport \"./LoginPage.css\";\n\nconst initialState = { status: \"idle\", message: \"\" };\n\nfunction LoginPage() {\n  const [role, setRole] = useState(\"teacher\");\n  const [status, setStatus] = useState(initialState);\n  const { setSession } = useSession();\n  const navigate = useNavigate();\n\n  const roleLabel =\n    role === \"teacher\" ? \"Teacher\" : role === \"student\" ? \"Student\" : \"Admin\";\n\n  const handleSubmit = async (event) => {\n    event.preventDefault();\n    const form = event.currentTarget;\n    const username = form.username.value.trim();\n    const password = form.password.value;\n\n    if (!username || !password) {\n      setStatus({ status: \"error\", message: \"Enter username and password.\" });\n      return;\n    }\n\n    setStatus({ status: \"loading\", message: `Signing in as ${roleLabel}â€¦` });\n\n    try {\n      const response = await loginRequest({ role, username, password });\n      if (!response?.token || !response?.user) {\n        throw new Error(\"Unexpected login response\");\n      }\n      setSession({ token: response.token, user: response.user });\n      setStatus({ status: \"success\", message: \"Signed in.\" });\n      if (response.user.role === \"admin\") {\n        navigate(\"/admin\", { replace: true });\n      } else if (response.user.role === \"teacher\") {\n        navigate(\"/dashboard\", { replace: true });\n      } else {\n        navigate(\"/student\", { replace: true });\n      }\n    } catch (error) {\n      setStatus({ status: \"error\", message: error.message || \"Login failed\" });\n    }\n  };\n\n  return (\n    <div className=\"login-container\">\n      <section className=\"login-card\">\n        <header className=\"login-card__header\">\n          <img src={logo} alt=\"School crest\" className=\"login-card__logo\" />\n          <div>\n            <h1>Computer Science Department</h1>\n            <p className=\"muted\">Sign in to access the teaching dashboards and curriculum map.</p>\n          </div>\n        </header>\n\n        <div className=\"login-role\">\n          <span>Sign in as</span>\n          <div className=\"login-role__toggle\" role=\"group\" aria-label=\"Choose account role\">\n            <button\n              type=\"button\"\n              className={role === \"teacher\" ? \"active\" : \"\"}\n              onClick={() => {\n                setRole(\"teacher\");\n                setStatus(initialState);\n              }}\n            >\n              Teacher\n            </button>\n            <button\n              type=\"button\"\n              className={role === \"student\" ? \"active\" : \"\"}\n              onClick={() => {\n                setRole(\"student\");\n                setStatus(initialState);\n              }}\n            >\n              Student\n            </button>\n            <button\n              type=\"button\"\n              className={role === \"admin\" ? \"active\" : \"\"}\n              onClick={() => {\n                setRole(\"admin\");\n                setStatus(initialState);\n              }}\n            >\n              Admin\n            </button>\n          </div>\n        </div>\n\n        <form onSubmit={handleSubmit} className=\"login-form\">\n          <label>\n            <span>Username</span>\n            <input name=\"username\" required autoComplete=\"username\" />\n          </label>\n          <label>\n            <span>Password</span>\n            <input name=\"password\" type=\"password\" required autoComplete=\"current-password\" />\n          </label>\n          <button type=\"submit\" className=\"login-submit\" disabled={status.status === \"loading\"}>\n            {status.status === \"loading\" ? \"Workingâ€¦\" : `Log in as ${roleLabel}`}\n          </button>\n          {status.message && (\n            <FeedbackPanel tone={status.status === \"error\" ? \"error\" : status.status === \"success\" ? \"success\" : \"info\"}>\n              {status.message}\n            </FeedbackPanel>\n          )}\n        </form>\n\n        <footer className=\"login-footnote\">\n          <p className=\"muted\">\n            Admins manage teacher accounts. Teachers manage classes and unlock curriculum. Students track their own\n            journey. Choose the right role above so we can route you to the correct dashboard.\n          </p>\n        </footer>\n      </section>\n    </div>\n  );\n}\n\nexport default LoginPage;\n","const PASSWORD_WORDS = [\n  'Aero',\n  'Blaze',\n  'Comet',\n  'Delta',\n  'Echo',\n  'Frost',\n  'Glimmer',\n  'Helio',\n  'Iris',\n  'Jade',\n  'Kite',\n  'Lumen',\n  'Nova',\n  'Orion',\n  'Pip',\n  'Quill',\n  'Rune',\n  'Sol',\n  'Terra',\n  'Vivid',\n  'Wisp',\n  'Xeno',\n  'Yarrow',\n  'Zephyr',\n];\n\nconst PASSWORD_SYMBOLS = ['!', '?', '@', '#', '$'];\n\nfunction selectRandom(list, randomSource = Math.random) {\n  if (!Array.isArray(list) || list.length === 0) {\n    return '';\n  }\n  const index = Math.floor(randomSource() * list.length);\n  return list[Math.max(0, Math.min(list.length - 1, index))];\n}\n\nexport function generatePassword(randomSource = Math.random) {\n  const word = selectRandom(PASSWORD_WORDS, randomSource);\n  const number = Math.floor(randomSource() * 90) + 10;\n  const symbol = selectRandom(PASSWORD_SYMBOLS, randomSource);\n  return `${word}${number}${symbol}`;\n}\n\nexport { PASSWORD_WORDS, PASSWORD_SYMBOLS };\n\n\n","export function classNames(...inputs) {\n  const classes = [];\n\n  const process = (value) => {\n    if (!value) return;\n    if (typeof value === \"string\") {\n      classes.push(value);\n      return;\n    }\n    if (Array.isArray(value)) {\n      value.forEach(process);\n      return;\n    }\n    if (typeof value === \"object\") {\n      for (const [key, condition] of Object.entries(value)) {\n        if (condition) classes.push(key);\n      }\n    }\n  };\n\n  inputs.forEach(process);\n\n  return classes.join(\" \");\n}\n\nexport default classNames;\n\n","import { classNames } from \"../../utils/classNames.js\";\n\nconst VARIANT_CLASS = {\n  default: null,\n  compact: \"content-container--compact\",\n  wide: \"content-container--wide\",\n  fullWidth: \"content-container--full\",\n};\n\nfunction ContentContainer({ variant = \"default\", className, children, ...props }) {\n  const variantClass = VARIANT_CLASS[variant] ?? VARIANT_CLASS.default;\n  return (\n    <div className={classNames(\"content-container\", variantClass, className)} {...props}>\n      {children}\n    </div>\n  );\n}\n\nexport default ContentContainer;\n\n","import { classNames } from \"../../utils/classNames.js\";\n\nfunction normalizeUnit(value) {\n  if (value == null) return undefined;\n  if (typeof value === \"number\") {\n    return `${value}px`;\n  }\n  return value;\n}\n\nfunction ResponsiveGrid({\n  columns,\n  minColumnWidth = 280,\n  variant = \"grid\",\n  className,\n  children,\n  style,\n  ...props\n}) {\n  const resolvedStyle = { ...style };\n\n  if (variant !== \"masonry\" && columns) {\n    const base = columns.base ?? columns.xs ?? columns.sm ?? columns.md ?? columns.lg ?? 1;\n    resolvedStyle[\"--columns-base\"] = base;\n    if (columns.sm != null) resolvedStyle[\"--columns-sm\"] = columns.sm;\n    if (columns.md != null) resolvedStyle[\"--columns-md\"] = columns.md;\n    if (columns.lg != null) resolvedStyle[\"--columns-lg\"] = columns.lg;\n    if (columns.xl != null) resolvedStyle[\"--columns-xl\"] = columns.xl;\n  }\n\n  if (variant === \"autoFit\") {\n    resolvedStyle[\"--min-column-width\"] = normalizeUnit(minColumnWidth);\n  }\n\n  const classes =\n    variant === \"masonry\"\n      ? classNames(\"responsive-grid--masonry\", className)\n      : classNames(\"responsive-grid\", variant === \"autoFit\" && \"responsive-grid--auto-fit\", className);\n\n  return (\n    <div className={classes} style={resolvedStyle} {...props}>\n      {children}\n    </div>\n  );\n}\n\nexport default ResponsiveGrid;\n\n","import { classNames } from \"../../utils/classNames.js\";\nimport \"./StatCard.css\";\n\nfunction clampProgress(progress) {\n  if (typeof progress !== \"number\" || Number.isNaN(progress)) {\n    return null;\n  }\n  return Math.max(0, Math.min(progress, 1));\n}\n\nfunction resolveNode(content, fallbackClassName) {\n  if (!content) return null;\n  if (typeof content === \"string\") {\n    return <span className={fallbackClassName}>{content}</span>;\n  }\n  return content;\n}\n\nfunction StatCard({\n  label,\n  value,\n  description,\n  badge,\n  icon,\n  meta,\n  actions,\n  progress,\n  progressLabel,\n  tone = \"default\",\n  compact = false,\n  className,\n  children,\n}) {\n  const clampedProgress = clampProgress(progress);\n  const progressPercentage = clampedProgress === null ? null : Math.round(clampedProgress * 100);\n\n  const badgeNode = resolveNode(badge, \"stat-card__badge\");\n  const metaNode = resolveNode(meta, \"stat-card__meta-text\");\n\n  return (\n    <article\n      className={classNames(\n        \"stat-card\",\n        tone && `stat-card--${tone}`,\n        compact && \"stat-card--compact\",\n        className,\n      )}\n    >\n      {(badgeNode || label || actions) && (\n        <div className=\"stat-card__top\">\n          <div className=\"stat-card__title\">\n            {badgeNode}\n            {label && <span className=\"stat-card__label\">{label}</span>}\n          </div>\n          {actions ? <div className=\"stat-card__actions\">{actions}</div> : null}\n        </div>\n      )}\n\n      {(value || description || icon || children) && (\n        <div className=\"stat-card__content\">\n          {icon ? (\n            <span className=\"stat-card__icon\" aria-hidden=\"true\">\n              {icon}\n            </span>\n          ) : null}\n          <div className=\"stat-card__metrics\">\n            {value ? <span className=\"stat-card__value\">{value}</span> : null}\n            {description ? <p className=\"stat-card__description\">{description}</p> : null}\n            {children}\n          </div>\n        </div>\n      )}\n\n      {metaNode ? <div className=\"stat-card__meta\">{metaNode}</div> : null}\n\n      {progressPercentage !== null ? (\n        <div className=\"stat-card__progress\" style={{ \"--stat-card-progress\": `${progressPercentage}%` }}>\n          <div\n            className=\"stat-card__progress-bar\"\n            role=\"progressbar\"\n            aria-valuenow={progressPercentage}\n            aria-valuemin=\"0\"\n            aria-valuemax=\"100\"\n          />\n        </div>\n      ) : null}\n\n      {progressLabel ? <div className=\"stat-card__progress-label\">{progressLabel}</div> : null}\n    </article>\n  );\n}\n\nexport default StatCard;\n\n\n","import classNames from \"../../utils/classNames.js\";\n\nimport \"./StatusBanner.css\";\n\nconst TONES = new Set([\"info\", \"success\", \"warning\", \"danger\", \"neutral\"]);\n\nexport default function StatusBanner({\n  tone = \"info\",\n  title,\n  icon,\n  children,\n  actions,\n  onDismiss,\n  className,\n  as: Component = \"div\",\n  ...props\n}) {\n  const normalizedTone = TONES.has(tone) ? tone : \"info\";\n\n  return (\n    <Component\n      className={classNames(\"status-banner\", `status-banner--${normalizedTone}`, className)}\n      role=\"status\"\n      {...props}\n    >\n      {icon ? (\n        <span className=\"status-banner__icon\" aria-hidden=\"true\">\n          {icon}\n        </span>\n      ) : null}\n      <div className=\"status-banner__content\">\n        {title ? <strong>{title}</strong> : null}\n        {children ? <div className=\"status-banner__body\">{children}</div> : null}\n      </div>\n      {actions ? <div className=\"status-banner__actions\">{actions}</div> : null}\n      {onDismiss ? (\n        <button type=\"button\" className=\"status-banner__dismiss\" onClick={onDismiss} aria-label=\"Dismiss\">\n          Ã—\n        </button>\n      ) : null}\n    </Component>\n  );\n}\n\n\n","import { useEffect, useRef } from \"react\";\nimport \"./Modal.css\";\n\n/**\n * Modal component with focus trap, keyboard handling, and ARIA attributes\n * \n * @param {boolean} isOpen - Whether the modal is open\n * @param {function} onClose - Callback when modal should close\n * @param {string} title - Modal title (used for aria-labelledby)\n * @param {React.ReactNode} children - Modal content\n * @param {string} size - Modal size: 'sm' | 'md' | 'lg' | 'full' (default: 'md')\n * @param {boolean} closeOnBackdropClick - Whether to close on backdrop click (default: true)\n * @param {boolean} closeOnEscape - Whether to close on Escape key (default: true)\n */\nexport default function Modal({\n  isOpen,\n  onClose,\n  title,\n  children,\n  size = \"md\",\n  closeOnBackdropClick = true,\n  closeOnEscape = true,\n}) {\n  const modalRef = useRef(null);\n  const titleRef = useRef(null);\n  const previouslyFocusedElement = useRef(null);\n\n  // Focus trap: capture focus within modal\n  useEffect(() => {\n    if (!isOpen || !modalRef.current) return;\n\n    // Store previously focused element\n    previouslyFocusedElement.current = document.activeElement;\n\n    // Focus modal title or first focusable element\n    const firstFocusable = modalRef.current.querySelector(\n      'button, [href], input, select, textarea, [tabindex]:not([tabindex=\"-1\"])'\n    );\n    if (firstFocusable) {\n      firstFocusable.focus();\n    } else if (titleRef.current) {\n      titleRef.current.focus();\n    }\n\n    // Handle tab key to trap focus\n    const handleTab = (e) => {\n      if (!modalRef.current) return;\n\n      const focusableElements = modalRef.current.querySelectorAll(\n        'button, [href], input, select, textarea, [tabindex]:not([tabindex=\"-1\"])'\n      );\n      const firstElement = focusableElements[0];\n      const lastElement = focusableElements[focusableElements.length - 1];\n\n      if (e.shiftKey) {\n        // Shift + Tab\n        if (document.activeElement === firstElement) {\n          e.preventDefault();\n          lastElement?.focus();\n        }\n      } else {\n        // Tab\n        if (document.activeElement === lastElement) {\n          e.preventDefault();\n          firstElement?.focus();\n        }\n      }\n    };\n\n    // Handle Escape key\n    const handleEscape = (e) => {\n      if (closeOnEscape && e.key === \"Escape\") {\n        onClose();\n      }\n    };\n\n    document.addEventListener(\"keydown\", handleTab);\n    document.addEventListener(\"keydown\", handleEscape);\n\n    // Prevent body scroll when modal is open\n    document.body.style.overflow = \"hidden\";\n\n    return () => {\n      document.removeEventListener(\"keydown\", handleTab);\n      document.removeEventListener(\"keydown\", handleEscape);\n      document.body.style.overflow = \"\";\n\n      // Restore focus to previously focused element\n      if (previouslyFocusedElement.current) {\n        previouslyFocusedElement.current.focus();\n      }\n    };\n  }, [isOpen, onClose, closeOnEscape]);\n\n  if (!isOpen) return null;\n\n  const titleId = title ? `modal-title-${Math.random().toString(36).substr(2, 9)}` : undefined;\n\n  return (\n    <div className=\"modal-overlay\" role=\"presentation\">\n      <button\n        type=\"button\"\n        className=\"modal-overlay__backdrop\"\n        aria-label=\"Close modal\"\n        tabIndex={-1}\n        onClick={\n          closeOnBackdropClick\n            ? () => {\n                onClose?.();\n              }\n            : undefined\n        }\n        aria-hidden={closeOnBackdropClick ? undefined : \"true\"}\n      />\n      <div\n        ref={modalRef}\n        className={`modal-dialog modal-dialog--${size}`}\n        role=\"dialog\"\n        aria-modal=\"true\"\n        aria-labelledby={titleId}\n      >\n        {title && (\n          <header className=\"modal-header\">\n            <h2 id={titleId} ref={titleRef} className=\"modal-title\">\n              {title}\n            </h2>\n            <button\n              type=\"button\"\n              className=\"modal-close\"\n              onClick={onClose}\n              aria-label=\"Close modal\"\n            >\n              Ã—\n            </button>\n          </header>\n        )}\n        <div className=\"modal-content\">{children}</div>\n      </div>\n    </div>\n  );\n}\n","const IntroToCSLesson = {\n  id: \"lesson_cs_intro_001\",\n  title: \"Introduction to Computer Science\",\n  yearGroup: 7,\n  duration: 50,\n  objectives: [\n    \"Understand what computer science is\",\n    \"Identify the key components of a computer system\",\n    \"Recognize the difference between hardware and software\",\n    \"Apply computational thinking to solve a simple problem\",\n  ],\n  slides: [\n    {\n      id: \"slide_001\",\n      type: \"content\",\n      index: 0,\n      content: {\n        layout: \"centered\",\n        blocks: [\n          {\n            type: \"heading\",\n            level: 1,\n            text: \"Welcome to Computer Science! ðŸš€\",\n          },\n          {\n            type: \"interactive\",\n            component: \"ThinkPairShare\",\n            prompt: \"What do you think computer science is?\",\n            duration: 120,\n          },\n        ],\n      },\n      teacherNotes: \"Start with engagement. Let students discuss in pairs for 2 minutes.\",\n      minimumViewTime: 30,\n    },\n    {\n      id: \"slide_002\",\n      type: \"content\",\n      index: 1,\n      content: {\n        layout: \"split\",\n        blocks: [\n          {\n            type: \"objectives\",\n            objectives: [\n              \"Computer Science is the study of computation\",\n              \"It focuses on problem solving with algorithms\",\n              \"We build digital solutions to real problems\",\n            ],\n          },\n          {\n            type: \"paragraph\",\n            text: \"Tap each pillar to reveal examples.\",\n          },\n        ],\n      },\n      teacherNotes: \"Click each pillar to reveal. Emphasize problem-solving aspect.\",\n    },\n    {\n      id: \"slide_003\",\n      type: \"interactive\",\n      index: 2,\n      content: {\n        layout: \"full\",\n        blocks: [\n          {\n            type: \"sortingActivity\",\n            title: \"Hardware or Software?\",\n            instruction: \"Drag each item to the correct category\",\n            items: [\n              { id: \"mouse\", label: \"Mouse\", correct: \"hardware\" },\n              { id: \"windows\", label: \"Windows 11\", correct: \"software\" },\n              { id: \"ram\", label: \"RAM Memory\", correct: \"hardware\" },\n              { id: \"chrome\", label: \"Google Chrome\", correct: \"software\" },\n              { id: \"keyboard\", label: \"Keyboard\", correct: \"hardware\" },\n              { id: \"python\", label: \"Python\", correct: \"software\" },\n            ],\n            categories: [\"hardware\", \"software\"],\n            feedback: {\n              correct: \"ðŸŽ‰ Excellent! You understand the difference!\",\n              incorrect: \"Not quite. Remember: Hardware you can touch, Software you cannot.\",\n            },\n          },\n        ],\n      },\n      assessmentId: \"assess_hardware_software\",\n    },\n    {\n      id: \"slide_004\",\n      type: \"content\",\n      index: 3,\n      content: {\n        layout: \"interactive\",\n        blocks: [\n          {\n            type: \"heading\",\n            text: \"How Computers Think: Binary! ðŸ’¡\",\n          },\n          {\n            type: \"interactive\",\n            component: \"BinaryLightBulbs\",\n            levels: [\n              { target: 5, bulbs: 3 },\n              { target: 10, bulbs: 4 },\n              { target: 21, bulbs: 5 },\n            ],\n          },\n        ],\n      },\n      teacherNotes: \"Let students experiment. Show binary patterns on board.\",\n    },\n    {\n      id: \"slide_005\",\n      type: \"assessment\",\n      index: 4,\n      assessmentId: \"assess_computational_thinking\",\n      content: {\n        type: \"multipart\",\n        title: \"Computational Thinking Challenge\",\n        parts: [\n          {\n            type: \"sequencing\",\n            prompt: \"Put these steps in order to make a sandwich:\",\n            items: [\n              { id: 1, text: \"Get two slices of bread\" },\n              { id: 2, text: \"Spread butter on bread\" },\n              { id: 3, text: \"Add filling\" },\n              { id: 4, text: \"Put slices together\" },\n              { id: 5, text: \"Cut sandwich in half\" },\n            ],\n            correctOrder: [1, 2, 3, 4, 5],\n          },\n          {\n            type: \"pattern-recognition\",\n            prompt: \"What comes next in this pattern?\",\n            sequence: [\"2\", \"4\", \"8\", \"16\", \"?\"],\n            options: [\"20\", \"24\", \"32\", \"64\"],\n            correct: \"32\",\n          },\n        ],\n        timeLimit: 180,\n        experienceReward: 100,\n      },\n    },\n    {\n      id: \"slide_006\",\n      type: \"content\",\n      index: 5,\n      content: {\n        layout: \"gallery\",\n        blocks: [\n          {\n            type: \"gallery\",\n            items: [\n              {\n                title: \"Gaming\",\n                image: \"/images/gaming.jpg\",\n                description: \"Game engines use physics algorithms\",\n                link: \"explore_gaming_cs\",\n              },\n              {\n                title: \"Social Media\",\n                image: \"/images/social.jpg\",\n                description: \"Recommendation algorithms decide what you see\",\n                link: \"explore_social_cs\",\n              },\n              {\n                title: \"Medicine\",\n                image: \"/images/medicine.jpg\",\n                description: \"AI helps doctors diagnose diseases\",\n                link: \"explore_medical_cs\",\n              },\n              {\n                title: \"Environment\",\n                image: \"/images/environment.jpg\",\n                description: \"Climate models predict weather patterns\",\n                link: \"explore_climate_cs\",\n              },\n            ],\n          },\n        ],\n      },\n      teacherNotes: \"Click each card to reveal. Relate to student interests.\",\n    },\n    {\n      id: \"slide_007\",\n      type: \"interactive\",\n      index: 6,\n      content: {\n        layout: \"collaborative\",\n        blocks: [\n          {\n            type: \"heading\",\n            text: \"Team Challenge: Program a Robot! ðŸ¤–\",\n          },\n          {\n            type: \"interactive\",\n            component: \"RobotMaze\",\n            config: {\n              maze: [\n                [\"S\", \"0\", \"0\", \"W\"],\n                [\"W\", \"W\", \"0\", \"0\"],\n                [\"0\", \"0\", \"0\", \"W\"],\n                [\"W\", \"0\", \"G\", \"0\"],\n              ],\n              commands: [\"MOVE_FORWARD\", \"TURN_LEFT\", \"TURN_RIGHT\"],\n              maxCommands: 10,\n              teamSize: 2,\n              shareResults: true,\n            },\n            experiencePoints: 150,\n          },\n        ],\n      },\n      assessmentId: \"assess_robot_programming\",\n    },\n    {\n      id: \"slide_008\",\n      type: \"content\",\n      index: 7,\n      content: {\n        layout: \"reflection\",\n        blocks: [\n          {\n            type: \"heading\",\n            text: \"What Did We Learn Today? ðŸŽ“\",\n          },\n          {\n            type: \"reflectionPrompts\",\n            prompts: [\n              \"One thing that surprised me about computer science was...\",\n              \"I think computer science is important because...\",\n              \"One question I still have is...\",\n            ],\n            submitTo: \"teacherDashboard\",\n          },\n          {\n            type: \"badgeAward\",\n            badge: {\n              id: \"badge_cs_intro\",\n              name: \"CS Explorer\",\n              icon: \"ðŸ†\",\n              description: \"Completed Introduction to Computer Science\",\n              experiencePoints: 200,\n            },\n          },\n        ],\n      },\n      teacherNotes: \"Allow 5 minutes for reflection. Celebrate achievements!\",\n    },\n  ],\n  homework: {\n    id: \"hw_cs_intro_001\",\n    title: \"CS in My World\",\n    tasks: [\n      {\n        type: \"research\",\n        prompt: \"Find 3 examples of computer science in your home\",\n        submission: \"photo_upload\",\n      },\n      {\n        type: \"creative\",\n        prompt: \"Design your own simple algorithm for a daily task\",\n        submission: \"text_diagram\",\n      },\n    ],\n    dueInDays: 7,\n    experiencePoints: 100,\n  },\n};\n\nexport default IntroToCSLesson;\n\n","import IntroToCSLesson from \"./content/lessons/intro-to-cs.js\";\n\nfunction buildTeacherMeta(slide) {\n  if (!slide.teacherNotes) return null;\n  return {\n    headline: slide.teacherNotes,\n    script: Array.isArray(slide.teacherScript) ? slide.teacherScript : null,\n    prompts: slide.teacherPrompts || null,\n  };\n}\n\nfunction buildStudentMeta(slide) {\n  return {\n    headline: slide.content?.headline || slide.content?.title || null,\n  };\n}\n\nfunction transformSlide(slide, index) {\n  const baseType = slide.type === \"assessment\" ? \"assessment\" : slide.type;\n  return {\n    id: slide.id,\n    order: slide.order ?? index + 1,\n    index,\n    type: baseType,\n    title: slide.title || `Slide ${index + 1}`,\n    layout: slide.content?.layout ?? null,\n    duration: slide.duration ?? null,\n    allowRetry: slide.allowRetry !== false,\n    content: slide.content,\n    assessmentId: slide.assessmentId ?? null,\n    teacher: buildTeacherMeta(slide),\n    student: buildStudentMeta(slide),\n    checkpoint: slide.content?.checkpoint ?? null,\n  };\n}\n\nconst KS3_DECK = {\n    id: \"KS3-COMP-FOUNDATIONS\",\n    slug: \"ks3-computing-foundations\",\n    title: \"Computing Foundations (Teacher-Paced)\",\n    summary:\n      \"A teacher-led launch sequence for Year 7 computing. Slides mirror the teacher display, and the pacing pointer prevents students from racing ahead while keeping earlier material available for revision.\",\n    accent: \"#2563eb\",\n    icon: \"ðŸŽ¯\",\n    estimatedDuration: \"90 min\",\n    defaultAudience: \"ks3\",\n  lesson: IntroToCSLesson,\n  slides: IntroToCSLesson.slides.map(transformSlide),\n};\n\nconst LIVE_DECKS = [KS3_DECK];\n\nconst deckIndex = new Map();\nconst slideIndex = new Map();\n\nfor (const deck of LIVE_DECKS) {\n  deckIndex.set(deck.id, deck);\n  deck.slides.forEach((slide, position) => {\n    slideIndex.set(slide.id, {\n      deckId: deck.id,\n      deck,\n      slide,\n      index: position,\n    });\n  });\n}\n\nexport function listLiveDecks() {\n  return LIVE_DECKS.map((deck) => ({\n    id: deck.id,\n    title: deck.title,\n    summary: deck.summary,\n    accent: deck.accent,\n    icon: deck.icon,\n    estimatedDuration: deck.estimatedDuration ?? null,\n    slideCount: deck.slides.length,\n  }));\n}\n\nexport function getDefaultLiveDeck() {\n  return LIVE_DECKS[0] ?? null;\n}\n\nexport function getLiveDeckById(deckId) {\n  if (!deckId) return null;\n  return deckIndex.get(deckId) ?? null;\n}\n\nexport function getSlideById(slideId) {\n  if (!slideId) return null;\n  return slideIndex.get(slideId) ?? null;\n}\n\nexport function getSlideWithinDeck(deckId, slideId) {\n  const deck = getLiveDeckById(deckId);\n  if (!deck) return null;\n  const meta = deck.slides.find((slide) => slide.id === slideId);\n  if (!meta) return null;\n  return {\n    deckId: deck.id,\n    deck,\n    slide: meta,\n    index: deck.slides.indexOf(meta),\n  };\n}\n\nexport function getFirstSlide(deckId) {\n  const deck = deckId ? getLiveDeckById(deckId) : getDefaultLiveDeck();\n  if (!deck || deck.slides.length === 0) return null;\n  const slide = deck.slides[0];\n  return {\n    deckId: deck.id,\n    deck,\n    slide,\n    index: 0,\n  };\n}\n\nexport function getNextSlide(deckId, currentSlideId) {\n  const deck = deckId ? getLiveDeckById(deckId) : getDefaultLiveDeck();\n  if (!deck) return null;\n  if (!currentSlideId) {\n    return getFirstSlide(deck.id);\n  }\n  const currentIndex = deck.slides.findIndex((slide) => slide.id === currentSlideId);\n  if (currentIndex === -1) return null;\n  const nextSlide = deck.slides[currentIndex + 1];\n  if (!nextSlide) return null;\n  return {\n    deckId: deck.id,\n    deck,\n    slide: nextSlide,\n    index: currentIndex + 1,\n  };\n}\n\nexport function getPreviousSlide(deckId, currentSlideId) {\n  const deck = deckId ? getLiveDeckById(deckId) : getDefaultLiveDeck();\n  if (!deck) return null;\n  if (!currentSlideId) return null;\n  const currentIndex = deck.slides.findIndex((slide) => slide.id === currentSlideId);\n  if (currentIndex <= 0) return null;\n  const prevSlide = deck.slides[currentIndex - 1];\n  return {\n    deckId: deck.id,\n    deck,\n    slide: prevSlide,\n    index: currentIndex - 1,\n  };\n}\n\nexport function listSlidesForDeck(deckId) {\n  const deck = getLiveDeckById(deckId) ?? getDefaultLiveDeck();\n  if (!deck) return [];\n  return deck.slides.map((slide, index) => ({\n    id: slide.id,\n    title: slide.title,\n    order: slide.order ?? index + 1,\n    type: slide.type,\n    deckId: deck.id,\n    deckTitle: deck.title,\n    index,\n    layout: slide.layout ?? null,\n    lockByDefault: Boolean(slide.lockByDefault),\n  }));\n}\n\nexport function flattenSlides() {\n  return LIVE_DECKS.flatMap((deck) =>\n    deck.slides.map((slide, index) => ({\n      deckId: deck.id,\n      deckTitle: deck.title,\n      slideId: slide.id,\n      slideTitle: slide.title,\n      index,\n      type: slide.type,\n    })),\n  );\n}\n\nexport function normaliseHistory(deckId, history) {\n  const deck = getLiveDeckById(deckId);\n  if (!deck) return [];\n  const sequence = deck.slides.map((slide) => slide.id);\n  const seen = new Set();\n  const result = [];\n  for (const entry of Array.isArray(history) ? history : []) {\n    if (sequence.includes(entry) && !seen.has(entry)) {\n      seen.add(entry);\n      result.push(entry);\n    }\n  }\n  if (result.length === 0 && sequence.length > 0) {\n    result.push(sequence[0]);\n  }\n  return result;\n}\n\nexport function deriveAccessibleSlides(deckId, currentSlideId, history) {\n  const deck = getLiveDeckById(deckId);\n  if (!deck) return [];\n  const normalised = normaliseHistory(deckId, history);\n  const knownIds = new Set(normalised);\n  if (currentSlideId && !knownIds.has(currentSlideId)) {\n    knownIds.add(currentSlideId);\n    normalised.push(currentSlideId);\n  }\n  return normalised\n    .map((slideId) => {\n      const match = getSlideWithinDeck(deckId, slideId);\n      if (!match) return null;\n      return {\n        deckId: match.deckId,\n        slideId: match.slide.id,\n        title: match.slide.title,\n        type: match.slide.type,\n        layout: match.slide.layout ?? null,\n        order: match.slide.order ?? match.index + 1,\n        index: match.index,\n      };\n    })\n    .filter(Boolean)\n    .sort((a, b) => a.index - b.index);\n}\n\nexport function getSlideAfter(deckId, slideId, offset = 1) {\n  const deck = getLiveDeckById(deckId);\n  if (!deck) return null;\n  const index = deck.slides.findIndex((slide) => slide.id === slideId);\n  if (index === -1) return null;\n  const target = deck.slides[index + offset];\n  if (!target) return null;\n  return {\n    deckId: deck.id,\n    deck,\n    slide: target,\n    index: index + offset,\n  };\n}\n\nexport function describeSlide(slideId) {\n  const meta = getSlideById(slideId);\n  if (!meta) return null;\n  const { deck, slide, index } = meta;\n  return {\n    deckId: deck.id,\n    deckTitle: deck.title,\n    slideId: slide.id,\n    slideTitle: slide.title,\n    type: slide.type,\n    index,\n    order: slide.order ?? index + 1,\n    layout: slide.layout ?? null,\n  };\n}\n\nexport function getDeckSummary(deckId) {\n  const deck = getLiveDeckById(deckId);\n  if (!deck) return null;\n  return {\n    id: deck.id,\n    title: deck.title,\n    summary: deck.summary,\n    accent: deck.accent,\n    icon: deck.icon,\n    estimatedDuration: deck.estimatedDuration ?? null,\n    slideCount: deck.slides.length,\n  };\n}\n\nconst DEFAULT_DECK = getDefaultLiveDeck();\nconst DEFAULT_DECK_ID = DEFAULT_DECK?.id ?? null;\n\nexport const YEAR7_CURRICULUM = LIVE_DECKS.map((deck) => ({\n  id: deck.id,\n  title: deck.title,\n  summary: deck.summary,\n  accent: deck.accent,\n  icon: deck.icon,\n  lessons: deck.slides.map((slide, index) => ({\n    id: slide.id,\n    slug: slide.id,\n    order: slide.order ?? index + 1,\n    title: slide.title,\n    duration: slide.duration ?? null,\n    type: slide.type,\n    mode: slide.type,\n  })),\n}));\n\nexport const YEAR7_LESSON_SEQUENCE = listSlidesForDeck(DEFAULT_DECK_ID);\n\nexport function getYear7LessonById(lessonId) {\n  if (!lessonId) return null;\n  const described = describeSlide(lessonId);\n  if (!described) return null;\n  return {\n    id: described.slideId,\n    title: described.slideTitle,\n    unitId: described.deckId,\n    unitTitle: described.deckTitle,\n    mode: described.type,\n    order: described.order,\n    index: described.index,\n  };\n}\n\nexport function getYear7LessonIndex(lessonId) {\n  const meta = describeSlide(lessonId);\n  return meta?.index ?? -1;\n}\n\nexport function getYear7NextLesson(currentLessonId) {\n  if (!DEFAULT_DECK_ID) return null;\n  const next = getNextSlide(DEFAULT_DECK_ID, currentLessonId);\n  if (!next) return null;\n  return {\n    id: next.slide.id,\n    title: next.slide.title,\n    unitId: next.deckId,\n    unitTitle: next.deck.title,\n    index: next.index,\n    order: next.slide.order ?? next.index + 1,\n  };\n}\n\nexport function getYear7DefaultPointer() {\n  if (!DEFAULT_DECK_ID) return null;\n  const first = getFirstSlide(DEFAULT_DECK_ID);\n  if (!first) return null;\n  return {\n    unitId: first.deckId,\n    lessonId: first.slide.id,\n    index: first.index,\n  };\n}\n\nexport function listYear7Slides() {\n  return listSlidesForDeck(DEFAULT_DECK_ID);\n}\n\nexport function getYear7DeckById(deckId) {\n  return getLiveDeckById(deckId);\n}\n\nexport function getYear7SlideContent(lessonId) {\n  const meta = getSlideById(lessonId);\n  if (!meta) return null;\n  return {\n    deck: getDeckSummary(meta.deckId),\n    slide: meta.slide,\n    meta: describeSlide(lessonId),\n  };\n}\n\nexport function listYear7Decks() {\n  return listLiveDecks();\n}\n\nexport { LIVE_DECKS };\n\nexport const YEAR7_UNITS = [\n  {\n    id: \"y7-unit-1\",\n    title: \"Unit 1 Â· Introduction to Computing\",\n    summary:\n      \"Launch the course with live, teacher-paced slides that introduce digital systems, the IPO model, and collaborative routines.\",\n    focus: \"Teacher-paced live deck\",\n    estimatedHours: \"5â€“6 lessons\",\n    deckId: LIVE_DECKS[0]?.id ?? null,\n    status: \"available\",\n    icon: \"ðŸ§­\",\n    colour: \"#2563eb\",\n  },\n  {\n    id: \"y7-unit-2\",\n    title: \"Unit 2 Â· Digital Systems in Context\",\n    summary: \"Investigate real-world systems, sensors, and control loops through guided case studies.\",\n    focus: \"Project-based\",\n    estimatedHours: \"6 lessons\",\n    deckId: null,\n    status: \"upcoming\",\n    icon: \"ðŸ› ï¸\",\n    colour: \"#0ea5e9\",\n  },\n  {\n    id: \"y7-unit-3\",\n    title: \"Unit 3 Â· Computational Thinking\",\n    summary: \"Build decomposition, pattern recognition, abstraction, and algorithm skills with unplugged challenges.\",\n    focus: \"Unplugged + micro-tasks\",\n    estimatedHours: \"5 lessons\",\n    deckId: null,\n    status: \"upcoming\",\n    icon: \"ðŸ§©\",\n    colour: \"#6366f1\",\n  },\n  {\n    id: \"y7-unit-4\",\n    title: \"Unit 4 Â· Python Foundations\",\n    summary: \"Move from blocks to Python with short, confidence-building coding sprints.\",\n    focus: \"Coding labs\",\n    estimatedHours: \"6 lessons\",\n    deckId: null,\n    status: \"upcoming\",\n    icon: \"ðŸ\",\n    colour: \"#22c55e\",\n  },\n  {\n    id: \"y7-unit-5\",\n    title: \"Unit 5 Â· Data, Media & Representation\",\n    summary: \"Explore how computers store numbers, text, and media through interactive demos.\",\n    focus: \"Interactive media\",\n    estimatedHours: \"4 lessons\",\n    deckId: null,\n    status: \"upcoming\",\n    icon: \"ðŸŽ¨\",\n    colour: \"#f59e0b\",\n  },\n  {\n    id: \"y7-unit-6\",\n    title: \"Unit 6 Â· Create & Reflect\",\n    summary: \"Wrap the year with a mini project that blends research, making, and reflection.\",\n    focus: \"Capstone\",\n    estimatedHours: \"5 lessons\",\n    deckId: null,\n    status: \"upcoming\",\n    icon: \"ðŸš€\",\n    colour: \"#ef4444\",\n  },\n];\n\n\n","import { useCallback, useEffect, useMemo, useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport {\n  archiveStudent,\n  bulkCreateStudents,\n  createClass,\n  createStudent,\n  getTeacherDashboard,\n  regenerateClassCredentials,\n  updateClassPacing,\n} from \"../lib/api.js\";\nimport { generatePassword } from \"../../../shared/passwords.js\";\nimport { useSession } from \"../hooks/useSession.js\";\nimport ContentContainer from \"../components/ui/ContentContainer.jsx\";\nimport ResponsiveGrid from \"../components/ui/ResponsiveGrid.jsx\";\nimport StatCard from \"../components/ui/StatCard.jsx\";\nimport StatusBanner from \"../components/ui/StatusBanner.jsx\";\nimport Modal from \"../components/ui/Modal.jsx\";\nimport \"./TeacherDashboardPage.css\";\nimport { getYear7LessonById } from \"../../../shared/liveDecks.js\";\n\nconst STAGE_CONFIG = [\n  {\n    id: \"year7\",\n    label: \"Year 7\",\n    yearGroupLabel: \"Year 7\",\n    cohortOffset: 7,\n    groups: [\"A\", \"B\", \"C\", \"D\"],\n    programme: \"ks3\",\n    buildCode: (cohort, group) => `CsC/${cohort}F${group}`,\n  },\n  {\n    id: \"year8\",\n    label: \"Year 8\",\n    yearGroupLabel: \"Year 8\",\n    cohortOffset: 6,\n    groups: [\"A\", \"B\", \"C\", \"D\"],\n    programme: \"ks3\",\n    buildCode: (cohort, group) => `CsC/${cohort}F${group}`,\n  },\n  {\n    id: \"year9\",\n    label: \"Year 9\",\n    yearGroupLabel: \"Year 9\",\n    cohortOffset: 5,\n    groups: [\"A\", \"B\", \"C\", \"D\"],\n    programme: \"ks3\",\n    buildCode: (cohort, group) => `CsC/${cohort}F${group}`,\n  },\n  {\n    id: \"igcse\",\n    label: \"IGCSE\",\n    yearGroupLabel: \"IGCSE\",\n    cohortOffset: 4,\n    groups: [\"G1\", \"G2\"],\n    programme: \"igcse\",\n    buildCode: (cohort, group) => `CsC/${cohort}${group}`,\n  },\n  {\n    id: \"ib\",\n    label: \"IB\",\n    yearGroupLabel: \"IB\",\n    cohortOffset: 2,\n    groups: [\"SL\", \"HL\"],\n    programme: (group) => (group === \"HL\" ? \"ib-hl\" : \"ib-sl\"),\n    buildCode: (cohort, group) => `CsC/${cohort}${group}`,\n  },\n];\n\nconst CSV_TEMPLATE = \"firstName,lastName,username\\n\";\nconst PASSWORD_STORAGE_KEY = \"ibcs.teacherPasswords\";\n\nfunction upsertClassPacingRecords(list = [], pacing) {\n  if (!pacing?.classId) return Array.isArray(list) ? list : [];\n  const filtered = (list ?? []).filter((item) => item?.classId !== pacing.classId);\n  return [...filtered, pacing];\n}\n\nfunction isYear7ClassRecord(classRecord) {\n  return (classRecord?.yearGroup ?? \"\").toLowerCase().includes(\"year 7\");\n}\n\nfunction readStoredPasswords() {\n  if (typeof window === \"undefined\") return {};\n  try {\n    const raw = window.localStorage.getItem(PASSWORD_STORAGE_KEY);\n    if (!raw) return {};\n    const parsed = JSON.parse(raw);\n    return parsed && typeof parsed === \"object\" ? parsed : {};\n  } catch {\n    return {};\n  }\n}\n\nfunction writeStoredPasswords(map) {\n  if (typeof window === \"undefined\") return;\n  try {\n    window.localStorage.setItem(PASSWORD_STORAGE_KEY, JSON.stringify(map));\n  } catch {\n    // Ignore storage write failures (private browsing, etc.)\n  }\n}\n\nfunction usernameKey(username) {\n  return `username:${username.toLowerCase()}`;\n}\n\nfunction rememberPasswords(prev, entries) {\n  const next = { ...prev };\n  for (const entry of entries) {\n    if (!entry?.password) continue;\n    if (entry.id) {\n      next[entry.id] = entry.password;\n    }\n    if (entry.username) {\n      next[usernameKey(entry.username)] = entry.password;\n    }\n  }\n  return next;\n}\n\nfunction resolveStoredPassword(map, student) {\n  const byId = student?.id ? map[student.id] : undefined;\n  if (byId) return byId;\n  if (student?.username) {\n    return map[usernameKey(student.username)];\n  }\n  return undefined;\n}\n\nfunction getStageConfig(stageId) {\n  return STAGE_CONFIG.find((item) => item.id === stageId) ?? STAGE_CONFIG[0];\n}\n\nfunction padCohort(value) {\n  const digits = String(value).replace(/\\D/g, \"\");\n  if (!digits) return \"\";\n  return digits.slice(-2).padStart(2, \"0\");\n}\n\nfunction defaultCohort(offsetYears) {\n  const year = new Date().getFullYear();\n  const cohort = (year % 100) + offsetYears;\n  return padCohort(cohort);\n}\n\nfunction generateClassCode(stageId, cohort, group) {\n  const config = getStageConfig(stageId);\n  const cleanedGroup = group?.toUpperCase() ?? \"\";\n  const cleanedCohort = padCohort(cohort || defaultCohort(config.cohortOffset));\n  return config.buildCode(cleanedCohort, cleanedGroup);\n}\n\nfunction deriveProgramme(stageId, group) {\n  const config = getStageConfig(stageId);\n  if (typeof config.programme === \"function\") {\n    return config.programme(group?.toUpperCase());\n  }\n  return config.programme;\n}\n\nfunction deriveYearGroupLabel(stageId, group) {\n  const config = getStageConfig(stageId);\n  if (stageId === \"ib\") {\n    return `IB ${group?.toUpperCase() === \"HL\" ? \"HL\" : \"SL\"}`;\n  }\n  if (stageId === \"igcse\") {\n    return \"IGCSE\";\n  }\n  return config.yearGroupLabel;\n}\n\nfunction parseClassMeta(classItem) {\n  const className = classItem?.className ?? \"\";\n  const yearGroup = (classItem?.yearGroup ?? \"\").toLowerCase();\n  let stageId = null;\n  if (yearGroup.includes(\"year 7\")) stageId = \"year7\";\n  else if (yearGroup.includes(\"year 8\")) stageId = \"year8\";\n  else if (yearGroup.includes(\"year 9\")) stageId = \"year9\";\n  else if (yearGroup.includes(\"igcse\")) stageId = \"igcse\";\n  else if (yearGroup.includes(\"hl\") || yearGroup.includes(\"sl\") || yearGroup.includes(\"ib\")) stageId = \"ib\";\n\n  const match = className.match(/^CsC\\/(\\d{2})([A-Za-z0-9]+)$/);\n  const cohort = match ? match[1] : \"\";\n  let group = match ? match[2].toUpperCase() : \"\";\n\n  if (stageId === \"year7\" || stageId === \"year8\" || stageId === \"year9\") {\n    group = group.replace(/^F/, \"\");\n  }\n  if (stageId === \"igcse\" && !group.startsWith(\"G\")) {\n    group = `G${group}`;\n  }\n  if (stageId === \"ib\") {\n    group = group === \"HL\" ? \"HL\" : \"SL\";\n  }\n\n  const programme = deriveProgramme(stageId ?? \"year7\", group);\n  const yearGroupLabel = deriveYearGroupLabel(stageId ?? \"year7\", group);\n\n  return {\n    stageId: stageId ?? \"year7\",\n    cohort: cohort || defaultCohort(getStageConfig(stageId ?? \"year7\").cohortOffset),\n    group: group || getStageConfig(stageId ?? \"year7\").groups[0],\n    programme,\n    yearGroupLabel,\n  };\n}\n\nfunction extractPlainPassword(student) {\n  const candidates = [\n    student?.passwordPlain,\n    student?.initialPassword,\n    student?.passwordPreview,\n    student?.defaultPassword,\n    student?.password,\n  ];\n  for (const candidate of candidates) {\n    if (typeof candidate !== \"string\") continue;\n    const trimmed = candidate.trim();\n    if (!trimmed) continue;\n    if (/^\\$2[aby]\\$/.test(trimmed)) {\n      continue;\n    }\n    return trimmed;\n  }\n  return \"\";\n}\n\nfunction parseCsvStudents(text) {\n  const rows = text\n    .split(/\\r?\\n/)\n    .map((line) => line.trim())\n    .filter(Boolean);\n\n  if (rows.length <= 1) {\n    return [];\n  }\n\n  const header = rows[0].split(/\\s*,\\s*/).map((h) => h.toLowerCase());\n  const firstNameIndex = header.indexOf(\"firstname\");\n  const lastNameIndex = header.indexOf(\"lastname\");\n  const usernameIndex = header.indexOf(\"username\");\n\n  if (firstNameIndex === -1 || lastNameIndex === -1) {\n    throw new Error(\"Template must include firstName and lastName columns.\");\n  }\n\n  return rows.slice(1).map((row) => {\n    const cells = row.split(/\\s*,\\s*/);\n    return {\n      firstName: cells[firstNameIndex] ?? \"\",\n      lastName: cells[lastNameIndex] ?? \"\",\n      username: usernameIndex === -1 ? \"\" : cells[usernameIndex] ?? \"\",\n    };\n  });\n}\n\nfunction downloadTemplate() {\n  const blob = new Blob([CSV_TEMPLATE], { type: \"text/csv\" });\n  const url = URL.createObjectURL(blob);\n  const link = document.createElement(\"a\");\n  link.href = url;\n  link.download = \"ibcs-student-template.csv\";\n  document.body.appendChild(link);\n  link.click();\n  document.body.removeChild(link);\n  URL.revokeObjectURL(url);\n}\n\nfunction TeacherDashboardPage() {\n  const { session, ready } = useSession();\n  const navigate = useNavigate();\n  const token = session?.token ?? null;\n  const isTeacher = session?.user?.role === \"teacher\";\n\n  const [dashboard, setDashboard] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [status, setStatus] = useState(null);\n  const [selectedClassId, setSelectedClassId] = useState(null);\n\n  const [classModalOpen, setClassModalOpen] = useState(false);\n  const [studentModal, setStudentModal] = useState(null);\n  const [pacingState, setPacingState] = useState({});\n\n  const [classForm, setClassForm] = useState(() => {\n    const stage = STAGE_CONFIG[0];\n    const cohort = defaultCohort(stage.cohortOffset);\n    const group = stage.groups[0];\n    return {\n      stageId: stage.id,\n      cohort,\n      group,\n      className: generateClassCode(stage.id, cohort, group),\n      description: \"\",\n    };\n  });\n\n  const [studentForm, setStudentForm] = useState({\n    firstName: \"\",\n    lastName: \"\",\n    username: \"\",\n    password: generatePassword(),\n  });\n\n  const [bulkCsv, setBulkCsv] = useState(null);\n  const [bulkStatus, setBulkStatus] = useState(null);\n  const [passwordLookup, setPasswordLookupState] = useState(() => readStoredPasswords());\n  const [visiblePasswords, setVisiblePasswords] = useState({});\n\n  const updatePasswordLookup = useCallback((updater) => {\n    setPasswordLookupState((prev) => {\n      const result = typeof updater === \"function\" ? updater(prev) : updater;\n      const next = result ? result : {};\n      writeStoredPasswords(next);\n      return next;\n    });\n  }, []);\n\n  useEffect(() => {\n    if (!ready) return;\n    if (!isTeacher) {\n      updatePasswordLookup({});\n      navigate(\"/\", { replace: true });\n    }\n  }, [ready, isTeacher, navigate, updatePasswordLookup]);\n\n  const loadDashboard = useCallback(async () => {\n    if (!token || !isTeacher) return;\n    setLoading(true);\n    try {\n      const data = await getTeacherDashboard(token);\n      setDashboard(data);\n      if (Array.isArray(data?.students)) {\n        const entries = [];\n        for (const student of data.students) {\n          const plain = extractPlainPassword(student);\n          if (plain) {\n            entries.push({ id: student.id, username: student.username, password: plain });\n          }\n        }\n        if (entries.length > 0) {\n          updatePasswordLookup((prev) => rememberPasswords(prev, entries));\n        }\n      }\n    } catch (error) {\n      setStatus({ tone: \"error\", message: error.message || \"Failed to load dashboard.\" });\n    } finally {\n      setLoading(false);\n    }\n  }, [token, isTeacher, updatePasswordLookup]);\n\n  useEffect(() => {\n    if (!ready || !isTeacher) return;\n    loadDashboard();\n  }, [ready, isTeacher, loadDashboard]);\n\n  const classes = useMemo(() => {\n    const list = dashboard?.classes ?? [];\n    return [...list].sort((a, b) => a.className.localeCompare(b.className));\n  }, [dashboard?.classes]);\n\n  useEffect(() => {\n    if (classes.length === 0) {\n      setSelectedClassId(null);\n      return;\n    }\n    setSelectedClassId((prev) => {\n      if (prev && classes.some((clazz) => clazz.id === prev)) {\n        return prev;\n      }\n      return classes[0].id;\n    });\n  }, [classes]);\n\n  const studentsByClass = useMemo(() => {\n    const map = new Map();\n    for (const student of dashboard?.students ?? []) {\n      if (!map.has(student.classId)) {\n        map.set(student.classId, []);\n      }\n      map.get(student.classId).push(student);\n    }\n    for (const list of map.values()) {\n      list.sort((a, b) => a.displayName.localeCompare(b.displayName));\n    }\n    return map;\n  }, [dashboard?.students]);\n\n  const classPacingMap = useMemo(() => {\n    const map = new Map();\n    for (const entry of dashboard?.classPacing ?? []) {\n      if (entry?.classId) {\n        map.set(entry.classId, entry);\n      }\n    }\n    return map;\n  }, [dashboard?.classPacing]);\n\n  const selectedClass = useMemo(() => classes.find((clazz) => clazz.id === selectedClassId) ?? null, [classes, selectedClassId]);\n  const selectedStudents = useMemo(\n    () => (selectedClass ? studentsByClass.get(selectedClass.id) ?? [] : []),\n    [selectedClass, studentsByClass],\n  );\n  const selectedClassMeta = useMemo(() => (selectedClass ? parseClassMeta(selectedClass) : null), [selectedClass]);\n  const selectedPacing = selectedClass ? classPacingMap.get(selectedClass.id) ?? null : null;\n  const selectedPacingLesson = selectedPacing ? getYear7LessonById(selectedPacing.lessonId) : null;\n  const numberFormatter = useMemo(() => new Intl.NumberFormat(), []);\n  const classSummaryCards = useMemo(() => {\n    if (!selectedClass) return [];\n    const totalLessons = availableLessons + lockedLessons;\n    const formattedStudents = numberFormatter.format(selectedStudents.length);\n    const formattedAvailable = numberFormatter.format(availableLessons);\n    const formattedLocked = numberFormatter.format(lockedLessons);\n    const formattedTotalLessons = numberFormatter.format(totalLessons);\n    return [\n      {\n        key: \"students\",\n        label: \"Total students\",\n        value: formattedStudents,\n      },\n      {\n        key: \"available\",\n        label: \"Lessons available\",\n        value: formattedAvailable,\n        progress: totalLessons > 0 ? availableLessons / totalLessons : null,\n        progressLabel:\n          totalLessons > 0\n            ? `${formattedAvailable} of ${formattedTotalLessons} open`\n            : \"No lessons unlocked yet\",\n      },\n      {\n        key: \"locked\",\n        label: \"Lessons locked\",\n        value: formattedLocked,\n        progress: totalLessons > 0 ? lockedLessons / totalLessons : null,\n        progressLabel:\n          totalLessons > 0\n            ? `${formattedLocked} awaiting release`\n            : \"All lessons unlocked\",\n      },\n    ];\n  }, [availableLessons, lockedLessons, numberFormatter, selectedClass, selectedStudents.length]);\n  const selectedPacingInfo = selectedClass ? pacingState[selectedClass.id] : null;\n  const isYear7Selected = selectedClass ? isYear7ClassRecord(selectedClass) : false;\n\n  const clearPacingMessage = useCallback((classId) => {\n    setTimeout(() => {\n      setPacingState((prev) => {\n        const current = prev[classId];\n        if (!current || current.busy) {\n          return prev;\n        }\n        const next = { ...prev };\n        delete next[classId];\n        return next;\n      });\n    }, 4000);\n  }, []);\n\n  const handleStartPacing = useCallback(\n    async (classId) => {\n      if (!token) return;\n      setPacingState((prev) => ({\n        ...prev,\n        [classId]: {\n          ...(prev[classId] ?? {}),\n          busy: true,\n          message: \"Updating pointerâ€¦\",\n          tone: \"info\",\n        },\n      }));\n\n      try {\n        const response = await updateClassPacing(token, classId, { command: \"start\" });\n        if (response?.pacing) {\n          setDashboard((prev) => ({\n            ...prev,\n            classPacing: upsertClassPacingRecords(prev?.classPacing, response.pacing),\n          }));\n        }\n        const lessonTitle = response?.lesson?.title ?? \"Lesson 1\";\n        setPacingState((prev) => ({\n          ...prev,\n          [classId]: {\n            busy: false,\n            message: `Pointer set to ${lessonTitle}`,\n            tone: \"success\",\n          },\n        }));\n      } catch (error) {\n        setPacingState((prev) => ({\n          ...prev,\n          [classId]: {\n            busy: false,\n            message: error?.message || \"Unable to update the teaching pointer.\",\n            tone: \"error\",\n          },\n        }));\n      } finally {\n        clearPacingMessage(classId);\n      }\n    },\n    [token, clearPacingMessage],\n  );\n\n  const handleAdvancePacing = useCallback(\n    async (classId) => {\n      if (!token) return;\n      setPacingState((prev) => ({\n        ...prev,\n        [classId]: {\n          ...(prev[classId] ?? {}),\n          busy: true,\n          message: \"Advancing pointerâ€¦\",\n          tone: \"info\",\n        },\n      }));\n\n      try {\n        const response = await updateClassPacing(token, classId, { command: \"advance\" });\n        if (response?.pacing) {\n          setDashboard((prev) => ({\n            ...prev,\n            classPacing: upsertClassPacingRecords(prev?.classPacing, response.pacing),\n          }));\n        }\n        const lessonTitle = response?.lesson?.title ?? \"the next lesson\";\n        setPacingState((prev) => ({\n          ...prev,\n          [classId]: {\n            busy: false,\n            message: `Advanced to ${lessonTitle}`,\n            tone: \"success\",\n          },\n        }));\n      } catch (error) {\n        setPacingState((prev) => ({\n          ...prev,\n          [classId]: {\n            busy: false,\n            message: error?.message || \"Unable to advance the pointer.\",\n            tone: \"error\",\n          },\n        }));\n      } finally {\n        clearPacingMessage(classId);\n      }\n    },\n    [token, clearPacingMessage],\n  );\n\n  const handleStopPacing = useCallback(\n    async (classId) => {\n      if (!token || !classId) return;\n      setPacingState((prev) => ({\n        ...prev,\n        [classId]: {\n          ...(prev[classId] ?? {}),\n          busy: true,\n          message: \"Saving pointerâ€¦\",\n          tone: \"info\",\n        },\n      }));\n\n      try {\n        const response = await updateClassPacing(token, classId, { command: \"stop\" });\n        if (response?.pacing) {\n          setDashboard((prev) => ({\n            ...prev,\n            classPacing: upsertClassPacingRecords(prev?.classPacing, response.pacing),\n          }));\n        }\n        const lessonTitle = response?.lesson?.title ?? \"current lesson\";\n        setPacingState((prev) => ({\n          ...prev,\n          [classId]: {\n            busy: false,\n            message: `Pointer saved at ${lessonTitle}`,\n            tone: \"success\",\n          },\n        }));\n      } catch (error) {\n        setPacingState((prev) => ({\n          ...prev,\n          [classId]: {\n            busy: false,\n            message: error?.message || \"Unable to save the teaching pointer.\",\n            tone: \"error\",\n          },\n        }));\n      } finally {\n        clearPacingMessage(classId);\n      }\n    },\n    [token, clearPacingMessage],\n  );\n\n  const handleOpenYear7Map = useCallback(\n    (classId) => {\n      navigate(`/curriculum/year7?classId=${encodeURIComponent(classId)}`);\n    },\n    [navigate],\n  );\n\n  const teacherName =\n    dashboard?.teacher?.displayName ?? session?.user?.displayName ?? session?.user?.username ?? \"Teacher\";\n\n  const overallStudentCount = dashboard?.students?.length ?? 0;\n  const lockedLessons = dashboard?.lessonSummary?.locked ?? 0;\n  const availableLessons = dashboard?.lessonSummary?.available ?? 0;\n  const formativeComplete = dashboard?.lessonSummary?.[\"formative-complete\"] ?? 0;\n  const summativeComplete = dashboard?.lessonSummary?.[\"summative-complete\"] ?? 0;\nconst summaryCards = useMemo(\n    () => [\n      { label: \"Active classes\", value: numberFormatter.format(classes.length) },\n      { label: \"Active students\", value: numberFormatter.format(overallStudentCount) },\n      { label: \"Formative complete\", value: numberFormatter.format(formativeComplete) },\n      { label: \"Summative complete\", value: numberFormatter.format(summativeComplete) },\n    ],\n    [classes.length, formativeComplete, numberFormatter, overallStudentCount, summativeComplete],\n  );\n\n  const studentLookup = useMemo(() => {\n    const map = new Map();\n    for (const student of dashboard?.students ?? []) {\n      map.set(student.id, student);\n    }\n    return map;\n  }, [dashboard?.students]);\n\n  const studentProgressSummary = useMemo(() => {\n    const summaries = new Map();\n    for (const record of dashboard?.progress ?? []) {\n      if (!record?.studentId) continue;\n      const student = studentLookup.get(record.studentId);\n      if (!student) continue;\n      let summary = summaries.get(record.studentId);\n      if (!summary) {\n        summary = {\n          id: record.studentId,\n          displayName: student.displayName ?? student.username ?? \"Student\",\n          username: student.username ?? \"\",\n          locked: 0,\n          available: 0,\n          formativeComplete: 0,\n          summativeComplete: 0,\n          lastUpdated: null,\n        };\n        summaries.set(record.studentId, summary);\n      }\n      const statusValue = (record.status || \"locked\").toLowerCase();\n      if (statusValue === \"locked\") summary.locked += 1;\n      else if (statusValue === \"available\") summary.available += 1;\n      else if (statusValue === \"formative-complete\") summary.formativeComplete += 1;\n      else if (statusValue === \"summative-complete\") summary.summativeComplete += 1;\n      const updatedAt = record.updatedAt ? new Date(record.updatedAt).getTime() : null;\n      if (updatedAt && (!summary.lastUpdated || updatedAt > summary.lastUpdated)) {\n        summary.lastUpdated = updatedAt;\n      }\n    }\n    return Array.from(summaries.values()).sort((a, b) => a.displayName.localeCompare(b.displayName));\n  }, [dashboard?.progress, studentLookup]);\n\n  const studentsNeedingAttention = useMemo(() => {\n    return studentProgressSummary\n      .filter((item) => item.available > 0 && item.formativeComplete === 0)\n      .slice(0, 6);\n  }, [studentProgressSummary]);\n\n  const recentProgress = useMemo(() => {\n    const records = [...(dashboard?.progress ?? [])]\n      .filter((record) => record.updatedAt)\n      .sort((a, b) => new Date(b.updatedAt).getTime() - new Date(a.updatedAt).getTime())\n      .slice(0, 8)\n      .map((record) => {\n        const student = studentLookup.get(record.studentId);\n        return {\n          id: record.id ?? `${record.studentId}-${record.lessonSlug}`,\n          lesson: record.lessonSlug,\n          status: record.status,\n          updatedAt: record.updatedAt,\n          studentName: student?.displayName ?? student?.username ?? \"Student\",\n        };\n      });\n    return records;\n  }, [dashboard?.progress, studentLookup]);\n\n  const handleClassStageChange = (key, value) => {\n    setClassForm((prev) => {\n      if (key === \"stageId\") {\n        const config = getStageConfig(value);\n        const cohort = defaultCohort(config.cohortOffset);\n        const group = config.groups[0];\n        return {\n          stageId: value,\n          cohort,\n          group,\n          description: \"\",\n          className: generateClassCode(value, cohort, group),\n        };\n      }\n      if (key === \"cohort\") {\n        return {\n          ...prev,\n          cohort: value,\n          className: generateClassCode(prev.stageId, value, prev.group),\n        };\n      }\n      if (key === \"group\") {\n        return {\n          ...prev,\n          group: value,\n          className: generateClassCode(prev.stageId, prev.cohort, value),\n        };\n      }\n      return { ...prev, [key]: value };\n    });\n  };\n\n  const openClassModal = () => {\n    const stage = STAGE_CONFIG[0];\n    const cohort = defaultCohort(stage.cohortOffset);\n    const group = stage.groups[0];\n    setClassForm({\n      stageId: stage.id,\n      cohort,\n      group,\n      description: \"\",\n      className: generateClassCode(stage.id, cohort, group),\n    });\n    setStatus(null);\n    setClassModalOpen(true);\n  };\n\n  const submitClass = async (event) => {\n    event.preventDefault();\n    if (!token) return;\n    const config = getStageConfig(classForm.stageId);\n    const cohort = padCohort(classForm.cohort) || defaultCohort(config.cohortOffset);\n    const group = classForm.group || config.groups[0];\n    const className = generateClassCode(classForm.stageId, cohort, group);\n    const yearGroup = deriveYearGroupLabel(classForm.stageId, group);\n\n    try {\n      setStatus({ tone: \"info\", message: \"Creating classâ€¦\" });\n      const created = await createClass(token, {\n        className,\n        description: classForm.description || undefined,\n        yearGroup,\n      });\n      setStatus({ tone: \"success\", message: `Class ${className} created.` });\n      setClassModalOpen(false);\n      await loadDashboard();\n      if (created?.id) {\n        setSelectedClassId(created.id);\n      }\n    } catch (error) {\n      setStatus({ tone: \"error\", message: error.message || \"Unable to create class.\" });\n    }\n  };\n\n  const openStudentModal = (classItem, mode = \"single\") => {\n    const meta = parseClassMeta(classItem);\n    setStudentForm({\n      firstName: \"\",\n      lastName: \"\",\n      username: \"\",\n      password: generatePassword(),\n    });\n    setBulkCsv(null);\n    setBulkStatus(null);\n    setStudentModal({ classItem: classItem, meta, mode });\n  };\n\n  const handleStudentFormChange = (field, value) => {\n    setStudentForm((prev) => {\n      const next = { ...prev, [field]: value };\n      if ((field === \"firstName\" || field === \"lastName\") && !prev.username) {\n        const first = (field === \"firstName\" ? value : prev.firstName).trim();\n        const last = (field === \"lastName\" ? value : prev.lastName).trim();\n        if (first && last) {\n          next.username = `${first[0] ?? \"\"}${last}`.toLowerCase().replace(/[^a-z0-9]/g, \"\");\n        }\n      }\n      return next;\n    });\n  };\n\n  const submitStudent = async (event) => {\n    event.preventDefault();\n    if (!token || !studentModal) return;\n\n    const meta = studentModal.meta;\n    const classId = studentModal.classItem.id;\n    const firstName = studentForm.firstName.trim();\n    const lastName = studentForm.lastName.trim();\n    const username = studentForm.username.trim();\n    const password = studentForm.password || generatePassword();\n\n    if (!firstName || !lastName) {\n      setStatus({ tone: \"error\", message: \"First name and surname are required.\" });\n      return;\n    }\n\n    if (!username) {\n      setStatus({ tone: \"error\", message: \"Username is required.\" });\n      return;\n    }\n\n    try {\n      setStatus({ tone: \"info\", message: \"Adding studentâ€¦\" });\n      const created = await createStudent(token, {\n        classId,\n        firstName,\n        lastName,\n        username,\n        password,\n        yearGroup: meta.yearGroupLabel,\n        programme: meta.programme,\n      });\n      updatePasswordLookup((prev) => rememberPasswords(prev, [{ id: created.id, username: created.username, password }]));\n      setVisiblePasswords((prev) => ({ ...prev, [created.id]: true }));\n      setStudentModal(null);\n      await loadDashboard();\n      setStatus({ tone: \"success\", message: `${firstName} ${lastName} added to ${studentModal.classItem.className}.` });\n    } catch (error) {\n      setStatus({ tone: \"error\", message: error.message || \"Unable to add student.\" });\n    }\n  };\n\n  const submitBulkStudents = async (event) => {\n    event.preventDefault();\n    if (!token || !studentModal || !bulkCsv) {\n      setBulkStatus({ tone: \"error\", message: \"Attach a CSV file to import.\" });\n      return;\n    }\n    try {\n      setBulkStatus({ tone: \"info\", message: \"Parsing CSVâ€¦\" });\n      const text = typeof bulkCsv === \"string\" ? bulkCsv : await bulkCsv.text();\n      const parsed = parseCsvStudents(text);\n      if (parsed.length === 0) {\n        throw new Error(\"The CSV file did not contain any students.\");\n      }\n      const meta = studentModal.meta;\n      const prepared = parsed.map((row) => {\n        const firstName = row.firstName.trim();\n        const lastName = row.lastName.trim();\n        const username = row.username.trim() || `${firstName[0] ?? \"\"}${lastName}`.toLowerCase();\n        const password = generatePassword();\n        return {\n          firstName,\n          lastName,\n          username,\n          password,\n          passwordPlain: password,\n          programme: meta.programme,\n          yearGroup: meta.yearGroupLabel,\n        };\n      });\n\n      setBulkStatus({ tone: \"info\", message: \"Uploading studentsâ€¦\" });\n      const sanitizedStudents = prepared.map((student) => {\n        const copy = { ...student };\n        delete copy.passwordPlain;\n        return copy;\n      });\n\n      const created = await bulkCreateStudents(token, {\n        classId: studentModal.classItem.id,\n        students: sanitizedStudents,\n      });\n\n      const passwordEntries = created\n        .map((student, index) => ({\n          id: student.id,\n          username: student.username,\n          password: prepared[index]?.passwordPlain ?? \"\",\n        }))\n        .filter((entry) => entry.password);\n      if (passwordEntries.length > 0) {\n        updatePasswordLookup((prev) => rememberPasswords(prev, passwordEntries));\n      }\n      setVisiblePasswords((prev) => ({ ...prev, ...Object.fromEntries(created.map((student) => [student.id, true])) }));\n\n      setBulkStatus({ tone: \"success\", message: `${created.length} students imported.` });\n      setBulkCsv(null);\n      setStudentModal(null);\n      await loadDashboard();\n    } catch (error) {\n      setBulkStatus({ tone: \"error\", message: error.message || \"Unable to import CSV.\" });\n    }\n  };\n\n  const togglePassword = (studentId) => {\n    setVisiblePasswords((prev) => ({ ...prev, [studentId]: !prev[studentId] }));\n  };\n\n  const handleArchive = async (studentId) => {\n    if (!token || !studentId) return;\n    const confirmArchive = window.confirm(\"Archive this student? They can be restored later by an administrator.\");\n    if (!confirmArchive) return;\n    try {\n      await archiveStudent(token, { studentId });\n      setStatus({ tone: \"success\", message: \"Student archived.\" });\n      await loadDashboard();\n    } catch (error) {\n      setStatus({ tone: \"error\", message: error.message || \"Unable to archive student.\" });\n    }\n  };\n\n  const handleCopyCredentials = useCallback(async () => {\n    if (!selectedClass || selectedStudents.length === 0) {\n      setStatus({ tone: \"error\", message: \"Select a class with students first.\" });\n      return;\n    }\n\n    const storedEntries = [];\n    const missingStudents = [];\n\n    for (const student of selectedStudents) {\n      const password = resolveStoredPassword(passwordLookup, student);\n      const username = student.username ?? \"â€”\";\n      const fallbackName = `${student.firstName ?? \"\"} ${student.lastName ?? \"\"}`.trim();\n      const name = student.displayName ?? (fallbackName || username || \"Student\");\n\n      if (password && !password.startsWith(\"$2\")) {\n        storedEntries.push({ id: student.id, name, username, password });\n      } else {\n        missingStudents.push({ id: student.id, name, username });\n      }\n    }\n\n    let credentialEntries = [...storedEntries];\n    let generatedCount = 0;\n\n    if (missingStudents.length > 0) {\n      if (!token) {\n        setStatus({ tone: \"error\", message: \"Session expired. Sign in again to generate new passwords.\" });\n        return;\n      }\n\n      const confirmReset = window.confirm(\n        `No stored passwords for ${missingStudents.length} student${missingStudents.length === 1 ? \"\" : \"s\"}. Generate new passwords now?`,\n      );\n      if (!confirmReset) {\n        setStatus({ tone: \"error\", message: \"Password copy cancelled.\" });\n        return;\n      }\n\n      setStatus({ tone: \"info\", message: \"Generating fresh passwordsâ€¦\" });\n\n      try {\n        const response = await regenerateClassCredentials(token, selectedClass.id, {\n          studentIds: missingStudents.map((student) => student.id),\n        });\n        const generated = (response?.credentials ?? [])\n          .filter((entry) => entry?.password)\n          .map((entry) => {\n            const fallbackName = `${entry.firstName ?? \"\"} ${entry.lastName ?? \"\"}`.trim();\n            const username = entry.username ?? \"â€”\";\n            const name = entry.displayName ?? (fallbackName || username || \"Student\");\n            return {\n              id: entry.id,\n              name,\n              username,\n              password: entry.password,\n            };\n          });\n\n        if (generated.length === 0) {\n          setStatus({ tone: \"error\", message: \"Unable to generate passwords for the selected students.\" });\n          return;\n        }\n\n        generatedCount = generated.length;\n        credentialEntries = [...credentialEntries, ...generated];\n        updatePasswordLookup((prev) =>\n          rememberPasswords(prev, generated.map((entry) => ({ id: entry.id, username: entry.username, password: entry.password }))),\n        );\n        setVisiblePasswords((prev) => ({ ...prev, ...Object.fromEntries(generated.map((entry) => [entry.id, true])) }));\n      } catch (error) {\n        console.warn(\"Credential regeneration failed\", error);\n        setStatus({ tone: \"error\", message: error?.message || \"Unable to generate new passwords.\" });\n        return;\n      }\n    }\n\n    if (credentialEntries.length === 0) {\n      setStatus({ tone: \"error\", message: \"No stored passwords available for this class.\" });\n      return;\n    }\n\n    credentialEntries.sort((a, b) => a.name.localeCompare(b.name));\n\n    const header = \"Name\\tUsername\\tPassword\";\n    const lines = credentialEntries.map((entry) => `${entry.name}\\t${entry.username || \"â€”\"}\\t${entry.password}`);\n    const payload = [header, ...lines].join(\"\\n\");\n\n    try {\n      await navigator.clipboard.writeText(payload);\n      setStatus({\n        tone: \"success\",\n        message:\n          generatedCount > 0\n            ? `Credentials copied. ${generatedCount} password${generatedCount === 1 ? \"\" : \"s\"} refreshed.`\n            : \"Credentials copied to clipboard.\",\n      });\n    } catch (error) {\n      console.warn(\"Clipboard copy failed\", error);\n      setStatus({ tone: \"error\", message: \"Unable to copy credentials. Try again.\" });\n    }\n  }, [passwordLookup, selectedClass, selectedStudents, token, updatePasswordLookup]);\n\n  const handleViewStudentDashboard = useCallback(\n    (studentId) => {\n      if (!studentId) return;\n      navigate(`/dashboard/student/${encodeURIComponent(studentId)}`);\n    },\n    [navigate],\n  );\n\n  if (!ready) {\n    return null;\n  }\n\n  if (!isTeacher) {\n    return null;\n  }\n\n  return (\n    <ContentContainer variant=\"fullWidth\" className=\"teacher-dashboard\">\n      <section className=\"teacher-dashboard__hero\">\n        <div className=\"teacher-dashboard__hero-left\">\n          <span className=\"teacher-dashboard__eyebrow\">Teacher dashboard</span>\n          <h1>Good day, {teacherName}</h1>\n          <p className=\"muted\">\n            Manage classes, enrol students, and monitor lesson unlocks. Everything updates in real time as your classes\n            progress through the IB Computer Science curriculum.\n          </p>\n          <div className=\"teacher-dashboard__hero-actions\">\n            <button type=\"button\" className=\"pill pill--action\" onClick={openClassModal}>\n              Add class\n            </button>\n            <button\n              type=\"button\"\n              className=\"pill\"\n              onClick={() => (selectedClass ? openStudentModal(selectedClass, \"single\") : classes[0] && openStudentModal(classes[0], \"single\"))}\n              disabled={classes.length === 0}\n            >\n              Add student\n            </button>\n          </div>\n        </div>\n        <ResponsiveGrid variant=\"autoFit\" minColumnWidth={200} className=\"teacher-dashboard__summary-grid\">\n          {summaryCards.map((card) => (\n            <StatCard key={card.label} label={card.label} value={card.value} tone=\"brand\" compact />\n          ))}\n        </ResponsiveGrid>\n      </section>\n\n      {status && <StatusBanner tone={status.tone}>{status.message}</StatusBanner>}\n\n      <section className=\"teacher-dashboard__workspace\">\n        <aside className=\"teacher-dashboard__class-panel\">\n          <header>\n            <h2>Your classes</h2>\n            <p className=\"muted\">Select a class to review students, pacing, and quick actions.</p>\n          </header>\n          <div className=\"teacher-dashboard__class-list\">\n            {classes.length === 0 && !loading && <p className=\"muted\">Create your first class to get started.</p>}\n            {classes.map((clazz) => {\n              const students = studentsByClass.get(clazz.id) ?? [];\n              const meta = parseClassMeta(clazz);\n              const isSelected = selectedClassId === clazz.id;\n              return (\n                <button\n                  key={clazz.id}\n                  type=\"button\"\n                  className={`teacher-dashboard__class-button ${isSelected ? \"is-active\" : \"\"}`}\n                  onClick={() => setSelectedClassId(clazz.id)}\n                >\n                  <div>\n                    <strong>{clazz.className}</strong>\n                    <span>{meta.yearGroupLabel}</span>\n                  </div>\n                  <div className=\"teacher-dashboard__class-meta-chip\">\n                    <span>{students.length} students</span>\n                    <span>{meta.cohort}</span>\n                  </div>\n                </button>\n              );\n            })}\n          </div>\n        </aside>\n\n        <div className=\"teacher-dashboard__class-detail\">\n          {selectedClass ? (\n            <>\n              <header className=\"teacher-dashboard__class-header\">\n                <div>\n                  <span className=\"teacher-dashboard__eyebrow\">Selected class</span>\n                  <h2>{selectedClass.className}</h2>\n                  {selectedClassMeta && <p className=\"muted\">{selectedClassMeta.yearGroupLabel}</p>}\n                </div>\n                <div className=\"teacher-dashboard__class-actions\">\n                  <button type=\"button\" className=\"pill\" onClick={() => navigate('/curriculum/ib', { state: { classId: selectedClass.id } })}>\n                    View IB Curriculum\n                  </button>\n                  <button type=\"button\" className=\"pill\" onClick={() => openStudentModal(selectedClass, \"single\")}>\n                    Add student\n                  </button>\n                  <button type=\"button\" className=\"pill\" onClick={() => openStudentModal(selectedClass, \"bulk\")}>\n                    Import CSV\n                  </button>\n                  <button type=\"button\" className=\"pill\" onClick={handleCopyCredentials}>\n                    Copy credentials\n                  </button>\n                </div>\n              </header>\n\n              {classSummaryCards.length > 0 && (\n                <ResponsiveGrid variant=\"autoFit\" minColumnWidth={200} className=\"teacher-dashboard__class-summary\">\n                  {classSummaryCards.map((card, index) => (\n                    <StatCard\n                      key={card.key}\n                      label={card.label}\n                      value={card.value}\n                      compact\n                      tone={index === 0 ? \"brand\" : undefined}\n                      progress={card.progress}\n                      progressLabel={card.progressLabel}\n                    />\n                  ))}\n                </ResponsiveGrid>\n              )}\n\n              {isYear7Selected && (\n                <StatCard\n                  label=\"Teacher-paced pointer\"\n                  value={\n                    selectedPacingLesson\n                      ? selectedPacingLesson.title\n                      : \"Pointer not set\"\n                  }\n                  description={\n                    selectedPacingLesson\n                      ? selectedPacingLesson.unitTitle\n                      : \"Set the pointer to guide the Year 7 teaching sequence.\"\n                  }\n                  meta={\n                    selectedPacing?.updatedAt\n                      ? `Updated ${new Date(selectedPacing.updatedAt).toLocaleString()}`\n                      : null\n                  }\n                  tone=\"brand\"\n                  actions={\n                    <div className=\"teacher-dashboard__pacing-actions\">\n                      <button\n                        type=\"button\"\n                        className=\"pill\"\n                        onClick={() => handleOpenYear7Map(selectedClass.id)}\n                      >\n                        Open Year 7 map\n                      </button>\n                      <button\n                        type=\"button\"\n                        className=\"pill pill--action\"\n                        onClick={() => handleStartPacing(selectedClass.id)}\n                        disabled={Boolean(selectedPacingInfo?.busy)}\n                      >\n                        {selectedPacing ? \"Restart at lesson 1\" : \"Start teaching\"}\n                      </button>\n                      <button\n                        type=\"button\"\n                        className=\"pill\"\n                        onClick={() => handleAdvancePacing(selectedClass.id)}\n                        disabled={Boolean(selectedPacingInfo?.busy) || !selectedPacing}\n                      >\n                        Advance lesson\n                      </button>\n                      <button\n                        type=\"button\"\n                        className=\"pill\"\n                        onClick={() => handleStopPacing(selectedClass.id)}\n                        disabled={Boolean(selectedPacingInfo?.busy) || !selectedPacing}\n                      >\n                        Stop teaching\n                      </button>\n                    </div>\n                  }\n                >\n                  {selectedPacingInfo?.message && (\n                    <p className={`teacher-dashboard__pacing-status teacher-dashboard__pacing-status--${selectedPacingInfo.tone ?? \"info\"}`}>\n                      {selectedPacingInfo.message}\n                    </p>\n                  )}\n                </StatCard>\n              )}\n\n              <div className=\"teacher-dashboard__table-wrapper\">\n                <table className=\"teacher-dashboard__table\">\n                  <thead>\n                    <tr>\n                      <th>Student</th>\n                      <th>Username</th>\n                      <th>Password</th>\n                      <th>Track</th>\n                      <th>Stage</th>\n                      <th aria-label=\"Actions\" />\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {selectedStudents.map((student) => {\n                      const storedPassword = resolveStoredPassword(passwordLookup, student) ?? student.password ?? \"\";\n                      const isHash = typeof storedPassword === \"string\" && storedPassword.startsWith(\"$2\");\n                      const plainPassword = isHash ? \"\" : storedPassword;\n                      const isVisible = visiblePasswords[student.id];\n                      return (\n                        <tr key={student.id} onClick={() => handleViewStudentDashboard(student.id)} className=\"teacher-dashboard__student-row\">\n                          <td>\n                            <span className=\"teacher-student-name\">{student.displayName}</span>\n                            <span className=\"teacher-student-sub\">Joined {new Date(student.createdAt).toLocaleDateString()}</span>\n                          </td>\n                          <td>{student.username || \"â€”\"}</td>\n                          <td>\n                            {plainPassword ? (\n                              <button\n                                type=\"button\"\n                                className=\"teacher-password\"\n                                onClick={(event) => {\n                                  event.stopPropagation();\n                                  togglePassword(student.id);\n                                }}\n                              >\n                                {isVisible ? plainPassword : \"â€¢â€¢â€¢â€¢â€¢â€¢\"}\n                              </button>\n                            ) : (\n                              <span className=\"muted\">Not available</span>\n                            )}\n                          </td>\n                          <td>{student.curriculumTrack ? student.curriculumTrack.toUpperCase() : \"â€”\"}</td>\n                          <td>{student.activeStage ? student.activeStage.toUpperCase() : \"â€”\"}</td>\n                          <td className=\"teacher-dashboard__table-actions\">\n                            <button\n                              type=\"button\"\n                              className=\"button-outline button-outline--danger\"\n                              onClick={(event) => {\n                                event.stopPropagation();\n                                handleArchive(student.id);\n                              }}\n                            >\n                              Archive\n                            </button>\n                          </td>\n                        </tr>\n                      );\n                    })}\n                    {selectedStudents.length === 0 && (\n                      <tr>\n                        <td colSpan={6} className=\"muted\">\n                          No students yet. Use â€œAdd studentâ€ to enrol the first learner.\n                        </td>\n                      </tr>\n                    )}\n                  </tbody>\n                </table>\n              </div>\n            </>\n          ) : (\n            <div className=\"teacher-dashboard__empty-detail\">\n              <h2>Select a class to view its roster</h2>\n              <p className=\"muted\">Once you choose a class, you can copy credentials, manage pacing, and monitor progress.</p>\n            </div>\n          )}\n        </div>\n      </section>\n\n      <section className=\"teacher-dashboard__insights\">\n        <article className=\"teacher-dashboard__card\">\n          <h3>Lesson progress snapshot</h3>\n          <div className=\"teacher-dashboard__metrics\">\n            <div>\n              <span>{summativeComplete}</span>\n              <small>Summative complete</small>\n            </div>\n            <div>\n              <span>{formativeComplete}</span>\n              <small>Formative complete</small>\n            </div>\n            <div>\n              <span>{availableLessons}</span>\n              <small>Available lessons</small>\n            </div>\n            <div>\n              <span>{lockedLessons}</span>\n              <small>Locked lessons</small>\n            </div>\n          </div>\n        </article>\n\n        <article className=\"teacher-dashboard__card\">\n          <h3>Learners needing a nudge</h3>\n          <p className=\"muted\">Students with unlocked lessons but no formative completions yet.</p>\n          <ul className=\"teacher-dashboard__list\">\n            {studentsNeedingAttention.length === 0 && <li className=\"muted\">All caught up â€” no students flagged.</li>}\n            {studentsNeedingAttention.map((student) => (\n              <li key={student.id}>\n                <div>\n                  <strong>{student.displayName}</strong>\n                  <span className=\"muted\">{student.available} unlocked Â· 0 cleared checkpoints</span>\n                </div>\n                <span className=\"teacher-dashboard__tag\">Follow up</span>\n              </li>\n            ))}\n          </ul>\n        </article>\n\n        <article className=\"teacher-dashboard__card\">\n          <h3>Recent lesson updates</h3>\n          <p className=\"muted\">Latest activity across your classes (most recent first).</p>\n          <ul className=\"teacher-dashboard__list teacher-dashboard__list--compact\">\n            {recentProgress.length === 0 && <li className=\"muted\">No lesson activity recorded yet.</li>}\n            {recentProgress.map((record) => (\n              <li key={record.id}>\n                <div>\n                  <strong>{record.lesson}</strong>\n                  <span className=\"muted\">{record.studentName}</span>\n                </div>\n                <div className=\"teacher-dashboard__list-meta\">\n                  <span className={`teacher-dashboard__tag teacher-dashboard__tag--${(record.status || \"locked\").toLowerCase()}`}>\n                    {record.status ?? \"locked\"}\n                  </span>\n                  <span className=\"muted\">\n                    {record.updatedAt ? new Date(record.updatedAt).toLocaleString() : \"recently\"}\n                  </span>\n                </div>\n              </li>\n            ))}\n          </ul>\n        </article>\n      </section>\n\n      {classModalOpen && (\n        <Modal\n          isOpen={classModalOpen}\n          onClose={() => setClassModalOpen(false)}\n          title=\"Create class\"\n          size=\"md\"\n        >\n          <form onSubmit={submitClass} className=\"teacher-modal__content\">\n            <label>\n              <span>Stage</span>\n              <select\n                value={classForm.stageId}\n                onChange={(event) => handleClassStageChange(\"stageId\", event.target.value)}\n                required\n              >\n                {STAGE_CONFIG.map((option) => (\n                  <option key={option.id} value={option.id}>\n                    {option.label}\n                  </option>\n                ))}\n              </select>\n            </label>\n            <label>\n              <span>Cohort (two digits)</span>\n              <input\n                value={classForm.cohort}\n                onChange={(event) => handleClassStageChange(\"cohort\", event.target.value)}\n                placeholder=\"32\"\n                required\n              />\n            </label>\n            <label>\n              <span>Group</span>\n              <select\n                value={classForm.group}\n                onChange={(event) => handleClassStageChange(\"group\", event.target.value)}\n                required\n              >\n                {getStageConfig(classForm.stageId).groups.map((group) => (\n                  <option key={group} value={group}>\n                    {group}\n                  </option>\n                ))}\n              </select>\n            </label>\n            <label>\n              <span>Description (optional)</span>\n              <input\n                value={classForm.description}\n                onChange={(event) => setClassForm((prev) => ({ ...prev, description: event.target.value }))}\n                placeholder=\"Notes for this class\"\n              />\n            </label>\n            <div className=\"teacher-modal__preview\">\n              <span>Generated code</span>\n              <strong>{generateClassCode(classForm.stageId, classForm.cohort, classForm.group)}</strong>\n            </div>\n            <footer>\n              <button type=\"button\" onClick={() => setClassModalOpen(false)}>\n                Cancel\n              </button>\n              <button type=\"submit\" className=\"pill pill--action\">\n                Create class\n              </button>\n            </footer>\n          </form>\n        </Modal>\n      )}\n\n      {studentModal && (\n        <Modal\n          isOpen={!!studentModal}\n          onClose={() => setStudentModal(null)}\n          title={\n            studentModal.mode === \"bulk\"\n              ? `Import students Â· ${studentModal.classItem.className}`\n              : `Add student Â· ${studentModal.classItem.className}`\n          }\n          size=\"md\"\n        >\n          {studentModal.mode === \"single\" ? (\n            <form onSubmit={submitStudent} className=\"teacher-modal__content\">\n              <label>\n                <span>First name</span>\n                <input\n                  value={studentForm.firstName}\n                  onChange={(event) => handleStudentFormChange(\"firstName\", event.target.value)}\n                  required\n                />\n              </label>\n              <label>\n                <span>Surname</span>\n                <input\n                  value={studentForm.lastName}\n                  onChange={(event) => handleStudentFormChange(\"lastName\", event.target.value)}\n                  required\n                />\n              </label>\n              <label>\n                <span>Username</span>\n                <input\n                  value={studentForm.username}\n                  onChange={(event) => handleStudentFormChange(\"username\", event.target.value)}\n                  placeholder=\"Enter unique username\"\n                  required\n                />\n              </label>\n              <label>\n                <span>Generated password</span>\n                <input\n                  value={studentForm.password}\n                  onChange={(event) => handleStudentFormChange(\"password\", event.target.value)}\n                  required\n                />\n                <button\n                  type=\"button\"\n                  className=\"teacher-modal__ghost\"\n                  onClick={() => setStudentForm((prev) => ({ ...prev, password: generatePassword() }))}\n                >\n                  Regenerate\n                </button>\n              </label>\n              <footer>\n                <button type=\"button\" onClick={() => setStudentModal(null)}>\n                  Cancel\n                </button>\n                <button type=\"submit\" className=\"pill pill--action\">\n                  Add student\n                </button>\n              </footer>\n            </form>\n          ) : (\n            <form onSubmit={submitBulkStudents} className=\"teacher-modal__content\">\n              <p className=\"muted\">\n                Upload a CSV with the columns <code>firstName</code>, <code>lastName</code>, and optional\n                <code>username</code>. Passwords are auto-generated for each row.\n              </p>\n              <button type=\"button\" className=\"teacher-modal__ghost\" onClick={downloadTemplate}>\n                Download blank template\n              </button>\n              <label>\n                <span>CSV file</span>\n                <input\n                  type=\"file\"\n                  accept=\".csv,text/csv\"\n                  onChange={(event) => setBulkCsv(event.target.files?.[0] ?? null)}\n                  required\n                />\n              </label>\n              {bulkStatus && <p className={`status status--${bulkStatus.tone}`}>{bulkStatus.message}</p>}\n              <footer>\n                <button type=\"button\" onClick={() => setStudentModal(null)}>\n                  Cancel\n                </button>\n                <button type=\"submit\" className=\"pill pill--action\">\n                  Import students\n                </button>\n              </footer>\n            </form>\n          )}\n        </Modal>\n      )}\n    </ContentContainer>\n  );\n}\n\nexport default TeacherDashboardPage;\n","export default \"__VITE_ASSET__DMZ5NBvI__\"","import { useEffect, useState } from \"react\";\nimport manifestUrl from \"../data/curriculumManifest.json?url\";\nimport fallbackManifest from \"../data/curriculumManifest.json\";\n\nlet manifestCache = null;\nlet manifestPromise = null;\n\nfunction cloneManifest(data) {\n  return JSON.parse(JSON.stringify(data));\n}\n\nasync function loadManifest() {\n  if (manifestCache) return manifestCache;\n  if (!manifestPromise) {\n    manifestPromise = fetch(manifestUrl, { cache: \"no-cache\" })\n      .then((response) => {\n        if (!response.ok) {\n          throw new Error(\"Failed to load curriculum manifest\");\n        }\n        return response.json();\n      })\n      .then((data) => {\n        manifestCache = data;\n        return data;\n      })\n      .catch((error) => {\n        console.warn(\"Falling back to bundled curriculum manifest:\", error);\n        manifestCache = cloneManifest(fallbackManifest);\n        return manifestCache;\n      })\n      .finally(() => {\n        manifestPromise = null;\n      });\n  }\n  return manifestPromise;\n}\n\nexport function useCurriculumManifest() {\n  const [state, setState] = useState(() => ({\n    status: manifestCache ? \"ready\" : \"loading\",\n    manifest: manifestCache,\n    error: null,\n  }));\n\n  useEffect(() => {\n    let cancelled = false;\n    loadManifest()\n      .then((data) => {\n        if (!cancelled) {\n          setState({ status: \"ready\", manifest: data, error: null });\n        }\n      })\n      .catch((error) => {\n        if (!cancelled) {\n          setState({ status: \"ready\", manifest: cloneManifest(fallbackManifest), error });\n        }\n      });\n    return () => {\n      cancelled = true;\n    };\n  }, []);\n\n  return state;\n}\n\nexport function resetCurriculumManifestCache() {\n  manifestCache = null;\n  manifestPromise = null;\n}\n\nexport function getTrackLabel(manifest, track) {\n  const lookup = manifest?.tracks ?? {};\n  return lookup[track]?.label ?? track ?? \"Unknown\";\n}\n\nexport function isLessonAvailableForTrack(lesson, track, manifest) {\n  if (!lesson) return false;\n  if (!track) return true;\n  const unitAccess = manifest?.units?.some((unit) => unit.availableFor?.includes(track)) ?? true;\n  if (!unitAccess) return false;\n  if (lesson.hlOnly && track !== \"ib-hl\") {\n    return false;\n  }\n  return true;\n}\n","import { createContext, useCallback, useContext, useEffect, useMemo, useReducer, useRef } from \"react\";\nimport { syncStudentGamification } from \"../lib/api.js\";\n\nconst LEGACY_STORAGE_KEY = \"ibcs.gamification\";\nconst SYNC_DEBOUNCE_MS = 2000; // Sync to backend after 2 seconds of no changes\n\nfunction sanitizeProfile(value) {\n  if (!value) return \"anonymous\";\n  return String(value).toLowerCase().replace(/[^a-z0-9.-]/g, \"-\") || \"anonymous\";\n}\n\nfunction storageKey(profileKey) {\n  const safe = sanitizeProfile(profileKey);\n  return `${LEGACY_STORAGE_KEY}.${safe}`;\n}\n\nfunction readStoredState(key) {\n  if (typeof window === \"undefined\") return null;\n  try {\n    const raw = window.localStorage.getItem(key);\n    if (!raw) return null;\n    const parsed = JSON.parse(raw);\n    if (parsed && typeof parsed === \"object\") {\n      return parsed;\n    }\n  } catch (error) {\n    console.warn(\"Failed to read gamification state\", key, error);\n  }\n  return null;\n}\nconst DEFAULT_STATE = {\n  xp: 0,\n  level: 1,\n  streak: 0,\n  spritesUnlocked: [],\n  totalCorrect: 0,\n  totalAttempts: 0,\n  lastUpdated: null,\n};\n\nconst GamificationContext = createContext({\n  state: DEFAULT_STATE,\n  awardXp: () => {},\n  resetStreak: () => {},\n  updateFromRemote: () => {},\n});\n\nfunction computeLevel(xp) {\n  if (!Number.isFinite(xp)) return 1;\n  // Simple levelling curve: Level up every 150 XP, with diminishing returns.\n  return Math.max(1, Math.floor(xp / 150) + 1);\n}\n\nfunction reducer(state, action) {\n  switch (action.type) {\n    case \"hydrate\": {\n      const merged = { ...state, ...(action.payload || {}) };\n      return {\n        ...merged,\n        level: computeLevel(merged.xp ?? 0),\n      };\n    }\n    case \"award\": {\n      const { xpGained, correct, attempts, spriteUnlocks = [] } = action.payload;\n      const totalCorrect = (state.totalCorrect ?? 0) + (correct ?? 0);\n      const totalAttempts = (state.totalAttempts ?? 0) + (attempts ?? 0);\n      const xp = (state.xp ?? 0) + xpGained;\n      const level = computeLevel(xp);\n      const streak = xpGained > 0 && correct === attempts ? (state.streak ?? 0) + 1 : 0;\n      const spritesUnlocked = Array.from(\n        new Set([...(state.spritesUnlocked ?? []), ...spriteUnlocks.filter(Boolean)]),\n      );\n      return {\n        xp,\n        level,\n        streak,\n        spritesUnlocked,\n        totalCorrect,\n        totalAttempts,\n        lastUpdated: Date.now(),\n      };\n    }\n    case \"reset-streak\":\n      return { ...state, streak: 0, lastUpdated: Date.now() };\n    default:\n      return state;\n  }\n}\n\nexport function GamificationProvider({ children, initialState, profileKey = \"anonymous\", syncToken = null, isStudent = false }) {\n  const normalizedProfile = sanitizeProfile(profileKey);\n  const syncTimeoutRef = useRef(null);\n\n  const [state, dispatch] = useReducer(reducer, DEFAULT_STATE, (defaultState) => {\n    if (initialState) {\n      return reducer(defaultState, { type: \"hydrate\", payload: initialState });\n    }\n    const stored = readStoredState(storageKey(normalizedProfile)) ?? readStoredState(LEGACY_STORAGE_KEY);\n    if (stored) {\n      return reducer(defaultState, { type: \"hydrate\", payload: stored });\n    }\n    return defaultState;\n  });\n\n  const profileRef = useRef(normalizedProfile);\n\n  useEffect(() => {\n    if (profileRef.current === normalizedProfile) {\n      return;\n    }\n    const stored = readStoredState(storageKey(normalizedProfile)) ?? readStoredState(LEGACY_STORAGE_KEY);\n    if (stored) {\n      dispatch({ type: \"hydrate\", payload: stored });\n    } else {\n      dispatch({ type: \"hydrate\", payload: DEFAULT_STATE });\n    }\n    profileRef.current = normalizedProfile;\n  }, [normalizedProfile]);\n\n  // Sync to backend for students\n  useEffect(() => {\n    if (!isStudent || !syncToken || profileKey === \"anonymous\" || profileKey === \"guest\") {\n      return;\n    }\n\n    // Clear any pending sync\n    if (syncTimeoutRef.current) {\n      clearTimeout(syncTimeoutRef.current);\n    }\n\n    // Debounce sync to avoid too many API calls\n    syncTimeoutRef.current = setTimeout(async () => {\n      try {\n        await syncStudentGamification(syncToken, {\n          xp: state.xp ?? 0,\n          level: state.level ?? 1,\n          streak: state.streak ?? 0,\n          totalCorrect: state.totalCorrect ?? 0,\n          totalAttempts: state.totalAttempts ?? 0,\n        });\n      } catch (error) {\n        console.warn(\"Failed to sync gamification to backend\", error);\n      }\n    }, SYNC_DEBOUNCE_MS);\n\n    return () => {\n      if (syncTimeoutRef.current) {\n        clearTimeout(syncTimeoutRef.current);\n      }\n    };\n  }, [state.xp, state.level, state.streak, state.totalCorrect, state.totalAttempts, syncToken, isStudent, profileKey]);\n\n  useEffect(() => {\n    const targetKey = storageKey(normalizedProfile);\n    profileRef.current = normalizedProfile;\n    if (typeof window !== \"undefined\") {\n      try {\n        window.localStorage.setItem(targetKey, JSON.stringify(state));\n        if (targetKey !== LEGACY_STORAGE_KEY) {\n          window.localStorage.removeItem(LEGACY_STORAGE_KEY);\n        }\n      } catch (error) {\n        console.warn(\"Failed to persist gamification state\", error);\n      }\n    }\n  }, [state, normalizedProfile]);\n\n  const awardXp = useCallback((payload) => {\n    dispatch({ type: \"award\", payload });\n  }, []);\n\n  const resetStreak = useCallback(() => {\n    dispatch({ type: \"reset-streak\" });\n  }, []);\n\n  const updateFromRemote = useCallback((payload) => {\n    dispatch({ type: \"hydrate\", payload });\n  }, []);\n\n  const value = useMemo(\n    () => ({\n      state,\n      awardXp,\n      resetStreak,\n      updateFromRemote,\n    }),\n    [state, awardXp, resetStreak, updateFromRemote],\n  );\n\n  return <GamificationContext.Provider value={value}>{children}</GamificationContext.Provider>;\n}\n\nexport function useGamification() {\n  return useContext(GamificationContext);\n}\n\n","const LEGACY_SUFFIX = \".progress\";\n\nfunction sanitize(value, fallback) {\n  if (!value) return fallback;\n  return String(value).toLowerCase().replace(/[^a-z0-9.-]/g, \"-\") || fallback;\n}\n\nexport function progressStorageKey(unitId, username) {\n  const safeUnit = sanitize(unitId, \"unit\");\n  const safeUser = sanitize(username, \"guest\");\n  return `ibcs.${safeUnit}.${safeUser}${LEGACY_SUFFIX}`;\n}\n\nexport function legacyProgressKey(unitId) {\n  const safeUnit = sanitize(unitId, \"unit\");\n  return `ibcs.${safeUnit}${LEGACY_SUFFIX}`;\n}\n\nexport function readUnitProgress(unitId, username) {\n  if (typeof window === \"undefined\") return { data: null, key: null, migrated: false };\n  const scopedKey = progressStorageKey(unitId, username);\n  try {\n    const raw = window.localStorage.getItem(scopedKey);\n    if (raw) {\n      return { data: JSON.parse(raw), key: scopedKey, migrated: true };\n    }\n  } catch (error) {\n    console.warn(\"Unable to parse scoped progress\", scopedKey, error);\n  }\n\n  const legacyKey = legacyProgressKey(unitId);\n  try {\n    const legacyRaw = window.localStorage.getItem(legacyKey);\n    if (legacyRaw) {\n      return { data: JSON.parse(legacyRaw), key: legacyKey, migrated: false };\n    }\n  } catch (error) {\n    console.warn(\"Unable to parse legacy progress\", legacyKey, error);\n  }\n\n  return { data: null, key: scopedKey, migrated: true };\n}\n\nexport function writeUnitProgress(unitId, username, state) {\n  if (typeof window === \"undefined\") return;\n  const key = progressStorageKey(unitId, username);\n  try {\n    window.localStorage.setItem(key, JSON.stringify(state));\n  } catch (error) {\n    console.warn(\"Unable to persist progress\", key, error);\n  }\n\n  // const legacyKey = legacyProgressKey(unitId);\n  // if (legacyKey !== key) {\n  //   try {\n  //     window.localStorage.removeItem(legacyKey);\n  //   } catch {\n  //     // ignore removal failures\n  //   }\n  // }\n}\n\nexport function clearUnitProgress(unitId, username) {\n  if (typeof window === \"undefined\") return;\n  try {\n    window.localStorage.removeItem(progressStorageKey(unitId, username));\n  } catch {\n    // ignore removal failures\n  }\n}\n\n","import \"./EnhancedComponents.css\";\n\n/**\n * Modern keyword definition card with icon and hover effects\n */\nexport function KeywordCard({ term, definition, icon = \"â—\" }) {\n  return (\n    <div className=\"keyword-card\">\n      <div className=\"keyword-card__header\">\n        <span className=\"keyword-card__icon\">{icon}</span>\n        <h4 className=\"keyword-card__term\">{term}</h4>\n      </div>\n      <p className=\"keyword-card__definition\">{definition}</p>\n    </div>\n  );\n}\n\n/**\n * Enhanced callout/info box for highlighting important information\n */\nexport function Callout({ type = \"info\", title, children, icon }) {\n  const iconMap = {\n    info: \"â„¹ï¸\",\n    tip: \"ðŸ’¡\",\n    warning: \"âš ï¸\",\n    success: \"âœ“\",\n    error: \"âš ï¸\",\n  };\n\n  return (\n    <div className={`callout callout--${type}`}>\n      <div className=\"callout__header\">\n        <span className=\"callout__icon\">{icon || iconMap[type]}</span>\n        {title && <strong className=\"callout__title\">{title}</strong>}\n      </div>\n      <div className=\"callout__body\">{children}</div>\n    </div>\n  );\n}\n\n/**\n * Enhanced table with sticky headers, zebra striping, and hover effects\n */\nexport function EnhancedTable({ columns, rows, caption }) {\n  return (\n    <div className=\"enhanced-table-wrapper\">\n      {caption && <div className=\"enhanced-table__caption\">{caption}</div>}\n      <div className=\"enhanced-table__scroll\">\n        <table className=\"enhanced-table\">\n          <thead>\n            <tr>\n              {columns.map((column, index) => (\n                <th key={index}>{column}</th>\n              ))}\n            </tr>\n          </thead>\n          <tbody>\n            {rows.map((row, rowIndex) => (\n              <tr key={rowIndex}>\n                {row.map((cell, cellIndex) => (\n                  <td key={cellIndex}>{cell}</td>\n                ))}\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      </div>\n    </div>\n  );\n}\n\n/**\n * Progress indicator for showing completion status\n */\nexport function ProgressIndicator({ current, total, label }) {\n  const safeTotal = Number.isFinite(total) && total > 0 ? total : 1;\n  const safeCurrent = Number.isFinite(current) ? current : 0;\n  const percentage = Math.round(Math.max(0, Math.min((safeCurrent / safeTotal) * 100, 100)));\n\n  return (\n    <div className=\"progress-indicator\" style={{ \"--progress-indicator\": `${percentage}%` }}>\n      {label && <div className=\"progress-indicator__label\">{label}</div>}\n      <div className=\"progress-indicator__track\">\n        <div\n          className=\"progress-indicator__fill\"\n          role=\"progressbar\"\n          aria-valuenow={Math.max(0, Math.min(safeCurrent, safeTotal))}\n          aria-valuemin=\"0\"\n          aria-valuemax={safeTotal}\n        >\n          <span className=\"progress-indicator__shimmer\" />\n        </div>\n      </div>\n      <div className=\"progress-indicator__stats\">\n        <span>\n          {current} / {total}\n        </span>\n        <span className=\"progress-indicator__percentage\">{percentage}%</span>\n      </div>\n    </div>\n  );\n}\n\n/**\n * Achievement badge for displaying milestones and accomplishments\n */\nexport function AchievementBadge({ icon, title, description, unlocked = true }) {\n  return (\n    <div className={`achievement-badge ${unlocked ? \"is-unlocked\" : \"is-locked\"}`}>\n      <div className=\"achievement-badge__icon\">{icon || \"ðŸ†\"}</div>\n      <div className=\"achievement-badge__content\">\n        <strong className=\"achievement-badge__title\">{title}</strong>\n        {description && <p className=\"achievement-badge__description\">{description}</p>}\n      </div>\n      {!unlocked && <div className=\"achievement-badge__lock\">ðŸ”’</div>}\n    </div>\n  );\n}\n\n/**\n * XP notification toast for celebrating achievements\n */\nexport function XPNotification({ xpGained, message, onClose }) {\n  return (\n    <div className=\"xp-notification animate-slide-in-right\">\n      <div className=\"xp-notification__content\">\n        <span className=\"xp-notification__icon\">âœ¨</span>\n        <div className=\"xp-notification__text\">\n          <strong className=\"xp-notification__xp\">+{xpGained} XP</strong>\n          {message && <p className=\"xp-notification__message\">{message}</p>}\n        </div>\n      </div>\n      {onClose && (\n        <button className=\"xp-notification__close\" onClick={onClose} aria-label=\"Close\">\n          Ã—\n        </button>\n      )}\n    </div>\n  );\n}\n\n/**\n * Streak indicator for showing consecutive completions\n */\nexport function StreakIndicator({ streak, label = \"Day Streak\" }) {\n  const getStreakEmoji = (count) => {\n    if (count >= 30) return \"ðŸ”¥ðŸ”¥ðŸ”¥\";\n    if (count >= 7) return \"ðŸ”¥ðŸ”¥\";\n    return \"ðŸ”¥\";\n  };\n\n  return (\n    <div className=\"streak-indicator\">\n      <div className=\"streak-indicator__flame\">{getStreakEmoji(streak)}</div>\n      <div className=\"streak-indicator__content\">\n        <strong className=\"streak-indicator__count\">{streak}</strong>\n        <span className=\"streak-indicator__label\">{label}</span>\n      </div>\n    </div>\n  );\n}\n\n/**\n * Loading skeleton for content placeholders\n */\nexport function SkeletonLoader({ type = \"text\", count = 1 }) {\n  const skeletons = Array.from({ length: count }, (_, i) => (\n    <div key={i} className={`skeleton skeleton--${type}`} />\n  ));\n\n  return <div className=\"skeleton-container\">{skeletons}</div>;\n}\n\n","import { Fragment } from \"react\";\nimport {\n  KeywordCard,\n  Callout,\n  EnhancedTable,\n} from \"../components/segments/EnhancedComponents\";\n\nconst keyVocabulary = [\n  {\n    term: \"Computational Thinking\",\n    definition:\n      \"A problem-solving approach that involves abstraction, decomposition, pattern recognition, and algorithmic design to create solutions that can be executed by a computer.\",\n    icon: \"ðŸ§ \",\n  },\n  {\n    term: \"Problem Specification\",\n    definition:\n      \"A detailed document outlining a problem, including the problem statement, constraints, objectives, goals, input/output requirements, and evaluation criteria.\",\n    icon: \"ðŸ“\",\n  },\n  {\n    term: \"Abstraction\",\n    definition:\n      \"The process of filtering out unnecessary details to focus on the essential elements of a problem or system.\",\n    icon: \"ðŸŒ¬ï¸\",\n  },\n  {\n    term: \"Decomposition\",\n    definition:\n      \"Breaking down a complex problem into smaller, more manageable sub-problems that are easier to solve.\",\n    icon: \"ðŸ§©\",\n  },\n  {\n    term: \"Pattern Recognition\",\n    definition:\n      \"Identifying recurring similarities, trends, or regularities within problems or data. Recognizing patterns allows you to reuse solutions and make predictions.\",\n    icon: \"ðŸŽ¨\",\n  },\n  {\n    term: \"Algorithmic Design\",\n    definition:\n      \"Creating a clear, step-by-step set of instructions to solve a problem. The algorithm is the roadmap that a computer (or a person) follows to reach the solution.\",\n    icon: \"âš™ï¸\",\n  },\n  {\n    term: \"Flowchart\",\n    definition:\n      \"A diagram that visually represents a process, workflow, or algorithm using standardized symbols (ISO 5807).\",\n    icon: \"ðŸ“Š\",\n  },\n  {\n    term: \"Constraint\",\n    definition:\n      \"A restriction or boundary that impacts the solution, such as time, budget, technology, or regulations.\",\n    icon: \"ðŸ”’\",\n  },\n  {\n    term: \"Stakeholder\",\n    definition:\n      \"An individual or group affected by or having an interest in a project or its outcome.\",\n    icon: \"ðŸ‘¥\",\n  },\n];\n\nconst overviewAim = (\n  <Fragment>\n    <p>\n      This unit will equip you with a powerful mental toolkit for solving\n      problems like a computer scientist. You will learn to break down complex\n      challenges, identify patterns, focus on what truly matters, and design\n      clear, logical solutions.\n    </p>\n    <ul>\n      <li>\n        <strong>Construct</strong> a formal problem specification to guide a\n        project.\n      </li>\n      <li>\n        <strong>Describe and apply</strong> the four cornerstones of\n        computational thinking.\n      </li>\n      <li>\n        <strong>Explain</strong> how these concepts are used across different\n        areas of computer science.\n      </li>\n      <li>\n        <strong>Trace and interpret</strong> flowcharts that represent\n        algorithms.\n      </li>\n    </ul>\n  </Fragment>\n);\n\nexport const b1Unit = {\n  id: \"B1\",\n  title: \"Computational Thinking\",\n  hours: {\n    sl: \"SL Â· 5 hours\",\n    hl: \"HL Â· 5 hours\",\n  },\n  guidingQuestion:\n    \"How can we apply a computational solution to a real-world problem?\",\n  overview: {\n    aim: overviewAim,\n    vocabulary: keyVocabulary,\n  },\n  stages: [\n    {\n      id: \"B1-orientation\",\n      title: \"Unit Orientation\",\n      duration: \"15 min\",\n      description:\n        \"Get familiar with the unit&apos;s guiding question, learning objectives, and key vocabulary.\",\n      segments: [\n        {\n          type: \"content\",\n          id: \"orientation-aim\",\n          heading: \"Unit Aims and Objectives\",\n          body: overviewAim,\n        },\n        {\n          type: \"content\",\n          id: \"orientation-vocab\",\n          heading: \"Key Vocabulary\",\n          body: (\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              {keyVocabulary.map((item) => (\n                <KeywordCard\n                  key={item.term}\n                  term={item.term}\n                  definition={item.definition}\n                  icon={item.icon}\n                />\n              ))}\n            </div>\n          ),\n        },\n      ],\n    },\n    {\n      id: \"B1.1.1\",\n      title: \"Constructing a Problem Specification\",\n      duration: \"60 min\",\n      description:\n        \"Learn to define problems with clarity and precision by constructing a formal problem specification.\",\n      segments: [\n        {\n          type: \"content\",\n          id: \"spec-intro\",\n          heading: \"The Blueprint for Success\",\n          body: (\n            <Fragment>\n              <p>\n                Before writing a single line of code, a computer scientist must\n                deeply understand the problem. A Problem Specification is the\n                formal document that ensures everyone involvedâ€”clients,\n                developers, and usersâ€”shares the same understanding. It acts as\n                a blueprint and a contract, defining what success looks like.\n              </p>\n              <Callout type=\"info\" title=\"Core Components\">\n                A thorough problem specification consists of six key parts: the\n                problem statement, constraints, objectives and goals, input\n                specifications, output specifications, and evaluation\n                criteria.\n              </Callout>\n            </Fragment>\n          ),\n        },\n        {\n          type: \"accordion\",\n          id: \"spec-components-deep-dive\",\n          heading: \"Deep Dive into Specification Components\",\n          items: [\n            {\n              title: \"1. The Problem Statement\",\n              body: (\n                <Fragment>\n                  <p>\n                    This is a concise, clear definition of the problem. It\n                    focuses on the &lsquo;what&rsquo; and the &lsquo;why&rsquo;.\n                  </p>\n                  <Callout type=\"error\" title=\"Poor Example\">\n                    â€œOur customer service processes are inefficient.â€ (This is\n                    too broad and vague. What does &quot;inefficient&quot; mean?)\n                  </Callout>\n                  <Callout type=\"success\" title=\"Strong Example\">\n                    â€œCustomers wait an average of 25 minutes on hold before\n                    reaching a representative, leading to a 15% increase in\n                    abandoned calls over the past quarter.â€ (This is focused,\n                    measurable, and highlights the negative impact.)\n                  </Callout>\n                </Fragment>\n              ),\n            },\n            {\n              title: \"2. Constraints and Limitations\",\n              body: (\n                <Fragment>\n                  <p>\n                    These are restrictions or boundaries that impact the\n                    solution. They can be technical, financial, or even legal.\n                  </p>\n                  <Callout type=\"error\" title=\"Poor Example\">\n                    â€œWe don&apos;t have many resources.â€ (Vague. Does this refer to\n                    money, people, or time?)\n                  </Callout>\n                  <Callout type=\"success\" title=\"Strong Example\">\n                    â€œThe project budget is limited to $10,000 and the solution\n                    must be deployed within three months.â€ (Specific,\n                    measurable, and provides clear boundaries.)\n                  </Callout>\n                </Fragment>\n              ),\n            },\n            {\n              title: \"3. Objectives and Goals\",\n              body: (\n                <Fragment>\n                  <p>\n                    Objectives are the broad, high-level desired outcomes.\n                    Goals are the specific, measurable, time-constrained\n                    milestones to achieve those objectives.\n                  </p>\n                  <p>\n                    <strong>Objective:</strong> &quot;Increase customer satisfaction\n                    with service interactions.&quot;\n                  </p>\n                  <p>\n                    <strong>Specific Goals:</strong>\n                  </p>\n                  <ul>\n                    <li>\n                      Achieve an average customer satisfaction rating of 4 out\n                      of 5 stars on post-service surveys over the next six\n                      months.\n                    </li>\n                    <li>\n                      Reduce the number of &lsquo;highly dissatisfied&rsquo; customer\n                      ratings by 30% within the next quarter.\n                    </li>\n                  </ul>\n                </Fragment>\n              ),\n            },\n            {\n              title: \"4. Input and Output Specifications\",\n              body: (\n                <Fragment>\n                  <p>\n                    These define the format, type, and expected characteristics\n                    of any data entering or leaving the system. This ensures\n                    compatibility and proper processing.\n                  </p>\n                  <p>\n                    <strong>Input Example (Chatbot):</strong> Text-based input\n                    via a chat interface; voice-to-text input. Should handle\n                    diverse phrasing for the same intent.\n                  </p>\n                  <p>\n                    <strong>Output Example (Chatbot):</strong> Direct text\n                    responses; links to knowledge base articles; escalation to a\n                    live agent with a chat transcript.\n                  </p>\n                </Fragment>\n              ),\n            },\n            {\n              title: \"5. Evaluation Criteria\",\n              body: (\n                <Fragment>\n                  <p>\n                    These are the benchmarks used to measure the success of the\n                    solution. They should be directly linked to the objectives\n                    and goals.\n                  </p>\n                  <p>\n                    Consider factors like:\n                  </p>\n                  <ul>\n                    <li>\n                      <strong>Effectiveness:</strong> Does it solve the\n                      problem? (e.g., task completion rate of 90% for a\n                      chatbot).\n                    </li>\n                    <li>\n                      <strong>Efficiency:</strong> Does it save time or\n                      resources? (e.g., faster issue resolution time).\n                    </li>\n                    <li>\n                      <strong>Usability:</strong> Is it easy for people to use?\n                      (e.g., intuitive interface requiring minimal training).\n                    </li>\n                  </ul>\n                </Fragment>\n              ),\n            },\n          ],\n        },\n        {\n          type: \"activity\",\n          id: \"spec-classification\",\n          activityType: \"classification\",\n          heading: \"Classify the Specification Components\",\n          instructions:\n            \"Drag each example into the correct component category.\",\n          categories: [\n            { id: \"cat-problem\", title: \"Problem Statement\" },\n            { id: \"cat-constraint\", title: \"Constraint\" },\n            { id: \"cat-goal\", title: \"Specific Goal\" },\n            { id: \"cat-eval\", title: \"Evaluation Criterion\" },\n          ],\n          tokens: [\n            {\n              id: \"tok-1\",\n              label:\n                \"The new mobile app must be available on both iOS and Android.\",\n              answer: \"cat-constraint\",\n            },\n            {\n              id: \"tok-2\",\n              label:\n                \"Increase daily active users by 25% in the next quarter.\",\n              answer: \"cat-goal\",\n            },\n            {\n              id: \"tok-3\",\n              label:\n                \"Our current inventory system leads to a 5% error rate in stock levels, causing shipping delays.\",\n              answer: \"cat-problem\",\n            },\n            {\n              id: \"tok-4\",\n              label:\n                \"The system must process 99.9% of transactions accurately under peak load.\",\n              answer: \"cat-eval\",\n            },\n          ],\n        },\n      ],\n    },\n    {\n      id: \"B1.1.2\",\n      title: \"Fundamental Concepts of CT\",\n      duration: \"60 min\",\n      description:\n        \"Master the four core techniques of computational thinking: decomposition, pattern recognition, abstraction, and algorithmic design.\",\n      segments: [\n        {\n          type: \"content\",\n          id: \"ct-intro-main\",\n          heading: \"The Four Pillars of Computational Thinking\",\n          body: (\n            <p>\n              Computational thinking provides a structured way to approach complex\n              problems. By mastering these four concepts, you can develop robust\n              and efficient solutions.\n            </p>\n          ),\n        },\n        {\n          type: \"accordion\",\n          id: \"ct-concepts-deep-dive\",\n          heading: \"Exploring the Concepts\",\n          items: [\n            {\n              title: \"Decomposition ðŸ§©\",\n              body: (\n                <Fragment>\n                  <p>\n                    Breaking down a large, complex problem into smaller, more\n                    manageable sub-problems. This makes the problem easier to\n                    understand and solve.\n                  </p>\n                  <Callout type=\"tip\" title=\"Example: Designing an NPC\">\n                    Instead of tackling &quot;realistic AI behavior&quot; all at once, you\n                    decompose it into:\n                    <ul>\n                      <li>\n                        <strong>Sensing:</strong> How does it see or hear the\n                        player?\n                      </li>\n                      <li>\n                        <strong>Decision-making:</strong> How does it choose an\n                        action (flee, attack)?\n                      </li>\n                      <li>\n                        <strong>Pathfinding:</strong> How does it navigate the\n                        world?\n                      </li>\n                    </ul>\n                  </Callout>\n                </Fragment>\n              ),\n            },\n            {\n              title: \"Pattern Recognition ðŸŽ¨\",\n              body: (\n                <Fragment>\n                  <p>\n                    Identifying recurring similarities, trends, or regularities\n                    within problems or data. Recognizing patterns allows you to\n                    reuse solutions and make predictions.\n                  </p>\n                  <Callout type=\"tip\" title=\"Example: Handwritten Digits\">\n                    To recognize a handwritten &lsquo;8&rsquo;, a machine learning model\n                    doesn&apos;t memorize every possible &lsquo;8&rsquo;. It learns the\n                    underlying pattern: two connected loops. This allows it to\n                    recognize any &lsquo;8&rsquo;, even ones it has never seen before.\n                  </Callout>\n                </Fragment>\n              ),\n            },\n            {\n              title: \"Abstraction ðŸŒ¬ï¸\",\n              body: (\n                <Fragment>\n                  <p>\n                    Filtering out unnecessary details to focus on the essential\n                    elements. Abstraction simplifies complexity by creating a\n                    model of the problem that is easier to work with.\n                  </p>\n                  <Callout type=\"tip\" title=\"Example: Predicting a Race Winner\">\n                    What factors are essential? Engine horsepower, driver\n                    experience, weather. What&apos;s irrelevant? The car&apos;s color,\n                    the driver&apos;s favorite snack. Abstraction means you build\n                    your predictive model using only the essential factors.\n                  </Callout>\n                </Fragment>\n              ),\n            },\n            {\n              title: \"Algorithmic Design âš™ï¸\",\n              body: (\n                <Fragment>\n                  <p>\n                    Developing a step-by-step, unambiguous set of instructions\n                    to solve a problem. The algorithm is the roadmap that a\n                    computer (or a person) follows to reach the solution.\n                  </p>\n                  <Callout type=\"tip\" title=\"Example: Number Sequence\">\n                    To find the next number in the sequence 2, 4, 6, 8... the\n                    algorithm is simple:\n                    <ol>\n                      <li>Get the current number.</li>\n                      <li>Add 2 to the current number.</li>\n                      <li>Output the result.</li>\n                    </ol>\n                  </Callout>\n                </Fragment>\n              ),\n            },\n          ],\n        },\n        {\n          type: \"activity\",\n          id: \"ct-matching-scenarios\",\n          activityType: \"matching\",\n          heading: \"Match Concepts to Scenarios\",\n          instructions:\n            \"Match each computational thinking concept to the scenario that best illustrates it.\",\n          pairs: [\n            {\n              term: \"Decomposition\",\n              example:\n                \"Planning a large software project by breaking it into modules: user authentication, data processing, and user interface.\",\n            },\n            {\n              term: \"Pattern Recognition\",\n              example:\n                \"Analyzing sales data and noticing that a certain product sells best on weekends, then creating a general rule for weekend promotions.\",\n            },\n            {\n              term: \"Abstraction\",\n              example:\n                \"Creating a subway map that shows the order of stations and connections, but ignores the exact geographical distances and street layouts.\",\n            },\n            {\n              term: \"Algorithmic Design\",\n              example:\n                \"Writing a detailed recipe for baking a cake, with precise measurements and steps that must be followed in order.\",\n            },\n          ],\n        },\n      ],\n    },\n    {\n      id: \"B1.1.3\",\n      title: \"Applying CT in Computer Science\",\n      duration: \"45 min\",\n      description:\n        \"See how the core CT concepts are applied in real-world computer science domains.\",\n      segments: [\n        {\n          type: \"content\",\n          id: \"ct-app-intro\",\n          heading: \"Computational Thinking in Action\",\n          body: (\n            <p>\n              Computational thinking isn&apos;t just a theoretical framework; it&apos;s the\n              practical foundation for many fields within computer science. Let&apos;s\n              explore how the four concepts are applied in different areas.\n            </p>\n          ),\n        },\n        {\n          type: \"list\",\n          id: \"ct-app-examples\",\n          heading: \"Domain Examples\",\n          items: [\n            {\n              title: \"Software Development\",\n              body: \"A large Customer Relationship Management (CRM) system is decomposed into modules (lead tracking, customer management). Developers recognize common bug patterns to speed up debugging. They use Object-Oriented Programming to abstract complex operations into reusable objects.\",\n            },\n            {\n              title: \"Data Analysis\",\n              body: \"An analyst decomposes the process of analyzing sales data into tasks like data cleaning and normalization. They use pattern recognition to spot seasonal trends. Abstraction is used to focus on Key Performance Indicators (KPIs) like monthly sales growth.\",\n            },\n            {\n              title: \"Machine Learning\",\n              body: \"A project is decomposed into data collection, model training, and deployment. Pattern recognition is key to identifying features in image data (e.g., using convolutional neural networks). Data is abstracted into feature sets and labels for the model.\",\n            },\n            {\n              title: \"Network Security\",\n              body: \"Security challenges are decomposed into categories like physical and application security. Pattern recognition identifies typical attack patterns (like DDoS or phishing). Abstraction is used to create generic security models and protocols (like SSL/TLS).\",\n            },\n          ],\n        },\n        {\n          type: \"activity\",\n          id: \"ct-app-spot-error\",\n          activityType: \"spot-error\",\n          heading: \"Which Statement is Incorrect?\",\n          instructions:\n            \"Read the statements about applying CT and identify the one that is logically flawed.\",\n          items: [\n            {\n              id: \"err-1\",\n              text: \"In database design, abstraction helps represent real-world entities as tables while ignoring irrelevant details.\",\n              isError: false,\n            },\n            {\n              id: \"err-2\",\n              text: \"When developing software, decomposition is only useful for single developers, not for teams.\",\n              isError: true,\n              explanation:\n                \"Decomposition is especially powerful for teams, as it allows different team members to work on separate modules concurrently.\",\n            },\n            {\n              id: \"err-3\",\n              text: \"A data analyst uses pattern recognition to predict future demand based on historical sales data.\",\n              isError: false,\n            },\n          ],\n        },\n      ],\n    },\n    {\n      id: \"B1.1.4\",\n      title: \"Tracing Flowcharts and Algorithms\",\n      duration: \"45 min\",\n      description:\n        \"Learn to read, interpret, and trace visual representations of algorithms using standardized flowchart symbols.\",\n      segments: [\n        {\n          type: \"content\",\n          id: \"flow-intro\",\n          heading: \"Visualizing Logic\",\n          body: (\n            <Fragment>\n              <p>\n                Flowcharts are diagrams that use standardized symbols (defined by\n                ISO 5807) to visually depict processes, decisions, and the flow\n                of control in an algorithm. They are an essential tool for\n                designing, documenting, and debugging logic before and after\n                coding.\n              </p>\n            </Fragment>\n          ),\n        },\n        {\n          type: \"content\",\n          id: \"flow-symbols-table\",\n          heading: \"Standard Flowchart Symbols (ISO 5807)\",\n          body: (\n            <EnhancedTable\n              columns={[\"Symbol\", \"Name\", \"Definition and Notes\"]}\n              rows={[\n                [\n                  \"Oval\",\n                  \"Terminator (Start/End)\",\n                  \"Indicates the beginning and ending of a program or sub-process.\",\n                ],\n                [\n                  \"Parallelogram\",\n                  \"Input / Output\",\n                  \"Represents a process of inputting data (e.g., from a user) or outputting data (e.g., to a screen).\",\n                ],\n                [\n                  \"Rectangle\",\n                  \"Process / Operation\",\n                  \"Represents a set of operations that changes the value, form, or location of data.\",\n                ],\n                [\n                  \"Diamond\",\n                  \"Decision\",\n                  \"Indicates a point where a decision must be made. The question inside should have only two possible answers (e.g., Yes/No or True/False), leading to different paths.\",\n                ],\n                [\n                  \"Arrow\",\n                  \"Flowline\",\n                  \"Shows the order of operations by connecting the other symbols.\",\n                ],\n              ]}\n            />\n          ),\n        },\n        {\n          type: \"activity\",\n          id: \"flow-gap-fill\",\n          activityType: \"gap-fill\",\n          heading: \"Build a Flowchart Explanation\",\n          instructions:\n            \"Drag the words into the correct blanks to complete the sentence.\",\n          interaction: \"drag\",\n          text: \"In a flowchart, a [[diamond]] symbol is used for a decision, a [[rectangle]] is used for a process, and a [[parallelogram]] is used for input or output.\",\n          tokens: [\n            { id: \"tok-diamond\", label: \"diamond\" },\n            { id: \"tok-para\", label: \"parallelogram\" },\n            { id: \"tok-rect\", label: \"rectangle\" },\n          ],\n          blanks: [\n            { id: \"diamond\", answer: \"tok-diamond\" },\n            { id: \"rectangle\", answer: \"tok-rect\" },\n            { id: \"parallelogram\", answer: \"tok-para\" },\n          ],\n        },\n        {\n          type: \"content\",\n          id: \"flow-tracing\",\n          heading: \"Trace Tables: Testing the Logic\",\n          body: (\n            <Fragment>\n              <p>\n                How do you know if your algorithm is correct? You trace it. A\n                trace table is a technique used to test an algorithm by tracking\n                the values of variables at each step. This helps you identify\n                logic errors.\n              </p>\n              <Callout type=\"tip\" title=\"Worked Example\">\n                Consider an algorithm where A starts at 10 and B starts at\n                100. In a loop, B decreases by 10 and A increases by 10 until A\n                is greater than or equal to B.\n              </Callout>\n              <EnhancedTable\n                columns={[\"Iteration\", \"A\", \"B\", \"Condition (A >= B)\"]}\n                rows={[\n                  [\"Start\", \"10\", \"100\", \"False\"],\n                  [\"1\", \"20\", \"90\", \"False\"],\n                  [\"2\", \"30\", \"80\", \"False\"],\n                  [\"3\", \"40\", \"70\", \"False\"],\n                  [\"4\", \"50\", \"60\", \"False\"],\n                  [\"5\", \"60\", \"50\", \"True -> Program Ends\"],\n                ]}\n              />\n            </Fragment>\n          ),\n        },\n      ],\n    },\n  ],\n  assessment: {\n    duration: \"45 min\",\n    totalMarks: 31,\n    questions: [\n      {\n        id: \"as-q1\",\n        prompt:\n          \"Describe what a problem statement is and why it is critical in the problem specification process.\",\n        marks: 2,\n      },\n      {\n        id: \"as-q2\",\n        prompt:\n          \"Explain the difference between a poor and a strong problem statement, giving an example of each.\",\n        marks: 4,\n      },\n      {\n        id: \"as-q3\",\n        prompt:\n          \"Define the role of constraints in a problem specification and provide an example of a well-defined constraint.\",\n        marks: 3,\n      },\n      {\n        id: \"as-q4\",\n        prompt:\n          \"Compare high-level objectives and specific goals in the context of computational problem-solving.\",\n        marks: 3,\n      },\n      {\n        id: \"as-q5\",\n        prompt:\n          \"Describe the process of decomposition in computational thinking and explain how it can be applied to a real-life problem.\",\n        marks: 4,\n      },\n      {\n        id: \"as-q6\",\n        prompt:\n          \"Explain the importance of pattern recognition in computational thinking, using a relevant example.\",\n        marks: 2,\n      },\n      {\n        id: \"as-q7\",\n        prompt:\n          \"Describe how abstraction simplifies problem-solving in computational thinking.\",\n        marks: 2,\n      },\n      {\n        id: \"as-q8\",\n        prompt:\n          \"Describe the process of algorithmic design, including the steps typically followed.\",\n        marks: 4,\n      },\n      {\n        id: \"as-q9\",\n        prompt:\n          \"Explain how the four fundamental concepts of computational thinking work together to solve problems in computer science.\",\n        marks: 4,\n      },\n    ],\n  },\n};\n\nexport default b1Unit;\n","export default \"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2NDAiIGhlaWdodD0iMzYwIiB2aWV3Qm94PSIwIDAgNjQwIDM2MCI+CiAgPGRlZnM+CiAgICA8bGluZWFyR3JhZGllbnQgaWQ9InN5c3RlbUJnIiB4MT0iMCUiIHkxPSIwJSIgeDI9IjEwMCUiIHkyPSIxMDAlIj4KICAgICAgPHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iI2Y4ZmJmZiIvPgogICAgICA8c3RvcCBvZmZzZXQ9IjEwMCUiIHN0b3AtY29sb3I9IiNlNWYyZmYiLz4KICAgIDwvbGluZWFyR3JhZGllbnQ+CiAgICA8bWFya2VyIGlkPSJhcnJvdyIgbWFya2VyV2lkdGg9IjEyIiBtYXJrZXJIZWlnaHQ9IjEyIiByZWZYPSI2IiByZWZZPSI2IiBvcmllbnQ9ImF1dG8tc3RhcnQtcmV2ZXJzZSI+CiAgICAgIDxwYXRoIGQ9Ik0yIDIgTDEwIDYgTDIgMTAgeiIgZmlsbD0iIzBmMmY3NSIvPgogICAgPC9tYXJrZXI+CiAgPC9kZWZzPgogIDxyZWN0IHdpZHRoPSI2NDAiIGhlaWdodD0iMzYwIiBmaWxsPSJ1cmwoI3N5c3RlbUJnKSIvPgoKICA8ZyBmb250LWZhbWlseT0iSW50ZXIsICdTZWdvZSBVSScsIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTYiIGZpbGw9IiMwZjJmNzUiIHN0cm9rZT0iIzBmMmY3NSIgc3Ryb2tlLXdpZHRoPSIyIj4KICAgIDxyZWN0IHg9IjcwIiB5PSIxNTAiIHdpZHRoPSIxMjAiIGhlaWdodD0iODAiIHJ4PSIxOCIgZmlsbD0iI2ZmZiIvPgogICAgPHRleHQgeD0iMTMwIiB5PSIxOTAiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGRvbWluYW50LWJhc2VsaW5lPSJtaWRkbGUiPklucHV0PC90ZXh0PgoKICAgIDxyZWN0IHg9IjI2MCIgeT0iOTAiIHdpZHRoPSIxMjAiIGhlaWdodD0iODAiIHJ4PSIxOCIgZmlsbD0iI2ZmZiIvPgogICAgPHRleHQgeD0iMzIwIiB5PSIxMzAiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGRvbWluYW50LWJhc2VsaW5lPSJtaWRkbGUiPkNQVTwvdGV4dD4KCiAgICA8cmVjdCB4PSIyNjAiIHk9IjIxMCIgd2lkdGg9IjEyMCIgaGVpZ2h0PSI4MCIgcng9IjE4IiBmaWxsPSIjZmZmIi8+CiAgICA8dGV4dCB4PSIzMjAiIHk9IjI1MCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZG9taW5hbnQtYmFzZWxpbmU9Im1pZGRsZSI+Q2FjaGU8L3RleHQ+CgogICAgPHJlY3QgeD0iNDMwIiB5PSIxNTAiIHdpZHRoPSIxNDAiIGhlaWdodD0iODAiIHJ4PSIxOCIgZmlsbD0iI2ZmZiIvPgogICAgPHRleHQgeD0iNTAwIiB5PSIxOTAiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGRvbWluYW50LWJhc2VsaW5lPSJtaWRkbGUiPk91dHB1dDwvdGV4dD4KCiAgICA8bGluZSB4MT0iMTkwIiB5MT0iMTkwIiB4Mj0iMjYwIiB5Mj0iMTMwIiBtYXJrZXItZW5kPSJ1cmwoI2Fycm93KSIvPgogICAgPGxpbmUgeDE9IjE5MCIgeTE9IjE5MCIgeDI9IjI2MCIgeTI9IjI1MCIgbWFya2VyLWVuZD0idXJsKCNhcnJvdykiLz4KICAgIDxsaW5lIHgxPSIzODAiIHkxPSIxMzAiIHgyPSI0MzAiIHkyPSIxOTAiIG1hcmtlci1lbmQ9InVybCgjYXJyb3cpIi8+CiAgICA8bGluZSB4MT0iMzgwIiB5MT0iMjUwIiB4Mj0iNDMwIiB5Mj0iMTkwIiBtYXJrZXItZW5kPSJ1cmwoI2Fycm93KSIvPgogIDwvZz4KCiAgPGcgZmlsbD0iIzJmNTRlYiIgc3Ryb2tlPSIjMmY1NGViIiBzdHJva2Utd2lkdGg9IjIiIGZvbnQtZmFtaWx5PSJJbnRlciwgJ1NlZ29lIFVJJywgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyI+CiAgICA8Y2lyY2xlIGN4PSIyMDAiIGN5PSIxNTAiIHI9IjE0IiBmaWxsPSIjZmZmIi8+CiAgICA8dGV4dCB4PSIyMDAiIHk9IjE1MCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZG9taW5hbnQtYmFzZWxpbmU9Im1pZGRsZSI+MTwvdGV4dD4KCiAgICA8Y2lyY2xlIGN4PSIzMjAiIGN5PSI3MCIgcj0iMTQiIGZpbGw9IiNmZmYiLz4KICAgIDx0ZXh0IHg9IjMyMCIgeT0iNzAiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGRvbWluYW50LWJhc2VsaW5lPSJtaWRkbGUiPjI8L3RleHQ+CgogICAgPGNpcmNsZSBjeD0iMzIwIiBjeT0iMzIwIiByPSIxNCIgZmlsbD0iI2ZmZiIvPgogICAgPHRleHQgeD0iMzIwIiB5PSIzMjAiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGRvbWluYW50LWJhc2VsaW5lPSJtaWRkbGUiPjM8L3RleHQ+CgogICAgPGNpcmNsZSBjeD0iNTQwIiBjeT0iMTQwIiByPSIxNCIgZmlsbD0iI2ZmZiIvPgogICAgPHRleHQgeD0iNTQwIiB5PSIxNDAiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGRvbWluYW50LWJhc2VsaW5lPSJtaWRkbGUiPjQ8L3RleHQ+CiAgPC9nPgo8L3N2Zz4K\"","import { Fragment } from \"react\";\nimport systemArchitecture from \"../assets/system-architecture.svg\";\n\nconst keyVocabulary = [\n  {\n    term: \"Variable\",\n    definition: \"Named reference to a value stored in memory.\",\n  },\n  {\n    term: \"Data type\",\n    definition: \"Describes the kind of value a variable may store and which operations are valid.\",\n  },\n  {\n    term: \"Boolean\",\n    definition: \"True or False value used in decision making.\",\n  },\n  {\n    term: \"Integer\",\n    definition: \"Whole number without a fractional component.\",\n  },\n  {\n    term: \"Float\",\n    definition: \"Number with a fractional component; supports decimal precision.\",\n  },\n  {\n    term: \"String\",\n    definition: \"Ordered, immutable sequence of characters.\",\n  },\n  {\n    term: \"Character\",\n    definition: \"Single-character string such as \\\"A\\\".\",\n  },\n  {\n    term: \"List\",\n    definition: \"Ordered, mutable collection of values.\",\n  },\n  {\n    term: \"Dictionary\",\n    definition: \"Mapping of keys to values for structured records.\",\n  },\n  {\n    term: \"Operator\",\n    definition: \"Symbol performing arithmetic, comparison, or logical work.\",\n  },\n  {\n    term: \"Assignment\",\n    definition: \"Evaluates the right-hand expression and stores the result in a variable.\",\n  },\n  {\n    term: \"Slice\",\n    definition: \"Portion of a sequence selected using start:stop indexes.\",\n  },\n  {\n    term: \"Concatenation\",\n    definition: \"Combining sequences end-to-end.\",\n  },\n  {\n    term: \"Escape character\",\n    definition: \"Backslash (\\\\) used to insert quotes, newlines, or tabs into strings.\",\n  },\n  {\n    term: \"Exception\",\n    definition: \"Runtime error that can be intercepted with try/except blocks.\",\n  },\n  {\n    term: \"Debugging\",\n    definition: \"Structured process of locating and fixing errors.\",\n  },\n  {\n    term: \"Trace table\",\n    definition: \"Table logging variable values across steps to verify logic.\",\n  },\n];\n\nconst keyVocabularyList = keyVocabulary.map(({ term, definition }) => ({\n  title: term,\n  body: definition,\n}));\n\nconst overviewAim = (\n  <Fragment>\n    <p>\n      Build fluency writing, tracing, and debugging Python programs. You will evaluate data types, practise string\n      manipulation, defend against runtime errors, and apply deliberate debugging workflows.\n    </p>\n    <ul>\n      <li>Choose appropriate data types and reason about scope and assignment.</li>\n      <li>Slice, search, and format strings defensively while reusing the Python standard library.</li>\n      <li>Handle exceptions gracefully and document debugging evidence.</li>\n    </ul>\n  </Fragment>\n);\n\nconst learningOutcomes = (\n  <Fragment>\n    <p>After completing this pathway you will be able to:</p>\n    <ul>\n      <li>\n        <strong>B2.1.1</strong> Construct and trace programs that use global and local variables of multiple data types.\n      </li>\n      <li>\n        <strong>B2.1.2</strong> Extract, reformat, and validate substrings using language-standard operations.\n      </li>\n      <li>\n        <strong>B2.1.3</strong> Describe and implement common exception handling strategies.\n      </li>\n      <li>\n        <strong>B2.1.4</strong> Apply structured debugging techniques including trace tables, breakpoints, and logging.\n      </li>\n    </ul>\n  </Fragment>\n);\n\nconst typeComparisonRows = [\n  [\"Boolean\", \"flag = True\", \"Booleans control decision branches and loop flow.\"],\n  [\"Integer\", \"attempts = 3\", \"Whole numbers; combine with // for floor division.\"],\n  [\"Float\", \"price = 19.95\", \"Store decimal values; use round() or format() for display.\"],\n  [\"String\", 'name = \"Ibcs\"', \"Immutable sequences; slicing returns new strings.\"],\n  [\"List\", \"scores = [88, 76, 93]\", \"Ordered, mutable collection suited to loops and aggregations.\"],\n  [\"Dictionary\", '{\"username\": \"ada\", \"role\": \"student\"}', \"Key/value pairs for structured records.\"],\n  [\"Set\", '{\"python\", \"scratch\"}', \"Unique items with fast membership tests.\"],\n  [\"Operators\", \"+ - * / // % **, comparisons < <= > >= == !=, logic and or not\", \"Pick the operator that matches the required behaviour.\"],\n  [\"Assignment\", \"score = base + bonus\", \"Right side evaluates first; previous value is overwritten.\"],\n];\n\nconst stringMethodRows = [\n  [\"Indexing\", \"greeting[2]\", \"Returns character at index 2; check len(greeting) first.\"],\n  [\"Slice\", \"phrase[0:8]\", \"Start index inclusive, end exclusive; supports negative indexes.\"],\n  [\"find\", 'phrase.find(\"Sci\")', \"Returns index or -1 if not found; test before slicing.\"],\n  [\"replace\", 'phrase.replace(\"is\", \"will be\")', \"Creates a new string with replacements.\"],\n  [\"split\", 'sentence.split()', \"Breaks a string into a list of tokens on whitespace by default.\"],\n  [\"strip\", 'raw.strip()', \"Removes leading and trailing whitespace.\"],\n  [\"formatting\", 'f\"{item} costs {price:.2f}\"', \"Use f-strings for readable output with controlled precision.\"],\n];\n\nconst exceptionScenarios = [\n  {\n    title: \"Unexpected input\",\n    body: (\n      <Fragment>\n        <p>\n          Users may enter empty strings, negative numbers, or malformed data. Validate ranges and wrap conversions in\n          <code>try/except</code> to present a helpful message instead of letting the program crash.\n        </p>\n      </Fragment>\n    ),\n  },\n  {\n    title: \"Missing resources\",\n    body: (\n      <Fragment>\n        <p>\n          Files, databases, or network resources might not exist or might be unavailable. Handle exceptions like{\" \"}\n          <code>FileNotFoundError</code> and close resources in a <code>finally</code> block.\n        </p>\n      </Fragment>\n    ),\n  },\n  {\n    title: \"Logic errors at runtime\",\n    body: (\n      <Fragment>\n        <p>\n          Off-by-one indexes or division by zero can surface after deployment. Defensive checks and descriptive error\n          messages make debugging faster for future maintainers.\n        </p>\n      </Fragment>\n    ),\n  },\n];\n\nconst debuggingTechniqueItems = [\n  {\n    title: \"Trace tables\",\n    body: (\n      <Fragment>\n        <p>\n          Track variable values per iteration to reveal where logic diverges. Perfect for validating loop boundaries or\n          conditional branches.\n        </p>\n      </Fragment>\n    ),\n  },\n  {\n    title: \"Breakpoints\",\n    body: (\n      <Fragment>\n        <p>\n          Pause program execution at a line to inspect state. Use when a branch or loop appears to skip expected code.\n        </p>\n      </Fragment>\n    ),\n  },\n  {\n    title: \"Print logging\",\n    body: (\n      <Fragment>\n        <p>\n          Insert temporary print statements to confirm control flow and data values. Combine with labels so output stays\n          clear during debugging.\n        </p>\n      </Fragment>\n    ),\n  },\n  {\n    title: \"Step execution\",\n    body: (\n      <Fragment>\n        <p>\n          Use your IDE to run code line-by-line. Ideal when you suspect an off-by-one error or incorrect function call\n          order.\n        </p>\n      </Fragment>\n    ),\n  },\n];\n\nexport const b2Unit = {\n  id: \"B2\",\n  title: \"Programming Fundamentals\",\n  hours: {\n    sl: \"SL Â· 40 hours\",\n    hl: \"HL Â· 42 hours\",\n  },\n  guidingQuestion: \"How can we apply programming to solve problems?\",\n  overview: {\n    aim: overviewAim,\n    vocabulary: keyVocabulary,\n  },\n  stages: [\n    {\n      id: \"B2-overview\",\n      title: \"Unit Orientation\",\n      duration: \"20 min\",\n      description:\n        \"Orient yourself to the learning outcomes, vocabulary, and assessment flow for programming fundamentals.\",\n      segments: [\n        {\n          type: \"content\",\n          id: \"b2-overview-aim\",\n          heading: \"Aim of the Unit\",\n          body: overviewAim,\n        },\n        {\n          type: \"content\",\n          id: \"b2-overview-outcomes\",\n          heading: \"Learning Outcomes\",\n          body: learningOutcomes,\n        },\n        {\n          type: \"list\",\n          id: \"b2-overview-vocab\",\n          heading: \"Key Vocabulary\",\n          items: keyVocabularyList,\n        },\n        {\n          type: \"micro-quiz\",\n          id: \"b2-overview-check\",\n          heading: \"Ready to Start?\",\n          questions: [\n            {\n              id: \"b2-overview-q1\",\n              type: \"mcq\",\n              prompt: \"Which statement best describes a programming variable?\",\n              options: [\n                { id: \"b2-overview-q1-a\", label: \"Static storage that cannot change after initial assignment.\" },\n                {\n                  id: \"b2-overview-q1-b\",\n                  label: \"Named memory location whose stored value can update during execution.\",\n                },\n                { id: \"b2-overview-q1-c\", label: \"Collection of operations that run only once.\" },\n              ],\n              answer: \"b2-overview-q1-b\",\n              rationale: \"Variables are storage locations that can change while a program runs.\",\n            },\n            {\n              id: \"b2-overview-q2\",\n              type: \"true-false\",\n              prompt: \"Exception handling exists to hide bugs rather than improve user experience.\",\n              answer: false,\n              rationale: \"Exception handling catches predictable failures and offers recovery paths for users.\",\n            },\n          ],\n        },\n      ],\n    },\n    {\n      id: \"B2.1.1\",\n      title: \"Variables and Data Types\",\n      duration: \"55 min\",\n      description:\n        \"Choose appropriate data types, reason about scope, and trace how assignments update program state.\",\n      segments: [\n        {\n          type: \"content\",\n          id: \"b2-211-why\",\n          heading: \"Why Variables and Types Matter\",\n          body: (\n            <Fragment>\n              <p>\n                Correct types unlock valid operations and prevent precision loss. When you choose the wrong type, simple\n                calculations can overflow, string conversions become awkward, and comparisons fail silently.\n              </p>\n              <p>\n                Understanding scope also prevents accidental reuse of values and makes debugging faster because you know\n                where each variable lives.\n              </p>\n            </Fragment>\n          ),\n        },\n        {\n          type: \"table\",\n          id: \"b2-211-types\",\n          heading: \"Type Cheat Sheet\",\n          columns: [\"Concept\", \"Python example\", \"Why it matters\"],\n          rows: typeComparisonRows,\n        },\n        {\n          type: \"list\",\n          id: \"b2-211-rules\",\n          heading: \"Essential Rules\",\n          items: [\n            {\n              title: \"Declaration vs inference\",\n              body: \"Python infers type from the assigned value. Keep readability high by naming variables descriptively and documenting expected types when needed.\",\n            },\n            {\n              title: \"Scope\",\n              body: \"Global variables persist for the program lifetime; local variables disappear when a function or block ends. Minimise global state to avoid surprise mutations.\",\n            },\n            {\n              title: \"Assignments overwrite\",\n              body: \"When you assign a new value, the prior contents are gone. Copy values you still need before overwriting.\",\n            },\n            {\n              title: \"Type conversions\",\n              body: \"Use constructors like int(), float(), str(), or bool() to convert values explicitly and capture ValueError when inputs are invalid.\",\n            },\n          ],\n        },\n        {\n          type: \"activity\",\n          id: \"b2-211-diagram\",\n          activityType: \"diagram-label\",\n          heading: \"Label the System Components\",\n          instructions: \"Drag each label onto the numbered hotspot to identify how data flows through a simple computer system.\",\n          image: {\n            src: systemArchitecture,\n            alt: \"Diagram showing input, CPU, cache and output blocks.\",\n          },\n          tokens: [\n            { id: \"sys-input\", label: \"Input devices\" },\n            { id: \"sys-cpu\", label: \"CPU\" },\n            { id: \"sys-cache\", label: \"Cache / RAM\" },\n            { id: \"sys-output\", label: \"Output devices\" },\n          ],\n          targets: [\n            { id: \"spot-input\", x: 31, y: 42, answer: \"sys-input\" },\n            { id: \"spot-cpu\", x: 50, y: 20, answer: \"sys-cpu\" },\n            { id: \"spot-cache\", x: 50, y: 89, answer: \"sys-cache\" },\n            { id: \"spot-output\", x: 84, y: 39, answer: \"sys-output\" },\n          ],\n        },\n        {\n          type: \"activity\",\n          id: \"b2-211-matching\",\n          activityType: \"matching\",\n          heading: \"Match the Data Type to the Scenario\",\n          instructions: \"Match each scenario to the most appropriate data type choice.\",\n          pairs: [\n            {\n              term: \"Boolean\",\n              example: \"Store whether a customer opted in to marketing emails.\",\n            },\n            {\n              term: \"float\",\n              example: \"Track the price of a flight ticket with cents precision.\",\n            },\n            {\n              term: \"String\",\n              example: \"Record a phone number that preserves leading zeroes and punctuation.\",\n            },\n            {\n              term: \"int\",\n              example: \"Count how many login attempts remain before lockout.\",\n            },\n            {\n              term: \"list\",\n              example: \"Maintain the quiz scores for a single student.\",\n            },\n          ],\n        },\n        {\n          type: \"activity\",\n          id: \"b2-211-swap\",\n          activityType: \"ordering\",\n          heading: \"Ordering: Safe Variable Swap\",\n          instructions: \"Arrange the steps to safely swap two variable values using a temporary placeholder.\",\n          items: [\n            \"Store the value of variable A in temp.\",\n            \"Assign the value of variable B to variable A.\",\n            \"Assign temp to variable B.\",\n            \"Declare the temporary variable temp.\",\n          ],\n        },\n        {\n          type: \"activity\",\n          id: \"b2-211-spot\",\n          activityType: \"spot-error\",\n          heading: \"Spot the Type Errors\",\n          instructions: \"Select every line that would raise a type or casting issue.\",\n          items: [\n            {\n              id: \"b2-211-spot-1\",\n              text: \"price = float(\\\"9.99\\\")\",\n              isError: false,\n              explanation: \"Converting the string to a float succeeds when the input is numeric.\",\n            },\n            {\n              id: \"b2-211-spot-2\",\n              text: \"tickets = int(user_input)\",\n              isError: true,\n              explanation: \"If user_input is not numeric this raises ValueError unless wrapped in try/except.\",\n            },\n            {\n              id: \"b2-211-spot-3\",\n              text: \"total = 42 + \\\" students\\\"\",\n              isError: true,\n              explanation: \"Python cannot add an int and a string without explicit conversion.\",\n            },\n            {\n              id: \"b2-211-spot-4\",\n              text: \"done = bool(1)\",\n              isError: false,\n              explanation: \"bool(1) evaluates to True, which is valid when you intend to cast integers to boolean.\",\n            },\n            {\n              id: \"b2-211-spot-5\",\n              text: \"stock = list({\\\"apples\\\": 3})\",\n              isError: true,\n              explanation: \"Casting a dict to list drops keys unexpectedly; use list(dictionary.items()) or keep the dict type.\",\n            },\n          ],\n        },\n        {\n          type: \"python-playground\",\n          id: \"b2-211-playground\",\n          heading: \"Try It: Inspecting Types and Swapping\",\n          prompt: (\n            <Fragment>\n              <p>Run the starter to inspect variable types, then experiment with your own assignments.</p>\n              <ul>\n                <li>Observe how Python infers types and how <code>type()</code> reports them.</li>\n                <li>Practise swapping values without losing the original data.</li>\n              </ul>\n            </Fragment>\n          ),\n          starterCode: `user_name = \"Ada\"\nage_years = 19\nticket_price = 19.95\nis_student = True\n\nprint(\"Values:\", user_name, age_years, ticket_price, is_student)\nprint(\"Types:\", type(user_name), type(age_years), type(ticket_price), type(is_student))\n\n# TODO: swap the values of a and b without losing data\na = 7\nb = 3\nprint(\"Before swap:\", a, b)\n\ntemp = a\na = b\nb = temp\n\nprint(\"After swap:\", a, b)\n`,\n          snippets: [\n            {\n              id: \"b2-211-cast\",\n              label: \"Cast user input\",\n              code: 'raw_age = \"17\"\\\\nage = int(raw_age)\\\\nprint(\"Age as int:\", age, type(age))',\n            },\n            {\n              id: \"b2-211-format\",\n              label: \"Format receipt line\",\n              code: 'item = \"Notebook\"\\\\nprice = 4.5\\\\nprint(f\"{item} ... ${price:.2f}\")',\n            },\n          ],\n        },\n        {\n          type: \"micro-quiz\",\n          id: \"b2-211-quiz\",\n          heading: \"Mini Checkpoint\",\n          questions: [\n            {\n              id: \"b2-211-q1\",\n              type: \"mcq\",\n              prompt: \"What does 7 // 2 evaluate to in Python?\",\n              options: [\n                { id: \"b2-211-q1-a\", label: \"3.5\" },\n                { id: \"b2-211-q1-b\", label: \"3\" },\n                { id: \"b2-211-q1-c\", label: \"4\" },\n              ],\n              answer: \"b2-211-q1-b\",\n              rationale: \"// performs floor division, returning the integer 3 for 7 // 2.\",\n            },\n            {\n              id: \"b2-211-q2\",\n              type: \"true-false\",\n              prompt: \"Python floor division uses the operator //.\",\n              answer: true,\n              rationale: \"`//` performs floor division in Python, returning an integer result.\",\n            },\n            {\n              id: \"b2-211-q3\",\n              type: \"mcq\",\n              prompt: \"Why do we need a temporary variable when swapping values?\",\n              options: [\n                {\n                  id: \"b2-211-q3-a\",\n                  label: \"Without it the interpreter refuses to reassign values.\",\n                },\n                {\n                  id: \"b2-211-q3-b\",\n                  label: \"Reassignment overwrites values; a temporary variable preserves one value until the swap finishes.\",\n                },\n                {\n                  id: \"b2-211-q3-c\",\n                  label: \"It makes the code compile faster.\",\n                },\n              ],\n              answer: \"b2-211-q3-b\",\n              rationale: \"Assignments overwrite values, so a temporary placeholder preserves one of them during the swap.\",\n            },\n            {\n              id: \"b2-211-q4\",\n              type: \"true-false\",\n              prompt: \"bool(0) evaluates to False in Python.\",\n              answer: true,\n              rationale: \"Non-zero numbers cast to True; zero casts to False.\",\n            },\n          ],\n        },\n        {\n          type: \"reflection\",\n          id: \"b2-211-reflection\",\n          heading: \"Reflection\",\n          prompt: \"When would you store age as a float instead of an int in a Python application? Justify the choice.\",\n        },\n      ],\n    },\n    {\n      id: \"B2.1.2\",\n      title: \"Strings: Extraction and Manipulation\",\n      duration: \"55 min\",\n      description:\n        \"Practise slicing, searching, and formatting text while guarding against index errors and inconsistent casing.\",\n      segments: [\n        {\n          type: \"content\",\n          id: \"b2-212-why\",\n          heading: \"Why String Skills Matter\",\n          body: (\n            <Fragment>\n              <p>\n                User-facing programs rely on text: usernames, passwords, log entries, IoT messages. Clean string\n                handling makes it possible to validate input and prepare meaningful outputs.\n              </p>\n              <p>\n                Index errors and inconsistent casing are common failure pointsâ€”defensive slicing and checks keep strings\n                safe before you manipulate them.\n              </p>\n            </Fragment>\n          ),\n        },\n        {\n          type: \"accordion\",\n          id: \"b2-212-techniques\",\n          heading: \"Technique Highlights\",\n          items: [\n            {\n              title: \"Indexing\",\n              body: (\n                <Fragment>\n                  <p>\n                    Python indexing requires <code>0 â‰¤ index &lt; len(sequence)</code>. Check the length first to avoid\n                    <code>IndexError</code>.\n                  </p>\n                </Fragment>\n              ),\n            },\n            {\n              title: \"Finding substrings\",\n              body: (\n                <Fragment>\n                  <p>\n                    Use <code>find</code> to locate substrings. A result of <code>-1</code> means the target was not\n                    foundâ€”handle that before slicing.\n                  </p>\n                </Fragment>\n              ),\n            },\n            {\n              title: \"Formatting output\",\n              body: (\n                <Fragment>\n                  <p>\n                    Python f-strings produce readable output with explicit formatting. Prefer them over manual\n                    concatenation when combining multiple values.\n                  </p>\n                </Fragment>\n              ),\n            },\n          ],\n        },\n        {\n          type: \"table\",\n          id: \"b2-212-methods\",\n          heading: \"Common String Operations\",\n          columns: [\"Operation\", \"Python example\", \"Why use it?\"],\n          rows: stringMethodRows,\n        },\n        {\n          type: \"activity\",\n          id: \"b2-212-matching\",\n          activityType: \"matching\",\n          heading: \"Match Method to Outcome\",\n          instructions: \"Pair each operation with the result it produces for the sample string.\",\n          pairs: [\n            {\n              term: 's = \"Old Town\"; s[4]',\n              example: '\"T\"',\n            },\n            {\n              term: 's = \"Computer Science is fun\"; s[9:16]',\n              example: '\"Science\"',\n            },\n            {\n              term: 's = \"Computer Science is fun\"; s.replace(\"is\", \"will be\")',\n              example: '\"Computer Science will be fun\"',\n            },\n            {\n              term: 'words = \"Hello world\".split()',\n              example: '[\"Hello\", \"world\"]',\n            },\n          ],\n        },\n        {\n          type: \"activity\",\n          id: \"b2-212-gap\",\n          activityType: \"gap-fill\",\n          heading: \"Fill the String Toolkit\",\n          instructions: \"Drag the correct method into each blank to complete the description.\",\n          interaction: \"drag\",\n          text:\n            \"Use [[b2-212-gap-find]] to locate a substring, [[b2-212-gap-slice]] to extract it, and [[b2-212-gap-format]] to output a tidy message.\",\n          tokens: [\n            { id: \"token-find\", label: \"find\" },\n            { id: \"token-slice\", label: \"slice\" },\n            { id: \"token-format\", label: \"f-string\" },\n          ],\n          blanks: [\n            { id: \"b2-212-gap-find\", answer: \"token-find\" },\n            { id: \"b2-212-gap-slice\", answer: \"token-slice\" },\n            { id: \"b2-212-gap-format\", answer: \"token-format\" },\n          ],\n        },\n        {\n          type: \"python-playground\",\n          id: \"b2-212-playground\",\n          heading: \"Try It: Build a Password Tag\",\n          prompt: (\n            <Fragment>\n              <p>\n                Generate a simple password suggestion using slices and formatting. Modify indices or methods to see how\n                the output changes.\n              </p>\n              <p className=\"muted\">Tip: Re-run the code each time you tweak the slicing range.</p>\n            </Fragment>\n          ),\n          starterCode: `surname = \"Stewart\"\nspecial = \"#42\"\nbase = surname.lower()\n\nfirst_four = base[:4]\npassword = f\"{first_four}{special}\"\n\nprint(password)\n\n# Challenge: ensure surname is at least 4 characters before slicing.\nif len(base) < 4:\n    print(\"Surname too short for default slice.\")\n`,\n          snippets: [\n            {\n              id: \"b2-212-strip\",\n              label: \"Strip whitespace\",\n              code: 'raw = \"  Computer Science  \"\\\\nprint(raw.strip())',\n            },\n            {\n              id: \"b2-212-format\",\n              label: \"Format sentence\",\n              code: 'course = \"IBCS\"\\\\nscore = 87.456\\\\nprint(f\"{course} score: {score:.1f}\")',\n            },\n          ],\n        },\n        {\n          type: \"micro-quiz\",\n          id: \"b2-212-quiz\",\n          heading: \"String Skills Pulse Check\",\n          questions: [\n            {\n              id: \"b2-212-q1\",\n              type: \"mcq\",\n              prompt: 'What does Python return for \"Science\"[2:6]?',\n              options: [\n                { id: \"b2-212-q1-a\", label: '\"ienc\"' },\n                { id: \"b2-212-q1-b\", label: '\"ien\"' },\n                { id: \"b2-212-q1-c\", label: '\"ence\"' },\n              ],\n              answer: \"b2-212-q1-a\",\n              rationale: \"Start index inclusive (2) and end exclusive (6) yields the characters i, e, n, c.\",\n            },\n            {\n              id: \"b2-212-q2\",\n              type: \"true-false\",\n              prompt: \"Python strings are immutable.\",\n              answer: true,\n              rationale: \"All string operations return new strings instead of modifying the original.\",\n            },\n            {\n              id: \"b2-212-q3\",\n              type: \"mcq\",\n              prompt: \"Which approach most clearly concatenates numbers into a string?\",\n              options: [\n                { id: \"b2-212-q3-a\", label: \"Use the + operator repeatedly with raw integers.\" },\n                {\n                  id: \"b2-212-q3-b\",\n                  label: \"Use formatting, e.g., f-strings or String.format, to control layout explicitly.\",\n                },\n                { id: \"b2-212-q3-c\", label: \"Convert numbers to binary strings first.\" },\n              ],\n              answer: \"b2-212-q3-b\",\n              rationale: \"Formatting keeps intent clear and avoids implicit conversions.\",\n            },\n          ],\n        },\n        {\n          type: \"reflection\",\n          id: \"b2-212-reflection\",\n          heading: \"Reflection\",\n          prompt: \"When concatenating numbers into strings, which Python formatting approach keeps your intent clearest?\",\n        },\n      ],\n    },\n    {\n      id: \"B2.1.3\",\n      title: \"Exception Handling\",\n      duration: \"45 min\",\n      description: \"Plan for runtime failures and design error messages that guide users instead of crashing the app.\",\n      segments: [\n        {\n          type: \"content\",\n          id: \"b2-213-why\",\n          heading: \"Why Exceptions Happen\",\n          body: (\n            <Fragment>\n              <p>\n                Unchecked input, missing files, and timing issues cause runtime failures. Exception handling lets you\n                respond predictably, log useful diagnostics, and keep programs stable.\n              </p>\n              <p>\n                The goal is not to hide bugsâ€”it is to surface helpful information while preserving control over the app.\n              </p>\n            </Fragment>\n          ),\n        },\n        {\n          type: \"list\",\n          id: \"b2-213-failures\",\n          heading: \"Typical Failure Points\",\n          items: [\n            {\n              title: \"Bad or missing input\",\n              body: \"Empty strings, unexpected characters, or numbers outside an allowed range.\",\n            },\n            {\n              title: \"Unavailable resources\",\n              body: \"Files, networks, or sensors that fail to respond when needed.\",\n            },\n            {\n              title: \"Logic defects\",\n              body: \"Dividing by zero, out-of-range indexes, or null dereferences triggered by logic mistakes.\",\n            },\n          ],\n        },\n        {\n          type: \"accordion\",\n          id: \"b2-213-accordion\",\n          heading: \"Handling Patterns\",\n          items: exceptionScenarios,\n        },\n        {\n          type: \"activity\",\n          id: \"b2-213-classify\",\n          activityType: \"classification\",\n          heading: \"Classify the Exception Strategy\",\n          instructions: \"Drag each scenario to the way you would respond to it.\",\n          categories: [\n            { id: \"prevent\", title: \"Prevent\", description: \"Validate or constrain inputs before they fail.\" },\n            { id: \"handle\", title: \"Handle\", description: \"Catch the error and present a friendly message.\" },\n            { id: \"recover\", title: \"Recover\", description: \"Retry or fallback to keep the program running.\" },\n          ],\n          tokens: [\n            {\n              id: \"b2-213-token-1\",\n              label: \"Ensure age is 0-120 before converting user input.\",\n              answer: \"prevent\",\n            },\n            {\n              id: \"b2-213-token-2\",\n              label: \"Wrap file access in try/except and show a missing-file notice.\",\n              answer: \"handle\",\n            },\n            {\n              id: \"b2-213-token-3\",\n              label: \"Retry a network request with exponential back-off.\",\n              answer: \"recover\",\n            },\n            {\n              id: \"b2-213-token-4\",\n              label: \"Validate dropdown selections so invalid IDs never hit the server.\",\n              answer: \"prevent\",\n            },\n          ],\n        },\n        {\n          type: \"activity\",\n          id: \"b2-213-ordering\",\n          activityType: \"ordering\",\n          heading: \"Ordering: Handle Input Safely\",\n          instructions: \"Place the steps in order to validate age input and handle failures.\",\n          items: [\n            \"Prompt the user for age input.\",\n            \"Attempt to convert the input to an integer inside a try block.\",\n            \"Check that the age is between 0 and 120 inclusive.\",\n            \"Raise or report an error if conversion fails or the range check fails.\",\n            \"Proceed with the program when conversion and range checks succeed.\",\n          ],\n        },\n        {\n          type: \"micro-quiz\",\n          id: \"b2-213-quiz\",\n          heading: \"Exception Handling Pulse Check\",\n          questions: [\n            {\n              id: \"b2-213-q1\",\n              type: \"true-false\",\n              prompt: \"A finally block only runs when an exception occurs.\",\n              answer: false,\n              rationale: \"Finally runs regardless of whether an exception was raised.\",\n            },\n            {\n              id: \"b2-213-q2\",\n              type: \"mcq\",\n              prompt: \"Which Python exception best matches a missing file scenario?\",\n              options: [\n                { id: \"b2-213-q2-a\", label: \"FileNotFoundError\" },\n                { id: \"b2-213-q2-b\", label: \"IndexError\" },\n                { id: \"b2-213-q2-c\", label: \"ValueError\" },\n              ],\n              answer: \"b2-213-q2-a\",\n              rationale: \"Missing resources trigger file-related exceptions that must be handled.\",\n            },\n            {\n              id: \"b2-213-q3\",\n              type: \"mcq\",\n              prompt: \"How does 'garbage in, garbage out' influence validation?\",\n              options: [\n                {\n                  id: \"b2-213-q3-a\",\n                  label: \"It suggests skipping validation to avoid upsetting users.\",\n                },\n                {\n                  id: \"b2-213-q3-b\",\n                  label: \"It emphasises preventing bad input early to avoid cascading failures.\",\n                },\n                { id: \"b2-213-q3-c\", label: \"It means errors are always the user's fault.\" },\n              ],\n              answer: \"b2-213-q3-b\",\n              rationale: \"Defensive validation stops bad input before it propagates through the system.\",\n            },\n          ],\n        },\n        {\n          type: \"reflection\",\n          id: \"b2-213-reflection\",\n          heading: \"Reflection\",\n          prompt: \"How does â€œgarbage in, garbage outâ€ influence your validation strategy for user forms?\",\n        },\n      ],\n    },\n    {\n      id: \"B2.1.4\",\n      title: \"Debugging Techniques\",\n      duration: \"50 min\",\n      description:\n        \"Diagnose faults with trace tables, breakpoints, print logging, and step execution, then apply them to a sample program.\",\n      segments: [\n        {\n          type: \"content\",\n          id: \"b2-214-why\",\n          heading: \"Debugging without Guesswork\",\n          body: (\n            <Fragment>\n              <p>\n                Bugs lurk in correct-looking code. A deliberate debugging workflow saves hours compared with random\n                tweaksâ€”especially when the bug refuses to reproduce on command.\n              </p>\n              <p>Pick tools based on symptoms, capture evidence, and share it with teammates for faster fixes.</p>\n            </Fragment>\n          ),\n        },\n        {\n          type: \"accordion\",\n          id: \"b2-214-techniques\",\n          heading: \"Technique Toolkit\",\n          items: debuggingTechniqueItems,\n        },\n        {\n          type: \"activity\",\n          id: \"b2-214-matching\",\n          activityType: \"matching\",\n          heading: \"Match Bug Symptom to Technique\",\n          instructions: \"Choose the debugging technique that best fits each scenario.\",\n          pairs: [\n            {\n              term: \"Loop skips the final element\",\n              example: \"Complete a trace table to inspect index and length per iteration.\",\n            },\n            {\n              term: \"Branch never triggers even with matching conditions\",\n              example: \"Set a breakpoint on the branch and inspect variable values at runtime.\",\n            },\n            {\n              term: \"API call fails midway through execution\",\n              example: \"Add labelled print statements before and after the call to confirm parameters and response.\",\n            },\n            {\n              term: \"Suspect off-by-one error in nested loop\",\n              example: \"Use step execution to watch the loop counters progress together.\",\n            },\n          ],\n        },\n        {\n          type: \"activity\",\n          id: \"b2-214-completion\",\n          activityType: \"code-completion\",\n          heading: \"Code Completion: Debug Logger\",\n          instructions: \"Fill in the missing expressions to finish the debugging helper.\",\n          prompt: (\n            <Fragment>\n              <p>Use deliberate logging to capture what your loop is doing at runtime.</p>\n            </Fragment>\n          ),\n          code: `for index, value in enumerate(numbers):\\n    [[b2-214-gap-log]]\\n    if [[b2-214-gap-condition]]:\\n        print(\"Found the value\", value)\\n`,\n          placeholders: [\n            {\n              id: \"b2-214-gap-log\",\n              answer: \"print(f\\\"Checking index {index}: {value}\\\")\",\n              label: \"Log statement\",\n              hint: \"Print both the index and current value.\",\n            },\n            {\n              id: \"b2-214-gap-condition\",\n              answer: \"value == target\",\n              label: \"Condition\",\n              hint: \"Compare the current value to the target before printing.\",\n            },\n          ],\n        },\n        {\n          type: \"python-playground\",\n          id: \"b2-214-playground\",\n          heading: \"Try It: Debug Selection Sort\",\n          prompt: (\n            <Fragment>\n              <p>\n                Run the selection sort sample with logging enabled. Modify the logging to capture more detail or fix the\n                bug that misplaces the final element.\n              </p>\n            </Fragment>\n          ),\n          starterCode: `numbers = [7, 2, 9, 4, 3]\n\ndef selection_sort(values):\n    items = values[:]\n    for i in range(len(items) - 1):\n        lowest_index = i\n        print(f\"Outer loop i={i}, start list: {items}\")\n        for j in range(i + 1, len(items)):\n            print(f\"  Compare items[{j}]={items[j]} with items[{lowest_index}]={items[lowest_index]}\")\n            if items[j] < items[lowest_index]:\n                lowest_index = j\n        # BUG: swap missing when lowest_index equals i\n        if lowest_index != i:\n            items[i], items[lowest_index] = items[lowest_index], items[i]\n        print(f\"After pass {i}: {items}\")\n    return items\n\nprint(\"Original:\", numbers)\nsorted_values = selection_sort(numbers)\nprint(\"Sorted:\", sorted_values)\n`,\n          snippets: [\n            {\n              id: \"b2-214-trace\",\n              label: \"Trace with enumerate\",\n              code: 'for index, value in enumerate(numbers):\\\\n    print(index, value)',\n            },\n            {\n              id: \"b2-214-todo\",\n              label: \"Add TODO marker\",\n              code: 'print(\"TODO: inspect lowest_index when equal to i\")',\n            },\n          ],\n        },\n        {\n          type: \"micro-quiz\",\n          id: \"b2-214-quiz\",\n          heading: \"Debugging Pulse Check\",\n          questions: [\n            {\n              id: \"b2-214-q1\",\n              type: \"mcq\",\n              prompt: \"Which technique best surfaces an off-by-one error in a loop?\",\n              options: [\n                { id: \"b2-214-q1-a\", label: \"Trace table covering each iteration.\" },\n                { id: \"b2-214-q1-b\", label: \"Only re-running the program repeatedly.\" },\n                { id: \"b2-214-q1-c\", label: \"Adding more features to the code.\" },\n              ],\n              answer: \"b2-214-q1-a\",\n              rationale: \"Trace tables expose iteration-by-iteration variable states.\",\n            },\n            {\n              id: \"b2-214-q2\",\n              type: \"true-false\",\n              prompt: \"Breakpoints let you pause execution to inspect values mid-run.\",\n              answer: true,\n              rationale: \"Breakpoints intentionally halt execution so you can inspect the stack and variables.\",\n            },\n            {\n              id: \"b2-214-q3\",\n              type: \"mcq\",\n              prompt: \"When do you prefer a breakpoint over print statements?\",\n              options: [\n                {\n                  id: \"b2-214-q3-a\",\n                  label: \"When you need to inspect variable state inside a complex branch without altering code output.\",\n                },\n                { id: \"b2-214-q3-b\", label: \"When print statements crash the program.\" },\n                { id: \"b2-214-q3-c\", label: \"Prints are always better than breakpoints.\" },\n              ],\n              answer: \"b2-214-q3-a\",\n              rationale: \"Breakpoints expose state without adding new output to the console.\",\n            },\n          ],\n        },\n        {\n          type: \"reflection\",\n          id: \"b2-214-reflection\",\n          heading: \"Reflection\",\n          prompt: \"Which bug did you last fix? Which technique helped you pinpoint it fastest?\",\n        },\n      ],\n    },\n    {\n      id: \"B2.1.summary\",\n      title: \"Consolidation Task\",\n      duration: \"50 min\",\n      description: \"Plan and implement a username utility with validation, exceptions, and debugging evidence.\",\n      segments: [\n        {\n          type: \"content\",\n          id: \"b2-summary-brief\",\n          heading: \"Project Brief\",\n          body: (\n            <ol>\n              <li>Ask for first and last names; create a username from the last two letters of the first name and the first three of the last.</li>\n              <li>Lower-case the result and validate minimum lengths before slicing.</li>\n              <li>Raise exceptions for short names or non-alphabetic characters.</li>\n              <li>Capture debug prints or trace-table notes for at least two test cases.</li>\n            </ol>\n          ),\n        },\n        {\n          type: \"activity\",\n          id: \"b2-summary-planner\",\n          activityType: \"planner\",\n          heading: \"Username Utility Planner\",\n          instructions: \"Complete each panel to outline your solution. Save the notes before you move on.\",\n          panels: [\n            { id: \"b2-summary-input\", label: \"Inputs & validation rules\" },\n            { id: \"b2-summary-exceptions\", label: \"Exceptions to handle and messages to show\" },\n            { id: \"b2-summary-tests\", label: \"Test cases and expected outputs\" },\n            { id: \"b2-summary-debug\", label: \"Debugging evidence you will capture\" },\n          ],\n        },\n        {\n          type: \"micro-quiz\",\n          id: \"b2-summary-exit\",\n          heading: \"Exit Ticket\",\n          questions: [\n            {\n              id: \"b2-summary-q1\",\n              type: \"mcq\",\n              prompt: \"Which step should run first when validating username inputs?\",\n              options: [\n                { id: \"b2-summary-q1-a\", label: \"Slice the names immediately.\" },\n                { id: \"b2-summary-q1-b\", label: \"Check the length and character rules before slicing.\" },\n                { id: \"b2-summary-q1-c\", label: \"Print the username before validation.\" },\n              ],\n              answer: \"b2-summary-q1-b\",\n              rationale: \"Validate before slicing to avoid runtime errors and produce helpful messages.\",\n            },\n            {\n              id: \"b2-summary-q2\",\n              type: \"true-false\",\n              prompt: \"Planner notes are only useful for teachers, not students.\",\n              answer: false,\n              rationale: \"Planner notes help you implement and debug your own work.\",\n            },\n          ],\n        },\n      ],\n    },\n  ],\n  assessment: {\n    duration: \"45 min\",\n    totalMarks: 25,\n    questions: [\n      {\n        id: \"b2-assessment-q1\",\n        prompt: \"Define variable and data type. Explain why type choice affects what operations are valid.\",\n        marks: 3,\n      },\n      {\n        id: \"b2-assessment-q2\",\n        prompt:\n          \"Given short snippets, identify bugs caused by integer versus floating-point division and correct them.\",\n        marks: 4,\n      },\n      {\n        id: \"b2-assessment-q3\",\n        prompt:\n          'For input text \"Computer Science is fun\", extract \"Science\", replace \"is\" with \"will be\", and output the final string using Python string operations.',\n        marks: 5,\n      },\n      {\n        id: \"b2-assessment-q4\",\n        prompt:\n          \"Describe two distinct exception scenarios and outline appropriate try/catch or try/except blocks with finally for each.\",\n        marks: 5,\n      },\n      {\n        id: \"b2-assessment-q5a\",\n        prompt: \"Complete a trace table for a loop that counts values > 20 and provide the final count.\",\n        marks: 4,\n      },\n      {\n        id: \"b2-assessment-q5b\",\n        prompt: \"Justify when to use breakpoints versus print statements when debugging the same task.\",\n        marks: 4,\n      },\n    ],\n  },\n};\n\nexport default b2Unit;\n","import { classNames } from \"../../utils/classNames.js\";\nimport \"./ProgressBar.css\";\n\nfunction clampPercent(value = 0, max = 100) {\n  const safeMax = Number.isFinite(max) && max > 0 ? max : 100;\n  const ratio = Number.isFinite(value) ? value / safeMax : 0;\n  const percent = ratio * 100;\n  if (!Number.isFinite(percent)) return 0;\n  return Math.max(0, Math.min(percent, 100));\n}\n\nfunction ProgressBar({\n  value = 0,\n  max = 100,\n  tone = \"brand\",\n  size = \"md\",\n  showValue = false,\n  label,\n  className,\n  children,\n  ariaLabel,\n  ...rest\n}) {\n  const percent = clampPercent(value, max);\n  const rounded = Math.round(percent);\n  const rootClass = classNames(\n    \"progress-bar\",\n    tone && `progress-bar--${tone}`,\n    size && `progress-bar--${size}`,\n    className,\n  );\n\n  return (\n    <div className={rootClass} style={{ \"--progress-percent\": `${percent}%` }} {...rest}>\n      <div className=\"progress-bar__track\">\n        <div\n          className=\"progress-bar__fill\"\n          role=\"progressbar\"\n          aria-valuemin={0}\n          aria-valuemax={100}\n          aria-valuenow={rounded}\n          aria-label={ariaLabel}\n        >\n          {showValue ? <span className=\"progress-bar__value\">{rounded}%</span> : null}\n        </div>\n      </div>\n      {(label || children) && <div className=\"progress-bar__footer\">{label || children}</div>}\n    </div>\n  );\n}\n\nexport default ProgressBar;\n\n\n","import classNames from \"../../utils/classNames.js\";\n\nimport \"./StatusPill.css\";\n\nconst TONES = new Set([\"info\", \"success\", \"warning\", \"danger\", \"neutral\", \"muted\"]);\nconst VARIANTS = new Set([\"soft\", \"solid\", \"outline\"]);\nconst SIZES = new Set([\"sm\", \"md\", \"lg\"]);\n\nexport default function StatusPill({\n  tone = \"info\",\n  variant = \"soft\",\n  size = \"sm\",\n  icon,\n  className,\n  children,\n  as: Component = \"span\",\n  ...props\n}) {\n  const normalizedTone = TONES.has(tone) ? tone : \"info\";\n  const normalizedVariant = VARIANTS.has(variant) ? variant : \"soft\";\n  const normalizedSize = SIZES.has(size) ? size : \"sm\";\n\n  return (\n    <Component\n      className={classNames(\n        \"status-pill\",\n        `status-pill--${normalizedTone}`,\n        `status-pill--variant-${normalizedVariant}`,\n        `status-pill--size-${normalizedSize}`,\n        icon ? \"status-pill--with-icon\" : null,\n        className,\n      )}\n      {...props}\n    >\n      {icon ? (\n        <span className=\"status-pill__icon\" aria-hidden=\"true\">\n          {icon}\n        </span>\n      ) : null}\n      <span className=\"status-pill__label\">{children}</span>\n    </Component>\n  );\n}\n\n\n","import { useEffect, useMemo, useState } from \"react\";\nimport { Link, useNavigate } from \"react-router-dom\";\nimport { getStudentDashboard } from \"../lib/api.js\";\nimport { useSession } from \"../hooks/useSession.js\";\nimport { useCurriculumManifest } from \"../hooks/useCurriculumManifest.js\";\nimport { useGamification } from \"../context/GamificationContext.jsx\";\nimport { readUnitProgress, writeUnitProgress } from \"../lib/progressStorage.js\";\nimport b1Unit from \"../content/b1ComputationalThinking.jsx\";\nimport b2Unit from \"../content/b2ProgrammingFundamentals.jsx\";\nimport {\n  YEAR7_CURRICULUM,\n  getYear7LessonById,\n  getYear7LessonIndex,\n} from \"../../../shared/liveDecks.js\";\nimport ContentContainer from \"../components/ui/ContentContainer.jsx\";\nimport ProgressBar from \"../components/ui/ProgressBar.jsx\";\nimport StatusPill from \"../components/ui/StatusPill.jsx\";\nimport StatusBanner from \"../components/ui/StatusBanner.jsx\";\n\nimport \"./StudentDashboardPage.css\";\n\nfunction normaliseStatus(status) {\n  if (!status) return \"locked\";\n  return status.toLowerCase();\n}\n\nfunction isLessonComplete(status) {\n  const value = normaliseStatus(status);\n  return value === \"formative-complete\" || value === \"summative-complete\";\n}\n\nfunction progressLabel(status) {\n  switch (normaliseStatus(status)) {\n    case \"summative-complete\":\n      return \"Summative complete\";\n    case \"formative-complete\":\n      return \"Formative complete\";\n    case \"available\":\n      return \"Ready to start\";\n    default:\n      return \"Locked\";\n  }\n}\n\nfunction progressTone(status) {\n  switch (normaliseStatus(status)) {\n    case \"summative-complete\":\n    case \"formative-complete\":\n      return \"success\";\n    case \"available\":\n      return \"info\";\n    case \"locked\":\n      return \"muted\";\n    default:\n      return \"neutral\";\n  }\n}\n\nfunction buildAttemptRows(unit, insights) {\n  if (!insights?.attempts) return [];\n  const rows = [];\n  const attempts = insights.attempts;\n  unit.stages.forEach((stage) => {\n    (stage.segments ?? []).forEach((segment) => {\n      if ([\"activity\", \"micro-quiz\", \"python-playground\"].includes(segment.type)) {\n        const stats = attempts?.[segment.id];\n        if (!stats) return;\n        const count = stats.count ?? 0;\n        const correct = stats.correct ?? 0;\n        rows.push({\n          stage: stage.title,\n          segment: segment.heading ?? segment.title ?? segment.id,\n          attempts: count,\n          correct,\n          successRate: count > 0 ? Math.round((correct / count) * 100) : null,\n        });\n      }\n    });\n  });\n  rows.sort((a, b) => b.attempts - a.attempts);\n  return rows;\n}\n\nfunction describeTrack(track) {\n  const value = (track || \"\").toLowerCase();\n  if (value.startsWith(\"ib\")) {\n    return \"IB Computer Science\";\n  }\n  if (value === \"igcse\") {\n    return \"IGCSE Computer Science\";\n  }\n  if (value.startsWith(\"ks3\")) {\n    return \"Key Stage 3 Computer Science\";\n  }\n  return \"Curriculum\";\n}\n\nfunction createUnitSummaries(manifest, lessonStatusMap, track) {\n  if (!manifest) return [];\n  const units = manifest.units ?? [];\n  return units\n    .filter((unit) => !unit.availableFor || unit.availableFor.includes(track))\n    .map((unit) => {\n      const chapters = unit.subtopics ?? [];\n      const lessons = [];\n      chapters.forEach((chapter) => {\n        (chapter.lessons ?? [])\n          .filter((lesson) => !lesson.availableFor || lesson.availableFor.includes(track))\n          .forEach((lesson) => {\n            lessons.push({\n              id: lesson.id,\n              title: lesson.title,\n              unitId: unit.id,\n              chapterTitle: chapter.title,\n              status: lessonStatusMap.get(lesson.id) ?? \"locked\",\n            });\n          });\n      });\n      const total = lessons.length || 1;\n      const completed = lessons.filter((lesson) => isLessonComplete(lesson.status)).length;\n      const unlocked = lessons.filter((lesson) => lesson.status !== \"locked\").length;\n      const inProgress = Math.max(unlocked - completed, 0);\n      const locked = Math.max(total - unlocked, 0);\n      const percentage = Math.round((completed / total) * 100);\n      const nextLesson = lessons.find((lesson) => !isLessonComplete(lesson.status));\n      return {\n        id: unit.id,\n        title: unit.title,\n        description: unit.summary,\n        completedCount: completed,\n        unlockedCount: unlocked,\n        inProgressCount: inProgress,\n        lockedCount: locked,\n        totalCount: total,\n        percentage,\n        lessons,\n        nextLesson,\n      };\n    });\n}\n\nfunction createRecentUpdates(progress) {\n  const sorted = [...progress].sort((a, b) => {\n    const aTime = a?.updatedAt ? new Date(a.updatedAt).getTime() : 0;\n    const bTime = b?.updatedAt ? new Date(b.updatedAt).getTime() : 0;\n    return bTime - aTime;\n  });\n  return sorted.slice(0, 6).map((record, index) => ({\n    ...record,\n    id: record.id ?? `${record.lessonSlug ?? \"lesson\"}-${index}`,\n  }));\n}\n\nfunction StudentDashboardLayout({\n  studentName,\n  track,\n  trackDisplayName,\n  curriculumLink,\n  curriculumCtaLabel,\n  overallPercentage,\n  totalCompleted,\n  totalLessons,\n  classInfo,\n  activeStage,\n  pointerLesson,\n  pointerUpdatedAt,\n  pointerHeadline,\n  pointerCta,\n  gamification,\n  unitSummaries,\n  interactiveAttemptSections,\n  recentUpdates,\n  status,\n  isIBTrack,\n}) {\n  const [selectedUnitId, setSelectedUnitId] = useState(() => unitSummaries[0]?.id ?? null);\n  const [activeInsightId, setActiveInsightId] = useState(() => interactiveAttemptSections[0]?.id ?? null);\n\n  useEffect(() => {\n    if (unitSummaries.length === 0) {\n      setSelectedUnitId(null);\n      return;\n    }\n    setSelectedUnitId((prev) => {\n      if (prev && unitSummaries.some((unit) => unit.id === prev)) {\n        return prev;\n      }\n      return unitSummaries[0].id;\n    });\n  }, [unitSummaries]);\n\n  useEffect(() => {\n    if (interactiveAttemptSections.length === 0) {\n      setActiveInsightId(null);\n      return;\n    }\n    setActiveInsightId((prev) => {\n      if (prev && interactiveAttemptSections.some((section) => section.id === prev)) {\n        return prev;\n      }\n      return interactiveAttemptSections[0].id;\n    });\n  }, [interactiveAttemptSections]);\n\n  const selectedUnit = useMemo(() => {\n    if (unitSummaries.length === 0) return null;\n    return unitSummaries.find((unit) => unit.id === selectedUnitId) ?? unitSummaries[0];\n  }, [unitSummaries, selectedUnitId]);\n\n  const breakdown = useMemo(() => {\n    if (!selectedUnit) return [];\n    return [\n      { id: \"complete\", label: \"Complete\", value: selectedUnit.completedCount },\n      { id: \"progress\", label: \"In progress\", value: selectedUnit.inProgressCount },\n      { id: \"locked\", label: \"Locked\", value: selectedUnit.lockedCount },\n    ];\n  }, [selectedUnit]);\n\n  const breakdownTotal = breakdown.reduce((sum, item) => sum + item.value, 0);\n\n  const activeInsight = useMemo(() => {\n    if (interactiveAttemptSections.length === 0) return null;\n    return interactiveAttemptSections.find((section) => section.id === activeInsightId) ?? interactiveAttemptSections[0];\n  }, [interactiveAttemptSections, activeInsightId]);\n\n  const focusSegments = useMemo(() => {\n    if (!activeInsight?.rows?.length) return [];\n    const sorted = [...activeInsight.rows].sort((a, b) => {\n      const aRate = a.successRate ?? 0;\n      const bRate = b.successRate ?? 0;\n      return aRate - bRate;\n    });\n    return sorted.slice(0, 3);\n  }, [activeInsight]);\n\n  const nextLesson = selectedUnit?.nextLesson ?? null;\n  const nextLessonIsUnlocked = nextLesson && nextLesson.status !== \"locked\";\n\n  const gamificationLevel = typeof gamification?.level === \"number\" ? gamification.level : null;\n  const gamificationXp = typeof gamification?.xp === \"number\" ? gamification.xp : null;\n  const gamificationStreak = typeof gamification?.streak === \"number\" ? gamification.streak : null;\n  const xpToNextLevel = useMemo(() => {\n    if (!Number.isFinite(gamificationXp)) return null;\n    const base = Math.floor(gamificationXp / 150) * 150;\n    const nextThreshold = base + 150;\n    const remaining = nextThreshold - gamificationXp;\n    return Math.max(remaining, 0);\n  }, [gamificationXp]);\n  const computedAccuracy = useMemo(() => {\n    if (typeof gamification?.accuracy === \"number\") return gamification.accuracy;\n    if (typeof gamification?.totalAttempts === \"number\" && gamification.totalAttempts > 0 && typeof gamification?.totalCorrect === \"number\") {\n      return Math.round((gamification.totalCorrect / gamification.totalAttempts) * 100);\n    }\n    return null;\n  }, [gamification?.accuracy, gamification?.totalAttempts, gamification?.totalCorrect]);\n\n  const levelMessage = gamificationLevel != null ? `Lv ${gamificationLevel + 1} unlocks new rewards` : \"Clear your first activity to begin levelling\";\n  const xpMessage = gamificationXp != null ? `${xpToNextLevel ?? 150} XP until the next rank` : \"Complete activities to earn XP\";\n  const streakMessage = gamificationStreak != null && gamificationStreak > 0 ? `${gamificationStreak} in a rowâ€”keep it going!` : \"Pass activities on the first try to build a streak\";\n  const attemptsLogged = gamification?.totalAttempts ?? 0;\n  const accuracyMessage = computedAccuracy != null ? `${attemptsLogged} attempts logged` : \"Your accuracy will appear once you start practicing\";\n\n  return (\n    <ContentContainer variant=\"fullWidth\" className=\"student-dashboard\">\n      <section className=\"student-dashboard__hero\">\n        <div className=\"student-dashboard__hero-left\">\n          <span className=\"student-dashboard__eyebrow\">Student dashboard</span>\n          <h1>Hi {studentName}</h1>\n          <p className=\"muted\">\n            Your progress through the {trackDisplayName} pathway lives here. Lessons unlock as your teacher enables\n            themâ€”use this page to see what to tackle next.\n          </p>\n\n          <div className=\"student-dashboard__meta-grid\">\n            <div className=\"student-dashboard__meta-card\">\n              <span>Track</span>\n              <strong>{track.toUpperCase()}</strong>\n            </div>\n            <div className=\"student-dashboard__meta-card\">\n              <span>Active stage</span>\n              <strong>{activeStage ?? \"Pending\"}</strong>\n            </div>\n            <div className=\"student-dashboard__meta-card\">\n              <span>Overall progress</span>\n              <strong>{overallPercentage}%</strong>\n            </div>\n          </div>\n\n          <div className=\"student-dashboard__class-card\">\n            <div>\n              <span className=\"student-dashboard__class-eyebrow\">Your class</span>\n              <strong>{classInfo ? classInfo.className : \"Awaiting placement\"}</strong>\n              <p className=\"muted\">\n                {classInfo\n                  ? classInfo.description || classInfo.yearGroup || \"Connected to your class\"\n                  : \"Your teacher will place you into a class soon.\"}\n              </p>\n              {(pointerLesson || pointerCta) && (\n                <div className=\"student-dashboard__pointer\">\n                  <span>Live lesson</span>\n                  <strong>{pointerHeadline ?? \"Your teacher will start the next lesson soon\"}</strong>\n                  {pointerUpdatedAt && <small>Updated {pointerUpdatedAt}</small>}\n                </div>\n              )}\n            </div>\n            {classInfo && (\n              <div className=\"student-dashboard__class-meta\">\n                <span>Teacher Â· {classInfo.teacherUsername ?? \"Assigned\"}</span>\n                {classInfo.yearGroup && <span>Year group Â· {classInfo.yearGroup}</span>}\n                <span>Class code Â· {classInfo.id}</span>\n              </div>\n            )}\n          </div>\n\n          <div className=\"student-dashboard__hero-actions\">\n            <Link to={curriculumLink} className=\"pill\">\n              {curriculumCtaLabel}\n            </Link>\n            {pointerCta && (\n              <Link to={pointerCta.link} className=\"pill pill--action pill--live\">\n                {pointerCta.label}\n              </Link>\n            )}\n          </div>\n        </div>\n\n        <div className=\"student-dashboard__summary\">\n          <CircularProgress\n            value={overallPercentage}\n            label=\"overall progress\"\n            caption={`${totalCompleted}/${totalLessons} lessons`}\n          />\n          <div className=\"student-dashboard__stat-grid\">\n            <div className=\"student-dashboard__stat-card student-dashboard__stat-card--level\">\n              <span>Level</span>\n              <strong>{gamificationLevel != null ? `Lv ${gamificationLevel}` : \"â€”\"}</strong>\n              <small>{levelMessage}</small>\n            </div>\n            <div className=\"student-dashboard__stat-card student-dashboard__stat-card--xp\">\n              <span>XP</span>\n              <strong>{gamificationXp != null ? gamificationXp : \"â€”\"}</strong>\n              <small>{xpMessage}</small>\n            </div>\n            <div className=\"student-dashboard__stat-card student-dashboard__stat-card--streak\">\n              <span>Streak</span>\n              <strong>{gamificationStreak != null ? gamificationStreak : \"â€”\"}</strong>\n              <small>{streakMessage}</small>\n            </div>\n            <div className=\"student-dashboard__stat-card student-dashboard__stat-card--accuracy\">\n              <span>Accuracy</span>\n              <strong>{computedAccuracy != null ? `${computedAccuracy}%` : \"â€”\"}</strong>\n              <small>{accuracyMessage}</small>\n            </div>\n          </div>\n        </div>\n      </section>\n\n      <section className=\"student-dashboard__view\">\n        <div className=\"student-dashboard__unit-column\">\n          <header>\n            <h2>{trackDisplayName} units</h2>\n            <p className=\"muted\">Select a unit to explore detailed progress.</p>\n          </header>\n          <div className=\"student-dashboard__unit-list\">\n            {unitSummaries.map((unit) => (\n              <button\n                key={unit.id}\n                type=\"button\"\n                className={`student-dashboard__unit-button ${selectedUnit?.id === unit.id ? \"is-active\" : \"\"}`}\n                onClick={() => setSelectedUnitId(unit.id)}\n              >\n                <div>\n                  <strong>{unit.title}</strong>\n                  {unit.description && <span>{unit.description}</span>}\n                </div>\n                <div className=\"student-dashboard__mini-summary\">\n                  <span>{unit.percentage}%</span>\n                  <ProgressBar\n                    className=\"student-dashboard__mini-bar\"\n                    value={Math.max(0, unit.percentage)}\n                    max={100}\n                    tone=\"brand\"\n                    size=\"xs\"\n                    ariaLabel={`${unit.title} completion`}\n                  />\n                  <small>\n                    {unit.completedCount} / {unit.totalCount} lessons\n                  </small>\n                </div>\n              </button>\n            ))}\n            {unitSummaries.length === 0 && (\n              <p className=\"student-dashboard__empty muted\">\n                Units will appear once your teacher shares the curriculum with your class.\n              </p>\n            )}\n          </div>\n        </div>\n\n        <div className=\"student-dashboard__detail-panel\">\n          {selectedUnit ? (\n            <>\n              <header className=\"student-dashboard__unit-header\">\n                <div>\n                  <span className=\"student-dashboard__eyebrow\">Selected unit</span>\n                  <h2>{selectedUnit.title}</h2>\n                  {selectedUnit.description && <p className=\"muted\">{selectedUnit.description}</p>}\n                </div>\n                <div className=\"student-dashboard__unit-score\">\n                  <strong>{selectedUnit.percentage}%</strong>\n                  <span>complete</span>\n                  <small>\n                    {selectedUnit.completedCount} of {selectedUnit.totalCount} lessons\n                  </small>\n                </div>\n              </header>\n\n              <div className=\"student-dashboard__unit-breakdown\">\n                <div className=\"student-dashboard__stack-bar\" role=\"presentation\">\n                  {breakdown\n                    .filter((item) => item.value > 0 && breakdownTotal > 0)\n                    .map((item) => (\n                      <div\n                        key={item.id}\n                        className={`student-dashboard__stack-bar-segment student-dashboard__stack-bar-segment--${item.id}`}\n                        style={{ \"--segment-percent\": `${Math.max(0, Math.min(100, (item.value / breakdownTotal) * 100))}%` }}\n                        aria-label={`${item.label}: ${item.value}`}\n                      />\n                    ))}\n                </div>\n                <div className=\"student-dashboard__unit-counters\">\n                  <span>{selectedUnit.completedCount} complete</span>\n                  <span>{selectedUnit.inProgressCount} in progress</span>\n                  <span>{selectedUnit.lockedCount} locked</span>\n                </div>\n              </div>\n\n              <div className=\"student-dashboard__unit-actions\">\n                <Link\n                  to={\n                    isIBTrack\n                      ? { pathname: \"/curriculum/ib\", state: { focusUnit: selectedUnit.id } }\n                      : curriculumLink\n                  }\n                  className=\"pill\"\n                >\n                  View unit map\n                </Link>\n                {nextLesson && (\n                  nextLessonIsUnlocked ? (\n                    <Link to={`/lesson/${nextLesson.id}`} className=\"pill pill--action\">\n                      Resume {nextLesson.title}\n                    </Link>\n                  ) : (\n                    <span className=\"student-dashboard__hint\">\n                      Next lesson ({nextLesson.title}) unlocks soon.\n                    </span>\n                  )\n                )}\n              </div>\n\n              <div className=\"student-dashboard__lesson-list\">\n                <div className=\"student-dashboard__list-header\">\n                  <h3>Lesson timeline</h3>\n                  <span className=\"muted\">\n                    Ordered sequence Â· first {Math.min(selectedUnit.lessons.length, 6)} shown\n                  </span>\n                </div>\n                <ul className=\"student-dashboard__lesson-items\">\n                  {selectedUnit.lessons.slice(0, 6).map((lesson) => {\n                    const lessonLink = resolveLessonLink(track, selectedUnit, lesson, classInfo);\n                    const actionLabel = lesson.status === \"formative-complete\" ? \"Review\" : \"Open lesson\";\n                    return (\n                      <li key={lesson.id}>\n                        <div className=\"student-dashboard__lesson-info\">\n                          <strong>{lesson.title}</strong>\n                          {lesson.chapterTitle && <span className=\"muted\">{lesson.chapterTitle}</span>}\n                        </div>\n                        <div className=\"student-dashboard__lesson-actions\">\n                          <StatusPill tone={progressTone(lesson.status)} size=\"sm\">\n                            {progressLabel(lesson.status)}\n                          </StatusPill>\n                          {lessonLink && lesson.status !== \"locked\" && (\n                            <Link to={lessonLink} className=\"pill pill--ghost\">\n                              {actionLabel}\n                            </Link>\n                          )}\n                        </div>\n                      </li>\n                    );\n                  })}\n                  {selectedUnit.lessons.length === 0 && (\n                    <li className=\"muted\">Lessons will appear once unlocked.</li>\n                  )}\n                </ul>\n              </div>\n\n              <div className=\"student-dashboard__insights\">\n                <div className=\"student-dashboard__insight-panel\">\n                  <div className=\"student-dashboard__insight-header\">\n                    <h3>Checkpoint insights</h3>\n                    <div className=\"student-dashboard__tabs\" role=\"tablist\">\n                      {interactiveAttemptSections.map((section) => (\n                        <button\n                          key={section.id}\n                          type=\"button\"\n                          role=\"tab\"\n                          aria-selected={activeInsight?.id === section.id}\n                          className={`student-dashboard__tab ${activeInsight?.id === section.id ? \"is-active\" : \"\"}`}\n                          onClick={() => setActiveInsightId(section.id)}\n                        >\n                          {section.id}\n                        </button>\n                      ))}\n                    </div>\n                  </div>\n\n                  {activeInsight && activeInsight.rows.length > 0 ? (\n                    <>\n                      <div className=\"student-dashboard__focus\">\n                        <span className=\"muted\">Segments to revisit</span>\n                        <ul>\n                          {focusSegments.map((row, index) => (\n                            <li key={`${row.segment}-${index}`}>\n                              <strong>{row.segment}</strong>\n                              <span>{row.successRate != null ? `${row.successRate}%` : \"â€”\"} success</span>\n                            </li>\n                          ))}\n                        </ul>\n                      </div>\n                      <div className=\"student-dashboard__insight-scroll\">\n                        <table>\n                          <thead>\n                            <tr>\n                              <th>Stage</th>\n                              <th>Activity</th>\n                              <th>Attempts</th>\n                              <th>Correct</th>\n                              <th>Success</th>\n                            </tr>\n                          </thead>\n                          <tbody>\n                            {activeInsight.rows.slice(0, 12).map((row, index) => (\n                              <tr key={`${activeInsight.id}-${row.segment}-${index}`}>\n                                <td>{row.stage}</td>\n                                <td>{row.segment}</td>\n                                <td>{row.attempts}</td>\n                                <td>{row.correct}</td>\n                                <td>{row.successRate != null ? `${row.successRate}%` : \"â€”\"}</td>\n                              </tr>\n                            ))}\n                          </tbody>\n                        </table>\n                      </div>\n                    </>\n                  ) : (\n                    <p className=\"student-dashboard__empty muted\">\n                      Complete interactive checkpoints to unlock insights.\n                    </p>\n                  )}\n                </div>\n\n                <div className=\"student-dashboard__timeline\">\n                  <div className=\"student-dashboard__list-header\">\n                    <h3>Recent updates</h3>\n                    <span className=\"muted\">Latest lessons Â· most recent first</span>\n                  </div>\n                  <ul>\n                    {recentUpdates.length === 0 && (\n                      <li className=\"muted\">No lessons tracked yet â€” start with your first unlocked topic.</li>\n                    )}\n                    {recentUpdates.map((record) => (\n                      <li key={record.id}>\n                        <div>\n                          <strong>{record.lessonSlug}</strong>\n                          <StatusPill tone={progressTone(record.status)} size=\"sm\">\n                            {progressLabel(record.status)}\n                          </StatusPill>\n                        </div>\n                        <span className=\"muted\">\n                          Updated {record.updatedAt ? new Date(record.updatedAt).toLocaleString() : \"recently\"}\n                        </span>\n                      </li>\n                    ))}\n                  </ul>\n                </div>\n              </div>\n            </>\n          ) : (\n            <div className=\"student-dashboard__empty-panel\">\n              <h2>No unit selected yet</h2>\n              <p className=\"muted\">Once your teacher unlocks lessons, you will see progress here.</p>\n            </div>\n          )}\n        </div>\n      </section>\n\n      {status && <StatusBanner tone=\"info\">{status}</StatusBanner>}\n    </ContentContainer>\n  );\n}\n\nfunction CircularProgress({ value, size = 148, strokeWidth = 12, label, caption }) {\n  const numericValue = Number.isFinite(value) ? value : 0;\n  const clamped = Math.max(0, Math.min(100, Math.round(numericValue)));\n  const radius = (size - strokeWidth) / 2;\n  const circumference = 2 * Math.PI * radius;\n  const dashOffset = circumference - (clamped / 100) * circumference;\n\n  return (\n    <div className=\"circular-progress\" style={{ \"--progress-size\": `${size}px`, \"--progress-stroke\": strokeWidth }}>\n      <svg className=\"circular-progress__svg\" width={size} height={size} viewBox={`0 0 ${size} ${size}`}>\n        <circle\n          className=\"circular-progress__track\"\n          cx={size / 2}\n          cy={size / 2}\n          r={radius}\n          strokeWidth={strokeWidth}\n          fill=\"none\"\n        />\n        <circle\n          className=\"circular-progress__indicator\"\n          cx={size / 2}\n          cy={size / 2}\n          r={radius}\n          strokeWidth={strokeWidth}\n          strokeDasharray={circumference}\n          strokeDashoffset={dashOffset}\n          fill=\"none\"\n          stroke=\"var(--color-primary-800)\"\n          strokeLinecap=\"round\"\n        />\n      </svg>\n      <div className=\"circular-progress__label\">\n        <strong>{clamped}%</strong>\n        {label && <span>{label}</span>}\n        {caption && <small>{caption}</small>}\n      </div>\n    </div>\n  );\n}\n\nfunction StudentDashboardPage() {\n  const { session, ready } = useSession();\n  const navigate = useNavigate();\n  const token = session?.token ?? null;\n  const studentSession = session?.user?.role === \"student\" ? session.user : null;\n  const { updateFromRemote } = useGamification();\n\n  const [dashboardData, setDashboardData] = useState(null);\n  const [localUnitProgress, setLocalUnitProgress] = useState({});\n  const [error, setError] = useState(null);\n  \n  useEffect(() => {\n    if (!ready) return;\n    if (!studentSession) {\n      navigate(\"/\", { replace: true });\n      return;\n    }\n    if (!token) return;\n\n    let active = true;\n    let intervalId;\n\n    const loadDashboard = async () => {\n      try {\n        const response = await getStudentDashboard(token);\n        if (!active) return;\n\n        setDashboardData(response);\n\n        const backendGamification = response?.gamification;\n        if (backendGamification) {\n          updateFromRemote(backendGamification);\n        }\n\n        const studentProgress = response?.progress ?? [];\n        const progressMap = new Map();\n        studentProgress.forEach((p) => {\n          if (p.unitId && p.progress) {\n            progressMap.set(p.unitId, p.progress);\n          }\n        });\n\n        const progressOwner = studentSession?.username?.toLowerCase() || \"guest\";\n\n        if (progressMap.has(b1Unit.id)) {\n          writeUnitProgress(b1Unit.id, progressOwner, progressMap.get(b1Unit.id));\n        }\n        if (progressMap.has(b2Unit.id)) {\n          writeUnitProgress(b2Unit.id, progressOwner, progressMap.get(b2Unit.id));\n        }\n\n        setError(null);\n      } catch (error) {\n        if (!active) return;\n        setError(error.message || \"Unable to load dashboard\");\n      }\n    };\n\n    setError(null);\n    loadDashboard();\n    const createInterval = typeof window !== \"undefined\" ? window.setInterval : setInterval;\n    const clearIntervalFn = typeof window !== \"undefined\" ? window.clearInterval : clearInterval;\n    intervalId = createInterval(loadDashboard, 5000);\n\n    return () => {\n      active = false;\n      if (intervalId) {\n        clearIntervalFn(intervalId);\n      }\n    };\n  }, [ready, studentSession, token, navigate, updateFromRemote]);\n\n  useEffect(() => {\n    if (!studentSession?.username) return;\n    if (typeof window === \"undefined\") return;\n\n    const profileKey = studentSession.username.toLowerCase();\n    const next = {};\n    [b1Unit, b2Unit].forEach((unit) => {\n      if (!unit?.id) return;\n      const { data } = readUnitProgress(unit.id, profileKey);\n      if (data && typeof data === \"object\") {\n        next[unit.id] = data;\n      }\n    });\n    setLocalUnitProgress(next);\n  }, [studentSession?.username]);\n\n  if (error && !dashboardData) {\n    return (\n      <ContentContainer variant=\"fullWidth\" className=\"student-dashboard\">\n        <StatusBanner tone=\"danger\">{error}</StatusBanner>\n      </ContentContainer>\n    );\n  }\n\n  if (!dashboardData) {\n    return (\n      <ContentContainer variant=\"fullWidth\" className=\"student-dashboard\">\n        Loading...\n      </ContentContainer>\n    );\n  }\n\n  return <StudentDashboardRenderer data={dashboardData} localProgress={localUnitProgress} />;\n}\n\nfunction StudentDashboardRenderer({ data, localProgress }) {\n  const { state: gamificationState } = useGamification();\n  const { manifest } = useCurriculumManifest();\n\n  const student = data?.student ?? {};\n  const classInfo = data?.class ?? null;\n  const classPacing = data?.classPacing ?? null;\n  const trackRaw = student.curriculumTrack ?? \"ib-sl\";\n  const track = trackRaw.toLowerCase();\n\n  const lessonStatusMap = useMemo(\n    () => buildLessonStatusMap(data?.unlocks ?? [], data?.progress ?? []),\n    [data?.unlocks, data?.progress],\n  );\n\n  const unitSummaries = useMemo(() => {\n    if (track.startsWith(\"ks3\")) {\n      const pointerLessonId = classPacing?.lessonId ?? null;\n      return createYear7Summaries(pointerLessonId);\n    }\n    return createUnitSummaries(manifest, lessonStatusMap, track);\n  }, [track, classPacing?.lessonId, manifest, lessonStatusMap]);\n\n  const totals = useMemo(() => computeOverallTotals(unitSummaries), [unitSummaries]);\n\n  const pointerLesson = useMemo(() => {\n    if (!track.startsWith(\"ks3\")) return null;\n    if (!classPacing?.lessonId) return null;\n    return getYear7LessonById(classPacing.lessonId);\n  }, [track, classPacing?.lessonId]);\n\n  const pointerUpdatedAt = useMemo(() => {\n    if (!track.startsWith(\"ks3\")) return null;\n    return formatTimestamp(classPacing?.updatedAt);\n  }, [track, classPacing?.updatedAt]);\n\n  const pointerHeadline = useMemo(() => {\n    if (pointerLesson) {\n      return `${pointerLesson.unitTitle}: ${pointerLesson.title}`;\n    }\n    if (classPacing?.lessonId) {\n      return classPacing.lessonId;\n    }\n    if (classPacing?.unitId) {\n      return classPacing.unitId;\n    }\n    return null;\n  }, [pointerLesson, classPacing?.lessonId, classPacing?.unitId]);\n\n  const pointerCta = useMemo(\n    () => resolvePointerAction(track, pointerLesson, classPacing, classInfo),\n    [track, pointerLesson, classPacing, classInfo],\n  );\n\n  const curriculumCta = useMemo(() => createCurriculumLink(track, classInfo), [track, classInfo]);\n\n  const interactiveAttemptSections = useMemo(\n    () => buildInteractiveSections(track, localProgress),\n    [track, localProgress],\n  );\n\n  const recentUpdates = useMemo(() => createRecentUpdates(data?.progress ?? []), [data?.progress]);\n\n  const gamification = useMemo(\n    () => ({ ...gamificationState, ...(data?.gamification ?? {}) }),\n    [gamificationState, data?.gamification],\n  );\n\n  const studentName = useMemo(() => {\n    if (student.displayName) return student.displayName;\n    const fallback = [student.firstName, student.lastName].filter(Boolean).join(\" \");\n    if (fallback.trim()) return fallback.trim();\n    if (student.username) return student.username;\n    return \"Student\";\n  }, [student.displayName, student.firstName, student.lastName, student.username]);\n\n  return (\n    <StudentDashboardLayout\n      studentName={studentName}\n      track={track}\n      trackDisplayName={describeTrack(trackRaw)}\n      curriculumLink={curriculumCta.link}\n      curriculumCtaLabel={curriculumCta.label}\n      overallPercentage={totals.overallPercentage}\n      totalCompleted={totals.totalCompleted}\n      totalLessons={totals.totalLessons}\n      classInfo={classInfo}\n      activeStage={student.activeStage ?? null}\n      pointerLesson={pointerLesson}\n      pointerUpdatedAt={pointerUpdatedAt}\n      pointerHeadline={pointerHeadline}\n      pointerCta={pointerCta}\n      gamification={gamification}\n      unitSummaries={unitSummaries}\n      interactiveAttemptSections={interactiveAttemptSections}\n      recentUpdates={recentUpdates}\n      status={data?.status ?? null}\n      isIBTrack={track.startsWith(\"ib\")}\n    />\n  );\n}\n\nfunction buildLessonStatusMap(unlocks = [], progress = []) {\n  const map = new Map();\n\n  (progress ?? []).forEach((record) => {\n    if (!record?.lessonSlug) return;\n    map.set(record.lessonSlug, record.status ?? \"locked\");\n  });\n\n  (unlocks ?? []).forEach((unlock) => {\n    if (unlock?.scope !== \"lesson\") return;\n    if (!unlock?.stageKey) return;\n    const existing = map.get(unlock.stageKey);\n    if (!existing || existing === \"locked\") {\n      map.set(unlock.stageKey, \"available\");\n    }\n  });\n\n  return map;\n}\n\nfunction createYear7Summaries(pointerLessonId) {\n  const pointerIndex = pointerLessonId ? getYear7LessonIndex(pointerLessonId) : -1;\n\n  return YEAR7_CURRICULUM.map((unit) => {\n    const lessons = unit.lessons.map((lesson) => {\n      const lessonIndex = getYear7LessonIndex(lesson.id);\n      let status = \"locked\";\n\n      if (pointerIndex === -1) {\n        status = lessonIndex === 0 ? \"available\" : \"locked\";\n      } else if (lessonIndex < pointerIndex) {\n        status = \"formative-complete\";\n      } else if (lessonIndex === pointerIndex) {\n        status = \"available\";\n      }\n\n      return {\n        ...lesson,\n        unitId: unit.id,\n        chapterTitle: null,\n        status,\n      };\n    });\n\n    const totalCount = lessons.length;\n    const completedCount = lessons.filter((lesson) => isLessonComplete(lesson.status)).length;\n    const unlockedCount = lessons.filter((lesson) => lesson.status !== \"locked\").length;\n    const inProgressCount = Math.max(unlockedCount - completedCount, 0);\n    const lockedCount = Math.max(totalCount - unlockedCount, 0);\n    const percentage = totalCount > 0 ? Math.round((completedCount / totalCount) * 100) : 0;\n    const nextLesson =\n      lessons.find((lesson) => lesson.status === \"available\") ??\n      lessons.find((lesson) => lesson.status === \"formative-complete\") ??\n      lessons[0] ?? null;\n\n    return {\n      id: unit.id,\n      title: unit.title,\n      description: unit.summary,\n      lessons,\n      completedCount,\n      unlockedCount,\n      inProgressCount,\n      lockedCount,\n      totalCount,\n      percentage,\n      nextLesson,\n    };\n  });\n}\n\nfunction computeOverallTotals(units = []) {\n  const totals = units.reduce(\n    (acc, unit) => {\n      const total = unit.totalCount ?? unit.lessons?.length ?? 0;\n      const completed = unit.completedCount ?? 0;\n      return {\n        totalLessons: acc.totalLessons + total,\n        totalCompleted: acc.totalCompleted + completed,\n      };\n    },\n    { totalLessons: 0, totalCompleted: 0 },\n  );\n\n  const overallPercentage = totals.totalLessons > 0\n    ? Math.round((totals.totalCompleted / totals.totalLessons) * 100)\n    : 0;\n\n  return { ...totals, overallPercentage };\n}\n\nfunction formatTimestamp(value) {\n  if (!value) return null;\n  const timestamp = new Date(value);\n  if (Number.isNaN(timestamp.getTime())) return null;\n  return timestamp.toLocaleString();\n}\n\nfunction createCurriculumLink(track, classInfo) {\n  if (track.startsWith(\"ks3\")) {\n    if (classInfo?.id) {\n      return {\n        link: { pathname: \"/curriculum/year7\", state: { classId: classInfo.id } },\n        label: \"Open Year 7 map\",\n      };\n    }\n    return { link: \"/curriculum/year7\", label: \"Explore Year 7 map\" };\n  }\n\n  if (track === \"igcse\") {\n    if (classInfo?.id) {\n      return {\n        link: { pathname: \"/curriculum/igcse\", state: { classId: classInfo.id } },\n        label: \"Open IGCSE map\",\n      };\n    }\n    return { link: \"/curriculum/igcse\", label: \"Explore IGCSE map\" };\n  }\n\n  return { link: \"/curriculum/ib\", label: \"Browse IB curriculum\" };\n}\n\nfunction resolvePointerAction(track, pointerLesson, classPacing, classInfo) {\n  if (track.startsWith(\"ks3\")) {\n    if (!pointerLesson) return null;\n    const state = {};\n    if (classInfo?.id) state.classId = classInfo.id;\n\n    const mapState = {\n      ...state,\n      ...(pointerLesson.unitId ? { focusUnit: pointerLesson.unitId } : {}),\n    };\n    const hasMapState = Object.keys(mapState).length > 0;\n    return {\n      link: {\n        pathname: \"/curriculum/year7\",\n        ...(hasMapState ? { state: mapState } : {}),\n      },\n      label: `View ${pointerLesson.title}`,\n    };\n  }\n\n  if (track.startsWith(\"ib\")) {\n    if (!classPacing?.unitId) return null;\n    const unitSlug = String(classPacing.unitId).toLowerCase();\n    const link = { pathname: `/curriculum/ib/${unitSlug}` };\n    if (classPacing.lessonId) {\n      link.state = { focusStage: classPacing.lessonId };\n    }\n    return {\n      link,\n      label: \"Join live lesson\",\n    };\n  }\n\n  if (track === \"igcse\") {\n    return {\n      link: { pathname: \"/curriculum/igcse\" },\n      label: \"View IGCSE roadmap\",\n    };\n  }\n\n  return null;\n}\n\nfunction resolveLessonLink(track, unit, lesson, classInfo) {\n  if (!lesson || lesson.status === \"locked\") return null;\n\n  if (track.startsWith(\"ks3\")) {\n    const baseState = {};\n    if (classInfo?.id) baseState.classId = classInfo.id;\n\n    const mapState = {\n      ...baseState,\n      ...(lesson.unitId ? { focusUnit: lesson.unitId } : {}),\n    };\n    if (!mapState.focusUnit && unit?.id) {\n      mapState.focusUnit = unit.id;\n    }\n    const hasMapState = Object.keys(mapState).length > 0;\n\n    return {\n      pathname: \"/curriculum/year7\",\n      ...(hasMapState ? { state: mapState } : {}),\n    };\n  }\n\n  if (!lesson.id) return null;\n  return `/lesson/${lesson.id}`;\n}\n\nfunction buildInteractiveSections(track, localProgress) {\n  const sequence = [];\n  if (track.startsWith(\"ks3\")) {\n    // KS3 interactive content rebuilt via teacher-paced decks; placeholder until new deck integration\n  }\n  sequence.push(b1Unit, b2Unit);\n\n  const seen = new Set();\n  return sequence\n    .filter((unit) => unit && !seen.has(unit.id) && seen.add(unit.id))\n    .map((unit) => {\n      const insights = localProgress?.[unit.id] ?? null;\n      return {\n        id: unit.title,\n        rows: buildAttemptRows(unit, insights),\n      };\n    })\n    .filter((section) => section.rows.length > 0);\n}\n\nexport default StudentDashboardPage;\nexport {\n  StudentDashboardLayout,\n  createUnitSummaries,\n  createRecentUpdates,\n  normaliseStatus,\n  progressLabel,\n  isLessonComplete,\n  buildAttemptRows,\n  describeTrack,\n};\n","import { useEffect, useMemo, useState } from \"react\";\nimport { useNavigate, useParams } from \"react-router-dom\";\nimport { getTeacherStudentDashboard } from \"../lib/api.js\";\nimport { useSession } from \"../hooks/useSession.js\";\nimport { useCurriculumManifest } from \"../hooks/useCurriculumManifest.js\";\nimport {\n  StudentDashboardLayout,\n  createUnitSummaries,\n  createRecentUpdates,\n  describeTrack,\n  normaliseStatus,\n} from \"./StudentDashboardPage.jsx\";\nimport StatusBanner from \"../components/ui/StatusBanner.jsx\";\nimport { getYear7LessonById } from \"../../../shared/liveDecks.js\";\n\nfunction TeacherStudentDashboardPage() {\n  const { session, ready } = useSession();\n  const navigate = useNavigate();\n  const { studentId } = useParams();\n  const token = session?.token ?? null;\n  const isTeacher = session?.user?.role === \"teacher\";\n\n  const [payload, setPayload] = useState(null);\n  const [status, setStatus] = useState(null);\n\n  const { manifest } = useCurriculumManifest();\n\n  useEffect(() => {\n    if (!ready) return;\n    if (!isTeacher) {\n      navigate(\"/\", { replace: true });\n      return;\n    }\n    if (!studentId || !token) {\n      setStatus({ tone: \"error\", message: \"Student identifier missing.\" });\n      return;\n    }\n\n    let active = true;\n    setStatus({ tone: \"info\", message: \"Loading student dashboardâ€¦\" });\n\n    (async () => {\n      try {\n        const response = await getTeacherStudentDashboard(token, studentId);\n        if (!active) return;\n        setPayload(response);\n        setStatus(null);\n      } catch (error) {\n        if (!active) return;\n        setStatus({ tone: \"error\", message: error.message || \"Unable to load student dashboard.\" });\n      }\n    })();\n\n    return () => {\n      active = false;\n    };\n  }, [ready, isTeacher, studentId, token, navigate]);\n\n  const student = payload?.student ?? null;\n  const classInfo = payload?.class ?? null;\n  const classPacing = payload?.classPacing ?? null;\n  const progress = useMemo(() => payload?.progress ?? [], [payload?.progress]);\n\n  const pointerLesson = useMemo(() => {\n    if (!classPacing?.lessonId) return null;\n    return getYear7LessonById(classPacing.lessonId);\n  }, [classPacing]);\n\n  const pointerUpdatedAt = useMemo(() => {\n    if (!classPacing?.updatedAt) return null;\n    const date = new Date(classPacing.updatedAt);\n    return Number.isNaN(date.getTime()) ? null : date.toLocaleString();\n  }, [classPacing?.updatedAt]);\n\n  const lessonStatusMap = useMemo(() => {\n    const map = new Map();\n    for (const record of progress) {\n      map.set(record.lessonSlug, normaliseStatus(record.status));\n    }\n    return map;\n  }, [progress]);\n\n  const track = (student?.curriculumTrack ?? \"ib-sl\").toLowerCase();\n  const isIBTrack = track.startsWith(\"ib\");\n  const trackDisplayName = describeTrack(track);\n  const curriculumLink = isIBTrack ? \"/curriculum/ib\" : \"/curriculum\";\n  const curriculumCtaLabel = isIBTrack ? \"View curriculum map\" : \"Open curriculum overview\";\n\n  const unitSummaries = useMemo(() => {\n    if (!manifest) return [];\n    return createUnitSummaries(manifest, lessonStatusMap, track);\n  }, [manifest, lessonStatusMap, track]);\n\n  const totalLessons = unitSummaries.reduce((sum, unit) => sum + unit.totalCount, 0);\n  const totalCompleted = unitSummaries.reduce((sum, unit) => sum + unit.completedCount, 0);\n  const overallPercentage = totalLessons > 0 ? Math.round((totalCompleted / totalLessons) * 100) : 0;\n\n  const recentUpdates = useMemo(() => createRecentUpdates(progress), [progress]);\n\n  const gamificationSummary = {\n    level: null,\n    xp: null,\n    streak: null,\n    totalAttempts: null,\n    totalCorrect: null,\n    accuracy: null,\n  };\n\n  if (!ready || !isTeacher) {\n    return null;\n  }\n\n  if (status?.tone === \"error\" && !payload) {\n    return (\n      <div className=\"page-shell page-shell--fluid student-dashboard\">\n        <StatusBanner tone=\"danger\">{status.message}</StatusBanner>\n      </div>\n    );\n  }\n\n  if (status?.tone === \"info\" && !payload) {\n    return (\n      <div className=\"page-shell page-shell--fluid student-dashboard\">\n        <StatusBanner tone=\"info\">{status.message}</StatusBanner>\n      </div>\n    );\n  }\n\n  if (!manifest || !student) {\n    return null;\n  }\n\n  return (\n    <StudentDashboardLayout\n      studentName={student.displayName ?? student.username ?? \"Student\"}\n      track={track}\n      trackDisplayName={trackDisplayName}\n      curriculumLink={curriculumLink}\n      curriculumCtaLabel={curriculumCtaLabel}\n      overallPercentage={overallPercentage}\n      totalCompleted={totalCompleted}\n      totalLessons={totalLessons}\n      classInfo={classInfo}\n      activeStage={student.activeStage ?? null}\n      pointerLesson={pointerLesson}\n      pointerUpdatedAt={pointerUpdatedAt}\n      gamification={gamificationSummary}\n      unitSummaries={unitSummaries}\n      interactiveAttemptSections={[]}\n      recentUpdates={recentUpdates}\n      status={status}\n      isIBTrack={isIBTrack}\n    />\n  );\n}\n\nexport default TeacherStudentDashboardPage;\n","import { Link } from \"react-router-dom\";\nimport ContentContainer from \"../components/ui/ContentContainer.jsx\";\nimport StatusPill from \"../components/ui/StatusPill.jsx\";\n\nimport \"./CurriculumMapPage.css\";\n\nconst tracks = {\n  ks3: [\n    { label: \"Year 7\", state: \"live\", href: \"/curriculum/year7\" },\n    { label: \"Year 8\", state: \"preview\" },\n    { label: \"Year 9\", state: \"preview\" },\n  ],\n  igcse: [{ label: \"IGCSE Computer Science\", state: \"live\", href: \"/curriculum/igcse\" }],\n};\n\nfunction CurriculumMapPage() {\n  return (\n    <ContentContainer variant=\"fullWidth\" className=\"curriculum-page\">\n      <section className=\"page-hero\">\n        <div className=\"page-hero__content\">\n          <span className=\"page-hero__eyebrow\">Curriculum pathway</span>\n          <h1 className=\"page-hero__title\">Computer Science journey</h1>\n          <p className=\"muted\">\n            A single place to preview the strands we are sequencing from Key Stage 3 through IB Computer Science.\n            Track what is live today and what is in production for the next cohort.\n          </p>\n        </div>\n        <div className=\"page-hero__actions\">\n          <Link to=\"/curriculum/ib\" className=\"pill pill--action\">\n            Explore IB curriculum map\n          </Link>\n        </div>\n      </section>\n\n      <div className=\"curriculum-panels page-panels\">\n        <article className=\"curriculum-panel\">\n          <header className=\"curriculum-panel__header\">\n            <div>\n              <h2>Key Stage 3</h2>\n              <p className=\"muted\">Start with the Year 7 Computing Adventure. Years 8 &amp; 9 unlock as the sequence ships.</p>\n            </div>\n            <StatusPill tone=\"info\" size=\"sm\">\n              Rolling release\n            </StatusPill>\n          </header>\n          <div className=\"curriculum-panel__body\">\n            <p>\n              Our middle years pathway is being rebuilt to mirror the IB learning experience. Year 7 is ready to run\n              today with live pacing pointers. Subsequent years follow later in the academic year.\n            </p>\n            <div className=\"curriculum-buttons\">\n              {tracks.ks3.map((item) => (\n                item.state === \"live\" && item.href ? (\n                  <Link key={item.label} to={item.href} className=\"pill pill--live\">\n                    {item.label}\n                    <small>Available now</small>\n                  </Link>\n                ) : (\n                  <button key={item.label} type=\"button\" disabled className=\"pill pill--locked\">\n                    {item.label}\n                    <small>Preview coming soon</small>\n                  </button>\n                )\n              ))}\n            </div>\n          </div>\n        </article>\n\n        <article className=\"curriculum-panel\">\n          <header className=\"curriculum-panel__header\">\n            <div>\n              <h2>IGCSE Computer Science</h2>\n              <p className=\"muted\">Content sequencing to bridge from Key Stage 4 to DP readiness.</p>\n            </div>\n            <StatusPill tone=\"info\" size=\"sm\">\n              Beta map\n            </StatusPill>\n          </header>\n          <div className=\"curriculum-panel__body\">\n            <p>\n              Topics 1 10 are now scaffolded into two streams so you can plan assessment pacing, live unlocks, and content authoring.\n            </p>\n            <div className=\"curriculum-buttons\">\n              {tracks.igcse.map((item) => (\n                item.state === \"live\" && item.href ? (\n                  <Link key={item.label} to={item.href} className=\"pill pill--action\">\n                    {item.label}\n                    <small>Open roadmap</small>\n                  </Link>\n                ) : (\n                  <button key={item.label} type=\"button\" disabled className=\"pill pill--locked\">\n                    {item.label}\n                    <small>Launch soon</small>\n                  </button>\n                )\n              ))}\n            </div>\n          </div>\n        </article>\n\n        <article className=\"curriculum-panel curriculum-panel--highlight\">\n          <header className=\"curriculum-panel__header\">\n            <div>\n              <h2>IB Computer Science</h2>\n              <p className=\"muted\">Full Standard and Higher Level strands with lesson unlock logic.</p>\n            </div>\n            <StatusPill tone=\"success\" size=\"sm\">\n              Live\n            </StatusPill>\n          </header>\n          <div className=\"curriculum-panel__body\">\n            <p>\n              Dive into the RevisionDojo-inspired experience with structured units, chapter dashboards, and lesson\n              unlocks ready for classroom delivery.\n            </p>\n            <div className=\"curriculum-buttons\">\n              <Link to=\"/curriculum/ib\" className=\"pill pill--action\">\n                Open IB curriculum map\n              </Link>\n            </div>\n          </div>\n        </article>\n      </div>\n    </ContentContainer>\n  );\n}\n\nexport default CurriculumMapPage;\n","export const IB_UNIT_METADATA = {\n  A1: {\n    theme: \"Theme A Â· Concepts of computer science\",\n    summary: \"Computer fundamentals\",\n    guidingQuestion:\n      \"What principles underpin the operation of a computer, from low-level hardware functionality to operating system interactions?\",\n    hours: {\n      sl: \"SL Â· 11 hours\",\n      hl: \"HL Â· 18 hours\",\n    },\n  },\n  A2: {\n    theme: \"Theme A Â· Concepts of computer science\",\n    summary: \"Networks\",\n    guidingQuestion: \"What are the principles and concepts that underpin how networks operate?\",\n    hours: {\n      sl: \"SL Â· 11 hours\",\n      hl: \"HL Â· 18 hours\",\n    },\n  },\n  A3: {\n    theme: \"Theme A Â· Concepts of computer science\",\n    summary: \"Databases\",\n    guidingQuestion:\n      \"What are the principles, structures, and operations that form the basis of database systems?\",\n    hours: {\n      sl: \"SL Â· 11 hours\",\n      hl: \"HL Â· 18 hours\",\n    },\n  },\n  A4: {\n    theme: \"Theme A Â· Concepts of computer science\",\n    summary: \"Machine learning\",\n    guidingQuestion:\n      \"What principles and approaches should be considered to ensure machine learning models produce accurate results ethically?\",\n    hours: {\n      sl: \"SL Â· 5 hours\",\n      hl: \"HL Â· 18 hours\",\n    },\n  },\n  B1: {\n    theme: \"Theme B Â· Computational thinking and problem-solving\",\n    summary: \"Computational thinking\",\n    guidingQuestion: \"How can we apply a computational solution to a real-world problem?\",\n    hours: {\n      sl: \"SL Â· 5 hours\",\n      hl: \"HL Â· 5 hours\",\n    },\n  },\n  B2: {\n    theme: \"Theme B Â· Computational thinking and problem-solving\",\n    summary: \"Programming\",\n    guidingQuestion: \"How can we apply computer programming to solve problems?\",\n    hours: {\n      sl: \"SL Â· 40 hours\",\n      hl: \"HL Â· 42 hours\",\n    },\n  },\n  B3: {\n    theme: \"Theme B Â· Computational thinking and problem-solving\",\n    summary: \"Object-oriented programming\",\n    guidingQuestion: \"Is object-oriented programming an appropriate paradigm for solving complex problems?\",\n    hours: {\n      sl: \"SL Â· 7 hours\",\n      hl: \"HL Â· 23 hours\",\n    },\n  },\n  B4: {\n    theme: \"Theme B Â· Computational thinking and problem-solving\",\n    summary: \"Abstract data types\",\n    guidingQuestion: \"Which abstract data types are most appropriate for different situations?\",\n    hours: {\n      hl: \"HL Â· 23 hours\",\n    },\n  },\n};\n\nexport const SUBTOPIC_DESCRIPTIONS = {\n  \"A1.1\": \"Computer hardware and operation\",\n  \"A1.2\": \"Data representation and computer logic\",\n  \"A1.3\": \"Operating systems and control systems\",\n  \"A1.4\": \"Translation\",\n  \"A2.1\": \"Network fundamentals\",\n  \"A2.2\": \"Network architecture\",\n  \"A2.3\": \"Data transmissions\",\n  \"A2.4\": \"Network security\",\n  \"A3.1\": \"Database fundamentals\",\n  \"A3.2\": \"Database design\",\n  \"A3.3\": \"Database programming\",\n  \"A3.4\": \"Alternative databases and data warehouses\",\n  \"A4.1\": \"Machine learning fundamentals\",\n  \"A4.2\": \"Data preprocessing\",\n  \"A4.3\": \"Machine learning approaches\",\n  \"A4.4\": \"Ethical considerations\",\n  \"B1.1\": \"Approaches to computational thinking\",\n  \"B2.1\": \"Programming fundamentals\",\n  \"B2.2\": \"Data structures\",\n  \"B2.3\": \"Programming constructs\",\n  \"B2.4\": \"Programming algorithms\",\n  \"B2.5\": \"File processing\",\n  \"B3.1\": \"Fundamentals of OOP for a single class\",\n  \"B3.2\": \"Fundamentals of OOP for multiple classes\",\n  \"B4.1\": \"Fundamentals of ADTs\",\n};\n\n","import { useEffect, useMemo, useState } from \"react\";\nimport { Link, useLocation } from \"react-router-dom\";\nimport { useSession } from \"../hooks/useSession.js\";\nimport {\n  useCurriculumManifest,\n  getTrackLabel,\n  resetCurriculumManifestCache,\n} from \"../hooks/useCurriculumManifest.js\";\nimport { IB_UNIT_METADATA, SUBTOPIC_DESCRIPTIONS } from \"../lib/ibMetadata.js\";\nimport b1Unit from \"../content/b1ComputationalThinking.jsx\";\nimport b2Unit from \"../content/b2ProgrammingFundamentals.jsx\";\nimport StatusPill from \"../components/ui/StatusPill.jsx\";\nimport \"./IBCurriculumPage.css\";\n\nfunction getTrackOptions(manifest) {\n  if (!manifest?.tracks) return [];\n  return Object.entries(manifest.tracks)\n    .filter(([track]) => track.startsWith(\"ib\"))\n    .map(([track, value]) => ({\n      id: track,\n      label: value.label ?? track,\n      defaultLessons: value.defaultLessons ?? [],\n    }));\n}\n\nfunction resolveInitialTrack(sessionTrack, trackOptions) {\n  const normalized = typeof sessionTrack === \"string\" ? sessionTrack.toLowerCase() : \"\";\n  if (normalized && trackOptions.some((option) => option.id === normalized)) {\n    return normalized;\n  }\n  return trackOptions[0]?.id ?? \"ib-sl\";\n}\n\nfunction computeLessonStatus({ lesson, lessonIndex, unit, subtopic, track, canViewAll }) {\n  if (canViewAll) {\n    return \"unlocked\";\n  }\n  const unitAvailable = Array.isArray(unit.availableFor)\n    ? unit.availableFor.includes(track)\n    : true;\n  const subtopicAvailable = Array.isArray(subtopic.availableFor)\n    ? subtopic.availableFor.includes(track)\n    : true;\n\n  const hlOnly = Boolean(lesson.hlOnly);\n  const trackSupportsHL = track === \"ib-hl\";\n  const accessible = unitAvailable && subtopicAvailable && (!hlOnly || trackSupportsHL);\n\n  if (!accessible) {\n    return hlOnly ? \"hl-only\" : \"locked\";\n  }\n\n  return lessonIndex === 0 ? \"unlocked\" : \"locked\";\n}\n\nfunction IBCurriculumPage() {\n  const { session } = useSession();\n  const location = useLocation();\n  const { manifest, status, error } = useCurriculumManifest();\n  const role = session?.user?.role ?? null;\n  const isTeacher = role === \"teacher\";\n  const canViewAll = role === \"teacher\" || role === \"admin\";\n  const staffBadgeLabel = isTeacher ? \"Teacher view\" : \"Staff view\";\n  const [selectedUnitId, setSelectedUnitId] = useState(null);\n  const trackOptions = useMemo(() => getTrackOptions(manifest), [manifest]);\n\n  const selectedTrack = useMemo(() => {\n    if (!trackOptions.length) {\n      return canViewAll\n        ? \"ib-hl\"\n        : resolveInitialTrack(session?.user?.curriculumTrack, [\n            { id: \"ib-sl\" },\n            { id: \"ib-hl\" },\n          ]);\n    }\n    if (canViewAll) {\n      return trackOptions.find((option) => option.id === \"ib-hl\")?.id ?? trackOptions[0].id;\n    }\n    return resolveInitialTrack(session?.user?.curriculumTrack, trackOptions);\n  }, [trackOptions, canViewAll, session?.user?.curriculumTrack]);\n\n  useEffect(() => {\n    if (!manifest) return;\n\n    const units = manifest.units ?? [];\n\n    const findFirstAccessibleUnit = () => {\n      if (canViewAll || !selectedTrack) {\n        return units.find((unit) => unit.id === \"A1\") ?? units[0];\n      }\n      return (\n        units.find((unit) => {\n          if (unit.id === \"A1\") {\n            return !unit.availableFor || unit.availableFor.includes(selectedTrack);\n          }\n          return false;\n        }) ??\n        units.find((unit) => !unit.availableFor || unit.availableFor.includes(selectedTrack)) ??\n        units[0]\n      );\n    };\n\n    if (!selectedUnitId) {\n      const defaultUnit = findFirstAccessibleUnit();\n      if (defaultUnit) {\n        setSelectedUnitId(defaultUnit.id);\n      }\n      return;\n    }\n\n    if (!canViewAll && selectedTrack) {\n      const activeUnit = units.find((unit) => unit.id === selectedUnitId);\n      const accessible = activeUnit\n        ? !activeUnit.availableFor || activeUnit.availableFor.includes(selectedTrack)\n        : false;\n      if (!accessible) {\n        const fallback = findFirstAccessibleUnit();\n        if (fallback) {\n          setSelectedUnitId(fallback.id);\n        }\n      }\n    }\n  }, [manifest, selectedUnitId, selectedTrack, canViewAll]);\n\n  useEffect(() => {\n    if (!manifest) return;\n    const focusUnit = location.state?.focusUnit;\n    if (focusUnit) {\n      setSelectedUnitId(focusUnit);\n    }\n  }, [location.state, manifest]);\n\n  const selectedUnit = useMemo(() => {\n    if (!manifest || !selectedUnitId) return null;\n    return manifest.units?.find((unit) => unit.id === selectedUnitId) ?? null;\n  }, [manifest, selectedUnitId]);\n\n  if (status === \"loading\") {\n    return (\n      <section className=\"ib-loading card\">\n        <p className=\"muted\">Loading IB curriculumâ€¦</p>\n      </section>\n    );\n  }\n\n  if (error) {\n    return (\n      <section className=\"ib-loading card\">\n        <h2>Unable to load curriculum</h2>\n        <p className=\"muted\">{error.message ?? \"Please try again later.\"}</p>\n        <button\n          type=\"button\"\n          onClick={() => {\n            resetCurriculumManifestCache();\n            window.location.reload();\n          }}\n          className=\"pill pill--action\"\n        >\n          Try again\n        </button>\n      </section>\n    );\n  }\n\n  if (!manifest) {\n    return null;\n  }\n\n  const baseTrackLabel = getTrackLabel(manifest, selectedTrack);\n  const trackBadgeText = canViewAll\n    ? `${staffBadgeLabel} Â· All content`\n    : baseTrackLabel\n    ? `${role === \"student\" ? \"Your track\" : \"Viewing\"}: ${baseTrackLabel}`\n    : null;\n  const unitMeta = selectedUnit ? IB_UNIT_METADATA[selectedUnit.id] ?? {} : {};\n\n  return (\n    <div className=\"ib-layout\">\n      <aside className=\"ib-sidebar\">\n        <div className=\"ib-sidebar__intro\">\n          <h1>IB Computer Science</h1>\n          <p className=\"muted\">\n            Explore the structured map for Standard and Higher level learners. Select a unit to view its\n            chapters and lesson pages.\n          </p>\n          <Link to=\"/curriculum\" className=\"ib-sidebar__back\">\n            âŸµ Back to curriculum overview\n          </Link>\n        </div>\n\n        <nav className=\"ib-sidebar__nav\" aria-label=\"IB units\">\n          {manifest.units?.map((unit) => {\n            const metadata = IB_UNIT_METADATA[unit.id] ?? {};\n            const isActive = unit.id === selectedUnitId;\n            const isTrackAvailable = canViewAll || !unit.availableFor || unit.availableFor.includes(selectedTrack);\n\n            return (\n              <button\n                key={unit.id}\n                type=\"button\"\n                className={`ib-sidebar__unit ${isActive ? \"is-active\" : \"\"}`}\n                onClick={() => setSelectedUnitId(unit.id)}\n                aria-current={isActive ? \"true\" : \"false\"}\n              >\n                <span className=\"ib-sidebar__unit-code\">{unit.id}</span>\n                <span className=\"ib-sidebar__unit-title\">{metadata.summary ?? unit.title}</span>\n                {!isTrackAvailable && (\n                  <StatusPill tone=\"warning\" size=\"sm\">\n                    HL only\n                  </StatusPill>\n                )}\n              </button>\n            );\n          })}\n        </nav>\n      </aside>\n\n      <section className=\"ib-content\" aria-live=\"polite\">\n        {selectedUnit ? (\n          <>\n            <header className=\"ib-content__header\">\n              <div>\n                <span className=\"ib-content__theme\">{unitMeta.theme ?? \"IB Computer Science\"}</span>\n                <h2>\n                  {selectedUnit.id} Â· {unitMeta.summary ?? selectedUnit.title}\n                </h2>\n                {unitMeta.guidingQuestion && (\n                  <p className=\"ib-content__guiding\">{unitMeta.guidingQuestion}</p>\n                )}\n              </div>\n              <div className=\"ib-content__meta\">\n                {unitMeta.hours?.sl && (\n                  <StatusPill tone=\"neutral\" variant=\"outline\" size=\"sm\">\n                    {unitMeta.hours.sl}\n                  </StatusPill>\n                )}\n                {unitMeta.hours?.hl && (\n                  <StatusPill tone=\"neutral\" variant=\"outline\" size=\"sm\">\n                    {unitMeta.hours.hl}\n                  </StatusPill>\n                )}\n                {trackBadgeText && (\n                  <StatusPill tone=\"info\" variant=\"outline\" size=\"sm\">\n                    {trackBadgeText}\n                  </StatusPill>\n                )}\n              </div>\n            </header>\n            {selectedUnit.id === \"B1\" ? (\n              <B1LearningPreview />\n            ) : selectedUnit.id === \"B2\" ? (\n              <B2LearningPreview />\n            ) : (\n              <>\n                <div className=\"ib-chapters\">\n                  {selectedUnit.subtopics?.map((subtopic) => {\n                    const description = SUBTOPIC_DESCRIPTIONS[subtopic.id] ?? subtopic.title;\n                    const trackAllowsChapter = !subtopic.availableFor || subtopic.availableFor.includes(selectedTrack);\n                    const isUnitAvailable = !selectedUnit.availableFor || selectedUnit.availableFor.includes(selectedTrack);\n                    const isChapterAvailable = trackAllowsChapter && isUnitAvailable;\n\n                return (\n                  <article className=\"ib-chapter\" key={subtopic.id}>\n                    <header className=\"ib-chapter__header\">\n                      <div>\n                        <h3>\n                          {subtopic.id} Â· {description}\n                        </h3>\n                        {subtopic.availableFor && !subtopic.availableFor.includes(\"ib-sl\") && (\n                          <span className=\"ib-chapter__tag\">HL focus</span>\n                        )}\n                        <p className=\"muted\">\n                          {subtopic.title}\n                        </p>\n                      </div>\n                      <div className=\"ib-chapter__actions\">\n                        <StatusPill\n                          as={Link}\n                          to={canViewAll || isChapterAvailable ? `/topic/${encodeURIComponent(subtopic.id)}` : \"#\"}\n                          className=\"ib-chapter__link\"\n                          tone={canViewAll || isChapterAvailable ? \"info\" : \"neutral\"}\n                          variant={canViewAll || isChapterAvailable ? \"outline\" : \"soft\"}\n                          size=\"sm\"\n                          aria-disabled={!canViewAll && !isChapterAvailable}\n                          tabIndex={!canViewAll && !isChapterAvailable ? -1 : undefined}\n                          onClick={(event) => {\n                            if (!canViewAll && !isChapterAvailable) {\n                              event.preventDefault();\n                            }\n                          }}\n                        >\n                          View chapter\n                        </StatusPill>\n                        {!canViewAll && !isChapterAvailable && (\n                          <StatusPill tone=\"muted\" size=\"sm\">\n                            Locked\n                          </StatusPill>\n                        )}\n                        {canViewAll && (\n                          <StatusPill tone=\"neutral\" variant=\"outline\" size=\"sm\">\n                            {staffBadgeLabel}\n                          </StatusPill>\n                        )}\n                        {!canViewAll && isChapterAvailable && (\n                          <StatusPill tone=\"info\" variant=\"outline\" size=\"sm\">\n                            First page unlocked\n                          </StatusPill>\n                        )}\n                      </div>\n                    </header>\n\n                    <ul className=\"ib-lessons\">\n                      {subtopic.lessons?.map((lesson, index) => {\n                        const status = computeLessonStatus({\n                          lesson,\n                          lessonIndex: index,\n                          unit: selectedUnit,\n                          subtopic,\n                          track: selectedTrack,\n                          canViewAll,\n                        });\n\n                        const unlocked = status === \"unlocked\";\n                        const hlOnly = status === \"hl-only\";\n                        const lessonHref = `/lesson/${encodeURIComponent(lesson.id)}`;\n                        const canLaunchLesson = canViewAll || unlocked;\n\n                        return (\n                          <li key={lesson.id} className={`ib-lesson ib-lesson--${status}`}>\n                            <span className=\"ib-lesson__code\">{lesson.id}</span>\n                            <span className=\"ib-lesson__title\">{lesson.title}</span>\n                            <span className=\"ib-lesson__status\">\n                              {canLaunchLesson && (\n                                <StatusPill\n                                  as={Link}\n                                  to={lessonHref}\n                                  tone={unlocked ? \"success\" : \"info\"}\n                                  variant=\"outline\"\n                                  size=\"sm\"\n                                  aria-label={`Open ${lesson.title}`}\n                                >\n                                  {canViewAll ? \"Open lesson\" : \"Start lesson\"}\n                                </StatusPill>\n                              )}\n                              {canViewAll && (\n                                <StatusPill tone=\"info\" variant=\"outline\" size=\"sm\">\n                                  {staffBadgeLabel}\n                                </StatusPill>\n                              )}\n                              {!canViewAll && hlOnly && (\n                                <StatusPill tone=\"warning\" size=\"sm\">\n                                  HL only\n                                </StatusPill>\n                              )}\n                              {!canViewAll && !unlocked && !hlOnly && (\n                                <StatusPill tone=\"muted\" size=\"sm\">\n                                  Locked\n                                </StatusPill>\n                              )}\n                            </span>\n                          </li>\n                        );\n                      })}\n                    </ul>\n                  </article>\n                  );\n                })}\n                </div>\n                <footer className=\"ib-unit-assessment\">\n                  <div>\n                    <h3>End of unit assessment</h3>\n                    <p className=\"muted\">\n                      Finish every chapter in {selectedUnit.id} to unlock the full unit assessment and check mastery.\n                    </p>\n                  </div>\n                  <button type=\"button\" className=\"pill pill--action\" disabled>\n                    Unit assessment locked\n                  </button>\n                </footer>\n              </>\n            )}\n          </>\n        ) : (\n          <div className=\"ib-placeholder\">\n            <p className=\"muted\">Select a unit to explore its chapters.</p>\n          </div>\n        )}\n      </section>\n    </div>\n  );\n}\n\nfunction B1LearningPreview() {\n  const location = useLocation();\n  const classId = location.state?.classId;\n  return (\n    <section className=\"ib-b1-preview\">\n      <div className=\"ib-b1-preview__intro\">\n        <h3>Interactive pathway available</h3>\n        <p className=\"muted\">\n          Work through staged content, formative checkpoints, and the end-of-unit assessment inside the B1 learning\n          path. Progress and attempts save automatically on this device.\n        </p>\n      </div>\n      <div className=\"ib-b1-preview__stages\">\n        {b1Unit.stages.map((stage) => (\n          <article key={stage.id}>\n            <h4>{stage.title}</h4>\n            <span>{stage.duration}</span>\n            <p>{stage.description}</p>\n          </article>\n        ))}\n      </div>\n      <div className=\"ib-b1-preview__actions\">\n        <Link to=\"/curriculum/ib/b1\" state={{ classId }} className=\"pill pill--action\">\n          Open B1 learning path\n        </Link>\n        <p className=\"muted\">Formative assessments unlock sequentiallyâ€”teachers can track attempts from the dashboard.</p>\n      </div>\n    </section>\n  );\n}\n\nfunction B2LearningPreview() {\n  const location = useLocation();\n  const classId = location.state?.classId;\n  return (\n    <section className=\"ib-b2-preview\">\n      <div className=\"ib-b2-preview__intro\">\n        <h3>Interactive pathway available</h3>\n        <p className=\"muted\">\n          Explore staged lessons on variables, strings, exceptions, and debugging. Includes an in-browser Python\n          playground for safe practiceâ€”progress saves locally on this device.\n        </p>\n      </div>\n      <div className=\"ib-b2-preview__stages\">\n        {b2Unit.stages.map((stage) => (\n          <article key={stage.id}>\n            <h4>{stage.title}</h4>\n            <span>{stage.duration}</span>\n            <p>{stage.description}</p>\n          </article>\n        ))}\n      </div>\n      <div className=\"ib-b2-preview__actions\">\n        <Link to=\"/curriculum/ib/b2\" state={{ classId }} className=\"pill pill--action\">\n          Open B2 learning path\n        </Link>\n        <span className=\"muted\">Python runs in-browser using Skulptâ€”no installation required.</span>\n      </div>\n    </section>\n  );\n}\n\nexport default IBCurriculumPage;\n","export const IGCSE_CURRICULUM = [\n  {\n    id: \"IGCSE-COMPUTER-SYSTEMS\",\n    title: \"Computer Systems\",\n    summary: \"Topics 1â€“6 Â· Core theory across data, hardware, software, and emerging technology.\",\n    accent: \"#1d4ed8\",\n    icon: \"ðŸ–¥ï¸\",\n    lessons: [\n      {\n        id: \"IGCSE-T1\",\n        order: 1,\n        slug: \"topic-1-data-representation\",\n        title: \"Topic 1 Â· Data representation\",\n      },\n      {\n        id: \"IGCSE-T2\",\n        order: 2,\n        slug: \"topic-2-data-transmission\",\n        title: \"Topic 2 Â· Data transmission\",\n      },\n      {\n        id: \"IGCSE-T3\",\n        order: 3,\n        slug: \"topic-3-hardware\",\n        title: \"Topic 3 Â· Hardware\",\n      },\n      {\n        id: \"IGCSE-T4\",\n        order: 4,\n        slug: \"topic-4-software\",\n        title: \"Topic 4 Â· Software\",\n      },\n      {\n        id: \"IGCSE-T5\",\n        order: 5,\n        slug: \"topic-5-internet-and-uses\",\n        title: \"Topic 5 Â· The internet and its uses\",\n      },\n      {\n        id: \"IGCSE-T6\",\n        order: 6,\n        slug: \"topic-6-automated-and-emerging-tech\",\n        title: \"Topic 6 Â· Automated and emerging technologies\",\n      },\n    ],\n  },\n  {\n    id: \"IGCSE-ALGORITHMS\",\n    title: \"Algorithms, Programming & Logic\",\n    summary: \"Topics 7â€“10 Â· Problem solving, coding practice, databases, and Boolean logic.\",\n    accent: \"#0ea5e9\",\n    icon: \"ðŸ§ \",\n    lessons: [\n      {\n        id: \"IGCSE-T7\",\n        order: 7,\n        slug: \"topic-7-algorithm-design\",\n        title: \"Topic 7 Â· Algorithm design and problem-solving\",\n      },\n      {\n        id: \"IGCSE-T8\",\n        order: 8,\n        slug: \"topic-8-programming\",\n        title: \"Topic 8 Â· Programming\",\n      },\n      {\n        id: \"IGCSE-T9\",\n        order: 9,\n        slug: \"topic-9-databases\",\n        title: \"Topic 9 Â· Databases\",\n      },\n      {\n        id: \"IGCSE-T10\",\n        order: 10,\n        slug: \"topic-10-boolean-logic\",\n        title: \"Topic 10 Â· Boolean logic\",\n      },\n    ],\n  },\n];\n\nexport const IGCSE_LESSON_SEQUENCE = IGCSE_CURRICULUM.flatMap((unit) =>\n  unit.lessons.map((lesson, index) => ({\n    ...lesson,\n    unitId: unit.id,\n    unitTitle: unit.title,\n    unitSummary: unit.summary,\n    position: index,\n  })),\n);\n\nexport function getIgcseLessonIndex(lessonId) {\n  if (!lessonId) return -1;\n  return IGCSE_LESSON_SEQUENCE.findIndex((lesson) => lesson.id === lessonId);\n}\n\nexport function getIgcseLessonById(lessonId) {\n  return IGCSE_LESSON_SEQUENCE.find((lesson) => lesson.id === lessonId) ?? null;\n}\n\nexport function getIgcseDefaultPointer() {\n  const first = IGCSE_LESSON_SEQUENCE[0];\n  if (!first) return null;\n  return { unitId: first.unitId, lessonId: first.id };\n}\n\n","import { useMemo } from \"react\";\nimport { IGCSE_CURRICULUM } from \"../../../shared/igcseCurriculum.js\";\nimport StatusPill from \"../components/ui/StatusPill.jsx\";\n\nimport \"./IGCSECurriculumPage.css\";\n\nfunction LessonList({ lessons }) {\n  return (\n    <ol className=\"igcse-unit__list\">\n      {lessons.map((lesson) => (\n        <li key={lesson.id} className=\"igcse-lesson\">\n          <span className=\"igcse-lesson__order\">{lesson.order.toString().padStart(2, \"0\")}</span>\n          <div className=\"igcse-lesson__meta\">\n            <strong>{lesson.title}</strong>\n            <small className=\"muted\">Content coming soon</small>\n          </div>\n        </li>\n      ))}\n    </ol>\n  );\n}\n\nexport default function IGCSECurriculumPage() {\n  const units = useMemo(() => IGCSE_CURRICULUM, []);\n\n  return (\n    <div className=\"page-shell igcse-map\">\n      <section className=\"igcse-hero card\">\n        <div className=\"igcse-hero__text\">\n          <span className=\"igcse-hero__eyebrow\">Cambridge IGCSE Â· Syllabus 0478 (2026\u00130)</span>\n          <h1>IGCSE Computer Science roadmap</h1>\n          <p className=\"muted\">\n            Two strands mirror the official syllabus: Computer Systems (topics 1\u00126) and Algorithms, Programming &amp;\n            Logic (topics 7\u001210). Use this map to plan releases, teacher pacing, and future student unlocks.\n          </p>\n        </div>\n        <div className=\"igcse-hero__status\">\n          <StatusPill tone=\"info\" size=\"sm\">\n            Beta map\n          </StatusPill>\n          <p className=\"muted\">Lesson content placeholders are ready for authoring.</p>\n        </div>\n      </section>\n\n      <div className=\"igcse-grid\">\n        {units.map((unit) => (\n          <article key={unit.id} className=\"igcse-unit card\" style={{ borderTopColor: unit.accent }}>\n            <header className=\"igcse-unit__header\">\n              <div className=\"igcse-unit__icon\" aria-hidden=\"true\">\n                {unit.icon}\n              </div>\n              <div className=\"igcse-unit__meta\">\n                <h2>{unit.title}</h2>\n                <p className=\"muted\">{unit.summary}</p>\n              </div>\n            </header>\n            <LessonList lessons={unit.lessons} />\n          </article>\n        ))}\n      </div>\n    </div>\n  );\n}\n\n","import { useEffect, useState, useMemo } from \"react\";\nimport { useParams, useNavigate, Link } from \"react-router-dom\";\nimport { useSession } from \"../hooks/useSession.js\";\nimport { useCurriculumManifest, getTrackLabel } from \"../hooks/useCurriculumManifest.js\";\nimport \"./TopicPage.css\";\n\nfunction TopicPage() {\n  const { id } = useParams();\n  const { session, ready } = useSession();\n  const navigate = useNavigate();\n  const { manifest, loading } = useCurriculumManifest();\n  const [message, setMessage] = useState(\"Loading topic detailsâ€¦\");\n\n  const subtopic = useMemo(() => {\n    if (!manifest || !id) return null;\n    for (const unit of manifest.units) {\n      for (const sub of unit.subtopics) {\n        if (sub.id === id) {\n          return {\n            ...sub,\n            unitId: unit.id,\n            unitTitle: unit.title,\n            unitAvailableFor: unit.availableFor ?? null,\n          };\n        }\n      }\n    }\n    return null;\n  }, [manifest, id]);\n\n  const role = session?.user?.role ?? null;\n  const isTeacher = role === \"teacher\";\n\n  const userProgramme = useMemo(() => {\n    if (isTeacher) return \"ib-hl\";\n    const track = session?.user?.curriculumTrack;\n    if (typeof track === \"string\" && track.toLowerCase().startsWith(\"ib\")) {\n      return track;\n    }\n    return \"ib-sl\";\n  }, [session?.user?.curriculumTrack, isTeacher]);\n\n  const trackLabel = useMemo(() => {\n    const base = getTrackLabel(manifest, userProgramme);\n    return isTeacher ? `${base} Â· Teacher view` : base;\n  }, [manifest, userProgramme, isTeacher]);\n\n  const chapterAccessible = useMemo(() => {\n    if (!subtopic) return false;\n    if (isTeacher) return true;\n    const unitAccess = !subtopic.unitAvailableFor || subtopic.unitAvailableFor.includes(userProgramme);\n    const subtopicAccess = !subtopic.availableFor || subtopic.availableFor.includes(userProgramme);\n    return unitAccess && subtopicAccess;\n  }, [subtopic, userProgramme, isTeacher]);\n\n  const lessonsWithStatus = useMemo(() => {\n    if (!subtopic) return [];\n    const lessons = subtopic.lessons ?? [];\n\n    return lessons.map((lesson, index) => {\n      if (isTeacher) {\n        return {\n          ...lesson,\n          status: \"unlocked\",\n          teacherUnlocked: true,\n        };\n      }\n      if (!chapterAccessible) {\n        return {\n          ...lesson,\n          status: \"hl-only\",\n          teacherUnlocked: false,\n        };\n      }\n\n      if (lesson.hlOnly && userProgramme !== \"ib-hl\") {\n        return {\n          ...lesson,\n          status: \"hl-only\",\n          teacherUnlocked: false,\n        };\n      }\n\n      return {\n        ...lesson,\n        status: index === 0 ? \"unlocked\" : \"locked\",\n        teacherUnlocked: false,\n      };\n    });\n  }, [subtopic, chapterAccessible, userProgramme, isTeacher]);\n\n  useEffect(() => {\n    if (!ready) {\n      return;\n    }\n    if (!session) {\n      setMessage(\"Authenticate to view topic content.\");\n      navigate(\"/\", { replace: true });\n    } else if (!loading && !subtopic) {\n      setMessage(\"Subtopic not found.\");\n    } else if (subtopic) {\n      setMessage(\"\");\n    }\n  }, [session, navigate, ready, loading, subtopic]);\n\n  if (loading || !ready) {\n    return (\n      <section className=\"card topic-page\">\n        <p className=\"muted\">Loading topic detailsâ€¦</p>\n      </section>\n    );\n  }\n\n  if (!subtopic) {\n    return (\n      <section className=\"card topic-page\">\n        <h2>Topic {id}</h2>\n        <p className=\"muted\">{message}</p>\n        <Link to=\"/curriculum\">â† Back to Curriculum Map</Link>\n      </section>\n    );\n  }\n\n  return (\n    <div className=\"topic-page\">\n      <nav className=\"topic-breadcrumb\">\n        <Link to=\"/curriculum\">Curriculum</Link>\n        <span>/</span>\n        <span>{subtopic.unitId} {subtopic.unitTitle}</span>\n        <span>/</span>\n        <span>{subtopic.title}</span>\n      </nav>\n\n      <section className=\"topic-content\">\n        <header className=\"topic-header\">\n          <h1>\n            {subtopic.id}: {subtopic.title}\n          </h1>\n          <p className=\"muted\">\n            Part of {subtopic.unitId}: {subtopic.unitTitle} Â· Viewing as {trackLabel}\n          </p>\n          {!isTeacher && !chapterAccessible && (\n            <p className=\"topic-alert\">This chapter is part of the Higher Level pathway. Ask your teacher to unlock it.</p>\n          )}\n        </header>\n\n        <div className=\"topic-lessons\">\n          <h2>Lessons in this chapter</h2>\n          <p className=\"muted topic-lessons__intro\">\n            First lesson is unlocked by default. Additional lessons and assessments will unlock as you progress.\n          </p>\n          <div className=\"lesson-grid\">\n            {lessonsWithStatus.map((lesson) => {\n              const isUnlocked = lesson.status === \"unlocked\";\n              const isLocked = lesson.status === \"locked\";\n              const isHLOnly = lesson.status === \"hl-only\";\n              const teacherUnlocked = !!lesson.teacherUnlocked;\n              const isAccessible = teacherUnlocked || isUnlocked;\n\n              const handleClick = (event) => {\n                if (!isAccessible) {\n                  event.preventDefault();\n                  if (isHLOnly) {\n                    alert(\"This lesson is only available to Higher Level students.\");\n                  } else {\n                    alert(\"Complete the unlocked lesson first to continue the chapter.\");\n                  }\n                }\n              };\n\n              return (\n                <Link\n                  key={lesson.id}\n                  to={isAccessible ? `/lesson/${lesson.id}` : \"#\"}\n                  className={`lesson-card ${(isUnlocked || teacherUnlocked) ? \"unlocked\" : \"\"} ${(!teacherUnlocked && (isLocked || isHLOnly)) ? \"locked\" : \"\"}`}\n                  onClick={handleClick}\n                  aria-disabled={!isAccessible}\n                >\n                  <div className=\"lesson-card__header\">\n                    <span className=\"lesson-card__number\">{lesson.id.split(\".\").pop()}</span>\n                    {teacherUnlocked && <span className=\"badge badge--teacher\">Teacher view</span>}\n                    {!teacherUnlocked && isHLOnly && <span className=\"badge badge--hl\">HL only</span>}\n                    {isUnlocked && <span className=\"badge badge--unlocked\">Unlocked</span>}\n                  </div>\n                  <h3 className=\"lesson-card__title\">{lesson.title}</h3>\n                  {!isAccessible && (\n                    <div className=\"lesson-card__lock\" aria-hidden=\"true\">\n                      <svg viewBox=\"0 0 24 24\" width=\"20\" height=\"20\">\n                        <path\n                          fill=\"currentColor\"\n                          d=\"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zM9 6c0-1.66 1.34-3 3-3s3 1.34 3 3v2H9V6z\"\n                        />\n                      </svg>\n                    </div>\n                  )}\n                </Link>\n              );\n            })}\n          </div>\n\n        </div>\n      </section>\n    </div>\n  );\n}\n\nexport default TopicPage;\n","import { useMemo } from \"react\";\nimport { useParams, Link } from \"react-router-dom\";\nimport { useSession } from \"../hooks/useSession.js\";\nimport { useCurriculumManifest, getTrackLabel } from \"../hooks/useCurriculumManifest.js\";\nimport ContentContainer from \"../components/ui/ContentContainer.jsx\";\nimport \"./LessonPage.css\";\n\nconst MODULE_LINKS = {\n  B1: { to: \"/curriculum/ib/b1\", label: \"Open B1 interactive pathway\" },\n  B2: { to: \"/curriculum/ib/b2\", label: \"Open B2 interactive pathway\" },\n};\n\nfunction LessonPage() {\n  const { lessonId } = useParams();\n  const { session } = useSession();\n  const { manifest, status, error } = useCurriculumManifest();\n\n  const role = session?.user?.role ?? null;\n  const isStaff = role === \"teacher\" || role === \"admin\";\n\n  const lessonMeta = useMemo(() => {\n    if (!manifest || !lessonId) return null;\n    for (const unit of manifest.units ?? []) {\n      for (const subtopic of unit.subtopics ?? []) {\n        const lessons = subtopic.lessons ?? [];\n        const index = lessons.findIndex((item) => item.id === lessonId);\n        if (index !== -1) {\n          return {\n            unit,\n            subtopic,\n            lessons,\n            lesson: lessons[index],\n            lessonIndex: index,\n          };\n        }\n      }\n    }\n    return null;\n  }, [manifest, lessonId]);\n\n  const userProgramme = useMemo(() => {\n    if (isStaff) {\n      return \"ib-hl\";\n    }\n    const track = session?.user?.curriculumTrack;\n    if (typeof track === \"string\" && track.toLowerCase().startsWith(\"ib\")) {\n      return track.toLowerCase();\n    }\n    return \"ib-sl\";\n  }, [session?.user?.curriculumTrack, isStaff]);\n\n  const trackLabel = useMemo(() => {\n    if (!manifest) return null;\n    return getTrackLabel(manifest, userProgramme);\n  }, [manifest, userProgramme]);\n\n  const unitAvailable =\n    lessonMeta && lessonMeta.unit\n      ? !Array.isArray(lessonMeta.unit.availableFor) || lessonMeta.unit.availableFor.includes(userProgramme)\n      : false;\n  const subtopicAvailable =\n    lessonMeta && lessonMeta.subtopic\n      ? !Array.isArray(lessonMeta.subtopic.availableFor) || lessonMeta.subtopic.availableFor.includes(userProgramme)\n      : false;\n  const isHlOnly = Boolean(lessonMeta?.lesson?.hlOnly);\n  const unlockedBySequence = lessonMeta ? lessonMeta.lessonIndex === 0 : false;\n  const accessibleForLearner =\n    Boolean(lessonMeta) &&\n    unitAvailable &&\n    subtopicAvailable &&\n    (!isHlOnly || userProgramme === \"ib-hl\") &&\n    unlockedBySequence;\n  const canViewLesson = isStaff || accessibleForLearner;\n\n  const lessonsWithStatus = useMemo(() => {\n    if (!lessonMeta) return [];\n    return lessonMeta.lessons.map((item, index) => {\n      const hlOnly = Boolean(item.hlOnly);\n      const unlocked = index === 0;\n      const accessible =\n        isStaff ||\n        ((!hlOnly || userProgramme === \"ib-hl\") && unitAvailable && subtopicAvailable && unlocked);\n      return {\n        ...item,\n        index,\n        isCurrent: item.id === lessonMeta.lesson.id,\n        hlOnly,\n        accessible,\n      };\n    });\n  }, [lessonMeta, isStaff, unitAvailable, subtopicAvailable, userProgramme]);\n\n  if (status === \"loading\") {\n    return (\n      <ContentContainer variant=\"fullWidth\" className=\"lesson-page\">\n        <section className=\"lesson-content\">\n          <p className=\"muted\">Loading lesson detailsâ€¦</p>\n        </section>\n      </ContentContainer>\n    );\n  }\n\n  if (error) {\n    return (\n      <ContentContainer variant=\"fullWidth\" className=\"lesson-page\">\n        <section className=\"lesson-content\">\n          <h2>Unable to load lesson</h2>\n          <p className=\"muted\">{error.message ?? \"Please try again later.\"}</p>\n          <Link to=\"/curriculum/ib\" className=\"pill pill--action\">\n            Back to IB curriculum\n          </Link>\n        </section>\n      </ContentContainer>\n    );\n  }\n\n  if (!lessonMeta) {\n    return (\n      <ContentContainer variant=\"fullWidth\" className=\"lesson-page\">\n        <section className=\"lesson-content\">\n          <h2>Lesson not found</h2>\n          <p className=\"muted\">\n            We could not locate lesson {lessonId}. Choose another chapter from the curriculum map.\n          </p>\n          <Link to=\"/curriculum/ib\" className=\"pill pill--action\">\n            Back to IB curriculum\n          </Link>\n        </section>\n      </ContentContainer>\n    );\n  }\n\n  const { unit, subtopic, lesson } = lessonMeta;\n  const moduleLink = MODULE_LINKS[unit.id] ?? null;\n\n  let availabilityMessage = \"\";\n  if (isStaff) {\n    availabilityMessage = \"Staff view shows the full sequence regardless of unlock status.\";\n  } else if (!unitAvailable || !subtopicAvailable) {\n    availabilityMessage = \"This chapter is locked for your programme. Ask your teacher to unlock it.\";\n  } else if (isHlOnly && userProgramme !== \"ib-hl\") {\n    availabilityMessage = \"This lesson is part of the Higher Level pathway.\";\n  } else if (!unlockedBySequence) {\n    availabilityMessage = \"Complete the first lesson in this chapter to unlock the remaining sequence.\";\n  } else {\n    availabilityMessage = \"Interactive lesson content is currently being migrated into the new gamified modules.\";\n  }\n\n  return (\n    <ContentContainer variant=\"fullWidth\" className=\"lesson-page\">\n      <nav className=\"lesson-breadcrumb\" aria-label=\"Breadcrumb\">\n        <Link to=\"/curriculum/ib\">IB curriculum</Link>\n        <span>/</span>\n        <Link to={`/topic/${encodeURIComponent(subtopic.id)}`}>{subtopic.id}</Link>\n        <span>/</span>\n        <span>{lesson.id}</span>\n      </nav>\n\n      <div className=\"lesson-container\">\n        <aside className=\"lesson-sidebar\">\n          <div className=\"lesson-sidebar__header\">\n            <h3>\n              {lesson.id} Â· {lesson.title}\n            </h3>\n            <p className=\"muted\">\n              {unit.id}: {unit.title}\n            </p>\n            <p className=\"muted\">\n              Viewing as {isStaff ? \"staff\" : trackLabel ?? userProgramme.toUpperCase()}.\n            </p>\n            {!canViewLesson && <span className=\"lesson-sidebar__alert\">Locked for this track</span>}\n            {isHlOnly && !isStaff && <span className=\"lesson-sidebar__alert\">Higher Level only</span>}\n          </div>\n\n          <div className=\"lesson-nav\" role=\"navigation\" aria-label=\"Lesson sequence\">\n            {lessonsWithStatus.map((item) => {\n              const classes = [\"lesson-nav__item\"];\n              if (item.isCurrent) classes.push(\"active\");\n              if (!item.accessible) classes.push(\"locked\");\n              return (\n                <Link\n                  key={item.id}\n                  to={`/lesson/${encodeURIComponent(item.id)}`}\n                  className={classes.join(\" \")}\n                >\n                  <span className=\"lesson-nav__number\">{item.id.split(\".\").pop()}</span>\n                  <span className=\"lesson-nav__title\">{item.title}</span>\n                  {item.hlOnly && <span className=\"badge badge--hl\">HL</span>}\n                </Link>\n              );\n            })}\n          </div>\n\n          <div className=\"lesson-sidebar__footer\">\n            <p className=\"small muted\">{availabilityMessage}</p>\n          </div>\n        </aside>\n\n        <section className=\"lesson-content\">\n          <header className=\"lesson-header\">\n            <h1>{lesson.title}</h1>\n            <div className=\"lesson-header__meta\">\n              <span className=\"badge badge--primary\">\n                {unit.id} Â· {subtopic.id}\n              </span>\n              {isStaff && <span className=\"badge badge--teacher\">Staff view</span>}\n              {!isStaff && <span className=\"badge badge--muted\">{trackLabel ?? userProgramme.toUpperCase()}</span>}\n              {isHlOnly && <span className=\"badge badge--hl\">Higher Level</span>}\n            </div>\n          </header>\n\n          <div className=\"lesson-sections\">\n            <article className=\"lesson-section\">\n              <h2 className=\"lesson-section__title\">Digital lesson coming soon</h2>\n              <div className=\"lesson-section__content\">\n                <p>\n                  We are migrating lesson {lesson.id} into the new gamified learning experience.{\" \"}\n                  {canViewLesson\n                    ? \"Until the migration completes, use the unit overview or interactive module links below to cover this content.\"\n                    : \"Ask your teacher to unlock the chapter when you are ready to continue.\"}\n                </p>\n                {moduleLink && (\n                  <p>\n                    <Link to={moduleLink.to} className=\"pill pill--action\">\n                      {moduleLink.label}\n                    </Link>\n                  </p>\n                )}\n              </div>\n            </article>\n\n            <article className=\"lesson-section\">\n              <h2 className=\"lesson-section__title\">What you can do now</h2>\n              <div className=\"lesson-section__content\">\n                <ul>\n                  <li>Review the chapter outline to keep track of the learning sequence.</li>\n                  <li>Use the interactive module previews for B1 and B2 while we migrate lessons.</li>\n                  <li>Teachers can unlock additional lessons to stage student access.</li>\n                </ul>\n              </div>\n            </article>\n          </div>\n\n          <div className=\"lesson-actions\">\n            <Link to={`/topic/${encodeURIComponent(subtopic.id)}`} className=\"btn btn--secondary\">\n              â† Back to chapter\n            </Link>\n            <Link to=\"/curriculum/ib\" className=\"btn btn--primary\">\n              Explore curriculum map\n            </Link>\n          </div>\n        </section>\n      </div>\n    </ContentContainer>\n  );\n}\n\nexport default LessonPage;\n","import { useCallback, useEffect, useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { createTeacher as createTeacherRequest, deleteTeacher, getAdminDashboard } from \"../lib/api.js\";\nimport { useSession } from \"../hooks/useSession.js\";\nimport FeedbackPanel from \"../components/ui/FeedbackPanel.jsx\";\nimport \"./AdminDashboardPage.css\";\n\nfunction AdminDashboardPage() {\n  const { session, ready } = useSession();\n  const navigate = useNavigate();\n  const token = session?.token ?? null;\n  const isAdmin = session?.user?.role === \"admin\";\n  const adminName = session?.user?.displayName ?? session?.user?.username ?? \"Admin\";\n\n  const [dashboard, setDashboard] = useState(null);\n  const [status, setStatus] = useState(null);\n  const [loading, setLoading] = useState(false);\n\n  useEffect(() => {\n    if (!ready) return;\n    if (!isAdmin) {\n      navigate(\"/\", { replace: true });\n    }\n  }, [ready, isAdmin, navigate]);\n\n  const loadDashboard = useCallback(async () => {\n    if (!token || !isAdmin) return;\n    setLoading(true);\n    try {\n      const data = await getAdminDashboard(token);\n      setDashboard(data);\n      setStatus(null);\n    } catch (error) {\n      setStatus({ tone: \"error\", message: error.message || \"Failed to load admin dashboard.\" });\n    } finally {\n      setLoading(false);\n    }\n  }, [isAdmin, token]);\n\n  useEffect(() => {\n    if (!ready || !isAdmin) return;\n    loadDashboard();\n  }, [ready, isAdmin, loadDashboard]);\n\n  const handleCreateTeacher = async (event) => {\n    event.preventDefault();\n    if (!token) return;\n    const form = event.currentTarget;\n\n    const firstName = form.firstName.value.trim();\n    const lastName = form.lastName.value.trim();\n    const username = form.username.value.trim();\n    const password = form.password.value;\n\n    if (!firstName || !lastName || !username || !password) {\n      setStatus({ tone: \"error\", message: \"All fields are required to create a teacher account.\" });\n      return;\n    }\n\n    try {\n      setStatus({ tone: \"info\", message: \"Creating teacherâ€¦\" });\n      await createTeacherRequest(token, { firstName, lastName, username, password });\n      form.reset();\n      setStatus({ tone: \"success\", message: `Teacher \"${username}\" created.` });\n      await loadDashboard();\n    } catch (error) {\n      setStatus({ tone: \"error\", message: error.message || \"Failed to create teacher.\" });\n    }\n  };\n\n  const handleDeleteTeacher = async (username) => {\n    if (!token || !username) return;\n    const confirm = window.confirm(`Archive teacher \"${username}\" and their classes?`);\n    if (!confirm) return;\n\n    try {\n      setStatus({ tone: \"info\", message: \"Archiving teacherâ€¦\" });\n      await deleteTeacher(token, username);\n      setStatus({ tone: \"success\", message: `Teacher \"${username}\" archived.` });\n      await loadDashboard();\n    } catch (error) {\n      setStatus({ tone: \"error\", message: error.message || \"Failed to archive teacher.\" });\n    }\n  };\n\n  if (!ready || !isAdmin) {\n    return (\n      <div className=\"admin-grid\">\n        <section className=\"card\">\n          <p className=\"muted\">Preparing admin toolsâ€¦</p>\n        </section>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"admin-grid\">\n      <section className=\"card\">\n        <header className=\"card-header\">\n          <div>\n            <h2>Admin control centre</h2>\n            <p>Manage teacher accounts so the platform can run smoothly even if you are away.</p>\n          </div>\n        </header>\n        <div className=\"admin-summary\">\n          <div>\n            <span className=\"muted\">Signed in as</span>\n            <strong>{adminName}</strong>\n          </div>\n          <div>\n            <span className=\"muted\">Active teachers</span>\n            <strong>{dashboard?.teachers?.filter((teacher) => !teacher.archivedAt).length ?? 0}</strong>\n          </div>\n          <div>\n            <span className=\"muted\">Archived teachers</span>\n            <strong>{dashboard?.teachers?.filter((teacher) => teacher.archivedAt).length ?? 0}</strong>\n          </div>\n        </div>\n        {status && (\n          <FeedbackPanel tone={status.tone === \"error\" ? \"error\" : status.tone === \"success\" ? \"success\" : \"info\"}>\n            {status.message}\n          </FeedbackPanel>\n        )}\n        {loading && <p className=\"muted\">Loading dataâ€¦</p>}\n      </section>\n\n      <section className=\"card\">\n        <h3>Create teacher account</h3>\n        <form onSubmit={handleCreateTeacher} className=\"admin-form\">\n          <label>\n            <span>First name</span>\n            <input name=\"firstName\" required />\n          </label>\n          <label>\n            <span>Last name</span>\n            <input name=\"lastName\" required />\n          </label>\n          <label>\n            <span>Username</span>\n            <input name=\"username\" required />\n          </label>\n          <label>\n            <span>Temporary password</span>\n            <input name=\"password\" type=\"password\" required />\n          </label>\n          <button type=\"submit\" className=\"dashboard-submit\">\n            Create teacher\n          </button>\n        </form>\n      </section>\n\n      <section className=\"card\">\n        <h3>Teacher roster</h3>\n        <div className=\"teacher-table\">\n          <div className=\"teacher-table__head\">\n            <span>Name</span>\n            <span>Username</span>\n            <span>Classes</span>\n            <span>Active students</span>\n            <span>Status</span>\n            <span />\n          </div>\n          <div className=\"teacher-table__body\">\n            {dashboard?.teachers?.length === 0 && <p className=\"muted\">No teacher records yet.</p>}\n            {dashboard?.teachers?.map((teacher) => (\n              <div key={teacher.id} className=\"teacher-row\">\n                <span>\n                  <strong>{teacher.displayName}</strong>\n                </span>\n                <span>{teacher.username}</span>\n                <span>{teacher.totals?.classes ?? 0}</span>\n                <span>{teacher.totals?.activeStudents ?? 0}</span>\n                <span className={teacher.archivedAt ? \"muted\" : \"badge\"}>\n                  {teacher.archivedAt ? `Archived ${new Date(teacher.archivedAt).toLocaleDateString()}` : \"Active\"}\n                </span>\n                <span>\n                  <button\n                    type=\"button\"\n                    className=\"button-outline button-outline--danger\"\n                    onClick={() => handleDeleteTeacher(teacher.username)}\n                    disabled={!!teacher.archivedAt}\n                  >\n                    Archive\n                  </button>\n                </span>\n              </div>\n            ))}\n          </div>\n        </div>\n      </section>\n    </div>\n  );\n}\n\nexport default AdminDashboardPage;\n","import { useMemo } from \"react\";\nimport { Link, useNavigate } from \"react-router-dom\";\nimport { useSession } from \"../hooks/useSession.js\";\nimport \"./AccountPage.css\";\n\nfunction formatLabel(value) {\n  if (!value) return \"\";\n  return value\n    .split(/[-_]/)\n    .filter(Boolean)\n    .map((part) => part.charAt(0).toUpperCase() + part.slice(1))\n    .join(\" \");\n}\n\nfunction AccountPage() {\n  const { session, clear } = useSession();\n  const navigate = useNavigate();\n  const user = session?.user ?? null;\n\n  const details = useMemo(() => {\n    if (!user) return [];\n    const base = [\n      { label: \"Username\", value: user.username || \"â€”\" },\n      { label: \"Role\", value: formatLabel(user.role) || \"â€”\" },\n      { label: \"First name\", value: user.firstName || \"â€”\" },\n      { label: \"Last name\", value: user.lastName || \"â€”\" },\n      { label: \"Display name\", value: user.displayName || \"â€”\" },\n    ];\n\n    if (user.role === \"student\") {\n      base.push({ label: \"Year group\", value: user.yearGroup || \"â€”\" });\n      base.push({ label: \"Learning track\", value: formatLabel(user.curriculumTrack) || \"â€”\" });\n      base.push({ label: \"Active stage\", value: formatLabel(user.activeStage) || \"â€”\" });\n    }\n\n    if (user.role === \"teacher\") {\n      base.push({ label: \"Status\", value: user.archivedAt ? `Archived on ${new Date(user.archivedAt).toLocaleDateString()}` : \"Active\" });\n    }\n\n    return base;\n  }, [user]);\n\n  if (!user) {\n    return (\n      <div className=\"page-shell\">\n        <div className=\"account-grid\">\n          <section className=\"card\">\n            <h2>No session found</h2>\n            <p className=\"muted\">\n              Please <Link to=\"/\">return to the login screen</Link> to sign in.\n            </p>\n          </section>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"page-shell\">\n      <div className=\"account-grid\">\n        <section className=\"card\">\n        <header className=\"card-header\">\n          <div>\n            <h2>Account overview</h2>\n            <p>Personal details and role-specific permissions for your profile.</p>\n          </div>\n          <button\n            type=\"button\"\n            className=\"button-outline button-outline--danger\"\n            onClick={() => {\n              clear();\n              navigate(\"/\", { replace: true });\n            }}\n          >\n            Sign out\n          </button>\n        </header>\n        <dl className=\"account-detail\">\n          {details.map((item) => (\n            <div key={item.label}>\n              <dt>{item.label}</dt>\n              <dd>{item.value}</dd>\n            </div>\n          ))}\n        </dl>\n        </section>\n      </div>\n    </div>\n  );\n}\n\nexport default AccountPage;\n","import { useCallback, useEffect, useMemo, useState } from \"react\";\nimport { Link, useNavigate, useLocation } from \"react-router-dom\";\nimport { useSession } from \"../hooks/useSession.js\";\nimport logo from \"../assets/logo.svg\";\nimport \"./Layout.css\";\n\nfunction Layout({ children }) {\n  const { session, clear, ready } = useSession();\n  const navigate = useNavigate();\n  const location = useLocation();\n\n  const [menuOpen, setMenuOpen] = useState(false);\n  const [sidebarCollapsed, setSidebarCollapsed] = useState(false);\n  const [sidebarMobileOpen, setSidebarMobileOpen] = useState(false);\n\n  const role = session?.user?.role ?? null;\n  const firstName = (session?.user?.firstName || \"\").trim();\n  const displayName = (session?.user?.displayName || session?.user?.username || \"\").trim();\n  const greetingName = firstName || displayName.split(\" \")[0] || \"\";\n  const initials = useMemo(() => {\n    if (!displayName) return \"CS\";\n    const parts = displayName.split(/\\s+/).filter(Boolean);\n    if (parts.length === 0) return displayName.slice(0, 2).toUpperCase();\n    if (parts.length === 1) return parts[0].slice(0, 2).toUpperCase();\n    return (parts[0][0] + parts[parts.length - 1][0]).toUpperCase();\n  }, [displayName]);\n\n  const dashboardLink = useMemo(() => {\n    if (role === \"teacher\") return \"/dashboard\";\n    if (role === \"student\") return \"/student\";\n    if (role === \"admin\") return \"/admin\";\n    return null;\n  }, [role]);\n\n  const studentTrack = role === \"student\" ? (session?.user?.curriculumTrack || \"\").toLowerCase() : \"\";\n\n  const navSections = useMemo(() => {\n    if (!role) return [];\n\n    const sections = new Map();\n    const ensureSection = (key, title) => {\n      if (!sections.has(key)) {\n        sections.set(key, { id: key, title, items: [] });\n      }\n      return sections.get(key);\n    };\n\n    const overview = ensureSection(\"overview\", \"Curriculum\");\n    overview.items.push({\n      id: \"curriculum-overview\",\n      to: \"/curriculum\",\n      label: \"Curriculum overview\",\n      match: (pathname) => pathname === \"/curriculum\",\n    });\n\n    const allowYear7Link =\n      role === \"teacher\" ||\n      role === \"admin\" ||\n      studentTrack.startsWith(\"ks3\") ||\n      (session?.user?.yearGroup ?? \"\").toLowerCase().includes(\"year 7\");\n\n    if (allowYear7Link) {\n      overview.items.push({\n        id: \"year7-map\",\n        to: \"/curriculum/year7\",\n        label: \"Year 7 map\",\n        match: (pathname) => pathname.startsWith(\"/curriculum/year7\"),\n      });\n    }\n\n    const allowIbLink = role === \"teacher\" || role === \"admin\" || studentTrack.startsWith(\"ib\");\n    if (allowIbLink) {\n      overview.items.push({\n        id: \"ib-map\",\n        to: \"/curriculum/ib\",\n        label: \"IB curriculum map\",\n        match: (pathname) =>\n          pathname.startsWith(\"/curriculum/ib\") || pathname.startsWith(\"/topic\") || pathname.startsWith(\"/lesson\"),\n      });\n    }\n\n    if (role === \"teacher\" || role === \"admin\") {\n      const dashboards = ensureSection(\"dashboards\", \"Dashboards\");\n      dashboards.items.push({\n        id: \"teacher-dashboard\",\n        to: \"/dashboard\",\n        label: \"Teacher dashboard\",\n        match: (pathname) => pathname.startsWith(\"/dashboard\"),\n      });\n    }\n\n    if (role === \"student\") {\n      const studentSection = ensureSection(\"student\", \"My learning\");\n      studentSection.items.push({\n        id: \"student-space\",\n        to: \"/student\",\n        label: \"Student space\",\n        match: (pathname) => pathname.startsWith(\"/student\"),\n      });\n    }\n\n    if (role === \"admin\") {\n      const adminSection = ensureSection(\"admin\", \"Admin\");\n      adminSection.items.push({\n        id: \"admin-panel\",\n        to: \"/admin\",\n        label: \"Admin panel\",\n        match: (pathname) => pathname.startsWith(\"/admin\"),\n      });\n    }\n\n    return Array.from(sections.values()).filter((section) => section.items.length > 0);\n  }, [role, studentTrack, session?.user?.yearGroup]);\n\n  const handleSignOut = useCallback(() => {\n    clear();\n    setMenuOpen(false);\n    setSidebarMobileOpen(false);\n    if (location.pathname !== \"/\") {\n      navigate(\"/\", { replace: true });\n    }\n  }, [clear, navigate, location.pathname]);\n\n  useEffect(() => {\n    setMenuOpen(false);\n    setSidebarMobileOpen(false);\n  }, [location.pathname]);\n\n  const menuItems = useMemo(() => {\n    if (!role) return [];\n    const items = [];\n    if (dashboardLink) {\n      items.push({ type: \"link\", to: dashboardLink, label: \"My dashboard\" });\n    }\n    items.push({ type: \"link\", to: \"/account\", label: \"My account\" });\n    items.push({ type: \"action\", label: \"Log out\", onClick: handleSignOut });\n    return items;\n  }, [role, dashboardLink, handleSignOut]);\n\n  const handleAccountBlur = (event) => {\n    if (!event.currentTarget.contains(event.relatedTarget)) {\n      setMenuOpen(false);\n    }\n  };\n\n  const isAuthenticated = ready && Boolean(role);\n\n  return (\n    <div\n      className={`layout-root${sidebarCollapsed ? \" layout-root--collapsed\" : \"\"}${sidebarMobileOpen ? \" layout-root--nav-open\" : \"\"}`}\n    >\n      {isAuthenticated && (\n        <>\n          <aside className=\"layout-sidebar\" aria-label=\"Primary navigation\">\n            <div className=\"layout-sidebar__header\">\n              <Link to=\"/curriculum\" className=\"layout-brand\" aria-label=\"Computer Science Department home\">\n                <img src={logo} alt=\"School crest\" className=\"layout-brand__mark\" />\n                <div className=\"layout-brand__text\">\n                  <span className=\"layout-brand__title\">Computer Science Department</span>\n                  <small className=\"layout-brand__subtitle\">St Georges British International Schools Group Germany</small>\n                </div>\n              </Link>\n              <button\n                type=\"button\"\n                className=\"layout-sidebar__collapse\"\n                onClick={() => setSidebarCollapsed((prev) => !prev)}\n                aria-pressed={sidebarCollapsed}\n                aria-label={sidebarCollapsed ? \"Expand navigation\" : \"Collapse navigation\"}\n              >\n                <span aria-hidden=\"true\" />\n              </button>\n            </div>\n            <div className=\"layout-sidebar__sections\">\n              {navSections.map((section) => (\n                <div key={section.id} className=\"layout-sidebar__section\">\n                  <p className=\"layout-sidebar__section-title\">{section.title}</p>\n                  <nav>\n                    {section.items.map((item) => {\n                      const isActive = item.match ? item.match(location.pathname) : location.pathname === item.to;\n                      return (\n                        <Link\n                          key={item.id}\n                          to={item.to}\n                          className={`layout-sidebar__nav-item ${isActive ? \"is-active\" : \"\"}`}\n                          aria-current={isActive ? \"page\" : undefined}\n                          onClick={() => setSidebarMobileOpen(false)}\n                        >\n                          <span className=\"layout-sidebar__nav-bullet\" aria-hidden=\"true\">\n                            {item.label.charAt(0)}\n                          </span>\n                          <span className=\"layout-sidebar__nav-text\">{item.label}</span>\n                        </Link>\n                      );\n                    })}\n                  </nav>\n                </div>\n              ))}\n            </div>\n            <div className=\"layout-sidebar__footer\">\n              <div className=\"layout-sidebar__user\">\n                <span className=\"layout-sidebar__avatar\" aria-hidden=\"true\">\n                  {initials}\n                </span>\n                <div className=\"layout-sidebar__user-meta\">\n                  <strong>{displayName || \"Account\"}</strong>\n                  <span className=\"text-muted\">{role ?? \"\"}</span>\n                </div>\n              </div>\n              <button type=\"button\" className=\"layout-sidebar__signout\" onClick={handleSignOut}>\n                Log out\n              </button>\n            </div>\n          </aside>\n          <button\n            type=\"button\"\n            className=\"layout-sidebar__scrim\"\n            aria-hidden={!sidebarMobileOpen}\n            onClick={() => setSidebarMobileOpen(false)}\n          />\n        </>\n      )}\n\n      <div className=\"layout-scaffold\">\n        <header className=\"layout-topbar\">\n          <div className=\"layout-topbar__left\">\n            {isAuthenticated ? (\n              <>\n                <button\n                  type=\"button\"\n                  className=\"layout-topbar__nav-toggle show-mobile\"\n                  onClick={() => setSidebarMobileOpen((prev) => !prev)}\n                  aria-label={sidebarMobileOpen ? \"Close navigation\" : \"Open navigation\"}\n                  aria-pressed={sidebarMobileOpen}\n                >\n                  <span />\n                  <span />\n                  <span />\n                </button>\n                <span className=\"layout-topbar__title\">Computer Science Department</span>\n              </>\n            ) : (\n              <Link to=\"/\" className=\"layout-brand layout-brand--inline\" aria-label=\"Computer Science Department home\">\n                <img src={logo} alt=\"School crest\" className=\"layout-brand__mark\" />\n                <div className=\"layout-brand__text\">\n                  <span className=\"layout-brand__title\">Computer Science Department</span>\n                  <small className=\"layout-brand__subtitle\">St Georges British International Schools Group Germany</small>\n                </div>\n              </Link>\n            )}\n          </div>\n\n          <div className=\"layout-topbar__actions\">\n            {ready && !isAuthenticated && (\n              <Link to=\"/\" className=\"layout-login-link\">\n                Log in\n              </Link>\n            )}\n\n            {ready && isAuthenticated && (\n              <div className=\"layout-account\" onBlur={handleAccountBlur}>\n                <button\n                  type=\"button\"\n                  className=\"layout-account__button\"\n                  onClick={() => setMenuOpen((prev) => !prev)}\n                  aria-haspopup=\"menu\"\n                  aria-expanded={menuOpen}\n                >\n                  <span className=\"layout-account__avatar\" aria-hidden=\"true\">\n                    {initials}\n                  </span>\n                  <span className=\"layout-account__greeting\">{greetingName ? `Hi, ${greetingName}` : \"Account\"}</span>\n                  <svg className=\"layout-account__chevron\" viewBox=\"0 0 12 8\" aria-hidden=\"true\">\n                    <path d=\"M1 1.5 6 6.5 11 1.5\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.6\" strokeLinecap=\"round\" strokeLinejoin=\"round\" />\n                  </svg>\n                </button>\n                {menuOpen && (\n                  <div className=\"layout-account__menu\" role=\"menu\">\n                    {menuItems.map((item) =>\n                      item.type === \"link\" ? (\n                        <Link key={item.label} to={item.to} role=\"menuitem\">\n                          {item.label}\n                        </Link>\n                      ) : (\n                        <button key={item.label} type=\"button\" onClick={item.onClick} role=\"menuitem\">\n                          {item.label}\n                        </button>\n                      ),\n                    )}\n                  </div>\n                )}\n              </div>\n            )}\n          </div>\n        </header>\n\n        <main className=\"layout-main\">{children}</main>\n\n        <footer className=\"layout-footer\">\n          <small>Â© {new Date().getFullYear()} Computer Science Department Â· All curriculum in progress.</small>\n        </footer>\n      </div>\n    </div>\n  );\n}\n\nexport default Layout;\n","import \"./Segments.css\";\n\nexport default function AttemptBadge({ attemptStats }) {\n  if (!attemptStats) {\n    return null;\n  }\n  const attempts = attemptStats.count ?? 0;\n  const clears = attemptStats.correct ?? 0;\n  const last = attemptStats.last ?? {};\n  const lastCorrect = Number.isFinite(last.correct) ? last.correct : null;\n  const lastTotal = Number.isFinite(last.total) && last.total > 0 ? last.total : null;\n  const lastSuccess = last.success;\n\n  return (\n    <span className=\"gamified-attempt-badge\">\n      Attempts: {attempts}\n      <span aria-hidden=\"true\"> Â· </span>\n      Cleared: {clears}\n      {lastTotal !== null && lastTotal > 0 && (\n        <>\n          <span aria-hidden=\"true\"> Â· </span>\n          Last score: {lastCorrect ?? 0}/{lastTotal}\n        </>\n      )}\n      {lastSuccess === false && (\n        <>\n          <span aria-hidden=\"true\"> Â· </span>\n          Try again\n        </>\n      )}\n    </span>\n  );\n}\n","import { useMemo, useState } from \"react\";\nimport AttemptBadge from \"./AttemptBadge.jsx\";\nimport \"./Segments.css\";\n\nfunction evaluateQuestion(question, value) {\n  switch (question.type) {\n    case \"true-false\":\n      return {\n        correct: Boolean(value) === Boolean(question.answer),\n        details: { selected: value },\n      };\n    case \"mcq\":\n      return {\n        correct: value === question.answer,\n        details: { selected: value, correctAnswer: question.answer },\n      };\n    case \"multi-select\": {\n      const expected = Array.isArray(question.answers) ? question.answers : [];\n      const provided = Array.isArray(value) ? value : [];\n      const sortedExpected = [...expected].sort();\n      const sortedProvided = [...provided].sort();\n      const match =\n        sortedExpected.length === sortedProvided.length &&\n        sortedExpected.every((entry, index) => entry === sortedProvided[index]);\n      return {\n        correct: match,\n        details: { selected: provided, correctAnswers: expected },\n      };\n    }\n    default:\n      return { correct: false, details: {} };\n  }\n}\n\nfunction getOptionState(question, value, evaluation) {\n  if (!evaluation) return \"idle\";\n  if (question.type === \"true-false\") {\n    const optionValue = value;\n    if (optionValue === evaluation.details.selected) {\n      return evaluation.correct ? \"correct\" : \"incorrect\";\n    }\n    if (evaluation.correct && optionValue === question.answer) {\n      return \"correct\";\n    }\n    return \"idle\";\n  }\n\n  if (question.type === \"mcq\") {\n    if (value === evaluation.details.selected) {\n      return value === question.answer ? \"correct\" : \"incorrect\";\n    }\n    if (value === question.answer) {\n      return \"correct\";\n    }\n    return \"idle\";\n  }\n\n  if (question.type === \"multi-select\") {\n    const selected = evaluation.details.selected ?? [];\n    const correct = evaluation.details.correctAnswers ?? [];\n    if (selected.includes(value) && correct.includes(value)) return \"correct\";\n    if (selected.includes(value) && !correct.includes(value)) return \"incorrect\";\n    if (!selected.includes(value) && correct.includes(value)) return \"missed\";\n    return \"idle\";\n  }\n\n  return \"idle\";\n}\n\nexport default function MicroQuizSegment({ segment, onBack, onComplete, onAttempt, attemptStats, isTeacher }) {\n  const [responses, setResponses] = useState({});\n  const [locked, setLocked] = useState(false);\n  const [evaluations, setEvaluations] = useState({});\n  const [feedback, setFeedback] = useState(null);\n\n  const totalQuestions = segment.questions?.length ?? 0;\n  const unanswered = useMemo(() => {\n    return segment.questions?.some((question) => {\n      const value = responses[question.id];\n      if (question.type === \"multi-select\") {\n        return !Array.isArray(value) || value.length === 0;\n      }\n      return value === undefined || value === null || value === \"\";\n    });\n  }, [responses, segment.questions]);\n\n  const handleSubmit = (event) => {\n    event.preventDefault();\n    if (locked) {\n      return;\n    }\n\n    if (unanswered) {\n      setFeedback({ tone: \"error\", message: \"Answer every question before checking.\" });\n      return;\n    }\n\n    const perQuestion = {};\n    let correctCount = 0;\n    segment.questions.forEach((question) => {\n      const evaluation = evaluateQuestion(question, responses[question.id]);\n      perQuestion[question.id] = evaluation;\n      if (evaluation.correct) {\n        correctCount += 1;\n      }\n    });\n\n    setEvaluations(perQuestion);\n    const passed = correctCount === totalQuestions;\n    setFeedback({\n      tone: passed ? \"success\" : \"error\",\n      message: passed ? \"Perfect! XP incoming.\" : \"Review the highlights and try again.\",\n    });\n\n    onAttempt(segment.id, {\n      success: passed,\n      correctCount,\n      totalCount: totalQuestions,\n      onAdvance: passed\n        ? () => {\n            setLocked(true);\n            onComplete();\n          }\n        : null,\n    });\n\n    if (passed) {\n      setLocked(true);\n    }\n  };\n\n  return (\n    <article className={`gamified-card ${feedback?.tone === \"success\" ? \"is-success\" : \"\"}`}>\n      <header>\n        <h3>{segment.heading}</h3>\n        <AttemptBadge attemptStats={attemptStats} />\n        {segment.instructions && <p>{segment.instructions}</p>}\n      </header>\n      <form className=\"gamified-micro-quiz\" onSubmit={handleSubmit}>\n        {segment.questions?.map((question) => {\n          const evaluation = evaluations[question.id];\n          return (\n            <fieldset\n              key={question.id}\n              className={`gamified-micro-question ${\n                evaluation ? (evaluation.correct ? \"is-correct\" : \"is-incorrect\") : \"\"\n              }`}\n              disabled={locked && !isTeacher}\n            >\n              <legend>{question.prompt}</legend>\n              {question.type === \"true-false\" && (\n                <div className=\"gamified-micro-options\">\n                  {[true, false].map((option) => (\n                    <label\n                      key={String(option)}\n                      className={`gamified-micro-option gamified-micro-option--${getOptionState(\n                        question,\n                        option,\n                        evaluation,\n                      )}`}\n                    >\n                      <input\n                        type=\"radio\"\n                        name={question.id}\n                        value={String(option)}\n                        checked={responses[question.id] === option}\n                        onChange={() => {\n                          setResponses((prev) => ({ ...prev, [question.id]: option }));\n                          setFeedback(null);\n                          setLocked(false);\n                        }}\n                      />\n                      <span>{option ? \"True\" : \"False\"}</span>\n                    </label>\n                  ))}\n                </div>\n              )}\n\n              {question.type === \"mcq\" && (\n                <div className=\"gamified-micro-options\">\n                  {question.options?.map((option) => (\n                    <label\n                      key={option.id}\n                      className={`gamified-micro-option gamified-micro-option--${getOptionState(\n                        question,\n                        option.id,\n                        evaluation,\n                      )}`}\n                    >\n                      <input\n                        type=\"radio\"\n                        name={question.id}\n                        value={option.id}\n                        checked={responses[question.id] === option.id}\n                        onChange={() => {\n                          setResponses((prev) => ({ ...prev, [question.id]: option.id }));\n                          setFeedback(null);\n                          setLocked(false);\n                        }}\n                      />\n                      <span>{option.label}</span>\n                    </label>\n                  ))}\n                </div>\n              )}\n\n              {question.type === \"multi-select\" && (\n                <div className=\"gamified-micro-options\">\n                  {question.options?.map((option) => {\n                    const selected = Array.isArray(responses[question.id])\n                      ? responses[question.id].includes(option.id)\n                      : false;\n                    return (\n                      <label\n                        key={option.id}\n                        className={`gamified-micro-option gamified-micro-option--${getOptionState(\n                          question,\n                          option.id,\n                          evaluation,\n                        )}`}\n                      >\n                        <input\n                          type=\"checkbox\"\n                          value={option.id}\n                          checked={selected}\n                          onChange={(event) => {\n                            const checked = event.target.checked;\n                            setResponses((prev) => {\n                              const current = Array.isArray(prev[question.id]) ? prev[question.id] : [];\n                              let next = [...current];\n                              if (checked) {\n                                if (!next.includes(option.id)) next.push(option.id);\n                              } else {\n                                next = next.filter((value) => value !== option.id);\n                              }\n                              return {\n                                ...prev,\n                                [question.id]: next,\n                              };\n                            });\n                            setFeedback(null);\n                            setLocked(false);\n                          }}\n                        />\n                        <span>{option.label}</span>\n                      </label>\n                    );\n                  })}\n                </div>\n              )}\n\n              {evaluation && !evaluation.correct && question.rationale && (\n                <p className=\"gamified-feedback\">{question.rationale}</p>\n              )}\n            </fieldset>\n          );\n        })}\n\n        <div className=\"gamified-segment-nav\">\n          {onBack ? (\n            <button type=\"button\" className=\"btn btn--ghost\" onClick={onBack}>\n              Back\n            </button>\n          ) : (\n            <span />\n          )}\n          <div className=\"gamified-segment-actions\">\n            <button type=\"submit\" className=\"btn btn--primary\" disabled={locked && !isTeacher}>\n              Check answers\n            </button>\n          </div>\n        </div>\n      </form>\n      {feedback && (\n        <p className={`gamified-feedback ${feedback.tone === \"error\" ? \"is-error\" : \"is-success\"}`}>{feedback.message}</p>\n      )}\n    </article>\n  );\n}\n\n","export function shuffle(array) {\n  const copy = Array.isArray(array) ? [...array] : [];\n  for (let i = copy.length - 1; i > 0; i -= 1) {\n    const j = Math.floor(Math.random() * (i + 1));\n    [copy[i], copy[j]] = [copy[j], copy[i]];\n  }\n  return copy;\n}\n\n","import \"./ButtonGroup.css\";\n\n/**\n * ButtonGroup component for grouping related action buttons\n * \n * @param {React.ReactNode} children - Button elements\n * @param {string} layout - Layout direction: 'horizontal' | 'vertical' (default: 'horizontal')\n * @param {string} align - Alignment: 'start' | 'center' | 'end' | 'space-between' (default: 'start')\n * @param {string} className - Additional CSS classes\n */\nexport default function ButtonGroup({ children, layout = \"horizontal\", align = \"start\", className = \"\" }) {\n  const classes = [`button-group`, `button-group--${layout}`, `button-group--align-${align}`, className]\n    .filter(Boolean)\n    .join(\" \");\n\n  return (\n    <div className={classes} role=\"group\">\n      {children}\n    </div>\n  );\n}\n\n","import { useMemo, useState } from \"react\";\nimport { shuffle } from \"../../../utils/array.js\";\nimport AttemptBadge from \"../AttemptBadge.jsx\";\nimport FeedbackPanel from \"../../ui/FeedbackPanel.jsx\";\nimport ButtonGroup from \"../../ui/ButtonGroup.jsx\";\nimport \"./Activities.css\";\n\nexport default function MatchingActivity({ segment, onBack, onComplete, onAttempt, attemptStats, isTeacher }) {\n  const options = useMemo(() => shuffle(segment.pairs.map((pair) => pair.example)), [segment.pairs]);\n  const [answers, setAnswers] = useState(() => segment.pairs.map(() => ({ selection: \"\" })));\n  const [feedback, setFeedback] = useState(null);\n  const [resolved, setResolved] = useState(false);\n\n  const handleSubmit = () => {\n    if (resolved) return;\n    const allAnswered = answers.every((answer) => answer.selection);\n    if (!allAnswered) {\n      setFeedback({ tone: \"error\", message: \"Select an example for each term.\" });\n      return;\n    }\n    const correctCount = answers.filter((answer, index) => answer.selection === segment.pairs[index].example).length;\n    const passed = correctCount === segment.pairs.length;\n    setFeedback({\n      tone: passed ? \"success\" : \"error\",\n      message: passed ? \"Perfect match!\" : \"Something is mismatchedâ€”check the hints.\",\n    });\n    onAttempt(segment.id, {\n      success: passed,\n      correctCount,\n      totalCount: segment.pairs.length,\n      onAdvance: passed\n        ? () => {\n            setResolved(true);\n            onComplete();\n          }\n        : null,\n    });\n    if (passed) {\n      setResolved(true);\n    }\n  };\n\n  return (\n    <article className=\"gamified-card\">\n      <header>\n        <h3>{segment.heading}</h3>\n        <AttemptBadge attemptStats={attemptStats} />\n        {segment.instructions && <p>{segment.instructions}</p>}\n      </header>\n      <div className=\"activity-matching\">\n        {segment.pairs.map((pair, index) => (\n          <label key={pair.term} className=\"activity-matching__row\">\n            <span className=\"activity-matching__term\">{pair.term}</span>\n            <select\n              value={answers[index].selection}\n              disabled={resolved && !isTeacher}\n              onChange={(event) => {\n                const value = event.target.value;\n                setAnswers((prev) => {\n                  const next = [...prev];\n                  next[index] = { selection: value };\n                  return next;\n                });\n                setFeedback(null);\n              }}\n            >\n              <option value=\"\">Select exampleâ€¦</option>\n              {options.map((option) => (\n                <option key={option} value={option}>\n                  {option}\n                </option>\n              ))}\n            </select>\n          </label>\n        ))}\n      </div>\n      <div className=\"gamified-segment-nav\">\n        {onBack ? (\n          <button type=\"button\" className=\"btn btn--ghost\" onClick={onBack}>\n            Back\n          </button>\n        ) : (\n          <span />\n        )}\n        <ButtonGroup align=\"end\">\n          <button type=\"button\" className=\"btn btn--primary\" onClick={handleSubmit} disabled={resolved && !isTeacher}>\n            Check answers\n          </button>\n        </ButtonGroup>\n      </div>\n      {feedback && (\n        <FeedbackPanel tone={feedback.tone === \"error\" ? \"error\" : \"success\"}>\n          {feedback.message}\n        </FeedbackPanel>\n      )}\n    </article>\n  );\n}\n\n","import { useEffect, useMemo, useState } from \"react\";\nimport { shuffle } from \"../../../utils/array.js\";\nimport AttemptBadge from \"../AttemptBadge.jsx\";\nimport FeedbackPanel from \"../../ui/FeedbackPanel.jsx\";\nimport ButtonGroup from \"../../ui/ButtonGroup.jsx\";\nimport \"./Activities.css\";\n\nexport default function OrderingActivity({ segment, onBack, onComplete, onAttempt, attemptStats, isTeacher }) {\n  const baseItems = useMemo(\n    () =>\n      (segment.items ?? []).map((text, index) => ({\n        id: `${segment.id}-${index}`,\n        text,\n        correctIndex: index,\n      })),\n    [segment.id, segment.items],\n  );\n\n  const [cards, setCards] = useState(() => shuffle(baseItems));\n  const [draggingId, setDraggingId] = useState(null);\n  const [dragOverId, setDragOverId] = useState(null);\n  const [resolved, setResolved] = useState(false);\n  const [feedback, setFeedback] = useState(null);\n\n  useEffect(() => {\n    setCards(shuffle(baseItems));\n    setResolved(false);\n    setFeedback(null);\n  }, [baseItems]);\n\n  const moveCard = (sourceId, targetId) => {\n    if (sourceId === targetId) return;\n    setCards((prev) => {\n      const next = [...prev];\n      const fromIndex = next.findIndex((card) => card.id === sourceId);\n      const toIndex = next.findIndex((card) => card.id === targetId);\n      if (fromIndex === -1 || toIndex === -1) {\n        return prev;\n      }\n      const [moved] = next.splice(fromIndex, 1);\n      next.splice(toIndex, 0, moved);\n      return next;\n    });\n    setFeedback(null);\n  };\n\n  const moveToEnd = (sourceId) => {\n    setCards((prev) => {\n      const next = [...prev];\n      const fromIndex = next.findIndex((card) => card.id === sourceId);\n      if (fromIndex === -1) return prev;\n      const [moved] = next.splice(fromIndex, 1);\n      next.push(moved);\n      return next;\n    });\n    setFeedback(null);\n  };\n\n  const moveByOffset = (index, delta) => {\n    const targetIndex = index + delta;\n    if (targetIndex < 0 || targetIndex >= cards.length) return;\n    setCards((prev) => {\n      const next = [...prev];\n      const [moved] = next.splice(index, 1);\n      next.splice(targetIndex, 0, moved);\n      return next;\n    });\n    setFeedback(null);\n  };\n\n  const handleSubmit = () => {\n    if (resolved) return;\n    const correctCount = cards.filter((card, index) => card.correctIndex === index).length;\n    const passed = correctCount === cards.length;\n    setFeedback({\n      tone: passed ? \"success\" : \"error\",\n      message: passed ? \"Sequence locked in!\" : \"Some steps are out of order.\",\n    });\n    onAttempt(segment.id, {\n      success: passed,\n      correctCount,\n      totalCount: cards.length,\n      onAdvance: passed\n        ? () => {\n            setResolved(true);\n            onComplete();\n          }\n        : null,\n    });\n    if (passed) {\n      setResolved(true);\n    }\n  };\n\n  return (\n    <article className=\"gamified-card\">\n      <header>\n        <h3>{segment.heading}</h3>\n        <AttemptBadge attemptStats={attemptStats} />\n        {segment.instructions && <p>{segment.instructions}</p>}\n      </header>\n      <div className=\"activity-ordering\">\n        <p className=\"activity-ordering__hint\">\n          Drag and drop each card into the correct sequence. Use the arrow buttons if you prefer keyboard controls.\n        </p>\n        <ul className=\"activity-ordering__list\">\n          {cards.map((card, index) => {\n            const isCorrectSpot = card.correctIndex === index;\n            const isDropTarget = dragOverId === card.id && draggingId !== card.id;\n            const allowInteraction = !resolved || isTeacher;\n            return (\n              <li\n                key={card.id}\n                className={`activity-ordering__card${resolved ? (isCorrectSpot ? \" is-correct\" : \" is-incorrect\") : \"\"}${\n                  isDropTarget ? \" is-drop-target\" : \"\"\n                }`}\n                draggable={allowInteraction}\n                onDragStart={() => allowInteraction && setDraggingId(card.id)}\n                onDragEnter={() => allowInteraction && draggingId && setDragOverId(card.id)}\n                onDragOver={(event) => {\n                  if (!allowInteraction) return;\n                  event.preventDefault();\n                  if (draggingId && card.id !== draggingId) {\n                    setDragOverId(card.id);\n                  }\n                }}\n                onDragEnd={() => {\n                  setDraggingId(null);\n                  setDragOverId(null);\n                }}\n                onDrop={(event) => {\n                  if (!allowInteraction) return;\n                  event.preventDefault();\n                  if (draggingId) {\n                    moveCard(draggingId, card.id);\n                  }\n                  setDraggingId(null);\n                  setDragOverId(null);\n                }}\n              >\n                <span className=\"activity-ordering__index\">{index + 1}</span>\n                <span className=\"activity-ordering__text\">{card.text}</span>\n                <div className=\"activity-ordering__actions\">\n                  <button\n                    type=\"button\"\n                    className=\"activity-ordering__action\"\n                    onClick={() => moveByOffset(index, -1)}\n                    disabled={!allowInteraction || index === 0}\n                    aria-label={`Move \"${card.text}\" up`}\n                  >\n                    â†‘\n                  </button>\n                  <button\n                    type=\"button\"\n                    className=\"activity-ordering__action\"\n                    onClick={() => moveByOffset(index, 1)}\n                    disabled={!allowInteraction || index === cards.length - 1}\n                    aria-label={`Move \"${card.text}\" down`}\n                  >\n                    â†“\n                  </button>\n                </div>\n              </li>\n            );\n          })}\n          {draggingId && (\n            <li\n              className={`activity-ordering__dropzone${dragOverId === \"end\" ? \" is-drop-target\" : \"\"}`}\n              onDragOver={(event) => {\n                event.preventDefault();\n                if (draggingId) {\n                  setDragOverId(\"end\");\n                }\n              }}\n              onDragEnter={() => setDragOverId(\"end\")}\n              onDrop={(event) => {\n                event.preventDefault();\n                if (draggingId) {\n                  moveToEnd(draggingId);\n                }\n                setDraggingId(null);\n                setDragOverId(null);\n              }}\n            >\n              Drop here to move to the end\n            </li>\n          )}\n        </ul>\n      </div>\n      <div className=\"gamified-segment-nav\">\n        {onBack ? (\n          <button type=\"button\" className=\"btn btn--ghost\" onClick={onBack}>\n            Back\n          </button>\n        ) : (\n          <span />\n        )}\n        <ButtonGroup align=\"end\">\n          <button type=\"button\" className=\"btn btn--primary\" onClick={handleSubmit} disabled={resolved && !isTeacher}>\n            Check order\n          </button>\n        </ButtonGroup>\n      </div>\n      {feedback && (\n        <FeedbackPanel tone={feedback.tone === \"error\" ? \"error\" : \"success\"}>\n          {feedback.message}\n        </FeedbackPanel>\n      )}\n    </article>\n  );\n}\n","import { useState } from \"react\";\nimport AttemptBadge from \"../AttemptBadge.jsx\";\nimport FeedbackPanel from \"../../ui/FeedbackPanel.jsx\";\nimport ButtonGroup from \"../../ui/ButtonGroup.jsx\";\nimport \"./Activities.css\";\n\nexport default function DragDropActivity({ segment, onBack, onComplete, onAttempt, attemptStats, isTeacher }) {\n  const [assignments, setAssignments] = useState(() => {\n    return segment.targets.map((target) => ({\n      targetId: target.id,\n      tokenId: null,\n    }));\n  });\n  const [selectedToken, setSelectedToken] = useState(null);\n  const [resolved, setResolved] = useState(false);\n  const [feedback, setFeedback] = useState(null);\n\n  const assignedTokenIds = assignments.map((entry) => entry.tokenId).filter(Boolean);\n\n  const handleAssign = (targetId) => {\n    if (!selectedToken) return;\n    setAssignments((prev) =>\n      prev.map((entry) => {\n        if (entry.targetId === targetId) {\n          return { ...entry, tokenId: selectedToken };\n        }\n        if (entry.tokenId === selectedToken) {\n          return { ...entry, tokenId: null };\n        }\n        return entry;\n      }),\n    );\n    setSelectedToken(null);\n    setFeedback(null);\n  };\n\n  const handleSubmit = () => {\n    if (resolved) return;\n    const incomplete = assignments.some((entry) => !entry.tokenId);\n    if (incomplete) {\n      setFeedback({ tone: \"error\", message: \"Place every token on a target.\" });\n      return;\n    }\n    let correctCount = 0;\n    const targetMap = new Map(assignments.map((entry) => [entry.targetId, entry.tokenId]));\n    segment.targets.forEach((target) => {\n      if (target.answer === targetMap.get(target.id)) {\n        correctCount += 1;\n      }\n    });\n    const passed = correctCount === segment.targets.length;\n    setFeedback({\n      tone: passed ? \"success\" : \"error\",\n      message: passed ? \"All targets matched!\" : \"Check the highlighted tokens and retry.\",\n    });\n    onAttempt(segment.id, {\n      success: passed,\n      correctCount,\n      totalCount: segment.targets.length,\n      onAdvance: passed\n        ? () => {\n            setResolved(true);\n            onComplete();\n          }\n        : null,\n    });\n    if (passed) {\n      setResolved(true);\n    }\n  };\n\n  return (\n    <article className=\"gamified-card\">\n      <header>\n        <h3>{segment.heading}</h3>\n        <AttemptBadge attemptStats={attemptStats} />\n        {segment.instructions && <p>{segment.instructions}</p>}\n      </header>\n      <div className=\"activity-dragdrop\">\n        <div className=\"activity-dragdrop__bank\" aria-label=\"Token bank\">\n          {segment.tokens.map((token) => {\n            const picked = assignedTokenIds.includes(token.id);\n            return (\n              <button\n                type=\"button\"\n                key={token.id}\n                className={`activity-dragdrop__token${picked ? \" is-picked\" : \"\"}${\n                  selectedToken === token.id ? \" is-selected\" : \"\"\n                }`}\n                onClick={() => {\n                  if (picked) {\n                    setAssignments((prev) =>\n                      prev.map((entry) =>\n                        entry.tokenId === token.id ? { ...entry, tokenId: null } : entry,\n                      ),\n                    );\n                    setFeedback(null);\n                    return;\n                  }\n                  setSelectedToken((prev) => (prev === token.id ? null : token.id));\n                }}\n              >\n                {token.label}\n              </button>\n            );\n          })}\n        </div>\n\n        <div className=\"activity-dragdrop__targets\">\n          {segment.targets.map((target) => {\n            const assignment = assignments.find((entry) => entry.targetId === target.id);\n            const assignedToken = segment.tokens.find((token) => token.id === assignment?.tokenId);\n            const isCorrect = assignedToken?.id === target.answer;\n            return (\n              <button\n                type=\"button\"\n                key={target.id}\n                className={`activity-dragdrop__target${\n                  assignment?.tokenId ? \" is-filled\" : \"\"\n                }${resolved ? (isCorrect ? \" is-correct\" : \" is-incorrect\") : \"\"}`}\n                onClick={() => handleAssign(target.id)}\n                disabled={resolved && !isTeacher}\n              >\n                <div>\n                  <strong>{target.prompt}</strong>\n                  <div>{assignedToken ? assignedToken.label : \"Tap to assign\"}</div>\n                </div>\n              </button>\n            );\n          })}\n        </div>\n      </div>\n      <div className=\"gamified-segment-nav\">\n        {onBack ? (\n          <button type=\"button\" className=\"btn btn--ghost\" onClick={onBack}>\n            Back\n          </button>\n        ) : (\n          <span />\n        )}\n        <ButtonGroup align=\"end\">\n          <button type=\"button\" className=\"btn btn--primary\" onClick={handleSubmit} disabled={resolved && !isTeacher}>\n            Check matches\n          </button>\n        </ButtonGroup>\n      </div>\n      {feedback && (\n        <FeedbackPanel tone={feedback.tone === \"error\" ? \"error\" : \"success\"}>\n          {feedback.message}\n        </FeedbackPanel>\n      )}\n    </article>\n  );\n}\n\n","import { Fragment, useEffect, useMemo, useState } from \"react\";\nimport AttemptBadge from \"../AttemptBadge.jsx\";\nimport FeedbackPanel from \"../../ui/FeedbackPanel.jsx\";\nimport ButtonGroup from \"../../ui/ButtonGroup.jsx\";\nimport \"./Activities.css\";\n\nconst PLACEHOLDER_REGEX = /\\[\\[([^[\\]]+)\\]\\]/g;\n\nexport default function GapFillActivity({ segment, onBack, onComplete, onAttempt, attemptStats, isTeacher }) {\n  const blanks = useMemo(() => segment.blanks ?? [], [segment.blanks]);\n  const [responses, setResponses] = useState({});\n  const [assignments, setAssignments] = useState(() => {\n    return blanks.reduce((acc, blank) => {\n      acc[blank.id] = null;\n      return acc;\n    }, {});\n  });\n  const [pendingToken, setPendingToken] = useState(null);\n  const [draggingToken, setDraggingToken] = useState(null);\n  const [resolved, setResolved] = useState(false);\n  const [feedback, setFeedback] = useState(null);\n\n  const parts = useMemo(() => {\n    const chunks = [];\n    let lastIndex = 0;\n    const text = segment.text ?? \"\";\n    text.replace(PLACEHOLDER_REGEX, (match, placeholderId, index) => {\n      if (index > lastIndex) {\n        chunks.push({ type: \"text\", value: text.slice(lastIndex, index) });\n      }\n      chunks.push({ type: \"blank\", id: placeholderId });\n      lastIndex = index + match.length;\n      return match;\n    });\n    if (lastIndex < text.length) {\n      chunks.push({ type: \"text\", value: text.slice(lastIndex) });\n    }\n    return chunks;\n  }, [segment.text]);\n\n  const interactionMode = segment.interaction ?? segment.mode ?? \"select\";\n  const useTokenMode = interactionMode === \"drag\" || interactionMode === \"tokens\";\n  const tokens = useMemo(() => {\n    if (!useTokenMode) return [];\n    if (Array.isArray(segment.tokens) && segment.tokens.length > 0) {\n      return segment.tokens;\n    }\n    const unique = new Map();\n    blanks.forEach((blank) => {\n      (blank.options ?? []).forEach((option) => {\n        const id = typeof option === \"string\" ? option : option.id;\n        const label = typeof option === \"string\" ? option : option.label;\n        if (id && !unique.has(id)) {\n          unique.set(id, label ?? id);\n        }\n      });\n    });\n    return Array.from(unique.entries()).map(([id, label]) => ({ id, label }));\n  }, [blanks, segment.tokens, useTokenMode]);\n\n  const assignedTokenIds = useMemo(() => {\n    return new Set(Object.values(assignments || {}).filter(Boolean));\n  }, [assignments]);\n\n  const allowInteraction = !resolved || isTeacher;\n\n  useEffect(() => {\n    setResponses({});\n    setAssignments(\n      blanks.reduce((acc, blank) => {\n        acc[blank.id] = null;\n        return acc;\n      }, {}),\n    );\n    setPendingToken(null);\n    setDraggingToken(null);\n    setResolved(false);\n    setFeedback(null);\n  }, [blanks, useTokenMode, segment.text]);\n\n  const activateToken = (tokenId) => {\n    if (!allowInteraction) return;\n    if (assignedTokenIds.has(tokenId)) {\n      setAssignments((prev) => {\n        const next = { ...prev };\n        Object.keys(next).forEach((blankId) => {\n          if (next[blankId] === tokenId) {\n            next[blankId] = null;\n          }\n        });\n        return next;\n      });\n      setPendingToken(null);\n      setFeedback(null);\n      return;\n    }\n    setPendingToken((prev) => (prev === tokenId ? null : tokenId));\n    setFeedback(null);\n  };\n\n  const assignTokenToBlank = (blankId, tokenId) => {\n    if (!allowInteraction || !tokenId) return;\n    setAssignments((prev) => {\n      const next = { ...prev };\n      Object.keys(next).forEach((key) => {\n        if (next[key] === tokenId) {\n          next[key] = null;\n        }\n      });\n      next[blankId] = tokenId;\n      return next;\n    });\n    setPendingToken(null);\n    setFeedback(null);\n  };\n\n  const clearBlank = (blankId) => {\n    setAssignments((prev) => {\n      const next = { ...prev };\n      next[blankId] = null;\n      return next;\n    });\n    setFeedback(null);\n  };\n\n  const handleSubmit = () => {\n    if (resolved) return;\n    let correctCount = 0;\n\n    if (useTokenMode) {\n      const missing = blanks.some((blank) => !assignments[blank.id]);\n      if (missing) {\n        setFeedback({ tone: \"error\", message: \"Place every token before checking.\" });\n        return;\n      }\n      blanks.forEach((blank) => {\n        if (assignments[blank.id] === blank.answer) {\n          correctCount += 1;\n        }\n      });\n    } else {\n      const missing = blanks.some((blank) => !responses[blank.id]);\n      if (missing) {\n        setFeedback({ tone: \"error\", message: \"Fill every blank before checking.\" });\n        return;\n      }\n      blanks.forEach((blank) => {\n        if (responses[blank.id] === blank.answer) {\n          correctCount += 1;\n        }\n      });\n    }\n\n    const passed = correctCount === blanks.length;\n    setFeedback({\n      tone: passed ? \"success\" : \"error\",\n      message: passed ? \"Sentence complete!\" : \"Check the highlighted blanks and try again.\",\n    });\n    onAttempt(segment.id, {\n      success: passed,\n      correctCount,\n      totalCount: blanks.length,\n      onAdvance: passed\n        ? () => {\n            setResolved(true);\n            onComplete();\n          }\n        : null,\n    });\n    if (passed) {\n      setResolved(true);\n    }\n  };\n\n  return (\n    <article className=\"gamified-card\">\n      <header>\n        <h3>{segment.heading}</h3>\n        <AttemptBadge attemptStats={attemptStats} />\n        {segment.instructions && <p>{segment.instructions}</p>}\n      </header>\n      <div className={`activity-gapfill${useTokenMode ? \" activity-gapfill--tokens\" : \"\"}`}>\n        {useTokenMode && (\n          <div className=\"activity-gapfill__bank\" aria-label=\"Word bank\">\n            {tokens.map((token) => {\n              const isAssigned = assignedTokenIds.has(token.id);\n              const isSelected = pendingToken === token.id || draggingToken === token.id;\n              return (\n                <button\n                  key={token.id}\n                  type=\"button\"\n                  className={`activity-gapfill__token${isAssigned ? \" is-assigned\" : \"\"}${isSelected ? \" is-selected\" : \"\"}`}\n                  disabled={resolved && !isTeacher}\n                  onClick={() => activateToken(token.id)}\n                  draggable={allowInteraction && !isAssigned}\n                  onDragStart={(event) => {\n                    if (!allowInteraction || isAssigned) return;\n                    event.dataTransfer.setData(\"text/plain\", token.id);\n                    event.dataTransfer.effectAllowed = \"move\";\n                    setPendingToken(token.id);\n                    setDraggingToken(token.id);\n                  }}\n                  onDragEnd={() => {\n                    setDraggingToken(null);\n                    setPendingToken(null);\n                  }}\n                >\n                  {token.label}\n                </button>\n              );\n            })}\n          </div>\n        )}\n        <p className=\"activity-gapfill__text\">\n          {parts.map((part, index) => {\n            if (part.type === \"text\") {\n              return <Fragment key={`text-${index}`}>{part.value}</Fragment>;\n            }\n            const blank = blanks.find((entry) => entry.id === part.id) ?? { id: part.id, options: [] };\n            if (!blank) return null;\n\n            if (useTokenMode) {\n              const assignedId = assignments[blank.id];\n              const assignedToken = tokens.find((token) => token.id === assignedId);\n              const isCorrect = resolved && assignedToken?.id === blank.answer;\n              const isIncorrect = resolved && assignedToken && assignedToken.id !== blank.answer;\n              return (\n                <span\n                  key={blank.id}\n                  className={`activity-gapfill__blank activity-gapfill__blank--drop${\n                    isCorrect ? \" is-correct\" : \"\"\n                  }${isIncorrect ? \" is-incorrect\" : \"\"}`}\n                >\n                  <button\n                    type=\"button\"\n                    className=\"activity-gapfill__drop\"\n                    disabled={resolved && !isTeacher}\n                    onClick={() => {\n                      if (pendingToken) {\n                        assignTokenToBlank(blank.id, pendingToken);\n                      } else if (assignedId) {\n                        clearBlank(blank.id);\n                      }\n                    }}\n                    onDragOver={(event) => {\n                      if (!allowInteraction) return;\n                      event.preventDefault();\n                    }}\n                    onDrop={(event) => {\n                      if (!allowInteraction) return;\n                      event.preventDefault();\n                      const tokenId = event.dataTransfer.getData(\"text/plain\") || pendingToken;\n                      assignTokenToBlank(blank.id, tokenId);\n                      setDraggingToken(null);\n                    }}\n                  >\n                    {assignedToken ? assignedToken.label : \"Drop word\"}\n                  </button>\n                </span>\n              );\n            }\n\n            const selected = responses[blank.id] ?? \"\";\n            const isCorrect = resolved && selected === blank.answer;\n            const isIncorrect = resolved && selected && selected !== blank.answer;\n            return (\n              <span\n                key={blank.id}\n                className={`activity-gapfill__blank${isCorrect ? \" is-correct\" : \"\"}${isIncorrect ? \" is-incorrect\" : \"\"}`}\n              >\n                <select\n                  value={selected}\n                  disabled={resolved && !isTeacher}\n                  onChange={(event) => {\n                    setResponses((prev) => ({ ...prev, [blank.id]: event.target.value }));\n                    setFeedback(null);\n                  }}\n                >\n                  <option value=\"\">Selectâ€¦</option>\n                  {(blank.options ?? []).map((option) => (\n                    <option key={option.id} value={option.id}>\n                      {option.label}\n                    </option>\n                  ))}\n                </select>\n              </span>\n            );\n          })}\n        </p>\n      </div>\n      <div className=\"gamified-segment-nav\">\n        {onBack ? (\n          <button type=\"button\" className=\"btn btn--ghost\" onClick={onBack}>\n            Back\n          </button>\n        ) : (\n          <span />\n        )}\n        <ButtonGroup align=\"end\">\n          <button type=\"button\" className=\"btn btn--primary\" onClick={handleSubmit} disabled={resolved && !isTeacher}>\n            Check sentence\n          </button>\n        </ButtonGroup>\n      </div>\n      {feedback && (\n        <FeedbackPanel tone={feedback.tone === \"error\" ? \"error\" : \"success\"}>\n          {feedback.message}\n        </FeedbackPanel>\n      )}\n    </article>\n  );\n}\n","import { useState } from \"react\";\nimport AttemptBadge from \"../AttemptBadge.jsx\";\nimport FeedbackPanel from \"../../ui/FeedbackPanel.jsx\";\nimport ButtonGroup from \"../../ui/ButtonGroup.jsx\";\nimport \"./Activities.css\";\n\nexport default function ImageHotspotActivity({ segment, onBack, onComplete, onAttempt, attemptStats, isTeacher }) {\n  const [selected, setSelected] = useState([]);\n  const [resolved, setResolved] = useState(false);\n  const [feedback, setFeedback] = useState(null);\n\n  const toggleHotspot = (id) => {\n    if (resolved && !isTeacher) return;\n    setSelected((prev) => {\n      if (prev.includes(id)) {\n        return prev.filter((value) => value !== id);\n      }\n      return [...prev, id];\n    });\n    setFeedback(null);\n  };\n\n  const handleSubmit = () => {\n    const correctSet = new Set(segment.correctHotspots ?? []);\n    const selectedSet = new Set(selected);\n    let correctCount = 0;\n    segment.hotspots.forEach((hotspot) => {\n      const shouldSelect = correctSet.has(hotspot.id);\n      const didSelect = selectedSet.has(hotspot.id);\n      if (shouldSelect === didSelect) {\n        correctCount += 1;\n      }\n    });\n    const passed = correctCount === segment.hotspots.length;\n    setFeedback({\n      tone: passed ? \"success\" : \"error\",\n      message: passed ? \"Hotspots identified!\" : \"Check the highlighted hotspots and retry.\",\n    });\n    onAttempt(segment.id, {\n      success: passed,\n      correctCount: passed ? segment.hotspots.length : correctCount,\n      totalCount: segment.hotspots.length,\n      onAdvance: passed\n        ? () => {\n            setResolved(true);\n            onComplete();\n          }\n        : null,\n    });\n    if (passed) {\n      setResolved(true);\n    }\n  };\n\n  return (\n    <article className=\"gamified-card\">\n      <header>\n        <h3>{segment.heading}</h3>\n        <AttemptBadge attemptStats={attemptStats} />\n        {segment.instructions && <p>{segment.instructions}</p>}\n      </header>\n      <div className=\"activity-hotspot\">\n        <img src={segment.image?.src} alt={segment.image?.alt ?? \"\"} />\n        {segment.hotspots.map((hotspot, index) => {\n          const isSelected = selected.includes(hotspot.id);\n          const shouldSelect = (segment.correctHotspots ?? []).includes(hotspot.id);\n          const className = [\n            \"activity-hotspot__point\",\n            isSelected ? \"is-selected\" : \"\",\n            resolved && isSelected && !shouldSelect ? \"is-incorrect\" : \"\",\n          ]\n            .filter(Boolean)\n            .join(\" \");\n          return (\n            <button\n              type=\"button\"\n              key={hotspot.id}\n              className={className}\n              style={{\n                '--hotspot-x': `${hotspot.x}%`,\n                '--hotspot-y': `${hotspot.y}%`,\n              }}\n              onClick={() => toggleHotspot(hotspot.id)}\n            >\n              {index + 1}\n            </button>\n          );\n        })}\n      </div>\n      <div className=\"gamified-segment-nav\">\n        {onBack ? (\n          <button type=\"button\" className=\"btn btn--ghost\" onClick={onBack}>\n            Back\n          </button>\n        ) : (\n          <span />\n        )}\n        <ButtonGroup align=\"end\">\n          <button type=\"button\" className=\"btn btn--primary\" onClick={handleSubmit} disabled={resolved && !isTeacher}>\n            Check hotspots\n          </button>\n        </ButtonGroup>\n      </div>\n      {feedback && (\n        <FeedbackPanel tone={feedback.tone === \"error\" ? \"error\" : \"success\"}>\n          {feedback.message}\n        </FeedbackPanel>\n      )}\n    </article>\n  );\n}\n\n","import { useState } from \"react\";\nimport AttemptBadge from \"../AttemptBadge.jsx\";\nimport FeedbackPanel from \"../../ui/FeedbackPanel.jsx\";\nimport ButtonGroup from \"../../ui/ButtonGroup.jsx\";\nimport \"./Activities.css\";\n\nexport default function PlannerActivity({\n  segment,\n  onComplete,\n  onBack,\n  plannerValues = {},\n  onPlannerSave,\n  isTeacher,\n  attemptStats,\n  onAttempt,\n}) {\n  const panels = segment.panels ?? [];\n  const [feedback, setFeedback] = useState(null);\n  const [locked, setLocked] = useState(() =>\n    panels.every((panel) => {\n      const value = plannerValues[panel.id];\n      return typeof value === \"string\" && value.trim().length > 0;\n    }),\n  );\n\n  const handleChange = (panelId, value) => {\n    onPlannerSave?.(panelId, value);\n    setFeedback(null);\n  };\n\n  const submitSuccess = () => {\n    const total = panels.length || 1;\n    setLocked(true);\n    onAttempt?.(segment.id, {\n      success: true,\n      correctCount: total,\n      totalCount: total,\n      onAdvance: () => {\n        onComplete();\n      },\n    });\n  };\n\n  const handleSubmit = (event) => {\n    event.preventDefault();\n    const allFilled = panels.every((panel) => {\n      const value = plannerValues[panel.id];\n      return typeof value === \"string\" && value.trim().length > 0;\n    });\n    if (!allFilled) {\n      setFeedback({ tone: \"error\", message: \"Complete every panel before locking the planner.\" });\n      return;\n    }\n    submitSuccess();\n  };\n\n  const handleTeacherComplete = () => {\n    submitSuccess();\n  };\n\n  return (\n    <article className=\"gamified-card\">\n      <header>\n        <h3>{segment.heading}</h3>\n        {segment.instructions && <p>{segment.instructions}</p>}\n        <AttemptBadge attemptStats={attemptStats} />\n      </header>\n      <form className=\"activity-planner\" onSubmit={handleSubmit}>\n        {panels.map((panel) => (\n          <label key={panel.id} className=\"activity-planner__panel\">\n            <span>{panel.label}</span>\n            <textarea\n              value={plannerValues[panel.id] ?? \"\"}\n              onChange={(event) => handleChange(panel.id, event.target.value)}\n              rows={4}\n              disabled={locked && !isTeacher}\n            />\n          </label>\n        ))}\n        <div className=\"gamified-segment-nav\">\n          {onBack ? (\n            <button type=\"button\" className=\"btn btn--ghost\" onClick={onBack}>\n              Back\n            </button>\n          ) : (\n            <span />\n          )}\n          <ButtonGroup align=\"end\">\n            {isTeacher && (\n              <button type=\"button\" className=\"btn btn--outline\" onClick={handleTeacherComplete}>\n                Mark complete\n              </button>\n            )}\n            {!locked && (\n              <button type=\"submit\" className=\"btn btn--primary\" disabled={locked && !isTeacher}>\n                Lock planner\n              </button>\n            )}\n          </ButtonGroup>\n        </div>\n        {feedback && (\n          <FeedbackPanel tone={feedback.tone === \"error\" ? \"error\" : \"success\"}>\n            {feedback.message}\n          </FeedbackPanel>\n        )}\n      </form>\n    </article>\n  );\n}\n\n\n","import { useEffect, useMemo, useState } from \"react\";\nimport AttemptBadge from \"../AttemptBadge.jsx\";\nimport FeedbackPanel from \"../../ui/FeedbackPanel.jsx\";\nimport ButtonGroup from \"../../ui/ButtonGroup.jsx\";\nimport \"./Activities.css\";\n\nexport default function ClassificationActivity({\n  segment,\n  onBack,\n  onComplete,\n  onAttempt,\n  attemptStats,\n  isTeacher,\n}) {\n  const categories = useMemo(() => segment.categories ?? [], [segment.categories]);\n  const tokens = useMemo(() => segment.tokens ?? [], [segment.tokens]);\n  const [assignments, setAssignments] = useState(() =>\n    tokens.reduce((acc, token) => {\n      acc[token.id] = null;\n      return acc;\n    }, {}),\n  );\n  const [pendingToken, setPendingToken] = useState(null);\n  const [draggingToken, setDraggingToken] = useState(null);\n  const [resolved, setResolved] = useState(false);\n  const [feedback, setFeedback] = useState(null);\n\n  useEffect(() => {\n    setAssignments(\n      tokens.reduce((acc, token) => {\n        acc[token.id] = null;\n        return acc;\n      }, {}),\n    );\n    setPendingToken(null);\n    setDraggingToken(null);\n    setResolved(false);\n    setFeedback(null);\n  }, [tokens, categories, segment.id]);\n\n  const allowInteraction = !resolved || isTeacher;\n  const placedTokenIds = useMemo(() => new Set(Object.keys(assignments).filter((id) => assignments[id])), [assignments]);\n\n  const unplacedTokens = tokens.filter((token) => !placedTokenIds.has(token.id));\n\n  const assignToken = (tokenId, categoryId) => {\n    if (!allowInteraction || !tokenId) return;\n    setAssignments((prev) => ({\n      ...prev,\n      [tokenId]: categoryId,\n    }));\n    setPendingToken(null);\n    setFeedback(null);\n  };\n\n  const removeToken = (tokenId) => {\n    setAssignments((prev) => ({\n      ...prev,\n      [tokenId]: null,\n    }));\n    setPendingToken(null);\n    setFeedback(null);\n  };\n\n  const handleSubmit = () => {\n    if (resolved) return;\n    const total = tokens.length;\n    const missing = tokens.some((token) => !assignments[token.id]);\n    if (missing) {\n      setFeedback({ tone: \"error\", message: \"Classify every card before checking.\" });\n      return;\n    }\n    let correctCount = 0;\n    tokens.forEach((token) => {\n      if (assignments[token.id] === token.answer) {\n        correctCount += 1;\n      }\n    });\n    const passed = correctCount === total;\n    setFeedback({\n      tone: passed ? \"success\" : \"error\",\n      message: passed ? \"Everything is in the right bucket!\" : \"Some cards need to move. Check the highlights.\",\n    });\n    onAttempt(segment.id, {\n      success: passed,\n      correctCount,\n      totalCount: total,\n      onAdvance: passed\n        ? () => {\n            setResolved(true);\n            onComplete();\n          }\n        : null,\n    });\n    if (passed) {\n      setResolved(true);\n    }\n  };\n\n  const tokensByCategory = useMemo(() => {\n    return categories.reduce((acc, category) => {\n      acc[category.id] = tokens.filter((token) => assignments[token.id] === category.id);\n      return acc;\n    }, {});\n  }, [assignments, categories, tokens]);\n\n  return (\n    <article className=\"gamified-card\">\n      <header>\n        <h3>{segment.heading}</h3>\n        <AttemptBadge attemptStats={attemptStats} />\n        {segment.instructions && <p>{segment.instructions}</p>}\n      </header>\n\n      <div className=\"activity-classification\">\n        <div className=\"activity-classification__bank\" aria-label=\"Token bank\">\n          {unplacedTokens.map((token) => {\n            const isSelected = pendingToken === token.id || draggingToken === token.id;\n            return (\n              <button\n                key={token.id}\n                type=\"button\"\n                className={`activity-classification__token${isSelected ? \" is-selected\" : \"\"}`}\n                disabled={resolved && !isTeacher}\n                onClick={() => {\n                  if (!allowInteraction) return;\n                  setPendingToken((prev) => (prev === token.id ? null : token.id));\n                  setFeedback(null);\n                }}\n                draggable={allowInteraction}\n                onDragStart={(event) => {\n                  if (!allowInteraction) return;\n                  event.dataTransfer.setData(\"text/plain\", token.id);\n                  event.dataTransfer.effectAllowed = \"move\";\n                  setDraggingToken(token.id);\n                  setPendingToken(token.id);\n                }}\n                onDragEnd={() => {\n                  setDraggingToken(null);\n                  setPendingToken(null);\n                }}\n              >\n                {token.label}\n              </button>\n            );\n          })}\n          {unplacedTokens.length === 0 && <span className=\"activity-classification__bank-empty\">All cards placed</span>}\n        </div>\n\n        <div className=\"activity-classification__categories\">\n          {categories.map((category) => {\n            const placed = tokensByCategory[category.id] ?? [];\n            return (\n              <section\n                key={category.id}\n                className=\"activity-classification__category\"\n                onDragOver={(event) => {\n                  if (!allowInteraction) return;\n                  event.preventDefault();\n                }}\n                onDrop={(event) => {\n                  if (!allowInteraction) return;\n                  event.preventDefault();\n                  const tokenId = event.dataTransfer.getData(\"text/plain\") || pendingToken;\n                  assignToken(tokenId, category.id);\n                  setDraggingToken(null);\n                }}\n              >\n                <header>\n                  <h4>{category.title}</h4>\n                  {category.description && <p className=\"muted\">{category.description}</p>}\n                </header>\n                <div className=\"activity-classification__slots\">\n                  {placed.map((token) => {\n                    const isCorrect = resolved && token.answer === category.id;\n                    const isIncorrect = resolved && token.answer !== category.id;\n                    return (\n                      <button\n                        key={token.id}\n                        type=\"button\"\n                        className={`activity-classification__chip${isCorrect ? \" is-correct\" : \"\"}${\n                          isIncorrect ? \" is-incorrect\" : \"\"\n                        }`}\n                        disabled={resolved && !isTeacher}\n                        onClick={() => {\n                          if (!allowInteraction) return;\n                          removeToken(token.id);\n                        }}\n                      >\n                        {token.label}\n                      </button>\n                    );\n                  })}\n                  {placed.length === 0 && <span className=\"activity-classification__placeholder\">Drop cards here</span>}\n                </div>\n              </section>\n            );\n          })}\n        </div>\n      </div>\n\n      <div className=\"gamified-segment-nav\">\n        {onBack ? (\n          <button type=\"button\" className=\"btn btn--ghost\" onClick={onBack}>\n            Back\n          </button>\n        ) : (\n          <span />\n        )}\n        <ButtonGroup align=\"end\">\n          <button type=\"button\" className=\"btn btn--primary\" onClick={handleSubmit} disabled={resolved && !isTeacher}>\n            Check categories\n          </button>\n        </ButtonGroup>\n      </div>\n      {feedback && (\n        <FeedbackPanel tone={feedback.tone === \"error\" ? \"error\" : \"success\"}>\n          {feedback.message}\n        </FeedbackPanel>\n      )}\n    </article>\n  );\n}\n","import { Fragment, useEffect, useMemo, useState } from \"react\";\nimport AttemptBadge from \"../AttemptBadge.jsx\";\nimport FeedbackPanel from \"../../ui/FeedbackPanel.jsx\";\nimport ButtonGroup from \"../../ui/ButtonGroup.jsx\";\nimport \"./Activities.css\";\n\nconst PLACEHOLDER_REGEX = /\\[\\[([^[\\]]+)\\]\\]/g;\n\nexport default function CodeCompletionActivity({\n  segment,\n  onBack,\n  onComplete,\n  onAttempt,\n  attemptStats,\n  isTeacher,\n}) {\n  const [responses, setResponses] = useState({});\n  const [resolved, setResolved] = useState(false);\n  const [feedback, setFeedback] = useState(null);\n\n  const placeholders = useMemo(() => segment.placeholders ?? [], [segment.placeholders]);\n  const placeholderMap = useMemo(() => {\n    return placeholders.reduce((acc, placeholder) => {\n      acc[placeholder.id] = placeholder;\n      return acc;\n    }, {});\n  }, [placeholders]);\n\n  const parts = useMemo(() => {\n    const code = segment.code ?? \"\";\n    const chunks = [];\n    let lastIndex = 0;\n    code.replace(PLACEHOLDER_REGEX, (match, placeholderId, index) => {\n      if (index > lastIndex) {\n        chunks.push({ type: \"code\", value: code.slice(lastIndex, index) });\n      }\n      chunks.push({ type: \"blank\", id: placeholderId });\n      lastIndex = index + match.length;\n      return match;\n    });\n    if (lastIndex < code.length) {\n      chunks.push({ type: \"code\", value: code.slice(lastIndex) });\n    }\n    return chunks;\n  }, [segment.code]);\n\n  useEffect(() => {\n    setResponses({});\n    setResolved(false);\n    setFeedback(null);\n  }, [segment.id, segment.code]);\n\n  const allowInteraction = !resolved || isTeacher;\n\n  const evaluateResponse = (value, placeholder) => {\n    if (!placeholder) return false;\n    const trimmedValue = placeholder.trimInput === false ? value : value.trim();\n    if (placeholder.caseSensitive === false) {\n      return trimmedValue.toLowerCase() === placeholder.answer.toLowerCase();\n    }\n    return trimmedValue === placeholder.answer;\n  };\n\n  const handleSubmit = (event) => {\n    event.preventDefault();\n    if (resolved) return;\n    const total = placeholders.length;\n    const missing = placeholders.some((placeholder) => {\n      const value = responses[placeholder.id];\n      return value === undefined || value === null || value === \"\";\n    });\n    if (missing) {\n      setFeedback({ tone: \"error\", message: \"Fill every placeholder before checking.\" });\n      return;\n    }\n    let correctCount = 0;\n    placeholders.forEach((placeholder) => {\n      if (evaluateResponse(responses[placeholder.id], placeholder)) {\n        correctCount += 1;\n      }\n    });\n    const passed = correctCount === total;\n    setFeedback({\n      tone: passed ? \"success\" : \"error\",\n      message: passed ? \"Code compiled! Every placeholder is correct.\" : \"Review the highlighted slots and retry.\",\n    });\n    onAttempt(segment.id, {\n      success: passed,\n      correctCount,\n      totalCount: total,\n      onAdvance: passed\n        ? () => {\n            setResolved(true);\n            onComplete();\n          }\n        : null,\n    });\n    if (passed) {\n      setResolved(true);\n    }\n  };\n\n  return (\n    <article className=\"gamified-card\">\n      <header>\n        <h3>{segment.heading}</h3>\n        <AttemptBadge attemptStats={attemptStats} />\n        {segment.instructions && <p>{segment.instructions}</p>}\n      </header>\n\n      <form className=\"activity-code\" onSubmit={handleSubmit}>\n        {segment.prompt && <p className=\"activity-code__prompt\">{segment.prompt}</p>}\n        <pre className=\"activity-code__block\">\n          <code>\n            {parts.map((part, index) => {\n              if (part.type === \"code\") {\n                return <Fragment key={`code-${index}`}>{part.value}</Fragment>;\n              }\n              const placeholder = placeholderMap[part.id];\n              if (!placeholder) return null;\n              const value = responses[placeholder.id] ?? \"\";\n              const isCorrect = resolved && evaluateResponse(value, placeholder);\n              const isIncorrect = resolved && !evaluateResponse(value, placeholder);\n              return (\n                <span\n                  key={placeholder.id}\n                  className={`activity-code__blank${isCorrect ? \" is-correct\" : \"\"}${isIncorrect ? \" is-incorrect\" : \"\"}`}\n                >\n                  <input\n                    type=\"text\"\n                    value={value}\n                    disabled={!allowInteraction}\n                    onChange={(event) => {\n                      const nextValue = event.target.value;\n                      setResponses((prev) => ({ ...prev, [placeholder.id]: nextValue }));\n                      setFeedback(null);\n                    }}\n                    placeholder={placeholder.placeholder ?? \"â€¦\"}\n                    aria-label={placeholder.label ?? `Fill placeholder ${placeholder.id}`}\n                  />\n                </span>\n              );\n            })}\n          </code>\n        </pre>\n        {placeholders.some((placeholder) => placeholder.hint) && (\n          <ul className=\"activity-code__hints\">\n            {placeholders.map(\n              (placeholder) =>\n                placeholder.hint && (\n                  <li key={`${placeholder.id}-hint`}>\n                    <strong>{placeholder.label ?? placeholder.id}:</strong> {placeholder.hint}\n                  </li>\n                ),\n            )}\n          </ul>\n        )}\n\n        <div className=\"gamified-segment-nav\">\n          {onBack ? (\n            <button type=\"button\" className=\"btn btn--ghost\" onClick={onBack}>\n              Back\n            </button>\n          ) : (\n            <span />\n          )}\n          <ButtonGroup align=\"end\">\n            <button type=\"submit\" className=\"btn btn--primary\" disabled={resolved && !isTeacher}>\n              Check code\n            </button>\n          </ButtonGroup>\n        </div>\n        {feedback && (\n          <FeedbackPanel tone={feedback.tone === \"error\" ? \"error\" : \"success\"}>\n            {feedback.message}\n          </FeedbackPanel>\n        )}\n      </form>\n    </article>\n  );\n}\n","import { useEffect, useMemo, useState } from \"react\";\nimport AttemptBadge from \"../AttemptBadge.jsx\";\nimport FeedbackPanel from \"../../ui/FeedbackPanel.jsx\";\nimport ButtonGroup from \"../../ui/ButtonGroup.jsx\";\nimport \"./Activities.css\";\n\nexport default function SpotTheErrorActivity({\n  segment,\n  onBack,\n  onComplete,\n  onAttempt,\n  attemptStats,\n  isTeacher,\n}) {\n  const items = useMemo(() => segment.items ?? [], [segment.items]);\n  const [selected, setSelected] = useState(() => new Set());\n  const [resolved, setResolved] = useState(false);\n  const [feedback, setFeedback] = useState(null);\n\n  useEffect(() => {\n    setSelected(new Set());\n    setResolved(false);\n    setFeedback(null);\n  }, [segment.id]);\n\n  const allowInteraction = !resolved || isTeacher;\n  const errorIds = useMemo(() => new Set(items.filter((item) => item.isError).map((item) => item.id)), [items]);\n\n  const toggleItem = (id) => {\n    if (!allowInteraction) return;\n    setSelected((prev) => {\n      const next = new Set(prev);\n      if (next.has(id)) {\n        next.delete(id);\n      } else {\n        next.add(id);\n      }\n      return next;\n    });\n    setFeedback(null);\n  };\n\n  const handleSubmit = () => {\n    if (resolved) return;\n    const total = items.length;\n    const correctSelections = items.filter((item) => {\n      const userSelected = selected.has(item.id);\n      const shouldSelect = Boolean(item.isError);\n      return userSelected === shouldSelect;\n    }).length;\n    const passed = correctSelections === total;\n    setFeedback({\n      tone: passed ? \"success\" : \"error\",\n      message: passed ? \"Bug hunt complete!\" : \"Some choices are off. Review the highlights and try again.\",\n    });\n    onAttempt(segment.id, {\n      success: passed,\n      correctCount: correctSelections,\n      totalCount: total,\n      onAdvance: passed\n        ? () => {\n            setResolved(true);\n            onComplete();\n          }\n        : null,\n    });\n    if (passed) {\n      setResolved(true);\n    }\n  };\n\n  return (\n    <article className=\"gamified-card\">\n      <header>\n        <h3>{segment.heading}</h3>\n        <AttemptBadge attemptStats={attemptStats} />\n        {segment.instructions && <p>{segment.instructions}</p>}\n      </header>\n\n      <div className=\"activity-spot\">\n        {items.map((item, index) => {\n          const userSelected = selected.has(item.id);\n          const shouldSelect = errorIds.has(item.id);\n          const stateClass = resolved\n            ? shouldSelect\n              ? \" is-correct\"\n              : userSelected\n              ? \" is-incorrect\"\n              : \"\"\n            : userSelected\n            ? \" is-selected\"\n            : \"\";\n          return (\n            <button\n              key={item.id}\n              type=\"button\"\n              className={`activity-spot__item${stateClass}`}\n              disabled={!allowInteraction}\n              onClick={() => toggleItem(item.id)}\n            >\n              <span className=\"activity-spot__badge\">{index + 1}</span>\n              <span className=\"activity-spot__text\">{item.text}</span>\n              {resolved && item.explanation && (\n                <span className=\"activity-spot__explanation\">{item.explanation}</span>\n              )}\n            </button>\n          );\n        })}\n      </div>\n\n      <div className=\"gamified-segment-nav\">\n        {onBack ? (\n          <button type=\"button\" className=\"btn btn--ghost\" onClick={onBack}>\n            Back\n          </button>\n        ) : (\n          <span />\n        )}\n        <ButtonGroup align=\"end\">\n          <button type=\"button\" className=\"btn btn--primary\" onClick={handleSubmit} disabled={resolved && !isTeacher}>\n            Check answers\n          </button>\n        </ButtonGroup>\n      </div>\n      {feedback && (\n        <FeedbackPanel tone={feedback.tone === \"error\" ? \"error\" : \"success\"}>\n          {feedback.message}\n        </FeedbackPanel>\n      )}\n    </article>\n  );\n}\n","import { useEffect, useMemo, useState } from \"react\";\nimport AttemptBadge from \"../AttemptBadge.jsx\";\nimport FeedbackPanel from \"../../ui/FeedbackPanel.jsx\";\nimport ButtonGroup from \"../../ui/ButtonGroup.jsx\";\nimport \"./Activities.css\";\n\nexport default function DiagramLabelActivity({\n  segment,\n  onBack,\n  onComplete,\n  onAttempt,\n  attemptStats,\n  isTeacher,\n}) {\n  const tokens = useMemo(() => segment.tokens ?? [], [segment.tokens]);\n  const targets = useMemo(() => segment.targets ?? [], [segment.targets]);\n  const [assignments, setAssignments] = useState(() =>\n    targets.reduce((acc, target) => {\n      acc[target.id] = null;\n      return acc;\n    }, {}),\n  );\n  const [pendingToken, setPendingToken] = useState(null);\n  const [draggingToken, setDraggingToken] = useState(null);\n  const [resolved, setResolved] = useState(false);\n  const [feedback, setFeedback] = useState(null);\n\n  useEffect(() => {\n    setAssignments(\n      targets.reduce((acc, target) => {\n        acc[target.id] = null;\n        return acc;\n      }, {}),\n    );\n    setPendingToken(null);\n    setDraggingToken(null);\n    setResolved(false);\n    setFeedback(null);\n  }, [targets, tokens, segment.id]);\n\n  const allowInteraction = !resolved || isTeacher;\n  const assignedTokenIds = useMemo(() => new Set(Object.values(assignments).filter(Boolean)), [assignments]);\n  const availableTokens = tokens.filter((token) => !assignedTokenIds.has(token.id));\n\n  const assignToTarget = (targetId, tokenId) => {\n    if (!allowInteraction || !tokenId) return;\n    setAssignments((prev) => ({\n      ...prev,\n      [targetId]: tokenId,\n    }));\n    setPendingToken(null);\n    setFeedback(null);\n  };\n\n  const removeFromTarget = (targetId) => {\n    setAssignments((prev) => ({\n      ...prev,\n      [targetId]: null,\n    }));\n    setFeedback(null);\n  };\n\n  const handleSubmit = () => {\n    if (resolved) return;\n    const total = targets.length;\n    const missing = targets.some((target) => !assignments[target.id]);\n    if (missing) {\n      setFeedback({ tone: \"error\", message: \"Label every hotspot before checking.\" });\n      return;\n    }\n    let correctCount = 0;\n    targets.forEach((target) => {\n      if (assignments[target.id] === target.answer) {\n        correctCount += 1;\n      }\n    });\n    const passed = correctCount === total;\n    setFeedback({\n      tone: passed ? \"success\" : \"error\",\n      message: passed ? \"All labels are correct!\" : \"Some labels need adjusting. Review the highlights.\",\n    });\n    onAttempt(segment.id, {\n      success: passed,\n      correctCount,\n      totalCount: total,\n      onAdvance: passed\n        ? () => {\n            setResolved(true);\n            onComplete();\n          }\n        : null,\n    });\n    if (passed) {\n      setResolved(true);\n    }\n  };\n\n  return (\n    <article className=\"gamified-card\">\n      <header>\n        <h3>{segment.heading}</h3>\n        <AttemptBadge attemptStats={attemptStats} />\n        {segment.instructions && <p>{segment.instructions}</p>}\n      </header>\n      <div className=\"activity-diagram\">\n        <div className=\"activity-diagram__bank\" aria-label=\"Label tokens\">\n          {availableTokens.map((token) => {\n            const isSelected = pendingToken === token.id || draggingToken === token.id;\n            return (\n              <button\n                key={token.id}\n                type=\"button\"\n                className={`activity-diagram__token${isSelected ? \" is-selected\" : \"\"}`}\n                disabled={resolved && !isTeacher}\n                onClick={() => {\n                  if (!allowInteraction) return;\n                  setPendingToken((prev) => (prev === token.id ? null : token.id));\n                  setFeedback(null);\n                }}\n                draggable={allowInteraction}\n                onDragStart={(event) => {\n                  if (!allowInteraction) return;\n                  event.dataTransfer.setData(\"text/plain\", token.id);\n                  event.dataTransfer.effectAllowed = \"move\";\n                  setPendingToken(token.id);\n                  setDraggingToken(token.id);\n                }}\n                onDragEnd={() => {\n                  setPendingToken(null);\n                  setDraggingToken(null);\n                }}\n              >\n                {token.label}\n              </button>\n            );\n          })}\n          {availableTokens.length === 0 && (\n            <span className=\"activity-diagram__placeholder\">All labels placed</span>\n          )}\n        </div>\n\n        <div className=\"activity-diagram__canvas\">\n          <img src={segment.image?.src} alt={segment.image?.alt ?? \"\"} />\n          {targets.map((target) => {\n            const tokenId = assignments[target.id];\n            const token = tokens.find((entry) => entry.id === tokenId);\n            const isCorrect = resolved && token?.id === target.answer;\n            const isIncorrect = resolved && token && token.id !== target.answer;\n            return (\n              <button\n                key={target.id}\n                type=\"button\"\n                className={`activity-diagram__target${isCorrect ? \" is-correct\" : \"\"}${\n                  isIncorrect ? \" is-incorrect\" : \"\"\n                }`}\n                style={{\n                  '--target-x': `${target.x}%`,\n                  '--target-y': `${target.y}%`,\n                }}\n                disabled={resolved && !isTeacher}\n                onClick={() => {\n                  if (!allowInteraction) return;\n                  if (pendingToken) {\n                    assignToTarget(target.id, pendingToken);\n                  } else if (tokenId) {\n                    removeFromTarget(target.id);\n                  }\n                }}\n                onDragOver={(event) => {\n                  if (!allowInteraction) return;\n                  event.preventDefault();\n                }}\n                onDrop={(event) => {\n                  if (!allowInteraction) return;\n                  event.preventDefault();\n                  const tokenFromDrag = event.dataTransfer.getData(\"text/plain\") || pendingToken;\n                  assignToTarget(target.id, tokenFromDrag);\n                  setDraggingToken(null);\n                }}\n              >\n                {token ? token.label : \"Drop label\"}\n              </button>\n            );\n          })}\n        </div>\n      </div>\n      <div className=\"gamified-segment-nav\">\n        {onBack ? (\n          <button type=\"button\" className=\"btn btn--ghost\" onClick={onBack}>\n            Back\n          </button>\n        ) : (\n          <span />\n        )}\n        <ButtonGroup align=\"end\">\n          <button type=\"button\" className=\"btn btn--primary\" onClick={handleSubmit} disabled={resolved && !isTeacher}>\n            Check labels\n          </button>\n        </ButtonGroup>\n      </div>\n      {feedback && (\n        <FeedbackPanel tone={feedback.tone === \"error\" ? \"error\" : \"success\"}>\n          {feedback.message}\n        </FeedbackPanel>\n      )}\n    </article>\n  );\n}\n","import MatchingActivity from \"./MatchingActivity.jsx\";\nimport OrderingActivity from \"./OrderingActivity.jsx\";\nimport DragDropActivity from \"./DragDropActivity.jsx\";\nimport GapFillActivity from \"./GapFillActivity.jsx\";\nimport ImageHotspotActivity from \"./ImageHotspotActivity.jsx\";\nimport PlannerActivity from \"./PlannerActivity.jsx\";\nimport ClassificationActivity from \"./ClassificationActivity.jsx\";\nimport CodeCompletionActivity from \"./CodeCompletionActivity.jsx\";\nimport SpotTheErrorActivity from \"./SpotTheErrorActivity.jsx\";\nimport DiagramLabelActivity from \"./DiagramLabelActivity.jsx\";\n\nexport default function ActivitySegment(props) {\n  const { segment } = props;\n  switch (segment.activityType) {\n    case \"matching\":\n      return <MatchingActivity {...props} />;\n    case \"ordering\":\n      return <OrderingActivity {...props} />;\n    case \"drag-drop\":\n      return <DragDropActivity {...props} />;\n    case \"gap-fill\":\n      return <GapFillActivity {...props} />;\n    case \"image-hotspot\":\n      return <ImageHotspotActivity {...props} />;\n    case \"planner\":\n      return <PlannerActivity {...props} />;\n    case \"classification\":\n      return <ClassificationActivity {...props} />;\n    case \"code-completion\":\n      return <CodeCompletionActivity {...props} />;\n    case \"spot-error\":\n      return <SpotTheErrorActivity {...props} />;\n    case \"diagram-label\":\n      return <DiagramLabelActivity {...props} />;\n    default:\n      return (\n        <article className=\"gamified-card\">\n          <header>\n            <h3>{segment.heading}</h3>\n          </header>\n          <p>This activity type is coming soon.</p>\n        </article>\n      );\n  }\n}\n","import \"./Segments.css\";\n\nexport default function SegmentNav({ onBack, onComplete, completeLabel = \"Continue\", completeDisabled = false }) {\n  return (\n    <div className=\"gamified-segment-nav\">\n      {onBack ? (\n        <button type=\"button\" className=\"btn btn--ghost\" onClick={onBack}>\n          Back\n        </button>\n      ) : (\n        <span />\n      )}\n      <div className=\"gamified-segment-actions\">\n        <button type=\"button\" className=\"btn btn--primary\" onClick={onComplete} disabled={completeDisabled}>\n          {completeLabel}\n        </button>\n      </div>\n    </div>\n  );\n}\n\n","import { Fragment } from \"react\";\nimport SegmentNav from \"./SegmentNav.jsx\";\nimport \"./Segments.css\";\nimport \"./EnhancedComponents.css\";\n\nfunction renderBody(segment) {\n  switch (segment.type) {\n    case \"content\":\n      return <div className=\"gamified-card__body\">{segment.body}</div>;\n    case \"list\":\n      return (\n        <div className=\"gamified-card__body gamified-card__body--list\">\n          {segment.items?.map((item) => (\n            <div key={item.title} className=\"gamified-list-item\">\n              <h4>{item.title}</h4>\n              <div>{item.body}</div>\n            </div>\n          ))}\n        </div>\n      );\n    case \"table\":\n      return (\n        <div className=\"gamified-table-wrapper\">\n          <table>\n            <thead>\n              <tr>\n                {segment.columns?.map((column) => (\n                  <th key={column}>{column}</th>\n                ))}\n              </tr>\n            </thead>\n            <tbody>\n              {segment.rows?.map((row, rowIndex) => (\n                <tr key={rowIndex}>\n                  {row.map((cell, cellIndex) => (\n                    <td key={cellIndex}>{cell}</td>\n                  ))}\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n      );\n    case \"accordion\":\n      return (\n        <div className=\"gamified-accordion\">\n          {segment.items?.map((item, index) => (\n            <details key={item.title} open={index === 0}>\n              <summary>{item.title}</summary>\n              <div>{item.body}</div>\n            </details>\n          ))}\n        </div>\n      );\n    default:\n      return <div className=\"gamified-card__body\">{segment.body ?? <Fragment />}</div>;\n  }\n}\n\nexport default function ContentSegment({ segment, onComplete, onBack }) {\n  return (\n    <article className=\"gamified-card\">\n      <header>\n        <h3>{segment.heading}</h3>\n        {segment.subheading && <p className=\"muted\">{segment.subheading}</p>}\n      </header>\n      {renderBody(segment)}\n      <SegmentNav onBack={onBack} onComplete={onComplete} />\n    </article>\n  );\n}\n\n","import SegmentNav from \"./SegmentNav.jsx\";\nimport \"./Segments.css\";\n\nexport default function DemoSegment({ segment, onBack, onComplete }) {\n  const Demo = segment.demoComponent;\n\n  return (\n    <article className=\"gamified-card\">\n      <header>\n        <h3>{segment.heading}</h3>\n        {segment.description && <p>{segment.description}</p>}\n      </header>\n      <div className=\"gamified-card__body\">{Demo ? <Demo /> : <p>Demo coming soon.</p>}</div>\n      <SegmentNav onBack={onBack} onComplete={onComplete} />\n    </article>\n  );\n}\n\n","import { useEffect, useMemo, useRef, useState } from \"react\";\nimport Sk from \"skulpt\";\nimport AttemptBadge from \"./AttemptBadge.jsx\";\nimport SegmentNav from \"./SegmentNav.jsx\";\nimport FeedbackPanel from \"../ui/FeedbackPanel.jsx\";\nimport ButtonGroup from \"../ui/ButtonGroup.jsx\";\nimport \"./PythonPlaygroundSegment.css\";\n\nfunction builtinRead(x) {\n  const files = Sk.builtinFiles?.files ?? Sk.builtinFiles?.[\"files\"];\n  if (!files || !files[x]) {\n    throw new Error(`File not found: ${x}`);\n  }\n  return files[x];\n}\n\nfunction parseFillSnippet(task) {\n  const parts = [];\n  const regex = /\\{\\{([^}]+)\\}\\}/g;\n  let lastIndex = 0;\n  const text = task.snippet;\n  text.replace(regex, (match, placeholder, index) => {\n    if (index > lastIndex) {\n      parts.push({ type: \"text\", value: text.slice(lastIndex, index) });\n    }\n    parts.push({ type: \"blank\", id: placeholder.trim() });\n    lastIndex = index + match.length;\n    return match;\n  });\n  if (lastIndex < text.length) {\n    parts.push({ type: \"text\", value: text.slice(lastIndex) });\n  }\n  return parts;\n}\n\nexport default function PythonPlaygroundSegment({ segment, onBack, onComplete, onAttempt, attemptStats, isTeacher }) {\n  const [code, setCode] = useState(() => segment.starterCode ?? \"\");\n  const [output, setOutput] = useState(\"\");\n  const [status, setStatus] = useState(\"idle\");\n  const [running, setRunning] = useState(false);\n  const [hasRun, setHasRun] = useState(false);\n  const outputRef = useRef(null);\n\n  const [fillResponses, setFillResponses] = useState({});\n  const [fillFeedback, setFillFeedback] = useState(null);\n  const [fillResolved, setFillResolved] = useState(false);\n\n  useEffect(() => {\n    if (outputRef.current) {\n      outputRef.current.scrollTop = outputRef.current.scrollHeight;\n    }\n  }, [output]);\n\n  useEffect(() => {\n    setCode(segment.starterCode ?? \"\");\n    setOutput(\"\");\n    setStatus(\"idle\");\n    setRunning(false);\n    setHasRun(false);\n    setFillResponses({});\n    setFillFeedback(null);\n    setFillResolved(false);\n  }, [segment.id, segment.starterCode]);\n\n  const fillTasks = useMemo(() => segment.fillTasks ?? [], [segment.fillTasks]);\n  const parsedTasks = useMemo(() => fillTasks.map((task) => ({ ...task, parts: parseFillSnippet(task) })), [fillTasks]);\n\n  const handleRun = async () => {\n    setRunning(true);\n    setOutput(\"\");\n    setStatus(\"idle\");\n    try {\n      Sk.configure({\n        output: (text) => setOutput((prev) => prev + text),\n        read: builtinRead,\n        __future__: {\n          print_function: true,\n          division: true,\n        },\n        python3: true,\n      });\n      await Sk.misceval.asyncToPromise(() => Sk.importMainWithBody(\"<stdin>\", false, code, true));\n      setStatus(\"success\");\n      setHasRun(true);\n    } catch (error) {\n      const message = error?.toString ? error.toString() : String(error);\n      setOutput((prev) => prev + (prev.endsWith(\"\\n\") || prev.length === 0 ? \"\" : \"\\n\") + message);\n      setStatus(\"error\");\n    } finally {\n      setRunning(false);\n    }\n  };\n\n  const handleInsertExample = (exampleCode) => {\n    const snippet = typeof exampleCode === \"string\" ? exampleCode : exampleCode?.code;\n    if (!snippet) return;\n    const needsPadding = code.length > 0 && !code.endsWith(\"\\n\");\n    setCode((prev) => `${prev}${needsPadding ? \"\\n\" : \"\"}${snippet}`);\n  };\n\n  const handleReset = () => {\n    setCode(segment.starterCode ?? \"\");\n    setOutput(\"\");\n    setStatus(\"idle\");\n    setRunning(false);\n    setHasRun(false);\n  };\n\n  const handleFillCheck = () => {\n    const missing = parsedTasks.some((task) =>\n      task.parts\n        .filter((part) => part.type === \"blank\")\n        .some((blank) => !fillResponses[`${task.id}:${blank.id}`]),\n    );\n    if (missing) {\n      setFillFeedback({ tone: \"error\", message: \"Complete every blank in the snippets.\" });\n      return;\n    }\n    let correctCount = 0;\n    parsedTasks.forEach((task) => {\n      task.parts\n        .filter((part) => part.type === \"blank\")\n        .forEach((blank) => {\n          const key = `${task.id}:${blank.id}`;\n          if (fillResponses[key] === task.answers?.[blank.id]) {\n            correctCount += 1;\n          }\n        });\n    });\n    const totalBlanks = parsedTasks.reduce(\n      (sum, task) => sum + task.parts.filter((part) => part.type === \"blank\").length,\n      0,\n    );\n    const passed = correctCount === totalBlanks;\n    setFillFeedback({\n      tone: passed ? \"success\" : \"error\",\n      message: passed ? \"Snippets complete!\" : \"Check the highlights and retry.\",\n    });\n    onAttempt(segment.id, {\n      success: passed,\n      correctCount,\n      totalCount: totalBlanks,\n      onAdvance: passed\n        ? () => {\n            setFillResolved(true);\n            onComplete();\n          }\n        : null,\n    });\n    if (passed) {\n      setFillResolved(true);\n    }\n  };\n\n  return (\n    <article className=\"gamified-card gamified-card--python\">\n      <header>\n        <div>\n          <h3>{segment.heading}</h3>\n          {segment.prompt && <p>{segment.prompt}</p>}\n        </div>\n        <AttemptBadge attemptStats={attemptStats} />\n      </header>\n      <div className=\"python-playground\">\n        <div className=\"python-playground__editor\">\n          <label htmlFor={`${segment.id}-editor`} className=\"python-playground__label\">\n            Python editor\n          </label>\n          <textarea\n            id={`${segment.id}-editor`}\n            value={code}\n            onChange={(event) => setCode(event.target.value)}\n            spellCheck={false}\n            className=\"python-playground__textarea\"\n          />\n          <div className=\"python-playground__actions\">\n            <ButtonGroup align=\"start\">\n              <button type=\"button\" className=\"btn btn--ghost\" onClick={handleReset} disabled={running}>\n                Reset starter\n              </button>\n              <button type=\"button\" className=\"btn btn--outline\" onClick={handleRun} disabled={running}>\n                {running ? \"Runningâ€¦\" : \"Run code\"}\n              </button>\n            </ButtonGroup>\n          </div>\n          {segment.examples?.length > 0 && (\n            <div className=\"python-playground__examples\">\n              <span>Run example:</span>\n              {segment.examples.map((example) => (\n                <button\n                  type=\"button\"\n                  key={example.id}\n                  className=\"pill pill--outline\"\n                  onClick={() => handleInsertExample(example.code)}\n                >\n                  {example.label}\n                </button>\n              ))}\n            </div>\n          )}\n        </div>\n        <div className={`python-playground__console python-playground__console--${status}`}>\n          <header>\n            <span>Console</span>\n            {status === \"success\" && <span className=\"console-status is-success\">Ran successfully</span>}\n            {status === \"error\" && <span className=\"console-status is-error\">Runtime error</span>}\n          </header>\n          <pre ref={outputRef}>{output || \"Run the code to see output here.\"}</pre>\n        </div>\n      </div>\n\n      {parsedTasks.length > 0 && (\n        <div className=\"python-playground__fill\">\n          <h4>Snippet challenge</h4>\n          {parsedTasks.map((task) => (\n            <code key={task.id} className=\"python-playground__snippet\">\n              {task.parts.map((part, index) => {\n                if (part.type === \"text\") {\n                  return <span key={`text-${index}`}>{part.value}</span>;\n                }\n                const options = task.options?.[part.id] ?? [];\n                const key = `${task.id}:${part.id}`;\n                const selected = fillResponses[key] ?? \"\";\n                const answer = task.answers?.[part.id];\n                const isCorrect = fillResolved && selected === answer;\n                const isIncorrect = fillResolved && selected && selected !== answer;\n                return (\n                  <span\n                    key={key}\n                    className={`python-playground__blank${isCorrect ? \" is-correct\" : \"\"}${isIncorrect ? \" is-incorrect\" : \"\"}`}\n                  >\n                    <select\n                      value={selected}\n                      disabled={fillResolved && !isTeacher}\n                      onChange={(event) => {\n                        setFillResponses((prev) => ({ ...prev, [key]: event.target.value }));\n                        setFillFeedback(null);\n                      }}\n                    >\n                      <option value=\"\">?</option>\n                      {options.map((option) => (\n                        <option key={option.id} value={option.id}>\n                          {option.label}\n                        </option>\n                      ))}\n                    </select>\n                  </span>\n                );\n              })}\n            </code>\n          ))}\n          <button type=\"button\" className=\"btn btn--primary\" onClick={handleFillCheck} disabled={fillResolved && !isTeacher}>\n            Check snippets\n          </button>\n          {fillFeedback && (\n            <FeedbackPanel tone={fillFeedback.tone === \"error\" ? \"error\" : \"success\"}>\n              {fillFeedback.message}\n            </FeedbackPanel>\n          )}\n        </div>\n      )}\n\n      <SegmentNav\n        onBack={onBack}\n        onComplete={() => {\n          if (!fillTasks.length) {\n            if (hasRun || isTeacher) {\n              onComplete();\n            } else {\n              setFillFeedback({ tone: \"error\", message: \"Run the code at least once before continuing.\" });\n            }\n          } else if (fillResolved || isTeacher) {\n            onComplete();\n          } else {\n            setFillFeedback({ tone: \"error\", message: \"Complete the snippet challenge before continuing.\" });\n          }\n        }}\n        completeLabel={!fillTasks.length && !hasRun && !isTeacher ? \"Run code to continue\" : \"Continue\"}\n      />\n    </article>\n  );\n}\n\n","import { useEffect } from \"react\";\nimport \"./Segments.css\";\nimport \"./AssessmentResultsModal.css\";\n\nconst successMessages = [\"Great job!\", \"Well done!\", \"XP unlocked!\", \"Keep the streak going!\"];\nconst tryAgainMessages = [\"Almost there!\", \"Give it another shot!\", \"Check the hints and retry.\"];\n\nfunction pickMessage(success) {\n  const pool = success ? successMessages : tryAgainMessages;\n  return pool[Math.floor(Math.random() * pool.length)];\n}\n\nexport default function AssessmentResultsModal({ success, correctCount, totalCount, xpAward, onClose, onContinue }) {\n  useEffect(() => {\n    const handleKey = (event) => {\n      if (event.key === \"Escape\") {\n        onClose?.();\n      }\n      if (event.key === \"Enter\") {\n        onContinue?.();\n      }\n    };\n    window.addEventListener(\"keydown\", handleKey);\n    return () => window.removeEventListener(\"keydown\", handleKey);\n  }, [onClose, onContinue]);\n\n  const message = pickMessage(success);\n\n  return (\n    <div className={`results-modal ${success ? \"is-success\" : \"is-error\"}`}>\n      <button\n        type=\"button\"\n        className=\"results-modal__backdrop\"\n        onClick={onClose}\n        aria-label=\"Close results modal\"\n        tabIndex={-1}\n      />\n      <div className=\"results-modal__card\">\n        <header>\n          <h3>{success ? \"Checkpoint cleared!\" : \"Keep going!\"}</h3>\n          <p>{message}</p>\n        </header>\n        <div className=\"results-modal__stats\">\n          <div>\n            <span>Score</span>\n            <strong>\n              {correctCount}/{totalCount}\n            </strong>\n          </div>\n          <div>\n            <span>XP gained</span>\n            <strong>{xpAward}</strong>\n          </div>\n        </div>\n        <div className=\"results-modal__actions\">\n          <button type=\"button\" className=\"btn btn--ghost\" onClick={onClose}>\n            Close\n          </button>\n          <button type=\"button\" className=\"btn btn--primary\" onClick={onContinue}>\n            Next\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n","import { useEffect, useState } from \"react\";\nimport SegmentNav from \"./SegmentNav.jsx\";\nimport \"./Segments.css\";\n\nexport default function ReflectionSegment({\n  segment,\n  onBack,\n  onComplete,\n  onSave,\n  isTeacher,\n  initialValue = \"\",\n}) {\n  const [value, setValue] = useState(initialValue ?? \"\");\n\n  useEffect(() => {\n    setValue(initialValue ?? \"\");\n  }, [segment.id, initialValue]);\n\n  const handleSave = () => {\n    if (onSave) {\n      onSave(segment.id, value);\n    }\n    onComplete();\n  };\n\n  return (\n    <article className=\"gamified-card\">\n      <header>\n        <h3>{segment.heading}</h3>\n        {segment.prompt && <p>{segment.prompt}</p>}\n      </header>\n      <textarea\n        rows={6}\n        value={value}\n        onChange={(event) => setValue(event.target.value)}\n        placeholder=\"Capture your reflections hereâ€¦\"\n      />\n      <SegmentNav\n        onBack={onBack}\n        onComplete={handleSave}\n        completeLabel={isTeacher ? \"Mark complete\" : \"Save reflection\"}\n      />\n    </article>\n  );\n}\n\n","import React, { useEffect, useMemo, useState } from \"react\";\nimport { useSession } from \"../../hooks/useSession.js\";\nimport { getLiveAssessmentStatus } from \"../../lib/api.js\";\nimport \"./LiveAssessmentDashboard.css\";\n\nconst POLL_INTERVAL_MS = 4000;\n\nfunction formatStatusLabel(status) {\n  switch ((status || \"not-started\").toLowerCase()) {\n    case \"completed\":\n      return \"Completed\";\n    case \"in-progress\":\n      return \"In Progress\";\n    default:\n      return \"Not Started\";\n  }\n}\n\nfunction LiveAssessmentDashboard({\n  classId,\n  unitId,\n  segment,\n  stage,\n  isLastStage,\n  nextStageTitle,\n  advanceState,\n  advanceError,\n  onShowAssessment,\n  onAdvancePacing,\n}) {\n  const { session } = useSession();\n  const token = session?.token;\n  const segmentId = segment?.id;\n  const [rows, setRows] = useState([]);\n  const [summary, setSummary] = useState({ completed: 0, \"in-progress\": 0, \"not-started\": 0 });\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n    if (!token || !classId || !unitId || !segmentId) {\n      setRows([]);\n      setSummary({ completed: 0, \"in-progress\": 0, \"not-started\": 0 });\n      return;\n    }\n\n    let cancelled = false;\n    let intervalId;\n\n    async function fetchStatus(initial = false) {\n      if (initial) {\n        setLoading(true);\n        setError(null);\n      }\n      try {\n        const data = await getLiveAssessmentStatus(token, classId, { unitId, segmentId });\n        if (cancelled) return;\n        setRows(Array.isArray(data?.students) ? data.students : []);\n        setSummary(data?.summary || { completed: 0, \"in-progress\": 0, \"not-started\": 0 });\n        setError(null);\n      } catch (fetchError) {\n        if (cancelled) return;\n        console.warn(\"Failed to load live assessment status\", fetchError);\n        setError(fetchError?.message || \"Unable to load live progress right now.\");\n      } finally {\n        if (!cancelled) setLoading(false);\n      }\n    }\n\n    fetchStatus(true);\n    intervalId = setInterval(fetchStatus, POLL_INTERVAL_MS);\n\n    return () => {\n      cancelled = true;\n      if (intervalId) {\n        clearInterval(intervalId);\n      }\n    };\n  }, [token, classId, unitId, segmentId]);\n\n  const totals = useMemo(() => {\n    const totalStudents = rows.length;\n    const completed = typeof summary.completed === \"number\" ? summary.completed : rows.filter((row) => row.status === \"completed\").length;\n    const inProgress = typeof summary[\"in-progress\"] === \"number\" ? summary[\"in-progress\"] : rows.filter((row) => row.status === \"in-progress\").length;\n    const notStarted = Math.max(totalStudents - completed - inProgress, 0);\n    return { totalStudents, completed, inProgress, notStarted };\n  }, [rows, summary]);\n\n  const sortedRows = useMemo(() => {\n    return [...rows].sort((a, b) => {\n      const left = (a.displayName || a.username || \"\").toLowerCase();\n      const right = (b.displayName || b.username || \"\").toLowerCase();\n      if (left < right) return -1;\n      if (left > right) return 1;\n      return 0;\n    });\n  }, [rows]);\n\n  const unlockButtonLabel = isLastStage\n    ? \"Complete Unit\"\n    : nextStageTitle\n    ? `Unlock ${nextStageTitle}`\n    : \"Unlock Next Stage\";\n\n  const isAdvancing = advanceState === \"pending\";\n  const segmentTitle = segment?.heading || segment?.title || \"Formative Check\";\n  const stageTitle = stage?.title || stage?.id || \"Current Stage\";\n\n  return (\n    <div className=\"live-assessment-dashboard\">\n      <div className=\"dashboard-header\">\n        <div>\n          <h3>{stageTitle}</h3>\n          <p className=\"dashboard-subtitle\">{segmentTitle}</p>\n        </div>\n        <div className=\"summary\">\n          <span>{`Completion: ${totals.completed} / ${totals.totalStudents}`}</span>\n          <progress value={totals.totalStudents > 0 ? totals.completed : 0} max={Math.max(totals.totalStudents, 1)} />\n        </div>\n      </div>\n\n      <div className=\"dashboard-meta\">\n        <span className=\"meta-pill meta-pill--complete\">Completed: {totals.completed}</span>\n        <span className=\"meta-pill meta-pill--progress\">In progress: {totals.inProgress}</span>\n        <span className=\"meta-pill meta-pill--idle\">Not started: {totals.notStarted}</span>\n      </div>\n\n      <div className=\"dashboard-controls\">\n        <button onClick={onShowAssessment} className=\"control-button\">\n          Show Assessment View\n        </button>\n        <button\n          onClick={onAdvancePacing}\n          className=\"control-button primary\"\n          disabled={!onAdvancePacing || isAdvancing}\n        >\n          {isAdvancing ? \"Unlocking...\" : unlockButtonLabel}\n        </button>\n      </div>\n\n      {(loading || error || advanceError) && (\n        <div className=\"dashboard-alerts\">\n          {loading && <span className=\"alert-note\">Loading live statusâ€¦</span>}\n          {error && <span className=\"alert-error\">{error}</span>}\n          {!error && advanceError && <span className=\"alert-error\">{advanceError}</span>}\n        </div>\n      )}\n\n      <div className=\"student-grid-container\">\n        <table className=\"student-progress-table\">\n          <thead>\n            <tr>\n              <th>Student</th>\n              <th>Status</th>\n              <th>Attempts</th>\n              <th>Score</th>\n              <th>Last Updated</th>\n            </tr>\n          </thead>\n          <tbody>\n            {sortedRows.length === 0 ? (\n              <tr>\n                <td colSpan={5} className=\"table-empty\">\n                  {loading ? \"Waiting for student activityâ€¦\" : \"No student attempts recorded yet.\"}\n                </td>\n              </tr>\n            ) : (\n              sortedRows.map((student) => {\n                const statusClass = `status-${(student.status || \"not-started\").toLowerCase().replace(/\\s+/g, '-')}`;\n                const attempts = typeof student.attempts === \"number\" ? student.attempts : 0;\n                const score = typeof student.score === \"number\" ? `${student.score}%` : \"â€”\";\n                const lastUpdated = student.lastUpdated ? new Date(student.lastUpdated).toLocaleTimeString([], { hour: \"2-digit\", minute: \"2-digit\" }) : \"â€”\";\n                return (\n                  <tr key={student.id} className={statusClass}>\n                    <td>{student.displayName || student.username || \"Student\"}</td>\n                    <td>\n                      <span className=\"status-indicator\" />\n                      {formatStatusLabel(student.status)}\n                    </td>\n                    <td>{attempts}</td>\n                    <td>{score}</td>\n                    <td>{lastUpdated}</td>\n                  </tr>\n                );\n              })\n            )}\n          </tbody>\n        </table>\n      </div>\n    </div>\n  );\n}\n\nexport default LiveAssessmentDashboard;\n\n","import React, { createContext, useState, useContext, useMemo } from 'react';\n\nconst TeacherModeContext = createContext();\n\nexport const TeacherModeProvider = ({ children }) => {\n  const [isPresentationMode, setIsPresentationMode] = useState(false);\n  const [currentPacing, setCurrentPacing] = useState({ unitId: null, lessonId: null });\n\n  const togglePresentationMode = () => {\n    setIsPresentationMode(prev => !prev);\n  };\n\n  const value = useMemo(() => ({\n    isPresentationMode,\n    togglePresentationMode,\n    currentPacing,\n    setCurrentPacing\n  }), [isPresentationMode, currentPacing]);\n\n  return (\n    <TeacherModeContext.Provider value={value}>\n      {children}\n    </TeacherModeContext.Provider>\n  );\n};\n\nexport const useTeacherMode = () => {\n  const context = useContext(TeacherModeContext);\n  if (context === undefined) {\n    throw new Error('useTeacherMode must be used within a TeacherModeProvider');\n  }\n  return context;\n};\n","import { useEffect, useMemo, useReducer, useRef, useState } from \"react\";\nimport { useGamification } from \"../context/GamificationContext.jsx\";\nimport { useSession } from \"../hooks/useSession.js\";\nimport { readUnitProgress, writeUnitProgress } from \"../lib/progressStorage.js\";\nimport MicroQuizSegment from \"./segments/MicroQuizSegment.jsx\";\nimport ActivitySegment from \"./segments/activities/ActivitySegment.jsx\";\nimport ContentSegment from \"./segments/ContentSegment.jsx\";\nimport DemoSegment from \"./segments/DemoSegment.jsx\";\nimport PythonPlaygroundSegment from \"./segments/PythonPlaygroundSegment.jsx\";\nimport AssessmentResultsModal from \"./segments/AssessmentResultsModal.jsx\";\nimport ReflectionSegment from \"./segments/ReflectionSegment.jsx\";\nimport LiveAssessmentDashboard from \"./segments/LiveAssessmentDashboard.jsx\";\nimport StatCard from \"./ui/StatCard.jsx\";\nimport Modal from \"./ui/Modal.jsx\";\nimport \"./GamifiedModulePage.css\";\nimport { useTeacherMode } from \"../context/TeacherModeContext.jsx\";\nimport {\n  updateClassPacing,\n  getClassPacing,\n  getStudentClassPacing,\n  syncStudentProgress,\n  updateLiveAssessmentStatus,\n} from \"../lib/api.js\";\n\nconst STORAGE_VERSION = 2;\nconst SYNC_DEBOUNCE_MS = 2500;\nconst ASSESSMENT_STAGE_ID = \"__assessment__\";\n\nfunction normalizeAssessment(raw = null) {\n  if (!raw || typeof raw !== \"object\") {\n    return {\n      status: \"not-started\",\n      responses: {},\n      marks: {},\n      teacherNotes: {},\n      updatedAt: null,\n    };\n  }\n  return {\n    status: raw.status ?? \"not-started\",\n    responses: raw.responses ?? {},\n    marks: raw.marks ?? {},\n    teacherNotes: raw.teacherNotes ?? {},\n    updatedAt: raw.updatedAt ?? null,\n  };\n}\n\nconst AUTO_ASSESSMENT_ATTEMPTS_KEY = \"__autoAttempts\";\n\nfunction getSegmentAudience(segment) {\n  if (!segment || typeof segment !== \"object\") return \"all\";\n  if (segment.audience) {\n    const value = String(segment.audience).toLowerCase();\n    if (value === \"teacher\" || value === \"student\" || value === \"all\") {\n      return value;\n    }\n  }\n  if (segment.teacherOnly) return \"teacher\";\n  if (segment.studentOnly) return \"student\";\n  return \"all\";\n}\n\nfunction isSegmentVisibleForRole(segment, { isTeacher }) {\n  if (!segment) return false;\n  if (segment.hidden) return false;\n  const audience = getSegmentAudience(segment);\n  if (audience === \"teacher\") return Boolean(isTeacher);\n  if (audience === \"student\") return !isTeacher || Boolean(segment.allowTeacherPreview);\n  return true;\n}\n\nfunction evaluateAutoQuestion(question, value) {\n  if (!question) return { correct: false, details: {} };\n  switch (question.type) {\n    case \"true-false\": {\n      const expected = Boolean(question.answer);\n      const provided = Boolean(value);\n      return {\n        correct: expected === provided,\n        details: { selected: provided, answer: expected },\n      };\n    }\n    case \"mcq\": {\n      const expected = question.answer ?? question.options?.find((option) => option.isCorrect)?.id ?? null;\n      return {\n        correct: expected != null && value === expected,\n        details: { selected: value, answer: expected },\n      };\n    }\n    case \"multi-select\": {\n      const expected = Array.isArray(question.answers)\n        ? [...question.answers].sort()\n        : question.options?.filter((option) => option.isCorrect).map((option) => option.id).sort() ?? [];\n      const provided = Array.isArray(value) ? [...value].sort() : [];\n      const match =\n        expected.length === provided.length && expected.every((entry, index) => entry === provided[index]);\n      return {\n        correct: match,\n        details: { selected: provided, answers: expected },\n      };\n    }\n    default:\n      return { correct: false, details: {} };\n  }\n}\n\nfunction getAutoOptionState(question, optionValue, evaluation) {\n  if (!evaluation) return \"idle\";\n  if (question.type === \"true-false\") {\n    if (optionValue === evaluation.details.selected) {\n      return evaluation.correct ? \"correct\" : \"incorrect\";\n    }\n    if (evaluation.correct && optionValue === evaluation.details.answer) {\n      return \"correct\";\n    }\n    return \"idle\";\n  }\n\n  if (question.type === \"mcq\") {\n    if (optionValue === evaluation.details.selected) {\n      return optionValue === evaluation.details.answer ? \"correct\" : \"incorrect\";\n    }\n    if (optionValue === evaluation.details.answer) {\n      return \"correct\";\n    }\n    return \"idle\";\n  }\n\n  if (question.type === \"multi-select\") {\n    const selected = evaluation.details.selected ?? [];\n    const correct = evaluation.details.answers ?? [];\n    if (selected.includes(optionValue) && correct.includes(optionValue)) return \"correct\";\n    if (selected.includes(optionValue) && !correct.includes(optionValue)) return \"incorrect\";\n    if (!selected.includes(optionValue) && correct.includes(optionValue)) return \"missed\";\n    return \"idle\";\n  }\n\n  return \"idle\";\n}\n\nfunction AutoMarkingAssessment({\n  assessment,\n  normalizedState,\n  onResponseChange,\n  onMarkChange,\n  onStatusChange,\n  isTeacher,\n}) {\n  const assessmentQuestions = assessment?.questions;\n  const questions = useMemo(\n    () => (Array.isArray(assessmentQuestions) ? assessmentQuestions : []),\n    [assessmentQuestions],\n  );\n  const [feedback, setFeedback] = useState(null);\n  const responses = useMemo(() => normalizedState.responses ?? {}, [normalizedState.responses]);\n  const marks = useMemo(() => normalizedState.marks ?? {}, [normalizedState.marks]);\n  const status = normalizedState.status ?? \"not-started\";\n  const attemptCount = Number(responses[AUTO_ASSESSMENT_ATTEMPTS_KEY] ?? 0);\n  const instructions = assessment?.instructions;\n\n  const totalPoints = useMemo(\n    () => questions.reduce((sum, question) => sum + Number(question.points ?? 1), 0),\n    [questions],\n  );\n\n  const awardedPoints = useMemo(\n    () =>\n      questions.reduce((sum, question) => {\n        const raw = marks?.[question.id];\n        const numeric = Number(raw);\n        return sum + (Number.isFinite(numeric) ? numeric : 0);\n      }, 0),\n    [marks, questions],\n  );\n\n  const evaluationByQuestion = useMemo(() => {\n    if (status !== \"completed\") return {};\n    return questions.reduce((acc, question) => {\n      acc[question.id] = evaluateAutoQuestion(question, responses[question.id]);\n      return acc;\n    }, {});\n  }, [status, responses, questions]);\n\n  const allAnswered = useMemo(\n    () =>\n      questions.every((question) => {\n        const value = responses[question.id];\n        if (question.type === \"multi-select\") {\n          return Array.isArray(value) && value.length > 0;\n        }\n        return value !== undefined && value !== null && value !== \"\";\n      }),\n    [responses, questions],\n  );\n\n  useEffect(() => {\n    if (status === \"completed\") {\n      const perfect = awardedPoints === totalPoints && totalPoints > 0;\n      setFeedback({\n        tone: perfect ? \"success\" : \"info\",\n        message: perfect\n          ? \"Perfect score! Fantastic work.\"\n          : `You scored ${awardedPoints}/${totalPoints}. Review the highlights and retry if needed.`,\n      });\n    } else {\n      setFeedback(null);\n    }\n  }, [status, awardedPoints, totalPoints]);\n\n  const handleSubmit = (event) => {\n    event.preventDefault();\n    if (status === \"completed\") {\n      setFeedback({\n        tone: \"info\",\n        message: \"Assessment already submitted. Use Retake to try again.\",\n      });\n      return;\n    }\n\n    if (!allAnswered) {\n      setFeedback({ tone: \"error\", message: \"Answer every question before checking.\" });\n      return;\n    }\n\n    let totalAwarded = 0;\n    questions.forEach((question) => {\n      const result = evaluateAutoQuestion(question, responses[question.id]);\n      const points = Number(question.points ?? 1);\n      const awarded = result.correct ? points : 0;\n      totalAwarded += awarded;\n      onMarkChange(question.id, awarded);\n    });\n    onResponseChange(AUTO_ASSESSMENT_ATTEMPTS_KEY, String(attemptCount + 1));\n    onStatusChange(\"completed\");\n    const perfect = totalAwarded === totalPoints && totalPoints > 0;\n    setFeedback({\n      tone: perfect ? \"success\" : \"info\",\n      message: perfect\n        ? \"Perfect score! Fantastic work.\"\n        : `You scored ${totalAwarded}/${totalPoints}. Review the highlights and retry if needed.`,\n    });\n  };\n\n  const handleRetake = () => {\n    questions.forEach((question) => {\n      const resetValue = question.type === \"multi-select\" ? [] : null;\n      onResponseChange(question.id, resetValue);\n      onMarkChange(question.id, 0);\n    });\n    onStatusChange(\"in-progress\");\n    setFeedback(null);\n  };\n\n  return (\n    <div className=\"gamified-assessment__body\">\n      <div className=\"gamified-assessment__intro\">\n        <p>\n          {instructions\n            ? instructions\n            : \"Answer the multiple-choice questions below. You can retake the assessment to improve your score.\"}\n        </p>\n      </div>\n      <form className=\"gamified-micro-quiz\" onSubmit={handleSubmit}>\n        {questions.map((question) => {\n          const evaluation = evaluationByQuestion[question.id];\n          const locked = status === \"completed\";\n          const response = responses[question.id];\n          return (\n            <fieldset\n              key={question.id}\n              className={`gamified-micro-question ${\n                evaluation ? (evaluation.correct ? \"is-correct\" : \"is-incorrect\") : \"\"\n              }`}\n              disabled={locked && !isTeacher}\n            >\n              <legend>{question.prompt}</legend>\n\n              {question.type === \"true-false\" && (\n                <div className=\"gamified-micro-options\">\n                  {[true, false].map((option) => (\n                    <label\n                      key={String(option)}\n                      className={`gamified-micro-option gamified-micro-option--${getAutoOptionState(\n                        question,\n                        option,\n                        evaluation,\n                      )}`}\n                    >\n                      <input\n                        type=\"radio\"\n                        name={question.id}\n                        value={String(option)}\n                        checked={Boolean(response) === option}\n                        onChange={() => {\n                          onResponseChange(question.id, option);\n                          if (status === \"completed\") onStatusChange(\"in-progress\");\n                        }}\n                      />\n                      <span>{option ? \"True\" : \"False\"}</span>\n                    </label>\n                  ))}\n                </div>\n              )}\n\n              {question.type === \"mcq\" && (\n                <div className=\"gamified-micro-options\">\n                  {question.options?.map((option) => (\n                    <label\n                      key={option.id}\n                      className={`gamified-micro-option gamified-micro-option--${getAutoOptionState(\n                        question,\n                        option.id,\n                        evaluation,\n                      )}`}\n                    >\n                      <input\n                        type=\"radio\"\n                        name={question.id}\n                        value={option.id}\n                        checked={response === option.id}\n                        onChange={() => {\n                          onResponseChange(question.id, option.id);\n                          if (status === \"completed\") onStatusChange(\"in-progress\");\n                        }}\n                      />\n                      <span>{option.label}</span>\n                    </label>\n                  ))}\n                </div>\n              )}\n\n              {question.type === \"multi-select\" && (\n                <div className=\"gamified-micro-options\">\n                  {question.options?.map((option) => {\n                    const selected = Array.isArray(response) ? response.includes(option.id) : false;\n                    return (\n                      <label\n                        key={option.id}\n                        className={`gamified-micro-option gamified-micro-option--${getAutoOptionState(\n                          question,\n                          option.id,\n                          evaluation,\n                        )}`}\n                      >\n                        <input\n                          type=\"checkbox\"\n                          value={option.id}\n                          checked={selected}\n                          onChange={(event) => {\n                            const checked = event.target.checked;\n                            const current = Array.isArray(response) ? response : [];\n                            const next = checked\n                              ? [...new Set([...current, option.id])]\n                              : current.filter((value) => value !== option.id);\n                            onResponseChange(question.id, next);\n                            if (status === \"completed\") onStatusChange(\"in-progress\");\n                          }}\n                        />\n                        <span>{option.label}</span>\n                      </label>\n                    );\n                  })}\n                </div>\n              )}\n\n              {evaluation && !evaluation.correct && question.rationale && (\n                <p className=\"gamified-feedback\">{question.rationale}</p>\n              )}\n            </fieldset>\n          );\n        })}\n\n        <div className=\"gamified-segment-nav\">\n          <span />\n          <div className=\"gamified-segment-actions\">\n            <button type=\"submit\" className=\"btn btn--primary\" disabled={status === \"completed\"}>\n              Check answers\n            </button>\n            {status === \"completed\" && (\n              <button type=\"button\" className=\"btn btn--ghost\" onClick={handleRetake}>\n                Retake assessment\n              </button>\n            )}\n          </div>\n        </div>\n      </form>\n\n      <aside className=\"gamified-assessment__teacher gamified-assessment__teacher--hint\">\n        <h3>Assessment status</h3>\n        <p>\n          Score: {awardedPoints} / {totalPoints}\n        </p>\n        <p className=\"muted\">Attempts: {attemptCount}</p>\n        {feedback ? (\n          <p className={`gamified-feedback ${feedback.tone === \"error\" ? \"is-error\" : \"\"}`}>{feedback.message}</p>\n        ) : (\n          <p className=\"muted\">Submit your answers to calculate a score.</p>\n        )}\n        {isTeacher && (\n          <p className=\"small muted\">\n            Teachers see aggregated analytics on the dashboard. Students can retry to improve their score until you reset\n            the unit.\n          </p>\n        )}\n      </aside>\n    </div>\n  );\n}\n\nfunction buildInitialState(unit, profileKey) {\n  const fallback = {\n    version: STORAGE_VERSION,\n    stages: {},\n    reflections: {},\n    planner: {},\n    attempts: {},\n    assessment: normalizeAssessment(),\n  };\n\n  if (typeof window === \"undefined\") return fallback;\n\n  const { data } = readUnitProgress(unit.id, profileKey);\n  if (!data || typeof data !== \"object\") {\n    return fallback;\n  }\n\n  return {\n    ...fallback,\n    ...data,\n    version: STORAGE_VERSION,\n    assessment: normalizeAssessment(data.assessment),\n  };\n}\n\nfunction reducer(state, action) {\n  switch (action.type) {\n    case \"hydrate\": {\n      return {\n        ...state,\n        ...(action.payload ?? {}),\n      };\n    }\n    case \"segment-progress\": {\n      const { stageId, nextIndex, completed } = action.payload;\n      const prevStage = state.stages?.[stageId] ?? { segmentIndex: 0, completed: false };\n      const nextStage = {\n        segmentIndex: Math.max(prevStage.segmentIndex, nextIndex),\n        completed: completed ? true : prevStage.completed,\n      };\n      return {\n        ...state,\n        stages: {\n          ...state.stages,\n          [stageId]: nextStage,\n        },\n      };\n    }\n    case \"reflection\": {\n      const { id, value } = action.payload;\n      return {\n        ...state,\n        reflections: {\n          ...state.reflections,\n          [id]: value,\n        },\n      };\n    }\n    case \"planner\": {\n      const { id, value } = action.payload;\n      return {\n        ...state,\n        planner: {\n          ...state.planner,\n          [id]: value,\n        },\n      };\n    }\n    case \"attempt\": {\n      const { segmentId, success } = action.payload;\n      const correctCount = Number(action.payload?.correctCount ?? 0);\n      const totalCount = Number(action.payload?.totalCount ?? 0);\n      const current = state.attempts?.[segmentId] ?? { count: 0, correct: 0 };\n      const updated = {\n        count: current.count + 1,\n        correct: current.correct + (success ? 1 : 0),\n        lastResult: success ? \"correct\" : \"incorrect\",\n        last: {\n          correct: correctCount,\n          total: totalCount,\n          success: Boolean(success),\n        },\n        updatedAt: Date.now(),\n      };\n      return {\n        ...state,\n        attempts: {\n          ...state.attempts,\n          [segmentId]: updated,\n        },\n      };\n    }\n    case \"assessment-response\": {\n      const { questionId, value } = action.payload;\n      const assessment = normalizeAssessment(state.assessment);\n      return {\n        ...state,\n        assessment: {\n          ...assessment,\n          responses: {\n            ...assessment.responses,\n            [questionId]: value,\n          },\n          updatedAt: Date.now(),\n        },\n      };\n    }\n    case \"assessment-mark\": {\n      const { questionId, value } = action.payload;\n      const assessment = normalizeAssessment(state.assessment);\n      return {\n        ...state,\n        assessment: {\n          ...assessment,\n          marks: {\n            ...assessment.marks,\n            [questionId]: value,\n          },\n          updatedAt: Date.now(),\n        },\n      };\n    }\n    case \"assessment-note\": {\n      const { questionId, value } = action.payload;\n      const assessment = normalizeAssessment(state.assessment);\n      return {\n        ...state,\n        assessment: {\n          ...assessment,\n          teacherNotes: {\n            ...assessment.teacherNotes,\n            [questionId]: value,\n          },\n          updatedAt: Date.now(),\n        },\n      };\n    }\n    case \"assessment-status\": {\n      const { status } = action.payload;\n      const assessment = normalizeAssessment(state.assessment);\n      return {\n        ...state,\n        assessment: {\n          ...assessment,\n          status:\n            typeof status === \"string\" && status.length > 0\n              ? status\n              : assessment.status,\n          updatedAt: Date.now(),\n        },\n      };\n    }\n    default:\n      return state;\n  }\n}\n\nexport default function GamifiedModulePage({ unit, classId: teacherClassId }) {\n  const { state: gamificationState, awardXp, resetStreak } = useGamification();\n  const { session } = useSession();\n  const { isPresentationMode, togglePresentationMode, setCurrentPacing } = useTeacherMode();\n  const isTeacher = session?.user?.role === \"teacher\" || session?.user?.role === \"admin\";\n  const profileKey = session?.user?.username?.toLowerCase() || \"guest\";\n  const [paceStatus, setPaceStatus] = useState({});\n  const [classPacing, setClassPacing] = useState(null);\n  const classId = isTeacher ? teacherClassId : session?.user?.classId;\n  const hasAssessment = Boolean(unit.assessment);\n  const stages = useMemo(() => {\n    if (!hasAssessment) {\n      return unit.stages;\n    }\n    const assessmentStage = {\n      id: ASSESSMENT_STAGE_ID,\n      title: unit.assessment.title ?? \"End-of-unit assessment\",\n      duration: unit.assessment.duration ?? \"45 min\",\n      description:\n        unit.assessment.summary ?? `Summative checkpoint worth ${unit.assessment.totalMarks ?? 0} marks.`,\n      isAssessment: true,\n    };\n    return [...unit.stages, assessmentStage];\n  }, [unit, hasAssessment]);\n\n  const [progress, dispatch] = useReducer(\n    reducer,\n    { unit, profileKey },\n    ({ unit: initialUnit, profileKey: initialProfile }) => buildInitialState(initialUnit, initialProfile),\n  );\n  const programmeLabel = unit.programmeLabel ?? \"IB Computer Science\";\n\n  useEffect(() => {\n    if (!classId || !session?.token) {\n      setClassPacing(null);\n      return;\n    }\n\n    let active = true;\n    const fetchPacing = async () => {\n      try {\n        const pacingData = isTeacher\n          ? await getClassPacing(session.token, classId)\n          : await getStudentClassPacing(session.token, classId);\n        if (!active) return;\n        setClassPacing(pacingData?.pacing ?? null);\n      } catch (error) {\n        if (!active) return;\n        if (!isTeacher) {\n          console.warn(\"Failed to fetch class pacing\", error);\n        }\n      }\n    };\n\n    fetchPacing();\n\n    if (!isTeacher) {\n      const interval = setInterval(fetchPacing, 5000);\n      return () => {\n        active = false;\n        clearInterval(interval);\n      };\n    }\n\n    return () => {\n      active = false;\n    };\n  }, [isTeacher, classId, session?.token, unit.id]);\n\n  const profileRef = useRef(profileKey);\n  const unitRef = useRef(unit.id);\n\n  useEffect(() => {\n    if (profileRef.current === profileKey && unitRef.current === unit.id) {\n      return;\n    }\n    const nextState = buildInitialState(unit, profileKey);\n    dispatch({ type: \"hydrate\", payload: nextState });\n    profileRef.current = profileKey;\n    unitRef.current = unit.id;\n  }, [profileKey, unit]);\n\n  const [activeStageIndex, setActiveStageIndex] = useState(0);\n  const [resultModal, setResultModal] = useState(null);\n  const [sidebarCollapsed, setSidebarCollapsed] = useState(false);\n  const [headerCollapsed, setHeaderCollapsed] = useState(false);\n  const [levelUpModal, setLevelUpModal] = useState(null);\n  const previousLevelRef = useRef(null);\n  const syncTimeoutRef = useRef(null);\n  const pointerIndexRef = useRef(null);\n\n  const activeStage = stages[activeStageIndex];\n\n  useEffect(() => {\n    if (typeof window === \"undefined\") return;\n    writeUnitProgress(unit.id, profileKey, {\n      ...progress,\n      version: STORAGE_VERSION,\n    });\n    if (isTeacher) return;\n\n    if (syncTimeoutRef.current) {\n      clearTimeout(syncTimeoutRef.current);\n    }\n\n    syncTimeoutRef.current = setTimeout(async () => {\n      try {\n        await syncStudentProgress(session.token, {\n          unitId: unit.id,\n          progress,\n        });\n      } catch (error) {\n        console.warn(\"Failed to sync student progress to backend\", error);\n      }\n    }, SYNC_DEBOUNCE_MS);\n\n    return () => {\n      if (syncTimeoutRef.current) {\n        clearTimeout(syncTimeoutRef.current);\n      }\n    };\n  }, [progress, unit.id, profileKey, session?.token, isTeacher]);\n\n  useEffect(() => {\n    const firstIncomplete = stages.findIndex((stage) => !stage.isAssessment && !progress.stages?.[stage.id]?.completed);\n    if (firstIncomplete !== -1) {\n      setActiveStageIndex(firstIncomplete);\n    }\n  }, [progress.stages, stages]);\n\n  const overallXp = gamificationState.xp ?? 0;\n  const level = gamificationState.level ?? 1;\n  const xpToNext = level * 150;\n  const currentLevelFloor = (level - 1) * 150;\n  const levelProgress = Math.min(1, Math.max(0, (overallXp - currentLevelFloor) / Math.max(1, xpToNext - currentLevelFloor)));\n  const xpFormatter = useMemo(() => new Intl.NumberFormat(), []);\n  const formattedXp = useMemo(() => xpFormatter.format(Math.max(0, Math.round(overallXp))), [overallXp, xpFormatter]);\n  const formattedNextLevel = useMemo(() => xpFormatter.format(Math.max(0, Math.round(xpToNext))), [xpToNext, xpFormatter]);\n\n  // Initialize previous level on mount\n  useEffect(() => {\n    if (previousLevelRef.current === null) {\n      previousLevelRef.current = level;\n    }\n  }, [level]);\n\n  // Detect level up\n  useEffect(() => {\n    if (previousLevelRef.current !== null && level > previousLevelRef.current) {\n      setLevelUpModal({\n        oldLevel: previousLevelRef.current,\n        newLevel: level,\n        xp: overallXp,\n      });\n      previousLevelRef.current = level;\n    } else if (previousLevelRef.current === null) {\n      previousLevelRef.current = level;\n    }\n  }, [level, overallXp]);\n\n  const handleSegmentAdvance = (stageId, nextIndex, completed) => {\n    dispatch({ type: \"segment-progress\", payload: { stageId, nextIndex, completed } });\n  };\n\n  const handleReflectionSave = (id, value) => {\n    dispatch({ type: \"reflection\", payload: { id, value } });\n  };\n\n  const handlePlannerSave = (id, value) => {\n    dispatch({ type: \"planner\", payload: { id, value } });\n  };\n\n  const handleAttempt = (segmentId, payload) => {\n    const normalized = payload && typeof payload === \"object\" ? payload : { success: Boolean(payload) };\n    const success = Boolean(normalized.success);\n    const correctCount = Number(normalized.correctCount ?? (success ? normalized.totalCount ?? 0 : 0));\n    const totalCount = Number(normalized.totalCount ?? normalized.correctCount ?? 0);\n\n    const resolvedTotal = Number.isFinite(totalCount) && totalCount > 0 ? totalCount : correctCount;\n    const previousAttempts = progress.attempts?.[segmentId]?.count ?? 0;\n    const nextAttemptCount = previousAttempts + 1;\n    dispatch({\n      type: \"attempt\",\n      payload: {\n        segmentId,\n        success,\n        correctCount,\n        totalCount: resolvedTotal,\n      },\n    });\n\n    if (!isTeacher && session?.user?.role === \"student\" && session?.token) {\n      const studentClassId = session.user?.classId;\n      if (studentClassId) {\n        const status = success ? \"completed\" : \"in-progress\";\n        const scoreValue = resolvedTotal > 0 ? Math.round((correctCount / resolvedTotal) * 100) : success ? 100 : null;\n        updateLiveAssessmentStatus(session.token, {\n          classId: studentClassId,\n          unitId: unit.id,\n          segmentId,\n          attempts: nextAttemptCount,\n          status,\n          score: scoreValue,\n        }).catch((error) => {\n          console.warn(\"Failed to update live assessment status\", error);\n        });\n      }\n    }\n\n    if (success) {\n      if (correctCount > 0) {\n        const baseXp = correctCount * 10;\n        const streakBonus = Math.floor((gamificationState.streak + 1) / 3) * 5;\n        const xpAward = baseXp + streakBonus;\n        awardXp({\n          xpGained: xpAward,\n          correct: correctCount,\n          attempts: resolvedTotal || correctCount,\n          spriteUnlocks: normalized.spriteUnlocks,\n        });\n        setResultModal({\n          ...normalized,\n          success: true,\n          xpAward,\n          correctCount,\n          totalCount: resolvedTotal,\n        });\n      } else if (normalized.onAdvance) {\n        // Allow silent success without XP (e.g. informational segments)\n        normalized.onAdvance();\n      }\n    } else {\n      resetStreak();\n      setResultModal({\n        ...normalized,\n        success: false,\n        correctCount,\n        totalCount: resolvedTotal,\n        xpAward: 0,\n      });\n    }\n  };\n\n  const handleAssessmentResponseChange = (questionId, value) => {\n    dispatch({ type: \"assessment-response\", payload: { questionId, value } });\n  };\n\n  const handleAssessmentMarkChange = (questionId, value) => {\n    dispatch({ type: \"assessment-mark\", payload: { questionId, value } });\n  };\n\n  const handleAssessmentNoteChange = (questionId, value) => {\n    dispatch({ type: \"assessment-note\", payload: { questionId, value } });\n  };\n\n  const handleAssessmentStatusChange = (status) => {\n    dispatch({ type: \"assessment-status\", payload: { status } });\n  };\n\n  const overallCompletion = useMemo(() => {\n    const total = unit.stages.length;\n    const completed = Object.values(progress.stages ?? {}).filter((entry) => entry.completed).length;\n    return total > 0 ? Math.round((completed / total) * 100) : 0;\n  }, [unit.stages.length, progress.stages]);\n\n  const regularStagesComplete = useMemo(\n    () => unit.stages.every((stage) => progress.stages?.[stage.id]?.completed),\n    [unit.stages, progress.stages],\n  );\n  const pointerForUnit = useMemo(() => {\n    if (!classPacing) return null;\n    if (classPacing.unitId && classPacing.unitId !== unit.id) return null;\n    if (!classPacing.lessonId) return null;\n    return classPacing;\n  }, [classPacing, unit.id]);\n\n  const pointerIndex = useMemo(() => {\n    if (!pointerForUnit) return -1;\n    return stages.findIndex((entry) => entry.id === pointerForUnit.lessonId);\n  }, [pointerForUnit, stages]);\n\n  useEffect(() => {\n    if (isTeacher) return;\n    if (pointerIndex < 0 || pointerIndex >= stages.length) {\n      pointerIndexRef.current = null;\n      return;\n    }\n\n    const previousPointer = pointerIndexRef.current;\n    pointerIndexRef.current = pointerIndex;\n\n    if (previousPointer === pointerIndex) {\n      return;\n    }\n\n    setActiveStageIndex(pointerIndex);\n  }, [pointerIndex, stages.length, isTeacher]);\n\n  const pointerUnlocksAssessment = pointerForUnit?.lessonId === ASSESSMENT_STAGE_ID;\n  const assessmentUnlocked = pointerUnlocksAssessment || !hasAssessment || regularStagesComplete;\n\n  const handleSetPace = async (stage) => {\n    if (!isTeacher || !classId || !session?.token || !stage) return false;\n    const stageId = stage.id;\n    setPaceStatus((prev) => ({ ...prev, [stageId]: \"setting\" }));\n    try {\n      const response = await updateClassPacing(session.token, classId, {\n        unitId: unit.id,\n        lessonId: stageId,\n        lessonTitle: stage.title,\n      });\n      if (response?.pacing) {\n        setClassPacing(response.pacing);\n        setCurrentPacing({ unitId: response.pacing.unitId, lessonId: response.pacing.lessonId });\n      } else {\n        setCurrentPacing({ unitId: unit.id, lessonId: stageId });\n      }\n      setPaceStatus((prev) => {\n        if (!prev || prev[stageId] !== \"set\") return prev;\n        const updated = { ...prev };\n        delete updated[stageId];\n        return updated;\n      });\n      setTimeout(() => {\n        setPaceStatus((prev) => {\n          if (!prev || prev[stageId] !== \"set\") return prev;\n          const updated = { ...prev };\n          delete updated[stageId];\n          return updated;\n        });\n      }, 2000);\n      return true;\n    } catch (error) {\n      console.warn(\"Failed to update class pacing\", error);\n      setPaceStatus((prev) => {\n        if (!prev || prev[stageId] !== \"error\") return prev;\n        const updated = { ...prev };\n        delete updated[stageId];\n        return updated;\n      });\n      setTimeout(() => {\n        setPaceStatus((prev) => {\n          if (!prev || prev[stageId] !== \"error\") return prev;\n          const updated = { ...prev };\n          delete updated[stageId];\n          return updated;\n        });\n      }, 2000);\n      return false;\n    }\n  };\n\n  const handleTeacherAdvancePacingToStage = async (targetStage) => {\n    if (!targetStage) return false;\n    const ok = await handleSetPace(targetStage);\n    if (ok) {\n      const targetIndex = stages.findIndex((entry) => entry.id === targetStage.id);\n      if (targetIndex !== -1) {\n        setActiveStageIndex(targetIndex);\n      }\n    }\n    return ok;\n  };\n\n  const handleStopClassPace = async () => {\n    if (!isTeacher || !classId || !session?.token) return false;\n    setPaceStatus((prev) => ({ ...prev, __stop: \"setting\" }));\n    try {\n      const response = await updateClassPacing(session.token, classId, { command: \"stop\" });\n      if (response?.pacing) {\n        setClassPacing(response.pacing);\n        setCurrentPacing({ unitId: response.pacing.unitId, lessonId: response.pacing.lessonId });\n      }\n      setPaceStatus((prev) => {\n        if (!prev || prev.__stop !== \"set\") return prev;\n        const updated = { ...prev };\n        delete updated.__stop;\n        return updated;\n      });\n      setTimeout(() => {\n        setPaceStatus((prev) => {\n          if (!prev || prev.__stop !== \"set\") return prev;\n          const updated = { ...prev };\n          delete updated.__stop;\n          return updated;\n        });\n      }, 2000);\n      return true;\n    } catch (error) {\n      console.warn(\"Failed to save pacing pointer\", error);\n      setPaceStatus((prev) => {\n        if (!prev || prev.__stop !== \"error\") return prev;\n        const updated = { ...prev };\n        delete updated.__stop;\n        return updated;\n      });\n      setTimeout(() => {\n        setPaceStatus((prev) => {\n          if (!prev || prev.__stop !== \"error\") return prev;\n          const updated = { ...prev };\n          delete updated.__stop;\n          return updated;\n        });\n      }, 2000);\n      return false;\n    }\n  };\n\n  return (\n    <div className={`gamified-page ${sidebarCollapsed ? \"sidebar-collapsed\" : \"\"} ${headerCollapsed ? \"header-collapsed\" : \"\"} ${isTeacher && isPresentationMode ? \"presentation-mode\" : \"\"}`}>\n      {isTeacher && isPresentationMode && (\n        <button\n          type=\"button\"\n          className=\"presentation-exit-button\"\n          onClick={togglePresentationMode}\n        >\n          Exit presentation\n        </button>\n      )}\n      <header className={`gamified-header ${headerCollapsed ? \"is-collapsed\" : \"\"}`}>\n        <div className=\"gamified-header__main\">\n          <div>\n            <span className=\"gamified-eyebrow\">{programmeLabel} Â· {unit.id}</span>\n            <h1>{unit.title}</h1>\n            {!headerCollapsed && (\n              <>\n                <p>{unit.guidingQuestion}</p>\n                <div className=\"gamified-meta\">\n                  {unit.hours?.sl && <span>{unit.hours.sl}</span>}\n                  {unit.hours?.hl && <span>{unit.hours.hl}</span>}\n                </div>\n              </>\n            )}\n          </div>\n          {isTeacher ? (\n            <div className=\"teacher-controls\">\n              <button onClick={togglePresentationMode} className=\"btn\">\n                {isPresentationMode ? \"Exit Presentation\" : \"Enter Presentation\"}\n              </button>\n            </div>\n          ) : (\n            <div className=\"gamified-header__stats\">\n              <StatCard\n                tone=\"brand\"\n                compact={headerCollapsed}\n                badge={\n                  <span className={`stat-card__badge ${levelUpModal ? \"is-celebrating\" : \"\"}`}>Lv {level}</span>\n                }\n                label=\"Your journey\"\n                value={`${formattedXp} XP`}\n                description={headerCollapsed ? null : `Next level at ${formattedNextLevel} XP`}\n                progress={headerCollapsed ? null : levelProgress}\n                progressLabel={headerCollapsed ? null : `${Math.round(overallCompletion)}% unit completion`}\n                actions={\n                  <button\n                    type=\"button\"\n                    className=\"stat-card__action\"\n                    onClick={() => setHeaderCollapsed(!headerCollapsed)}\n                    aria-expanded={!headerCollapsed}\n                  >\n                    {headerCollapsed ? \"Show stats\" : \"Hide stats\"}\n                  </button>\n                }\n              />\n            </div>\n          )}\n        </div>\n      </header>\n\n      <main className=\"gamified-main\">\n        <nav className={`gamified-stages ${sidebarCollapsed ? \"is-collapsed\" : \"\"}`} aria-label=\"Stage navigation\">\n          <button\n            type=\"button\"\n            className=\"gamified-sidebar-toggle\"\n            onClick={() => setSidebarCollapsed(!sidebarCollapsed)}\n            aria-label={sidebarCollapsed ? \"Expand sidebar\" : \"Collapse sidebar\"}\n            aria-expanded={!sidebarCollapsed}\n          >\n            {sidebarCollapsed ? \"â–¶\" : \"â—€\"}\n          </button>\n          <ul>\n            {stages.map((stage, index) => {\n              const state = progress.stages?.[stage.id];\n\n              let unlocked;\n              if (isTeacher) {\n                unlocked = true;\n              } else if (stage.id === ASSESSMENT_STAGE_ID) {\n                if (pointerForUnit) {\n                  if (pointerIndex === -1) {\n                    unlocked = index === 0;\n                  } else {\n                    unlocked = index <= pointerIndex;\n                  }\n                } else {\n                  unlocked = assessmentUnlocked;\n                }\n              } else if (pointerForUnit) {\n                if (pointerIndex === -1) {\n                  unlocked = index === 0 || (index > 0 && progress.stages?.[stages[index - 1].id]?.completed);\n                } else {\n                  unlocked = index <= pointerIndex;\n                }\n              } else {\n                unlocked = index === 0 || (index > 0 && progress.stages?.[stages[index - 1].id]?.completed);\n              }\n\n              const isActive = index === activeStageIndex;\n              const isPointerStage = Boolean(pointerForUnit) && pointerForUnit.lessonId === stage.id;\n              const currentPaceStatus = paceStatus[stage.id];\n              return (\n                <li key={stage.id} className=\"gamified-stage-item\">\n                  <button\n                    type=\"button\"\n                    className={`gamified-stage-link${isActive ? \" is-active\" : \"\"}${state?.completed ? \" is-complete\" : \"\"}${\n                      !unlocked ? \" is-locked\" : \"\"\n                    }${isPointerStage ? \" is-pointer\" : \"\"}`}\n                    disabled={!unlocked}\n                    onClick={() => unlocked && setActiveStageIndex(index)}\n                  >\n                    <span className=\"gamified-stage-title\">{stage.title}</span>\n                    <span className=\"gamified-stage-duration\">{stage.duration}</span>\n                  </button>\n                  {isTeacher && (\n                    <button\n                      className={`set-pace-btn ${currentPaceStatus ? `set-pace-btn--${currentPaceStatus}` : \"\"}`}\n                      onClick={() => handleSetPace(stage)}\n                      disabled={currentPaceStatus === \"setting\"}\n                    >\n                      {currentPaceStatus === \"setting\" ? \"Setting...\" : currentPaceStatus === \"set\" ? \"Pace Set!\" : currentPaceStatus === \"error\" ? \"Error\" : \"Set Pace\"}\n                    </button>\n                  )}\n                </li>\n              );\n            })}\n          </ul>\n        </nav>\n\n        <section className=\"gamified-stage-viewer\">\n          <StagePlayer\n            key={activeStage?.id}\n            unit={unit}\n            stages={stages}\n            stage={activeStage}\n            progress={progress}\n            assessment={unit.assessment}\n            assessmentState={progress.assessment}\n            onAssessmentResponseChange={handleAssessmentResponseChange}\n            onAssessmentMarkChange={handleAssessmentMarkChange}\n            onAssessmentNoteChange={handleAssessmentNoteChange}\n            onAssessmentStatusChange={handleAssessmentStatusChange}\n            assessmentUnlocked={assessmentUnlocked}\n            overallCompletion={overallCompletion}\n            onAdvance={handleSegmentAdvance}\n            onReflectionSave={handleReflectionSave}\n            onPlannerSave={handlePlannerSave}\n            onAttempt={handleAttempt}\n            isTeacher={isTeacher}\n            classId={classId}\n            onAdvanceClassPace={handleTeacherAdvancePacingToStage}\n            onStopClassPace={classId ? handleStopClassPace : null}\n            stopStatus={paceStatus.__stop ?? null}\n          />\n        </section>\n      </main>\n\n      {resultModal && (\n        <AssessmentResultsModal\n          {...resultModal}\n          onClose={() => setResultModal(null)}\n          onContinue={() => {\n            if (typeof resultModal.onAdvance === \"function\" && resultModal.success) {\n              resultModal.onAdvance();\n            }\n            setResultModal(null);\n          }}\n        />\n      )}\n\n      {levelUpModal && (\n        <LevelUpModal\n          oldLevel={levelUpModal.oldLevel}\n          newLevel={levelUpModal.newLevel}\n          xp={levelUpModal.xp}\n          onClose={() => setLevelUpModal(null)}\n        />\n      )}\n    </div>\n  );\n}\n\nfunction StagePlayer({\n  unit,\n  stages,\n  stage,\n  progress,\n  assessment,\n  assessmentState,\n  onAssessmentResponseChange,\n  onAssessmentMarkChange,\n  onAssessmentNoteChange,\n  onAssessmentStatusChange,\n  assessmentUnlocked,\n  overallCompletion,\n  onAdvance,\n  onReflectionSave,\n  onPlannerSave,\n  onAttempt,\n  isTeacher,\n  classId,\n  onAdvanceClassPace,\n  onStopClassPace,\n  stopStatus,\n}) {\n  const isAssessmentStage = stage?.id === ASSESSMENT_STAGE_ID;\n  const segments = useMemo(() => {\n    if (isAssessmentStage) {\n      return [];\n    }\n    const candidates = Array.isArray(stage?.segments) ? stage.segments : [];\n    return candidates.filter((segment) => isSegmentVisibleForRole(segment, { isTeacher }));\n  }, [stage?.segments, isTeacher, isAssessmentStage]);\n  const stageId = stage?.id;\n  const stageProgress = stageId ? progress.stages?.[stageId] ?? {} : {};\n  const initialIndex = Math.min(stageProgress.segmentIndex ?? 0, Math.max(segments.length - 1, 0));\n  const [currentIndex, setCurrentIndex] = useState(isAssessmentStage ? 0 : initialIndex);\n  const [teacherAssessmentView, setTeacherAssessmentView] = useState(false);\n  const [advanceState, setAdvanceState] = useState(\"idle\");\n  const [advanceError, setAdvanceError] = useState(null);\n  const stageContainerRef = useRef(null);\n  const advanceTimeoutRef = useRef(null);\n  const [transitionDirection, setTransitionDirection] = useState(\"forward\");\n  const assessmentStatus = assessmentState?.status;\n\n  useEffect(() => {\n    setTeacherAssessmentView(false);\n  }, [stageId, currentIndex]);\n\n  useEffect(() => {\n    if (advanceTimeoutRef.current) {\n      clearTimeout(advanceTimeoutRef.current);\n      advanceTimeoutRef.current = null;\n    }\n    setAdvanceState(\"idle\");\n    setAdvanceError(null);\n  }, [stageId]);\n\n  useEffect(() => {\n    return () => {\n      if (advanceTimeoutRef.current) {\n        clearTimeout(advanceTimeoutRef.current);\n      }\n    };\n  }, []);\n\n  useEffect(() => {\n    if (isAssessmentStage) {\n      setCurrentIndex(0);\n    } else {\n      setCurrentIndex(initialIndex);\n    }\n    setTransitionDirection(\"forward\");\n  }, [initialIndex, stageId, isAssessmentStage]);\n\n  useEffect(() => {\n    if (typeof window === \"undefined\") return;\n    const node = stageContainerRef.current;\n    if (!node) return;\n    const prefersReducedMotion = window.matchMedia?.(\"(prefers-reduced-motion: reduce)\")?.matches;\n    node.scrollIntoView({\n      behavior: prefersReducedMotion ? \"auto\" : \"smooth\",\n      block: \"start\",\n    });\n  }, [stageId, currentIndex]);\n\n  useEffect(() => {\n    if (!isAssessmentStage || !assessmentState || !stage?.id) return;\n    if (assessmentStatus === \"completed\" && !stageProgress.completed) {\n      onAdvance(stage.id, 1, true);\n    }\n  }, [isAssessmentStage, assessmentState, assessmentStatus, stageProgress.completed, stage?.id, onAdvance]);\n\n  if (!stage) {\n    return (\n      <div className=\"gamified-stage-complete\">\n        <h2>Select a stage</h2>\n        <p>Choose a stage from the sidebar to get started.</p>\n      </div>\n    );\n  }\n\n  const currentSegment = segments[currentIndex];\n  const isFormativeAssessment = currentSegment && (currentSegment.type === 'micro-quiz' || currentSegment.type === 'activity');\n  const currentStageIndex = stages?.findIndex((item) => item.id === stageId) ?? -1;\n  const nextStage = currentStageIndex >= 0 ? stages[currentStageIndex + 1] : null;\n  const stopButtonDisabled = stopStatus === \"setting\";\n\n  const handleComplete = () => {\n    const nextIndex = Math.min(currentIndex + 1, segments.length);\n    const stageComplete = nextIndex >= segments.length;\n    setTransitionDirection(\"forward\");\n    setCurrentIndex((prev) => Math.min(prev + 1, segments.length));\n    onAdvance(stage.id, nextIndex, stageComplete);\n  };\n\n  const handleBack = () => {\n    setTransitionDirection(\"back\");\n    setCurrentIndex((prev) => Math.max(prev - 1, 0));\n  };\n\n  const handleAdvancePacingForClass = async () => {\n    if (!onAdvanceClassPace || !stageId) return;\n    const targetStage = nextStage ?? stage;\n    setAdvanceState(\"pending\");\n    setAdvanceError(null);\n    try {\n      const ok = await onAdvanceClassPace(targetStage, { fromStageId: stageId, isLastStage: !nextStage });\n      if (!ok) {\n        throw new Error(\"Unable to update class pacing\");\n      }\n      setAdvanceState(\"success\");\n    } catch (error) {\n      console.warn(\"Failed to advance class pacing\", error);\n      setAdvanceState(\"error\");\n      setAdvanceError(error?.message || \"Unable to unlock next stage right now\");\n    } finally {\n      if (advanceTimeoutRef.current) {\n        clearTimeout(advanceTimeoutRef.current);\n      }\n      advanceTimeoutRef.current = setTimeout(() => {\n        setAdvanceState(\"idle\");\n        setAdvanceError(null);\n      }, 2000);\n    }\n  };\n\n\n  if (isAssessmentStage && assessment) {\n    return (\n      <div className=\"gamified-stage\" ref={stageContainerRef}>\n        <div className={`gamified-stage__panel gamified-stage__panel--${transitionDirection}`}>\n          <AssessmentPanel\n            unit={unit}\n            assessmentState={assessmentState}\n            onResponseChange={onAssessmentResponseChange}\n            onMarkChange={onAssessmentMarkChange}\n            onTeacherNoteChange={onAssessmentNoteChange}\n            onStatusChange={onAssessmentStatusChange}\n            isTeacher={isTeacher}\n            isUnlocked={assessmentUnlocked}\n            completionPercentage={overallCompletion}\n          />\n        </div>\n      </div>\n    );\n  }\n\n  if (isTeacher && classId && isFormativeAssessment && !teacherAssessmentView) {\n    return (\n      <div className=\"gamified-stage\" ref={stageContainerRef}>\n        <LiveAssessmentDashboard\n          classId={classId}\n          unitId={unit.id}\n          segment={currentSegment}\n          stage={stage}\n          isLastStage={!nextStage}\n          nextStageTitle={nextStage?.title ?? null}\n          advanceState={advanceState}\n          advanceError={advanceError}\n          onShowAssessment={() => setTeacherAssessmentView(true)}\n          onAdvancePacing={handleAdvancePacingForClass}\n        />\n      </div>\n    );\n  }\n\n  if (!currentSegment) {\n    return (\n      <div className=\"gamified-stage-complete\">\n        <h2>Stage complete!</h2>\n        <p>Select the next stage from the sidebar or revisit segments to reinforce the concepts.</p>\n      </div>\n    );\n  }\n\n  const panelKey = `${stageId}:${currentSegment?.id}:${transitionDirection}`;\n  const panelClassName = `gamified-stage__panel gamified-stage__panel--${transitionDirection}`;\n\n  return (\n    <div className=\"gamified-stage\" ref={stageContainerRef}>\n      <header className=\"gamified-stage-header\">\n        <div>\n          <span className=\"gamified-stage-eyebrow\">Stage {stage.id}</span>\n          <h2>{stage.title}</h2>\n          <p>{stage.description}</p>\n        </div>\n        <div className=\"gamified-stage-header__actions\">\n          {isTeacher && onStopClassPace && (\n            <button\n              type=\"button\"\n              className=\"btn btn--outline\"\n              onClick={onStopClassPace}\n              disabled={stopButtonDisabled}\n            >\n              {stopButtonDisabled ? \"Savingâ€¦\" : \"Stop teaching\"}\n            </button>\n          )}\n          {isTeacher && isFormativeAssessment && teacherAssessmentView && (\n            <button onClick={() => setTeacherAssessmentView(false)} className=\"btn btn--ghost\">\n              Back to Live Dashboard\n            </button>\n          )}\n        </div>\n        <span className=\"gamified-stage-progress\">\n          {Math.min(currentIndex + 1, segments.length)} / {segments.length}\n        </span>\n      </header>\n      {stopStatus === \"error\" && (\n        <p className=\"gamified-feedback is-error\">Unable to save the teaching pointer. Please try again.</p>\n      )}\n      <div key={panelKey} className={panelClassName}>\n        <SegmentRenderer\n          unit={unit}\n          stage={stage}\n          segment={currentSegment}\n          onComplete={handleComplete}\n          onBack={currentIndex > 0 ? handleBack : null}\n          onReflectionSave={onReflectionSave}\n          onPlannerSave={onPlannerSave}\n          onAttempt={onAttempt}\n          attempts={progress.attempts}\n          reflections={progress.reflections}\n          planner={progress.planner}\n          isTeacher={isTeacher}\n        />\n      </div>\n    </div>\n  );\n}\n\nfunction AssessmentPanel({\n  unit,\n  assessmentState,\n  onResponseChange,\n  onMarkChange,\n  onTeacherNoteChange,\n  onStatusChange,\n  isTeacher,\n  isUnlocked,\n  completionPercentage,\n}) {\n  const assessment = unit.assessment;\n  const questions = assessment?.questions ?? [];\n  const [expanded, setExpanded] = useState(true);\n  const normalized = normalizeAssessment(assessmentState);\n\n  const totalAwarded = useMemo(\n    () =>\n      Object.values(normalized.marks ?? {}).reduce((sum, value) => {\n        const numeric = Number(value);\n        return sum + (Number.isFinite(numeric) ? numeric : 0);\n      }, 0),\n    [normalized.marks],\n  );\n\n  const handleExport = () => {\n    if (typeof window !== \"undefined\") {\n      window.print();\n    }\n  };\n\n  if (!assessment) {\n    return null;\n  }\n\n  if (assessment.format === \"auto-mcq\") {\n    return (\n      <section className=\"gamified-assessment\">\n        <article className=\"gamified-card gamified-assessment__card\">\n          <header className=\"gamified-assessment__header\">\n            <div>\n              <h2>Summative checkpoint</h2>\n              <p className=\"muted\">\n                {assessment.duration} Â· {assessment.totalMarks} marks\n              </p>\n            </div>\n            <button\n              type=\"button\"\n              className=\"btn btn--outline\"\n              onClick={() => setExpanded((prev) => !prev)}\n              disabled={!isUnlocked}\n            >\n              {expanded ? \"Hide assessment\" : \"Open assessment\"}\n            </button>\n          </header>\n\n          {!isUnlocked && (\n            <p className=\"gamified-assessment__lock\">\n              Complete all stages to unlock the assessment. You are {completionPercentage}% through the unit.\n            </p>\n          )}\n\n          {expanded && isUnlocked && (\n            <AutoMarkingAssessment\n              assessment={assessment}\n              normalizedState={normalized}\n              onResponseChange={onResponseChange}\n              onMarkChange={onMarkChange}\n              onStatusChange={onStatusChange}\n              isTeacher={isTeacher}\n            />\n          )}\n        </article>\n      </section>\n    );\n  }\n\n  return (\n    <section className=\"gamified-assessment\">\n      <article className=\"gamified-card gamified-assessment__card\">\n        <header className=\"gamified-assessment__header\">\n          <div>\n            <h2>End-of-unit assessment</h2>\n            <p className=\"muted\">\n              {assessment.duration} Â· {assessment.totalMarks} marks\n            </p>\n          </div>\n          <button\n            type=\"button\"\n            className=\"btn btn--outline\"\n            onClick={() => setExpanded((prev) => !prev)}\n            disabled={!isUnlocked}\n          >\n            {expanded ? \"Hide assessment\" : \"Open assessment\"}\n          </button>\n        </header>\n\n        {!isUnlocked && (\n          <p className=\"gamified-assessment__lock\">\n            Complete all stages to unlock the assessment. You are {completionPercentage}% through the unit.\n          </p>\n        )}\n\n        {expanded && isUnlocked && (\n          <div className=\"gamified-assessment__body\">\n            <p>\n              Answer each question in the space provided. Your work saves automatically on this device. Use the download\n              button to export a PDF copy for your teacher.\n            </p>\n            <ol className=\"gamified-assessment__questions\">\n              {questions.map((question) => (\n                <li key={question.id}>\n                  <div className=\"gamified-assessment__prompt\">\n                    <p>{question.prompt}</p>\n                    <span>{question.marks} marks</span>\n                  </div>\n                  <textarea\n                    rows={6}\n                    value={normalized.responses?.[question.id] ?? \"\"}\n                    onChange={(event) => onResponseChange(question.id, event.target.value)}\n                  />\n                </li>\n              ))}\n            </ol>\n            <div className=\"gamified-assessment__actions\">\n              <button type=\"button\" className=\"btn btn--primary\" onClick={handleExport}>\n                Download as PDF\n              </button>\n            </div>\n\n            {isTeacher ? (\n              <aside className=\"gamified-assessment__teacher gamified-assessment__teacher--panel\">\n                <div className=\"gamified-assessment__teacher-header\">\n                  <h3>Teacher marking workspace</h3>\n                  <span>\n                    Total awarded: {totalAwarded} / {assessment.totalMarks}\n                  </span>\n                </div>\n                <div className=\"gamified-assessment__teacher-grid\">\n                  {questions.map((question) => (\n                    <div key={question.id} className=\"gamified-assessment__teacher-item\">\n                      <div className=\"gamified-assessment__teacher-meta\">\n                        <h4>{question.prompt}</h4>\n                        <span>{question.marks} marks</span>\n                      </div>\n                      <label>\n                        <span>Marks awarded</span>\n                        <input\n                          type=\"number\"\n                          min={0}\n                          max={question.marks}\n                          value={normalized.marks?.[question.id] ?? \"\"}\n                          onChange={(event) => onMarkChange(question.id, event.target.value)}\n                        />\n                      </label>\n                      <label>\n                        <span>Feedback</span>\n                        <textarea\n                          rows={3}\n                          value={normalized.teacherNotes?.[question.id] ?? \"\"}\n                          onChange={(event) => onTeacherNoteChange(question.id, event.target.value)}\n                        />\n                      </label>\n                    </div>\n                  ))}\n                </div>\n              </aside>\n            ) : (\n              <aside className=\"gamified-assessment__teacher gamified-assessment__teacher--hint\">\n                <h3>Teacher view</h3>\n                <p>\n                  Teachers can record marks and feedback from the dashboard. Export your responses to share a PDF copy\n                  when requested.\n                </p>\n              </aside>\n            )}\n          </div>\n        )}\n      </article>\n    </section>\n  );\n}\n\nfunction LevelUpModal({ oldLevel, newLevel, xp, onClose }) {\n  const confettiPieces = Array.from({ length: 50 }).map((_, i) => ({\n    id: i,\n    delay: `${i * 0.05}s`,\n    offset: `${(Math.random() - 0.5) * 200}px`,\n  }));\n\n  return (\n    <Modal isOpen={true} onClose={onClose} size=\"md\" closeOnBackdropClick={true}>\n      <div className=\"level-up-modal\">\n        <div className=\"level-up-modal__confetti\">\n          {confettiPieces.map((piece) => (\n            <div\n              key={piece.id}\n              className=\"confetti-piece\"\n              style={{\n                '--delay': piece.delay,\n                '--offset': piece.offset,\n              }}\n            />\n          ))}\n        </div>\n        <div className=\"level-up-modal__content\">\n          <div className=\"level-up-modal__icon\">ðŸŽ‰</div>\n          <h2 className=\"level-up-modal__title\">Level Up!</h2>\n          <div className=\"level-up-modal__levels\">\n            <span className=\"level-up-modal__old-level\">Lv {oldLevel}</span>\n            <span className=\"level-up-modal__arrow\">â†’</span>\n            <span className=\"level-up-modal__new-level\">Lv {newLevel}</span>\n          </div>\n          <p className=\"level-up-modal__message\">Congratulations! You&apos;ve reached Level {newLevel}!</p>\n          <div className=\"level-up-modal__xp\">\n            <strong>{xp} XP</strong>\n            <span>Total Experience</span>\n          </div>\n          <button type=\"button\" className=\"level-up-modal__button\" onClick={onClose}>\n            Continue Learning\n          </button>\n        </div>\n      </div>\n    </Modal>\n  );\n}\n\nfunction SegmentRenderer({\n  unit,\n  stage,\n  segment,\n  onComplete,\n  onBack,\n  onReflectionSave,\n  onPlannerSave,\n  onAttempt,\n  attempts,\n  reflections,\n  planner,\n  isTeacher,\n}) {\n  const attemptStats = attempts?.[segment.id];\n  const sharedProps = { segment, onComplete, onBack, attemptStats, onAttempt, isTeacher, unit, stage };\n\n  switch (segment.type) {\n    case \"content\":\n    case \"list\":\n    case \"table\":\n    case \"accordion\":\n      return <ContentSegment {...sharedProps} />;\n    case \"micro-quiz\":\n      return <MicroQuizSegment {...sharedProps} />;\n    case \"activity\":\n      return <ActivitySegment {...sharedProps} plannerValues={planner} onPlannerSave={onPlannerSave} />;\n    case \"demo\":\n      return <DemoSegment {...sharedProps} />;\n    case \"python-playground\":\n      return <PythonPlaygroundSegment {...sharedProps} />;\n    case \"reflection\":\n      return (\n        <ReflectionSegment\n          {...sharedProps}\n          onSave={onReflectionSave}\n          initialValue={reflections?.[segment.id] ?? \"\"}\n        />\n      );\n    default:\n      return <ContentSegment {...sharedProps} />;\n  }\n}\n","import { useLocation } from \"react-router-dom\";\nimport GamifiedModulePage from \"../components/GamifiedModulePage.jsx\";\nimport { GamificationProvider } from \"../context/GamificationContext.jsx\";\nimport unit from \"../content/b1ComputationalThinking.jsx\";\nimport \"./B1ModulePage.css\";\n\nfunction B1ModulePage() {\n  const location = useLocation();\n  const classId = location.state?.classId;\n  return (\n    <GamificationProvider>\n      <GamifiedModulePage unit={unit} classId={classId} />\n    </GamificationProvider>\n  );\n}\n\nexport default B1ModulePage;\n\n\n","import { useLocation } from \"react-router-dom\";\nimport GamifiedModulePage from \"../components/GamifiedModulePage.jsx\";\nimport { GamificationProvider } from \"../context/GamificationContext.jsx\";\nimport unit from \"../content/b2ProgrammingFundamentals.jsx\";\nimport \"./B2ModulePage.css\";\n\nfunction B2ModulePage() {\n  const location = useLocation();\n  const classId = location.state?.classId;\n  return (\n    <GamificationProvider>\n      <GamifiedModulePage unit={unit} classId={classId} />\n    </GamificationProvider>\n  );\n}\n\nexport default B2ModulePage;\n\n\n","import { useEffect, useMemo, useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport {\n  getTeacherDashboard,\n  getClassPacing,\n  getStudentDashboard,\n  getStudentClassPacing,\n} from \"../lib/api.js\";\nimport { useSession } from \"../hooks/useSession.js\";\nimport { YEAR7_UNITS, describeSlide, listSlidesForDeck } from \"../../../shared/liveDecks.js\";\nimport \"./Year7MapPage.css\";\n\nfunction normaliseAccessible(value) {\n  if (!value) return null;\n  if (typeof value === \"string\") return value;\n  if (typeof value === \"object\" && value.slideId) return value.slideId;\n  if (typeof value === \"object\" && value.id) return value.id;\n  return null;\n}\n\nfunction buildSnapshot(payload) {\n  if (!payload) return null;\n  const pacing = payload.pacing ?? payload;\n  const lessonId = payload.lesson?.id || pacing?.lessonId || pacing?.slideId || null;\n  const lesson = lessonId ? describeSlide(lessonId) : null;\n  const accessibleSource = payload.accessibleSlides ?? pacing?.accessibleSlides ?? [];\n  const accessible = new Set(accessibleSource.map((entry) => normaliseAccessible(entry)).filter(Boolean));\n  if (lesson?.slideId) accessible.add(lesson.slideId);\n  return {\n    classDoc: payload.class ?? null,\n    pacing,\n    lesson,\n    accessible,\n    sessionCode: pacing?.sessionCode ?? null,\n    sessionStatus: pacing?.sessionStatus ?? (lesson ? \"live\" : \"idle\"),\n    updatedAt: pacing?.updatedAt ?? null,\n  };\n}\n\nfunction formatTimestamp(value) {\n  if (!value) return null;\n  const date = new Date(value);\n  if (Number.isNaN(date.getTime())) return null;\n  return date.toLocaleString();\n}\n\nfunction statusBadge(status) {\n  switch ((status || \"upcoming\").toLowerCase()) {\n    case \"available\":\n      return { label: \"Ready\", className: \"is-ready\" };\n    case \"upcoming\":\n    default:\n      return { label: \"Coming soon\", className: \"is-upcoming\" };\n  }\n}\n\nfunction statusLabel(status) {\n  switch ((status || \"upcoming\").toLowerCase()) {\n    case \"live\":\n      return \"Live\";\n    case \"idle\":\n    default:\n      return \"Idle\";\n  }\n}\n\nexport default function Year7MapPage() {\n  const { session, ready } = useSession();\n  const token = session?.token ?? null;\n  const role = session?.user?.role ?? null;\n  const isTeacher = role === \"teacher\";\n  const isStudent = role === \"student\";\n  const navigate = useNavigate();\n\n  const [selectedUnitId, setSelectedUnitId] = useState(YEAR7_UNITS[0]?.id ?? \"\");\n  const selectedUnit = YEAR7_UNITS.find((unit) => unit.id === selectedUnitId) ?? YEAR7_UNITS[0];\n\n  const [teacherData, setTeacherData] = useState(null);\n  const [selectedClassId, setSelectedClassId] = useState(\"\");\n  const [classSnapshot, setClassSnapshot] = useState(null);\n  const [studentInfo, setStudentInfo] = useState(null);\n  const [studentSnapshot, setStudentSnapshot] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  const unitDeckSlides = useMemo(() => (selectedUnit?.deckId ? listSlidesForDeck(selectedUnit.deckId) : []), [selectedUnit?.deckId]);\n\n  useEffect(() => {\n    if (!ready || !token) return;\n    const run = async () => {\n      setLoading(true);\n      try {\n        if (isTeacher) {\n          const data = await getTeacherDashboard(token);\n          setTeacherData(data);\n          const year7Classes = (data.classes || []).filter((clazz) => {\n            const label = String(clazz?.yearGroup || \"\").toLowerCase();\n            return label.includes(\"year 7\") || label.includes(\"ks3\");\n          });\n          const defaultClass = year7Classes[0]?.id || \"\";\n          setSelectedClassId((previous) => (previous && year7Classes.some((clazz) => clazz.id === previous) ? previous : defaultClass));\n        } else if (isStudent) {\n          const dashboard = await getStudentDashboard(token);\n          setStudentInfo(dashboard);\n          const classId = dashboard.class?.id || dashboard.student?.classId || \"\";\n          if (classId) {\n            const response = await getStudentClassPacing(token, classId);\n            setStudentSnapshot(buildSnapshot(response));\n          } else {\n            setStudentSnapshot(null);\n          }\n        }\n        setError(null);\n      } catch (err) {\n        console.error(err);\n        setError(err);\n      } finally {\n        setLoading(false);\n      }\n    };\n    run();\n  }, [ready, token, isTeacher, isStudent]);\n\n  useEffect(() => {\n    if (!isTeacher || !token || !selectedClassId) {\n      setClassSnapshot(null);\n      return;\n    }\n    let cancelled = false;\n    const load = async () => {\n      try {\n        const response = await getClassPacing(token, selectedClassId);\n        if (!cancelled) setClassSnapshot(buildSnapshot(response));\n      } catch (err) {\n        console.error(err);\n        if (!cancelled) setClassSnapshot(null);\n      }\n    };\n    load();\n    return () => {\n      cancelled = true;\n    };\n  }, [isTeacher, token, selectedClassId]);\n\n  useEffect(() => {\n    if (!isStudent || !token || !studentInfo?.class?.id) return;\n    let cancelled = false;\n    const load = async () => {\n      try {\n        const response = await getStudentClassPacing(token, studentInfo.class.id);\n        if (!cancelled) setStudentSnapshot(buildSnapshot(response));\n      } catch (err) {\n        console.error(err);\n        if (!cancelled) setStudentSnapshot(null);\n      }\n    };\n    load();\n    return () => {\n      cancelled = true;\n    };\n  }, [isStudent, token, studentInfo?.class?.id]);\n\n  const handleTeachUnit = (unit) => {\n    if (!unit.deckId) return;\n    const params = new URLSearchParams();\n    params.set(\"deckId\", unit.deckId);\n    if (selectedClassId) params.set(\"classId\", selectedClassId);\n    navigate(`/curriculum/year7/live?${params.toString()}`);\n  };\n\n  const handlePreviewUnit = (unit) => {\n    if (!unit.deckId) return;\n    navigate(`/curriculum/year7/live?deckId=${unit.deckId}`);\n  };\n\n  const handleStudentContinue = (unit) => {\n    if (!unit.deckId) return;\n    const params = new URLSearchParams();\n    params.set(\"deckId\", unit.deckId);\n    navigate(`/curriculum/year7/live?${params.toString()}`);\n  };\n\n  return (\n    <div className=\"y7-map-shell\">\n      <header className=\"y7-map-hero\">\n        <div>\n          <span className=\"y7-map-eyebrow\">Key Stage 3 Â· Year 7 Computing</span>\n          <h1>Year 7 Curriculum Map</h1>\n          <p>\n            Launch a purposeful computing journey. Start with a teacher-paced introduction, then flow through practical units that\n            blend pedagogy, live facilitation, and student independence.\n          </p>\n        </div>\n      </header>\n\n      {error && <div className=\"y7-map-alert\">{error.message || \"Something went wrong.\"}</div>}\n\n      <div className=\"y7-map-layout\">\n        <section className=\"y7-map-units\">\n          {YEAR7_UNITS.map((unit) => {\n            const badge = statusBadge(unit.status);\n            const isSelected = unit.id === selectedUnit.id;\n            return (\n              <button\n                key={unit.id}\n                type=\"button\"\n                className={`y7-unit-card ${isSelected ? \"is-selected\" : \"\"}`}\n                onClick={() => setSelectedUnitId(unit.id)}\n              >\n                <span className=\"y7-unit-icon\" aria-hidden=\"true\">\n                  {unit.icon}\n                </span>\n                <div className=\"y7-unit-text\">\n                  <strong>{unit.title}</strong>\n                  <p>{unit.summary}</p>\n                </div>\n                <span className={`y7-unit-status ${badge.className}`}>{badge.label}</span>\n              </button>\n            );\n          })}\n        </section>\n\n        <aside className=\"y7-map-detail\">\n          <div className=\"y7-map-detail__header\">\n            <div>\n              <h2>{selectedUnit.title}</h2>\n              <p>{selectedUnit.summary}</p>\n            </div>\n            <div className=\"y7-map-stats\">\n              {selectedUnit.estimatedHours && (\n                <div>\n                  <span>Estimated time</span>\n                  <strong>{selectedUnit.estimatedHours}</strong>\n                </div>\n              )}\n              <div>\n                <span>Status</span>\n                <strong>{statusBadge(selectedUnit.status).label}</strong>\n              </div>\n            </div>\n          </div>\n\n          <div className=\"y7-map-detail__actions\">\n            {selectedUnit.deckId ? (\n              isTeacher ? (\n                <>\n                  <label className=\"y7-map-field\">\n                    <span>Select a class</span>\n                    <select value={selectedClassId} onChange={(event) => setSelectedClassId(event.target.value)}>\n                      <option value=\"\">Preview only</option>\n                      {(teacherData?.classes || [])\n                        .filter((clazz) => {\n                          const label = String(clazz?.yearGroup || \"\").toLowerCase();\n                          return label.includes(\"year 7\") || label.includes(\"ks3\");\n                        })\n                        .map((clazz) => (\n                          <option key={clazz.id} value={clazz.id}>\n                            {clazz.className}\n                          </option>\n                        ))}\n                    </select>\n                  </label>\n                  <div className=\"y7-map-buttons\">\n                    <button\n                      type=\"button\"\n                      className=\"y7-btn y7-btn--primary\"\n                      disabled={!selectedClassId || loading}\n                      onClick={() => handleTeachUnit(selectedUnit)}\n                    >\n                      Start teaching\n                    </button>\n                    <button type=\"button\" className=\"y7-btn\" onClick={() => handlePreviewUnit(selectedUnit)}>\n                      Preview deck\n                    </button>\n                  </div>\n                </>\n              ) : (\n                <div className=\"y7-map-buttons\">\n                  <button type=\"button\" className=\"y7-btn y7-btn--primary\" onClick={() => handleStudentContinue(selectedUnit)}>\n                    Continue learning\n                  </button>\n                  <button type=\"button\" className=\"y7-btn\" onClick={() => handlePreviewUnit(selectedUnit)}>\n                    Preview deck\n                  </button>\n                </div>\n              )\n            ) : (\n              <div className=\"y7-map-coming-soon\">\n                <p>We&apos;re crafting a live experience for this unit. Teacher notes, formative checkpoints, and pacing tools arrive soon.</p>\n              </div>\n            )}\n          </div>\n\n          <div className=\"y7-map-live-cards\">\n            {isTeacher && (\n              <div className=\"y7-live-summary-card\">\n                <header>\n                  <strong>Live session status</strong>\n                  <span className={`chip ${classSnapshot ? classSnapshot.sessionStatus : \"is-idle\"}`}>\n                    {statusLabel(classSnapshot?.sessionStatus)}\n                  </span>\n                </header>\n                {classSnapshot?.lesson && classSnapshot.lesson.deckId === selectedUnit.deckId ? (\n                  <>\n                    <p>\n                      Pointer on <strong>{classSnapshot.lesson.slideTitle}</strong>\n                      {typeof classSnapshot.lesson.index === \"number\" && unitDeckSlides.length ? (\n                        <span>\n                          {\" \"}(slide {classSnapshot.lesson.index + 1} of {unitDeckSlides.length})\n                        </span>\n                      ) : null}\n                    </p>\n                    {classSnapshot.sessionCode && (\n                      <p className=\"code\">Join code: {classSnapshot.sessionCode}</p>\n                    )}\n                    {classSnapshot.updatedAt && (\n                      <p className=\"meta\">Updated {formatTimestamp(classSnapshot.updatedAt)}</p>\n                    )}\n                  </>\n                ) : (\n                  <p>No active session for this unit yet. Launch it to generate a join code and live pointer.</p>\n                )}\n              </div>\n            )}\n\n            {isStudent && (\n              <div className=\"y7-live-summary-card\">\n                <header>\n                  <strong>Your live pointer</strong>\n                  <span className={`chip ${studentSnapshot ? studentSnapshot.sessionStatus : \"is-idle\"}`}>\n                    {statusLabel(studentSnapshot?.sessionStatus)}\n                  </span>\n                </header>\n                {studentSnapshot?.lesson && studentSnapshot.lesson.deckId === selectedUnit.deckId ? (\n                  <>\n                    <p>\n                      Current slide: <strong>{studentSnapshot.lesson.slideTitle}</strong>\n                      {typeof studentSnapshot.lesson.index === \"number\" && unitDeckSlides.length ? (\n                        <span>\n                          {\" \"}(slide {studentSnapshot.lesson.index + 1} of {unitDeckSlides.length})\n                        </span>\n                      ) : null}\n                    </p>\n                    {studentSnapshot.sessionCode && (\n                      <p className=\"code\">Join code: {studentSnapshot.sessionCode}</p>\n                    )}\n                  </>\n                ) : (\n                  <p>Your teacher hasn&apos;t started a live session for this unit yet. You can still review slides once it begins.</p>\n                )}\n              </div>\n            )}\n          </div>\n\n          <div className=\"y7-map-note\">\n            <h3>Why this unit works</h3>\n            <ul>\n              <li>Teacher-paced slides keep the class together while enabling rapid formative feedback.</li>\n              <li>Students revisit previous slides for retrieval practice but can never jump ahead of the pointer.</li>\n              <li>Live checkpoints surface to the teacher dashboard, supporting classroom dialogue and responsive teaching.</li>\n            </ul>\n          </div>\n        </aside>\n      </div>\n    </div>\n  );\n}\n\n","// canvas-confetti v1.9.4 built on 2025-10-25T05:14:56.640Z\nvar module = {};\n\n// source content\n/* globals Map */\n\n(function main(global, module, isWorker, workerSize) {\n  var canUseWorker = !!(\n    global.Worker &&\n    global.Blob &&\n    global.Promise &&\n    global.OffscreenCanvas &&\n    global.OffscreenCanvasRenderingContext2D &&\n    global.HTMLCanvasElement &&\n    global.HTMLCanvasElement.prototype.transferControlToOffscreen &&\n    global.URL &&\n    global.URL.createObjectURL);\n\n  var canUsePaths = typeof Path2D === 'function' && typeof DOMMatrix === 'function';\n  var canDrawBitmap = (function () {\n    // this mostly supports ssr\n    if (!global.OffscreenCanvas) {\n      return false;\n    }\n\n    try {\n      var canvas = new OffscreenCanvas(1, 1);\n      var ctx = canvas.getContext('2d');\n      ctx.fillRect(0, 0, 1, 1);\n      var bitmap = canvas.transferToImageBitmap();\n      ctx.createPattern(bitmap, 'no-repeat');\n    } catch (e) {\n      return false;\n    }\n\n    return true;\n  })();\n\n  function noop() {}\n\n  // create a promise if it exists, otherwise, just\n  // call the function directly\n  function promise(func) {\n    var ModulePromise = module.exports.Promise;\n    var Prom = ModulePromise !== void 0 ? ModulePromise : global.Promise;\n\n    if (typeof Prom === 'function') {\n      return new Prom(func);\n    }\n\n    func(noop, noop);\n\n    return null;\n  }\n\n  var bitmapMapper = (function (skipTransform, map) {\n    // see https://github.com/catdad/canvas-confetti/issues/209\n    // creating canvases is actually pretty expensive, so we should create a\n    // 1:1 map for bitmap:canvas, so that we can animate the confetti in\n    // a performant manner, but also not store them forever so that we don't\n    // have a memory leak\n    return {\n      transform: function(bitmap) {\n        if (skipTransform) {\n          return bitmap;\n        }\n\n        if (map.has(bitmap)) {\n          return map.get(bitmap);\n        }\n\n        var canvas = new OffscreenCanvas(bitmap.width, bitmap.height);\n        var ctx = canvas.getContext('2d');\n        ctx.drawImage(bitmap, 0, 0);\n\n        map.set(bitmap, canvas);\n\n        return canvas;\n      },\n      clear: function () {\n        map.clear();\n      }\n    };\n  })(canDrawBitmap, new Map());\n\n  var raf = (function () {\n    var TIME = Math.floor(1000 / 60);\n    var frame, cancel;\n    var frames = {};\n    var lastFrameTime = 0;\n\n    if (typeof requestAnimationFrame === 'function' && typeof cancelAnimationFrame === 'function') {\n      frame = function (cb) {\n        var id = Math.random();\n\n        frames[id] = requestAnimationFrame(function onFrame(time) {\n          if (lastFrameTime === time || lastFrameTime + TIME - 1 < time) {\n            lastFrameTime = time;\n            delete frames[id];\n\n            cb();\n          } else {\n            frames[id] = requestAnimationFrame(onFrame);\n          }\n        });\n\n        return id;\n      };\n      cancel = function (id) {\n        if (frames[id]) {\n          cancelAnimationFrame(frames[id]);\n        }\n      };\n    } else {\n      frame = function (cb) {\n        return setTimeout(cb, TIME);\n      };\n      cancel = function (timer) {\n        return clearTimeout(timer);\n      };\n    }\n\n    return { frame: frame, cancel: cancel };\n  }());\n\n  var getWorker = (function () {\n    var worker;\n    var prom;\n    var resolves = {};\n\n    function decorate(worker) {\n      function execute(options, callback) {\n        worker.postMessage({ options: options || {}, callback: callback });\n      }\n      worker.init = function initWorker(canvas) {\n        var offscreen = canvas.transferControlToOffscreen();\n        worker.postMessage({ canvas: offscreen }, [offscreen]);\n      };\n\n      worker.fire = function fireWorker(options, size, done) {\n        if (prom) {\n          execute(options, null);\n          return prom;\n        }\n\n        var id = Math.random().toString(36).slice(2);\n\n        prom = promise(function (resolve) {\n          function workerDone(msg) {\n            if (msg.data.callback !== id) {\n              return;\n            }\n\n            delete resolves[id];\n            worker.removeEventListener('message', workerDone);\n\n            prom = null;\n\n            bitmapMapper.clear();\n\n            done();\n            resolve();\n          }\n\n          worker.addEventListener('message', workerDone);\n          execute(options, id);\n\n          resolves[id] = workerDone.bind(null, { data: { callback: id }});\n        });\n\n        return prom;\n      };\n\n      worker.reset = function resetWorker() {\n        worker.postMessage({ reset: true });\n\n        for (var id in resolves) {\n          resolves[id]();\n          delete resolves[id];\n        }\n      };\n    }\n\n    return function () {\n      if (worker) {\n        return worker;\n      }\n\n      if (!isWorker && canUseWorker) {\n        var code = [\n          'var CONFETTI, SIZE = {}, module = {};',\n          '(' + main.toString() + ')(this, module, true, SIZE);',\n          'onmessage = function(msg) {',\n          '  if (msg.data.options) {',\n          '    CONFETTI(msg.data.options).then(function () {',\n          '      if (msg.data.callback) {',\n          '        postMessage({ callback: msg.data.callback });',\n          '      }',\n          '    });',\n          '  } else if (msg.data.reset) {',\n          '    CONFETTI && CONFETTI.reset();',\n          '  } else if (msg.data.resize) {',\n          '    SIZE.width = msg.data.resize.width;',\n          '    SIZE.height = msg.data.resize.height;',\n          '  } else if (msg.data.canvas) {',\n          '    SIZE.width = msg.data.canvas.width;',\n          '    SIZE.height = msg.data.canvas.height;',\n          '    CONFETTI = module.exports.create(msg.data.canvas);',\n          '  }',\n          '}',\n        ].join('\\n');\n        try {\n          worker = new Worker(URL.createObjectURL(new Blob([code])));\n        } catch (e) {\n          // eslint-disable-next-line no-console\n          typeof console !== 'undefined' && typeof console.warn === 'function' ? console.warn('ðŸŽŠ Could not load worker', e) : null;\n\n          return null;\n        }\n\n        decorate(worker);\n      }\n\n      return worker;\n    };\n  })();\n\n  var defaults = {\n    particleCount: 50,\n    angle: 90,\n    spread: 45,\n    startVelocity: 45,\n    decay: 0.9,\n    gravity: 1,\n    drift: 0,\n    ticks: 200,\n    x: 0.5,\n    y: 0.5,\n    shapes: ['square', 'circle'],\n    zIndex: 100,\n    colors: [\n      '#26ccff',\n      '#a25afd',\n      '#ff5e7e',\n      '#88ff5a',\n      '#fcff42',\n      '#ffa62d',\n      '#ff36ff'\n    ],\n    // probably should be true, but back-compat\n    disableForReducedMotion: false,\n    scalar: 1\n  };\n\n  function convert(val, transform) {\n    return transform ? transform(val) : val;\n  }\n\n  function isOk(val) {\n    return !(val === null || val === undefined);\n  }\n\n  function prop(options, name, transform) {\n    return convert(\n      options && isOk(options[name]) ? options[name] : defaults[name],\n      transform\n    );\n  }\n\n  function onlyPositiveInt(number){\n    return number < 0 ? 0 : Math.floor(number);\n  }\n\n  function randomInt(min, max) {\n    // [min, max)\n    return Math.floor(Math.random() * (max - min)) + min;\n  }\n\n  function toDecimal(str) {\n    return parseInt(str, 16);\n  }\n\n  function colorsToRgb(colors) {\n    return colors.map(hexToRgb);\n  }\n\n  function hexToRgb(str) {\n    var val = String(str).replace(/[^0-9a-f]/gi, '');\n\n    if (val.length < 6) {\n        val = val[0]+val[0]+val[1]+val[1]+val[2]+val[2];\n    }\n\n    return {\n      r: toDecimal(val.substring(0,2)),\n      g: toDecimal(val.substring(2,4)),\n      b: toDecimal(val.substring(4,6))\n    };\n  }\n\n  function getOrigin(options) {\n    var origin = prop(options, 'origin', Object);\n    origin.x = prop(origin, 'x', Number);\n    origin.y = prop(origin, 'y', Number);\n\n    return origin;\n  }\n\n  function setCanvasWindowSize(canvas) {\n    canvas.width = document.documentElement.clientWidth;\n    canvas.height = document.documentElement.clientHeight;\n  }\n\n  function setCanvasRectSize(canvas) {\n    var rect = canvas.getBoundingClientRect();\n    canvas.width = rect.width;\n    canvas.height = rect.height;\n  }\n\n  function getCanvas(zIndex) {\n    var canvas = document.createElement('canvas');\n\n    canvas.style.position = 'fixed';\n    canvas.style.top = '0px';\n    canvas.style.left = '0px';\n    canvas.style.pointerEvents = 'none';\n    canvas.style.zIndex = zIndex;\n\n    return canvas;\n  }\n\n  function ellipse(context, x, y, radiusX, radiusY, rotation, startAngle, endAngle, antiClockwise) {\n    context.save();\n    context.translate(x, y);\n    context.rotate(rotation);\n    context.scale(radiusX, radiusY);\n    context.arc(0, 0, 1, startAngle, endAngle, antiClockwise);\n    context.restore();\n  }\n\n  function randomPhysics(opts) {\n    var radAngle = opts.angle * (Math.PI / 180);\n    var radSpread = opts.spread * (Math.PI / 180);\n\n    return {\n      x: opts.x,\n      y: opts.y,\n      wobble: Math.random() * 10,\n      wobbleSpeed: Math.min(0.11, Math.random() * 0.1 + 0.05),\n      velocity: (opts.startVelocity * 0.5) + (Math.random() * opts.startVelocity),\n      angle2D: -radAngle + ((0.5 * radSpread) - (Math.random() * radSpread)),\n      tiltAngle: (Math.random() * (0.75 - 0.25) + 0.25) * Math.PI,\n      color: opts.color,\n      shape: opts.shape,\n      tick: 0,\n      totalTicks: opts.ticks,\n      decay: opts.decay,\n      drift: opts.drift,\n      random: Math.random() + 2,\n      tiltSin: 0,\n      tiltCos: 0,\n      wobbleX: 0,\n      wobbleY: 0,\n      gravity: opts.gravity * 3,\n      ovalScalar: 0.6,\n      scalar: opts.scalar,\n      flat: opts.flat\n    };\n  }\n\n  function updateFetti(context, fetti) {\n    fetti.x += Math.cos(fetti.angle2D) * fetti.velocity + fetti.drift;\n    fetti.y += Math.sin(fetti.angle2D) * fetti.velocity + fetti.gravity;\n    fetti.velocity *= fetti.decay;\n\n    if (fetti.flat) {\n      fetti.wobble = 0;\n      fetti.wobbleX = fetti.x + (10 * fetti.scalar);\n      fetti.wobbleY = fetti.y + (10 * fetti.scalar);\n\n      fetti.tiltSin = 0;\n      fetti.tiltCos = 0;\n      fetti.random = 1;\n    } else {\n      fetti.wobble += fetti.wobbleSpeed;\n      fetti.wobbleX = fetti.x + ((10 * fetti.scalar) * Math.cos(fetti.wobble));\n      fetti.wobbleY = fetti.y + ((10 * fetti.scalar) * Math.sin(fetti.wobble));\n\n      fetti.tiltAngle += 0.1;\n      fetti.tiltSin = Math.sin(fetti.tiltAngle);\n      fetti.tiltCos = Math.cos(fetti.tiltAngle);\n      fetti.random = Math.random() + 2;\n    }\n\n    var progress = (fetti.tick++) / fetti.totalTicks;\n\n    var x1 = fetti.x + (fetti.random * fetti.tiltCos);\n    var y1 = fetti.y + (fetti.random * fetti.tiltSin);\n    var x2 = fetti.wobbleX + (fetti.random * fetti.tiltCos);\n    var y2 = fetti.wobbleY + (fetti.random * fetti.tiltSin);\n\n    context.fillStyle = 'rgba(' + fetti.color.r + ', ' + fetti.color.g + ', ' + fetti.color.b + ', ' + (1 - progress) + ')';\n\n    context.beginPath();\n\n    if (canUsePaths && fetti.shape.type === 'path' && typeof fetti.shape.path === 'string' && Array.isArray(fetti.shape.matrix)) {\n      context.fill(transformPath2D(\n        fetti.shape.path,\n        fetti.shape.matrix,\n        fetti.x,\n        fetti.y,\n        Math.abs(x2 - x1) * 0.1,\n        Math.abs(y2 - y1) * 0.1,\n        Math.PI / 10 * fetti.wobble\n      ));\n    } else if (fetti.shape.type === 'bitmap') {\n      var rotation = Math.PI / 10 * fetti.wobble;\n      var scaleX = Math.abs(x2 - x1) * 0.1;\n      var scaleY = Math.abs(y2 - y1) * 0.1;\n      var width = fetti.shape.bitmap.width * fetti.scalar;\n      var height = fetti.shape.bitmap.height * fetti.scalar;\n\n      var matrix = new DOMMatrix([\n        Math.cos(rotation) * scaleX,\n        Math.sin(rotation) * scaleX,\n        -Math.sin(rotation) * scaleY,\n        Math.cos(rotation) * scaleY,\n        fetti.x,\n        fetti.y\n      ]);\n\n      // apply the transform matrix from the confetti shape\n      matrix.multiplySelf(new DOMMatrix(fetti.shape.matrix));\n\n      var pattern = context.createPattern(bitmapMapper.transform(fetti.shape.bitmap), 'no-repeat');\n      pattern.setTransform(matrix);\n\n      context.globalAlpha = (1 - progress);\n      context.fillStyle = pattern;\n      context.fillRect(\n        fetti.x - (width / 2),\n        fetti.y - (height / 2),\n        width,\n        height\n      );\n      context.globalAlpha = 1;\n    } else if (fetti.shape === 'circle') {\n      context.ellipse ?\n        context.ellipse(fetti.x, fetti.y, Math.abs(x2 - x1) * fetti.ovalScalar, Math.abs(y2 - y1) * fetti.ovalScalar, Math.PI / 10 * fetti.wobble, 0, 2 * Math.PI) :\n        ellipse(context, fetti.x, fetti.y, Math.abs(x2 - x1) * fetti.ovalScalar, Math.abs(y2 - y1) * fetti.ovalScalar, Math.PI / 10 * fetti.wobble, 0, 2 * Math.PI);\n    } else if (fetti.shape === 'star') {\n      var rot = Math.PI / 2 * 3;\n      var innerRadius = 4 * fetti.scalar;\n      var outerRadius = 8 * fetti.scalar;\n      var x = fetti.x;\n      var y = fetti.y;\n      var spikes = 5;\n      var step = Math.PI / spikes;\n\n      while (spikes--) {\n        x = fetti.x + Math.cos(rot) * outerRadius;\n        y = fetti.y + Math.sin(rot) * outerRadius;\n        context.lineTo(x, y);\n        rot += step;\n\n        x = fetti.x + Math.cos(rot) * innerRadius;\n        y = fetti.y + Math.sin(rot) * innerRadius;\n        context.lineTo(x, y);\n        rot += step;\n      }\n    } else {\n      context.moveTo(Math.floor(fetti.x), Math.floor(fetti.y));\n      context.lineTo(Math.floor(fetti.wobbleX), Math.floor(y1));\n      context.lineTo(Math.floor(x2), Math.floor(y2));\n      context.lineTo(Math.floor(x1), Math.floor(fetti.wobbleY));\n    }\n\n    context.closePath();\n    context.fill();\n\n    return fetti.tick < fetti.totalTicks;\n  }\n\n  function animate(canvas, fettis, resizer, size, done) {\n    var animatingFettis = fettis.slice();\n    var context = canvas.getContext('2d');\n    var animationFrame;\n    var destroy;\n\n    var prom = promise(function (resolve) {\n      function onDone() {\n        animationFrame = destroy = null;\n\n        context.clearRect(0, 0, size.width, size.height);\n        bitmapMapper.clear();\n\n        done();\n        resolve();\n      }\n\n      function update() {\n        if (isWorker && !(size.width === workerSize.width && size.height === workerSize.height)) {\n          size.width = canvas.width = workerSize.width;\n          size.height = canvas.height = workerSize.height;\n        }\n\n        if (!size.width && !size.height) {\n          resizer(canvas);\n          size.width = canvas.width;\n          size.height = canvas.height;\n        }\n\n        context.clearRect(0, 0, size.width, size.height);\n\n        animatingFettis = animatingFettis.filter(function (fetti) {\n          return updateFetti(context, fetti);\n        });\n\n        if (animatingFettis.length) {\n          animationFrame = raf.frame(update);\n        } else {\n          onDone();\n        }\n      }\n\n      animationFrame = raf.frame(update);\n      destroy = onDone;\n    });\n\n    return {\n      addFettis: function (fettis) {\n        animatingFettis = animatingFettis.concat(fettis);\n\n        return prom;\n      },\n      canvas: canvas,\n      promise: prom,\n      reset: function () {\n        if (animationFrame) {\n          raf.cancel(animationFrame);\n        }\n\n        if (destroy) {\n          destroy();\n        }\n      }\n    };\n  }\n\n  function confettiCannon(canvas, globalOpts) {\n    var isLibCanvas = !canvas;\n    var allowResize = !!prop(globalOpts || {}, 'resize');\n    var hasResizeEventRegistered = false;\n    var globalDisableForReducedMotion = prop(globalOpts, 'disableForReducedMotion', Boolean);\n    var shouldUseWorker = canUseWorker && !!prop(globalOpts || {}, 'useWorker');\n    var worker = shouldUseWorker ? getWorker() : null;\n    var resizer = isLibCanvas ? setCanvasWindowSize : setCanvasRectSize;\n    var initialized = (canvas && worker) ? !!canvas.__confetti_initialized : false;\n    var preferLessMotion = typeof matchMedia === 'function' && matchMedia('(prefers-reduced-motion)').matches;\n    var animationObj;\n\n    function fireLocal(options, size, done) {\n      var particleCount = prop(options, 'particleCount', onlyPositiveInt);\n      var angle = prop(options, 'angle', Number);\n      var spread = prop(options, 'spread', Number);\n      var startVelocity = prop(options, 'startVelocity', Number);\n      var decay = prop(options, 'decay', Number);\n      var gravity = prop(options, 'gravity', Number);\n      var drift = prop(options, 'drift', Number);\n      var colors = prop(options, 'colors', colorsToRgb);\n      var ticks = prop(options, 'ticks', Number);\n      var shapes = prop(options, 'shapes');\n      var scalar = prop(options, 'scalar');\n      var flat = !!prop(options, 'flat');\n      var origin = getOrigin(options);\n\n      var temp = particleCount;\n      var fettis = [];\n\n      var startX = canvas.width * origin.x;\n      var startY = canvas.height * origin.y;\n\n      while (temp--) {\n        fettis.push(\n          randomPhysics({\n            x: startX,\n            y: startY,\n            angle: angle,\n            spread: spread,\n            startVelocity: startVelocity,\n            color: colors[temp % colors.length],\n            shape: shapes[randomInt(0, shapes.length)],\n            ticks: ticks,\n            decay: decay,\n            gravity: gravity,\n            drift: drift,\n            scalar: scalar,\n            flat: flat\n          })\n        );\n      }\n\n      // if we have a previous canvas already animating,\n      // add to it\n      if (animationObj) {\n        return animationObj.addFettis(fettis);\n      }\n\n      animationObj = animate(canvas, fettis, resizer, size , done);\n\n      return animationObj.promise;\n    }\n\n    function fire(options) {\n      var disableForReducedMotion = globalDisableForReducedMotion || prop(options, 'disableForReducedMotion', Boolean);\n      var zIndex = prop(options, 'zIndex', Number);\n\n      if (disableForReducedMotion && preferLessMotion) {\n        return promise(function (resolve) {\n          resolve();\n        });\n      }\n\n      if (isLibCanvas && animationObj) {\n        // use existing canvas from in-progress animation\n        canvas = animationObj.canvas;\n      } else if (isLibCanvas && !canvas) {\n        // create and initialize a new canvas\n        canvas = getCanvas(zIndex);\n        document.body.appendChild(canvas);\n      }\n\n      if (allowResize && !initialized) {\n        // initialize the size of a user-supplied canvas\n        resizer(canvas);\n      }\n\n      var size = {\n        width: canvas.width,\n        height: canvas.height\n      };\n\n      if (worker && !initialized) {\n        worker.init(canvas);\n      }\n\n      initialized = true;\n\n      if (worker) {\n        canvas.__confetti_initialized = true;\n      }\n\n      function onResize() {\n        if (worker) {\n          // TODO this really shouldn't be immediate, because it is expensive\n          var obj = {\n            getBoundingClientRect: function () {\n              if (!isLibCanvas) {\n                return canvas.getBoundingClientRect();\n              }\n            }\n          };\n\n          resizer(obj);\n\n          worker.postMessage({\n            resize: {\n              width: obj.width,\n              height: obj.height\n            }\n          });\n          return;\n        }\n\n        // don't actually query the size here, since this\n        // can execute frequently and rapidly\n        size.width = size.height = null;\n      }\n\n      function done() {\n        animationObj = null;\n\n        if (allowResize) {\n          hasResizeEventRegistered = false;\n          global.removeEventListener('resize', onResize);\n        }\n\n        if (isLibCanvas && canvas) {\n          if (document.body.contains(canvas)) {\n            document.body.removeChild(canvas);\n          }\n          canvas = null;\n          initialized = false;\n        }\n      }\n\n      if (allowResize && !hasResizeEventRegistered) {\n        hasResizeEventRegistered = true;\n        global.addEventListener('resize', onResize, false);\n      }\n\n      if (worker) {\n        return worker.fire(options, size, done);\n      }\n\n      return fireLocal(options, size, done);\n    }\n\n    fire.reset = function () {\n      if (worker) {\n        worker.reset();\n      }\n\n      if (animationObj) {\n        animationObj.reset();\n      }\n    };\n\n    return fire;\n  }\n\n  // Make default export lazy to defer worker creation until called.\n  var defaultFire;\n  function getDefaultFire() {\n    if (!defaultFire) {\n      defaultFire = confettiCannon(null, { useWorker: true, resize: true });\n    }\n    return defaultFire;\n  }\n\n  function transformPath2D(pathString, pathMatrix, x, y, scaleX, scaleY, rotation) {\n    var path2d = new Path2D(pathString);\n\n    var t1 = new Path2D();\n    t1.addPath(path2d, new DOMMatrix(pathMatrix));\n\n    var t2 = new Path2D();\n    // see https://developer.mozilla.org/en-US/docs/Web/API/DOMMatrix/DOMMatrix\n    t2.addPath(t1, new DOMMatrix([\n      Math.cos(rotation) * scaleX,\n      Math.sin(rotation) * scaleX,\n      -Math.sin(rotation) * scaleY,\n      Math.cos(rotation) * scaleY,\n      x,\n      y\n    ]));\n\n    return t2;\n  }\n\n  function shapeFromPath(pathData) {\n    if (!canUsePaths) {\n      throw new Error('path confetti are not supported in this browser');\n    }\n\n    var path, matrix;\n\n    if (typeof pathData === 'string') {\n      path = pathData;\n    } else {\n      path = pathData.path;\n      matrix = pathData.matrix;\n    }\n\n    var path2d = new Path2D(path);\n    var tempCanvas = document.createElement('canvas');\n    var tempCtx = tempCanvas.getContext('2d');\n\n    if (!matrix) {\n      // attempt to figure out the width of the path, up to 1000x1000\n      var maxSize = 1000;\n      var minX = maxSize;\n      var minY = maxSize;\n      var maxX = 0;\n      var maxY = 0;\n      var width, height;\n\n      // do some line skipping... this is faster than checking\n      // every pixel and will be mostly still correct\n      for (var x = 0; x < maxSize; x += 2) {\n        for (var y = 0; y < maxSize; y += 2) {\n          if (tempCtx.isPointInPath(path2d, x, y, 'nonzero')) {\n            minX = Math.min(minX, x);\n            minY = Math.min(minY, y);\n            maxX = Math.max(maxX, x);\n            maxY = Math.max(maxY, y);\n          }\n        }\n      }\n\n      width = maxX - minX;\n      height = maxY - minY;\n\n      var maxDesiredSize = 10;\n      var scale = Math.min(maxDesiredSize/width, maxDesiredSize/height);\n\n      matrix = [\n        scale, 0, 0, scale,\n        -Math.round((width/2) + minX) * scale,\n        -Math.round((height/2) + minY) * scale\n      ];\n    }\n\n    return {\n      type: 'path',\n      path: path,\n      matrix: matrix\n    };\n  }\n\n  function shapeFromText(textData) {\n    var text,\n        scalar = 1,\n        color = '#000000',\n        // see https://nolanlawson.com/2022/04/08/the-struggle-of-using-native-emoji-on-the-web/\n        fontFamily = '\"Apple Color Emoji\", \"Segoe UI Emoji\", \"Segoe UI Symbol\", \"Noto Color Emoji\", \"EmojiOne Color\", \"Android Emoji\", \"Twemoji Mozilla\", \"system emoji\", sans-serif';\n\n    if (typeof textData === 'string') {\n      text = textData;\n    } else {\n      text = textData.text;\n      scalar = 'scalar' in textData ? textData.scalar : scalar;\n      fontFamily = 'fontFamily' in textData ? textData.fontFamily : fontFamily;\n      color = 'color' in textData ? textData.color : color;\n    }\n\n    // all other confetti are 10 pixels,\n    // so this pixel size is the de-facto 100% scale confetti\n    var fontSize = 10 * scalar;\n    var font = '' + fontSize + 'px ' + fontFamily;\n\n    var canvas = new OffscreenCanvas(fontSize, fontSize);\n    var ctx = canvas.getContext('2d');\n\n    ctx.font = font;\n    var size = ctx.measureText(text);\n    var width = Math.ceil(size.actualBoundingBoxRight + size.actualBoundingBoxLeft);\n    var height = Math.ceil(size.actualBoundingBoxAscent + size.actualBoundingBoxDescent);\n\n    var padding = 2;\n    var x = size.actualBoundingBoxLeft + padding;\n    var y = size.actualBoundingBoxAscent + padding;\n    width += padding + padding;\n    height += padding + padding;\n\n    canvas = new OffscreenCanvas(width, height);\n    ctx = canvas.getContext('2d');\n    ctx.font = font;\n    ctx.fillStyle = color;\n\n    ctx.fillText(text, x, y);\n\n    var scale = 1 / scalar;\n\n    return {\n      type: 'bitmap',\n      // TODO these probably need to be transfered for workers\n      bitmap: canvas.transferToImageBitmap(),\n      matrix: [scale, 0, 0, scale, -width * scale / 2, -height * scale / 2]\n    };\n  }\n\n  module.exports = function() {\n    return getDefaultFire().apply(this, arguments);\n  };\n  module.exports.reset = function() {\n    getDefaultFire().reset();\n  };\n  module.exports.create = confettiCannon;\n  module.exports.shapeFromPath = shapeFromPath;\n  module.exports.shapeFromText = shapeFromText;\n}((function () {\n  if (typeof window !== 'undefined') {\n    return window;\n  }\n\n  if (typeof self !== 'undefined') {\n    return self;\n  }\n\n  return this || {};\n})(), module, false));\n\n// end source content\n\nexport default module.exports;\nexport var create = module.exports.create;\n","import { useMemo, useState } from \"react\";\nimport { DndContext, closestCenter, DragOverlay } from \"@dnd-kit/core\";\nimport { SortableContext, arrayMove, verticalListSortingStrategy, useSortable } from \"@dnd-kit/sortable\";\nimport { CSS } from \"@dnd-kit/utilities\";\nimport { motion } from \"framer-motion\";\nimport confetti from \"canvas-confetti\";\n\nimport classNames from \"../../utils/classNames.js\";\nimport FeedbackPanel from \"../ui/FeedbackPanel.jsx\";\nimport ButtonGroup from \"../ui/ButtonGroup.jsx\";\nimport \"./FormativeAssessment.css\";\n\nfunction SortableRow({ item }) {\n  const { attributes, listeners, setNodeRef, transform, transition, isDragging } = useSortable({ id: item.id });\n  const style = {\n    \"--sortable-transform\": transform ? CSS.Transform.toString(transform) : undefined,\n    \"--sortable-transition\": transition || undefined,\n    \"--sortable-opacity\": isDragging ? 0.72 : 1,\n  };\n\n  return (\n    <motion.div\n      ref={setNodeRef}\n      layout\n      className=\"formative-card\"\n      data-id={item.id}\n      data-dragging={isDragging ? \"true\" : \"false\"}\n      style={style}\n      role=\"listitem\"\n      {...attributes}\n      {...listeners}\n    >\n      <span className=\"formative-card__handle\" aria-hidden=\"true\">\n        â˜°\n      </span>\n      <span>{item.content || item.label || item.text}</span>\n    </motion.div>\n  );\n}\n\nfunction MultipleChoice({ question, onSubmit, allowRetry, disabled }) {\n  const [selected, setSelected] = useState(null);\n  const [feedback, setFeedback] = useState(null);\n\n  const evaluate = () => {\n    const isCorrect = selected === question.answer;\n    setFeedback({ isCorrect });\n    onSubmit?.({\n      status: \"completed\",\n      score: isCorrect ? 1 : 0,\n      attempts: 1,\n      details: [{ questionId: question.id, isCorrect }],\n    });\n    if (isCorrect) {\n      confetti({ particleCount: 80, spread: 70, origin: { y: 0.65 } });\n    }\n  };\n\n  const reset = () => {\n    setSelected(null);\n    setFeedback(null);\n  };\n\n  const handleSubmit = (event) => {\n    event.preventDefault();\n    if (selected === null || disabled) return;\n    evaluate();\n  };\n\n  const promptId = `${question.id}-prompt`;\n\n  return (\n    <form className=\"formative formative--choice\" onSubmit={handleSubmit}>\n      <p className=\"formative__prompt\" id={promptId}>\n        {question.prompt}\n      </p>\n      <div className=\"formative__options\" role=\"radiogroup\" aria-labelledby={promptId}>\n        {question.options?.map((option) => (\n          <label\n            key={option.id}\n            className={classNames(\"formative-option\", { \"is-selected\": selected === option.id })}\n          >\n            <input\n              type=\"radio\"\n              name={question.id}\n              value={option.id}\n              disabled={Boolean(feedback) || disabled}\n              checked={selected === option.id}\n              onChange={() => setSelected(option.id)}\n            />\n            <span>{option.label || option.text}</span>\n          </label>\n        ))}\n      </div>\n      <footer className=\"formative__footer\">\n        <ButtonGroup align=\"start\">\n          {!feedback && (\n            <button type=\"submit\" className=\"y7-btn y7-btn--primary\" disabled={selected === null || disabled}>\n              Check answer\n            </button>\n          )}\n          {feedback && allowRetry && (\n            <button type=\"button\" className=\"y7-btn\" onClick={reset}>\n              Try again\n            </button>\n          )}\n        </ButtonGroup>\n        {feedback && (\n          <FeedbackPanel tone={feedback.isCorrect ? \"success\" : \"error\"}>\n            {feedback.isCorrect ? \"Correct\" : \"Try again\"}\n          </FeedbackPanel>\n        )}\n      </footer>\n    </form>\n  );\n}\n\nfunction OrderingAssessment({ question, onComplete, disabled }) {\n  const [items, setItems] = useState(() => question.items ?? []);\n  const [feedback, setFeedback] = useState(null);\n  const [attempts, setAttempts] = useState(0);\n  const [activeId, setActiveId] = useState(null);\n\n  const handleDragEnd = (event) => {\n    const { active, over } = event;\n    if (!over || active.id === over.id) return;\n    setItems((current) => {\n      const oldIndex = current.findIndex((item) => item.id === active.id);\n      const newIndex = current.findIndex((item) => item.id === over.id);\n      return arrayMove(current, oldIndex, newIndex);\n    });\n  };\n\n  const evaluate = () => {\n    const nextAttempts = attempts + 1;\n    setAttempts(nextAttempts);\n    const submittedIds = items.map((item) => item.id);\n    const correct = JSON.stringify(submittedIds) === JSON.stringify(question.correctOrder);\n    if (correct) {\n      confetti({ particleCount: 100, spread: 70, origin: { y: 0.6 } });\n    }\n    setFeedback({ correct });\n    onComplete?.(correct);\n  };\n\n  const reset = () => {\n    setItems(question.items);\n    setFeedback(null);\n    setAttempts(0);\n  };\n\n  return (\n    <section className=\"formative formative--ordering\">\n      <p className=\"formative__prompt\">{question.prompt}</p>\n      <DndContext\n        collisionDetection={closestCenter}\n        onDragEnd={handleDragEnd}\n        onDragStart={({ active }) => setActiveId(active.id)}\n        onDragCancel={() => setActiveId(null)}\n      >\n        <SortableContext items={items} strategy={verticalListSortingStrategy}>\n          <div className=\"formative__stack\" role=\"list\">\n            {items.map((item) => (\n              <SortableRow key={item.id} item={item} />\n            ))}\n          </div>\n        </SortableContext>\n        <DragOverlay>\n          {activeId ? (\n            <motion.div\n              layout\n              className=\"formative-card formative-card--overlay\"\n              data-dragging=\"true\"\n              style={{\n                \"--sortable-transform\": \"translate3d(0, 0, 0)\",\n                \"--sortable-opacity\": 1,\n              }}\n            >\n              <span className=\"formative-card__handle\" aria-hidden=\"true\">\n                â˜°\n              </span>\n              <span>{items.find((item) => item.id === activeId)?.content || \"\"}</span>\n            </motion.div>\n          ) : null}\n        </DragOverlay>\n      </DndContext>\n      <footer className=\"formative__footer\">\n        <ButtonGroup align=\"start\">\n          {!feedback && (\n            <button type=\"button\" className=\"y7-btn y7-btn--primary\" onClick={evaluate} disabled={disabled}>\n              Check order\n            </button>\n          )}\n          {feedback && question.allowRetry !== false && (\n            <button type=\"button\" className=\"y7-btn\" onClick={reset}>\n              Try again\n            </button>\n          )}\n        </ButtonGroup>\n        {feedback && (\n          <FeedbackPanel tone={feedback.correct ? \"success\" : \"error\"}>\n            {feedback.correct ? \"Great work\" : \"One more attempt\"}\n          </FeedbackPanel>\n        )}\n      </footer>\n    </section>\n  );\n}\n\nfunction ClassificationAssessment({ question, onComplete }) {\n  const [answers, setAnswers] = useState({});\n  const [feedback, setFeedback] = useState(null);\n\n  const evaluate = () => {\n    const summary = question.items.map((item) => {\n      const submitted = answers[item.id];\n      const isCorrect = submitted === item.correct;\n      return {\n        id: item.id,\n        isCorrect,\n      };\n    });\n    const correctCount = summary.filter((item) => item.isCorrect).length;\n    const score = summary.length ? correctCount / summary.length : 1;\n    setFeedback({ summary, score });\n    if (score === 1) {\n      confetti({ particleCount: 90, spread: 70, origin: { y: 0.6 } });\n    }\n    onComplete?.(score === 1);\n  };\n\n  const reset = () => {\n    setAnswers({});\n    setFeedback(null);\n  };\n\n  const handleSubmit = (event) => {\n    event.preventDefault();\n    evaluate();\n  };\n\n  return (\n    <form className=\"formative formative--classification\" onSubmit={handleSubmit}>\n      <p className=\"formative__prompt\">{question.prompt}</p>\n      <div className=\"formative__classification\">\n        {question.items.map((item) => {\n          const fieldId = `${question.id}-${item.id}`;\n          const entry = feedback?.summary.find((summary) => summary.id === item.id);\n          return (\n            <div key={item.id} className={classNames(\"formative-classification__row\", { \"has-feedback\": Boolean(entry) })}>\n              <label className=\"formative-classification__label\" htmlFor={fieldId}>\n                {item.label}\n              </label>\n              <select\n                id={fieldId}\n                value={answers[item.id] || \"\"}\n                onChange={(event) => setAnswers((prev) => ({ ...prev, [item.id]: event.target.value }))}\n              >\n              <option value=\"\" disabled>\n                Select category\n              </option>\n              {question.categories.map((category) => (\n                <option key={category} value={category}>\n                  {category}\n                </option>\n              ))}\n            </select>\n            {feedback && (\n              <FeedbackPanel tone={entry?.isCorrect ? \"success\" : \"error\"}>\n                {entry?.isCorrect ? \"Correct\" : \"Incorrect\"}\n              </FeedbackPanel>\n            )}\n          </div>\n          );\n        })}\n      </div>\n      <footer className=\"formative__footer\">\n        <ButtonGroup align=\"start\">\n          {!feedback && (\n            <button type=\"submit\" className=\"y7-btn y7-btn--primary\">\n              Check answers\n            </button>\n          )}\n          {feedback && question.allowRetry !== false && (\n            <button type=\"button\" className=\"y7-btn\" onClick={reset}>\n              Try again\n            </button>\n          )}\n        </ButtonGroup>\n      </footer>\n    </form>\n  );\n}\n\nexport default function FormativeAssessment({ question, variant, onComplete, allowRetry = true, disabled }) {\n  const resolvedVariant = useMemo(() => {\n    if (variant) return variant;\n    if (Array.isArray(question?.options) && typeof question?.answer !== \"undefined\") return \"multiple-choice\";\n    if (Array.isArray(question?.items) && Array.isArray(question?.correctOrder)) return \"ordering\";\n    return \"ordering\";\n  }, [question, variant]);\n\n  if (resolvedVariant === \"multiple-choice\") {\n    return <MultipleChoice question={question} allowRetry={allowRetry} disabled={disabled} onSubmit={onComplete} />;\n  }\n\n  if (resolvedVariant === \"classification\") {\n    return <ClassificationAssessment question={question} onComplete={onComplete} />;\n  }\n\n  return <OrderingAssessment question={question} onComplete={onComplete} disabled={disabled} />;\n}\n\n","import { useCallback, useEffect, useState } from \"react\";\nimport { motion } from \"framer-motion\";\nimport { Sandpack } from \"@codesandbox/sandpack-react\";\n\nimport \"./PedagogicalComponents.css\";\n\nexport function BinaryLightBulbs({ levels = [], onComplete }) {\n  const [levelIndex, setLevelIndex] = useState(0);\n  const [states, setStates] = useState(() => new Array(5).fill(0));\n  const [score, setScore] = useState(0);\n\n  const level = levels[levelIndex] ?? null;\n  const bulbs = level ? level.bulbs : states.length;\n\n  useEffect(() => {\n    if (level && bulbs !== states.length) {\n      setStates(new Array(bulbs).fill(0));\n    }\n  }, [level, bulbs, states.length]);\n\n  const toggle = (position) => {\n    setStates((prev) => {\n      const next = [...prev];\n      next[position] = next[position] === 0 ? 1 : 0;\n      return next;\n    });\n  };\n\n  const decimalValue = states.slice(states.length - bulbs).reduce((acc, value, index) => acc + value * Math.pow(2, bulbs - index - 1), 0);\n\n  const handleCheck = () => {\n    if (!level) return;\n    const isCorrect = decimalValue === level.target;\n    if (isCorrect) {\n      const nextLevel = levelIndex + 1;\n      setScore((prev) => prev + 50);\n      if (nextLevel >= levels.length) {\n        onComplete?.({ score: score + 50 });\n      } else {\n        setLevelIndex(nextLevel);\n      }\n    }\n  };\n\n  return (\n    <div className=\"binary-light-bulbs\">\n      <h3>Make {level?.target ?? 0}</h3>\n      <div className=\"binary-light-bulbs__grid\">\n        {states.slice(states.length - bulbs).map((value, index) => (\n          <motion.button\n            key={index}\n            type=\"button\"\n            className={`binary-light-bulbs__bulb ${value === 1 ? \"is-on\" : \"\"}`}\n            onClick={() => toggle(states.length - bulbs + index)}\n            whileTap={{ scale: 0.95 }}\n          >\n            {value}\n          </motion.button>\n        ))}\n      </div>\n      <p className=\"binary-light-bulbs__value\">Value: {decimalValue}</p>\n      <button type=\"button\" className=\"y7-btn y7-btn--primary\" onClick={handleCheck}>\n        Check\n      </button>\n      <p className=\"binary-light-bulbs__score\">Score: {score}</p>\n    </div>\n  );\n}\n\nexport function RobotMaze({ config, onComplete }) {\n  const [commands, setCommands] = useState([]);\n  const [isRunning, setIsRunning] = useState(false);\n  const [position, setPosition] = useState({ x: 0, y: 0 });\n\n  const findStart = useCallback(() => {\n    for (let y = 0; y < config.maze.length; y += 1) {\n      const x = config.maze[y].indexOf(\"S\");\n      if (x !== -1) return { x, y };\n    }\n    return { x: 0, y: 0 };\n  }, [config]);\n\n  useEffect(() => {\n    setPosition(findStart());\n  }, [config, findStart]);\n\n  const turnRight = (current) => {\n    switch (current) {\n      case \"UP\":\n        return \"RIGHT\";\n      case \"RIGHT\":\n        return \"DOWN\";\n      case \"DOWN\":\n        return \"LEFT\";\n      default:\n        return \"UP\";\n    }\n  };\n\n  const turnLeft = (current) => {\n    switch (current) {\n      case \"UP\":\n        return \"LEFT\";\n      case \"LEFT\":\n        return \"DOWN\";\n      case \"DOWN\":\n        return \"RIGHT\";\n      default:\n        return \"UP\";\n    }\n  };\n\n  const moveForward = (pos, dir) => {\n    const next = { ...pos };\n    if (dir === \"UP\") next.y -= 1;\n    if (dir === \"DOWN\") next.y += 1;\n    if (dir === \"LEFT\") next.x -= 1;\n    if (dir === \"RIGHT\") next.x += 1;\n    const cell = config.maze[next.y]?.[next.x];\n    if (!cell || cell === \"W\") return pos;\n    return next;\n  };\n\n  const runProgram = async () => {\n    if (commands.length === 0) return;\n    setIsRunning(true);\n    let pos = findStart();\n    let dir = \"RIGHT\";\n    for (const command of commands) {\n      await new Promise((resolve) => setTimeout(resolve, 500));\n      if (command === \"MOVE_FORWARD\") {\n        pos = moveForward(pos, dir);\n      } else if (command === \"TURN_LEFT\") {\n        dir = turnLeft(dir);\n      } else if (command === \"TURN_RIGHT\") {\n        dir = turnRight(dir);\n      }\n      setPosition(pos);\n      const cell = config.maze[pos.y]?.[pos.x];\n      if (cell === \"G\") {\n        onComplete?.({ success: true });\n        break;\n      }\n    }\n    setIsRunning(false);\n  };\n\n  return (\n    <div className=\"robot-maze\">\n      <div className=\"robot-maze__grid\">\n        {config.maze.map((row, y) => (\n          <div key={`row-${y}`} className=\"robot-maze__row\">\n            {row.map((cell, x) => (\n              <div key={`cell-${x}-${y}`} className={`robot-maze__cell robot-maze__cell--${cell.toLowerCase()}`}>\n                {position.x === x && position.y === y ? \"ðŸ¤–\" : cell === \"G\" ? \"ðŸŽ¯\" : \"\"}\n              </div>\n            ))}\n          </div>\n        ))}\n      </div>\n      <div className=\"robot-maze__controls\">\n        {config.commands.map((command) => (\n          <button\n            key={command}\n            type=\"button\"\n            className=\"y7-btn\"\n            onClick={() => setCommands((prev) => (prev.length >= config.maxCommands ? prev : [...prev, command]))}\n            disabled={isRunning}\n          >\n            {command.replace(\"_\", \" \")}\n          </button>\n        ))}\n      </div>\n      <div className=\"robot-maze__program\">\n        {commands.map((cmd, index) => (\n          <span key={`${cmd}-${index}`} className=\"robot-maze__chip\">\n            {cmd.replace(\"_\", \" \")}\n          </span>\n        ))}\n      </div>\n      <div className=\"robot-maze__actions\">\n        <button type=\"button\" className=\"y7-btn y7-btn--primary\" onClick={runProgram} disabled={isRunning || commands.length === 0}>\n          Run program\n        </button>\n        <button type=\"button\" className=\"y7-btn\" onClick={() => setCommands([])} disabled={isRunning}>\n          Clear\n        </button>\n      </div>\n    </div>\n  );\n}\n\nexport function LiveCodeEditor({ initialCode, language = \"react\" }) {\n  return (\n    <Sandpack\n      template={language}\n      files={{\n        \"/App.js\": initialCode,\n      }}\n      options={{\n        showNavigator: false,\n        showTabs: true,\n        showLineNumbers: true,\n        editorHeight: 360,\n      }}\n    />\n  );\n}\n\nexport function ThinkPairShare({ prompt, duration = 180 }) {\n  const [phase, setPhase] = useState(\"think\");\n  const [timeLeft, setTimeLeft] = useState(Math.floor(duration / 3));\n\n  useEffect(() => {\n    const interval = setInterval(() => {\n      setTimeLeft((prev) => {\n        if (prev <= 1) {\n          if (phase === \"think\") {\n            setPhase(\"pair\");\n            return Math.floor(duration / 3);\n          }\n          if (phase === \"pair\") {\n            setPhase(\"share\");\n            return Math.floor(duration / 3);\n          }\n          clearInterval(interval);\n          return 0;\n        }\n        return prev - 1;\n      });\n    }, 1000);\n    return () => clearInterval(interval);\n  }, [phase, duration]);\n\n  const phases = [\n    { id: \"think\", label: \"Think\", icon: \"ðŸ¤”\" },\n    { id: \"pair\", label: \"Pair\", icon: \"ðŸ‘¥\" },\n    { id: \"share\", label: \"Share\", icon: \"ðŸ’¬\" },\n  ];\n\n  return (\n    <div className=\"think-pair-share\">\n      <h3>{prompt}</h3>\n      <div className=\"think-pair-share__phases\">\n        {phases.map((item) => (\n          <div key={item.id} className={`think-pair-share__phase ${phase === item.id ? \"is-active\" : \"\"}`}>\n            <span className=\"think-pair-share__icon\" aria-hidden=\"true\">\n              {item.icon}\n            </span>\n            <span>{item.label}</span>\n          </div>\n        ))}\n      </div>\n      <p className=\"think-pair-share__timer\">\n        {Math.floor(timeLeft / 60)}:{String(timeLeft % 60).padStart(2, \"0\")}\n      </p>\n    </div>\n  );\n}\n\nexport function InteractiveShell({ children }) {\n  return <div className=\"interactive-shell\">{children}</div>;\n}\n\nexport const INTERACTIVE_REGISTRY = {\n  BinaryLightBulbs,\n  RobotMaze,\n  ThinkPairShare,\n  LiveCodeEditor,\n};\n\n","import { useMemo } from \"react\";\nimport { AnimatePresence, motion } from \"framer-motion\";\nimport FormativeAssessment from \"../assessments/FormativeAssessment.jsx\";\nimport {\n  BinaryLightBulbs,\n  RobotMaze,\n  ThinkPairShare,\n  LiveCodeEditor,\n} from \"../interactive/PedagogicalComponents.jsx\";\n\nconst INTERACTIVE_COMPONENTS = {\n  ThinkPairShare,\n  BinaryLightBulbs,\n  RobotMaze,\n  LiveCodeEditor,\n};\n\nfunction HeadingBlock({ level = 2, text }) {\n  const Tag = `h${Math.min(Math.max(level || 2, 1), 4)}`;\n  return <Tag className=\"slide-block slide-block--heading\">{text}</Tag>;\n}\n\nfunction ParagraphBlock({ text }) {\n  return <p className=\"slide-block slide-block--paragraph\">{text}</p>;\n}\n\nfunction BulletedList({ items = [] }) {\n  return (\n    <ul className=\"slide-block slide-block--list\">\n      {items.map((item, index) => (\n        <li key={index}>{typeof item === \"string\" ? item : item?.text}</li>\n      ))}\n    </ul>\n  );\n}\n\nfunction ObjectivesBlock({ objectives = [] }) {\n  return (\n    <div className=\"slide-panel slide-panel--objectives\">\n      <h3>Learning objectives</h3>\n      <ul>\n        {objectives.map((objective, index) => (\n          <li key={index}>{objective}</li>\n        ))}\n      </ul>\n    </div>\n  );\n}\n\nfunction CalloutBlock({ type = \"info\", text, title }) {\n  return (\n    <div className={`slide-callout slide-callout--${type}`}>\n      {title && <strong>{title}</strong>}\n      <p>{text}</p>\n    </div>\n  );\n}\n\nfunction ReflectionBlock({ prompts = [], submitTo }) {\n  return (\n    <div className=\"slide-panel slide-panel--reflection\">\n      <h3>Reflection</h3>\n      <ul>\n        {prompts.map((prompt, index) => (\n          <li key={index}>{prompt}</li>\n        ))}\n      </ul>\n      {submitTo && <span className=\"slide-panel__meta\">Responses are sent to {submitTo}</span>}\n    </div>\n  );\n}\n\nfunction BadgeAwardBlock({ badge }) {\n  if (!badge) return null;\n  return (\n    <div className=\"slide-panel slide-panel--badge\">\n      <span className=\"slide-badge-icon\" aria-hidden=\"true\">\n        {badge.icon || \"ðŸ…\"}\n      </span>\n      <div>\n        <h3>{badge.name}</h3>\n        <p>{badge.description}</p>\n        {typeof badge.experiencePoints === \"number\" && <span>{badge.experiencePoints} XP</span>}\n      </div>\n    </div>\n  );\n}\n\nfunction InteractiveComponent({ component, props }) {\n  const Component = INTERACTIVE_COMPONENTS[component] || null;\n  if (!Component) {\n    return (\n      <div className=\"slide-panel slide-panel--placeholder\">\n        <p>Interactive component â€œ{component}â€ is not yet supported.</p>\n      </div>\n    );\n  }\n  return <Component {...props} />;\n}\n\nfunction renderBlock(block, context) {\n  if (!block) return null;\n  const { sessionId, studentId, onAssessmentComplete } = context ?? {};\n  const handleCompletion = (result) => {\n    if (!onAssessmentComplete) return;\n    if (typeof result === \"boolean\") {\n      onAssessmentComplete({ status: result ? \"completed\" : \"in-progress\", score: result ? 1 : 0 });\n    } else if (typeof result === \"object\") {\n      onAssessmentComplete(result);\n    }\n  };\n  switch (block.type) {\n    case \"heading\":\n      return <HeadingBlock level={block.level} text={block.text} />;\n    case \"paragraph\":\n      return <ParagraphBlock text={block.text} />;\n    case \"list\":\n      return <BulletedList items={block.items} />;\n    case \"objectives\":\n      return <ObjectivesBlock objectives={block.objectives} />;\n    case \"callout\":\n      return <CalloutBlock type={block.variant || block.calloutType || block.style || \"info\"} title={block.title} text={block.body || block.text} />;\n    case \"interactive\":\n      return <InteractiveComponent component={block.component} props={{ ...block, sessionId, studentId, onComplete: handleCompletion }} />;\n    case \"interactiveDiagram\":\n      return (\n        <div className=\"slide-panel slide-panel--diagram\">\n          <h3>{block.title || \"Interactive diagram\"}</h3>\n          <p>This diagram can be explored on student devices once unlocked.</p>\n        </div>\n      );\n    case \"reflectionPrompts\":\n      return <ReflectionBlock prompts={block.prompts} submitTo={block.submitTo} />;\n    case \"badgeAward\":\n      return <BadgeAwardBlock badge={block.badge} />;\n    case \"experience\":\n      return (\n        <div className=\"slide-panel slide-panel--xp\">\n          <h3>Earn experience</h3>\n          <p>{block.description || \"Complete the activity to gain XP.\"}</p>\n          {typeof block.xp === \"number\" && <span>{block.xp} XP</span>}\n        </div>\n      );\n    case \"formative\":\n      return <FormativeAssessment question={block.question} onComplete={handleCompletion} />;\n    default:\n      if (typeof block.text === \"string\") {\n        return <ParagraphBlock text={block.text} />;\n      }\n      return null;\n  }\n}\n\nfunction ContentSlide({ slide, context }) {\n  const layout = slide?.content?.layout || \"stack\";\n  const blocks = Array.isArray(slide?.content?.blocks) ? slide.content.blocks : [];\n\n  if (layout === \"split\") {\n    return (\n      <div className=\"slide-layout slide-layout--split\">\n        {blocks.map((block, index) => (\n          <div key={index} className=\"slide-layout__column\">\n            {renderBlock(block, context)}\n          </div>\n        ))}\n      </div>\n    );\n  }\n\n  if (layout === \"gallery\") {\n    const items = blocks[0]?.items ?? [];\n    return (\n      <div className=\"slide-gallery\">\n        {items.map((item) => (\n          <article key={item.title} className=\"slide-gallery__card\">\n            {item.image && <img src={item.image} alt={item.title} loading=\"lazy\" />}\n            <div>\n              <h3>{item.title}</h3>\n              <p>{item.description}</p>\n            </div>\n          </article>\n        ))}\n      </div>\n    );\n  }\n\n  if (layout === \"reflection\") {\n    return (\n      <div className=\"slide-layout slide-layout--stack\">\n        {blocks.map((block, index) => (\n          <div key={index} className=\"slide-layout__item\">\n            {renderBlock(block, context)}\n          </div>\n        ))}\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"slide-layout slide-layout--stack\">\n      {blocks.map((block, index) => (\n        <div key={index} className=\"slide-layout__item\">\n          {renderBlock(block, context)}\n        </div>\n      ))}\n    </div>\n  );\n}\n\nfunction InteractiveSlide({ slide, context }) {\n  const activity = slide?.content?.blocks?.[0];\n  if (!activity) return null;\n\n  const normalise = (result) => {\n    if (!context.onAssessmentComplete) return;\n    if (typeof result === \"boolean\") {\n      context.onAssessmentComplete({ status: result ? \"completed\" : \"in-progress\", score: result ? 1 : 0 });\n    } else if (typeof result === \"object\") {\n      context.onAssessmentComplete(result);\n    }\n  };\n\n  if (activity.type === \"sortingActivity\") {\n    return (\n        <FormativeAssessment\n          variant=\"classification\"\n          question={{\n            id: activity.assessmentId || slide.assessmentId,\n            prompt: activity.instruction,\n            items: activity.items,\n            categories: activity.categories,\n          }}\n          onComplete={normalise}\n        />\n    );\n  }\n\n  return renderBlock(activity, context);\n}\n\nfunction AssessmentSlide({ slide, context }) {\n  const { onAssessmentComplete } = context;\n  const payload = slide?.content;\n  const handleComplete = (result) => {\n    if (!onAssessmentComplete) return;\n    if (typeof result === \"boolean\") {\n      onAssessmentComplete({ status: result ? \"completed\" : \"in-progress\", score: result ? 1 : 0 });\n    } else if (typeof result === \"object\") {\n      onAssessmentComplete(result);\n    }\n  };\n\n  if (payload?.type === \"multipart\") {\n    return (\n      <div className=\"slide-assessment slide-assessment--multipart\">\n        <h3>{payload.title}</h3>\n        {Array.isArray(payload.parts) &&\n          payload.parts.map((part, index) => {\n            if (part.type === \"sequencing\") {\n              return (\n                <FormativeAssessment\n                  key={index}\n                  question={{\n                    id: `${slide.id}-part-${index}`,\n                    prompt: part.prompt,\n                    items: part.items.map((item) => ({ id: item.id, content: item.text })),\n                    correctOrder: part.correctOrder,\n                  }}\n                  onComplete={handleComplete}\n                />\n              );\n            }\n            if (part.type === \"pattern-recognition\") {\n              return (\n                <FormativeAssessment\n                  key={index}\n                  variant=\"multiple-choice\"\n                  question={{\n                    id: `${slide.id}-part-${index}`,\n                    prompt: part.prompt,\n                    options: part.options.map((option) => ({ id: option, label: option })),\n                    answer: part.correct,\n                  }}\n                  onComplete={handleComplete}\n                />\n              );\n            }\n            return null;\n          })}\n      </div>\n    );\n  }\n\n  return <FormativeAssessment question={payload} onComplete={handleComplete} />;\n}\n\nexport default function SlideRenderer({ slideData, isTeacher, sessionId, studentId, canProgress, onAssessmentComplete }) {\n  const variant = useMemo(() => ({\n    initial: { opacity: 0, x: 60 },\n    animate: { opacity: 1, x: 0 },\n    exit: { opacity: 0, x: -60 },\n  }), []);\n\n  const context = useMemo(\n    () => ({\n      isTeacher,\n      sessionId,\n      studentId,\n      onAssessmentComplete,\n    }),\n    [isTeacher, sessionId, studentId, onAssessmentComplete],\n  );\n\n  if (!slideData) {\n    return (\n      <div className=\"slide-container slide-container--empty\">\n        <p>Select a slide to begin.</p>\n      </div>\n    );\n  }\n\n  const { type } = slideData;\n\n  return (\n    <AnimatePresence mode=\"wait\">\n      <motion.div\n        key={slideData.id}\n        className={`slide-container slide-container--${type}`}\n        initial={variant.initial}\n        animate={variant.animate}\n        exit={variant.exit}\n        transition={{ duration: 0.3, ease: \"easeOut\" }}\n      >\n        {type === \"content\" && <ContentSlide slide={slideData} context={context} />}\n        {type === \"interactive\" && <InteractiveSlide slide={slideData} context={context} />}\n        {type === \"assessment\" && <AssessmentSlide slide={slideData} context={context} />}\n        {type === \"checkpoint\" && <AssessmentSlide slide={slideData} context={context} />}\n        {type === \"summative\" && <AssessmentSlide slide={slideData} context={context} />}\n\n        {!isTeacher && canProgress === false && (\n          <div className=\"slide-lock-overlay\">\n            <div>\n              <p>Waiting for teacher to unlock this contentâ€¦</p>\n            </div>\n          </div>\n        )}\n      </motion.div>\n    </AnimatePresence>\n  );\n}\n\n","const log = (() => {\n    let isEnabled = false;\n    // (XXX)\n    // We _do_ have Storage support in React Native. If we _really_ wanted,\n    // We could have AsyncStorage injected here.\n    if (typeof window !== \"undefined\" &&\n        typeof window.localStorage !== \"undefined\") {\n        isEnabled = !!window.localStorage.getItem(\"loggingEnabled\");\n    }\n    else {\n        isEnabled = false;\n    }\n    function makeLogger(fnName) {\n        return (...args) => {\n            if (!isEnabled)\n                return;\n            console[fnName](...args);\n        };\n    }\n    return {\n        info: makeLogger(\"info\"),\n        debug: makeLogger(\"debug\"),\n        error: makeLogger(\"error\"),\n    };\n})();\nexport default log;\n//# sourceMappingURL=log.js.map","!function(e){var t;\"object\"==typeof exports?module.exports=e():\"function\"==typeof define&&define.amd?define(e):(\"undefined\"!=typeof window?t=window:\"undefined\"!=typeof global?t=global:\"undefined\"!=typeof self&&(t=self),t.objectHash=e())}(function(){return function r(o,i,u){function s(n,e){if(!i[n]){if(!o[n]){var t=\"function\"==typeof require&&require;if(!e&&t)return t(n,!0);if(a)return a(n,!0);throw new Error(\"Cannot find module '\"+n+\"'\")}e=i[n]={exports:{}};o[n][0].call(e.exports,function(e){var t=o[n][1][e];return s(t||e)},e,e.exports,r,o,i,u)}return i[n].exports}for(var a=\"function\"==typeof require&&require,e=0;e<u.length;e++)s(u[e]);return s}({1:[function(w,b,m){!function(e,n,s,c,d,h,p,g,y){\"use strict\";var r=w(\"crypto\");function t(e,t){t=u(e,t);var n;return void 0===(n=\"passthrough\"!==t.algorithm?r.createHash(t.algorithm):new l).write&&(n.write=n.update,n.end=n.update),f(t,n).dispatch(e),n.update||n.end(\"\"),n.digest?n.digest(\"buffer\"===t.encoding?void 0:t.encoding):(e=n.read(),\"buffer\"!==t.encoding?e.toString(t.encoding):e)}(m=b.exports=t).sha1=function(e){return t(e)},m.keys=function(e){return t(e,{excludeValues:!0,algorithm:\"sha1\",encoding:\"hex\"})},m.MD5=function(e){return t(e,{algorithm:\"md5\",encoding:\"hex\"})},m.keysMD5=function(e){return t(e,{algorithm:\"md5\",encoding:\"hex\",excludeValues:!0})};var o=r.getHashes?r.getHashes().slice():[\"sha1\",\"md5\"],i=(o.push(\"passthrough\"),[\"buffer\",\"hex\",\"binary\",\"base64\"]);function u(e,t){var n={};if(n.algorithm=(t=t||{}).algorithm||\"sha1\",n.encoding=t.encoding||\"hex\",n.excludeValues=!!t.excludeValues,n.algorithm=n.algorithm.toLowerCase(),n.encoding=n.encoding.toLowerCase(),n.ignoreUnknown=!0===t.ignoreUnknown,n.respectType=!1!==t.respectType,n.respectFunctionNames=!1!==t.respectFunctionNames,n.respectFunctionProperties=!1!==t.respectFunctionProperties,n.unorderedArrays=!0===t.unorderedArrays,n.unorderedSets=!1!==t.unorderedSets,n.unorderedObjects=!1!==t.unorderedObjects,n.replacer=t.replacer||void 0,n.excludeKeys=t.excludeKeys||void 0,void 0===e)throw new Error(\"Object argument required.\");for(var r=0;r<o.length;++r)o[r].toLowerCase()===n.algorithm.toLowerCase()&&(n.algorithm=o[r]);if(-1===o.indexOf(n.algorithm))throw new Error('Algorithm \"'+n.algorithm+'\"  not supported. supported values: '+o.join(\", \"));if(-1===i.indexOf(n.encoding)&&\"passthrough\"!==n.algorithm)throw new Error('Encoding \"'+n.encoding+'\"  not supported. supported values: '+i.join(\", \"));return n}function a(e){if(\"function\"==typeof e)return null!=/^function\\s+\\w*\\s*\\(\\s*\\)\\s*{\\s+\\[native code\\]\\s+}$/i.exec(Function.prototype.toString.call(e))}function f(o,t,i){i=i||[];function u(e){return t.update?t.update(e,\"utf8\"):t.write(e,\"utf8\")}return{dispatch:function(e){return this[\"_\"+(null===(e=o.replacer?o.replacer(e):e)?\"null\":typeof e)](e)},_object:function(t){var n,e=Object.prototype.toString.call(t),r=/\\[object (.*)\\]/i.exec(e);r=(r=r?r[1]:\"unknown:[\"+e+\"]\").toLowerCase();if(0<=(e=i.indexOf(t)))return this.dispatch(\"[CIRCULAR:\"+e+\"]\");if(i.push(t),void 0!==s&&s.isBuffer&&s.isBuffer(t))return u(\"buffer:\"),u(t);if(\"object\"===r||\"function\"===r||\"asyncfunction\"===r)return e=Object.keys(t),o.unorderedObjects&&(e=e.sort()),!1===o.respectType||a(t)||e.splice(0,0,\"prototype\",\"__proto__\",\"constructor\"),o.excludeKeys&&(e=e.filter(function(e){return!o.excludeKeys(e)})),u(\"object:\"+e.length+\":\"),n=this,e.forEach(function(e){n.dispatch(e),u(\":\"),o.excludeValues||n.dispatch(t[e]),u(\",\")});if(!this[\"_\"+r]){if(o.ignoreUnknown)return u(\"[\"+r+\"]\");throw new Error('Unknown object type \"'+r+'\"')}this[\"_\"+r](t)},_array:function(e,t){t=void 0!==t?t:!1!==o.unorderedArrays;var n=this;if(u(\"array:\"+e.length+\":\"),!t||e.length<=1)return e.forEach(function(e){return n.dispatch(e)});var r=[],t=e.map(function(e){var t=new l,n=i.slice();return f(o,t,n).dispatch(e),r=r.concat(n.slice(i.length)),t.read().toString()});return i=i.concat(r),t.sort(),this._array(t,!1)},_date:function(e){return u(\"date:\"+e.toJSON())},_symbol:function(e){return u(\"symbol:\"+e.toString())},_error:function(e){return u(\"error:\"+e.toString())},_boolean:function(e){return u(\"bool:\"+e.toString())},_string:function(e){u(\"string:\"+e.length+\":\"),u(e.toString())},_function:function(e){u(\"fn:\"),a(e)?this.dispatch(\"[native]\"):this.dispatch(e.toString()),!1!==o.respectFunctionNames&&this.dispatch(\"function-name:\"+String(e.name)),o.respectFunctionProperties&&this._object(e)},_number:function(e){return u(\"number:\"+e.toString())},_xml:function(e){return u(\"xml:\"+e.toString())},_null:function(){return u(\"Null\")},_undefined:function(){return u(\"Undefined\")},_regexp:function(e){return u(\"regex:\"+e.toString())},_uint8array:function(e){return u(\"uint8array:\"),this.dispatch(Array.prototype.slice.call(e))},_uint8clampedarray:function(e){return u(\"uint8clampedarray:\"),this.dispatch(Array.prototype.slice.call(e))},_int8array:function(e){return u(\"int8array:\"),this.dispatch(Array.prototype.slice.call(e))},_uint16array:function(e){return u(\"uint16array:\"),this.dispatch(Array.prototype.slice.call(e))},_int16array:function(e){return u(\"int16array:\"),this.dispatch(Array.prototype.slice.call(e))},_uint32array:function(e){return u(\"uint32array:\"),this.dispatch(Array.prototype.slice.call(e))},_int32array:function(e){return u(\"int32array:\"),this.dispatch(Array.prototype.slice.call(e))},_float32array:function(e){return u(\"float32array:\"),this.dispatch(Array.prototype.slice.call(e))},_float64array:function(e){return u(\"float64array:\"),this.dispatch(Array.prototype.slice.call(e))},_arraybuffer:function(e){return u(\"arraybuffer:\"),this.dispatch(new Uint8Array(e))},_url:function(e){return u(\"url:\"+e.toString())},_map:function(e){u(\"map:\");e=Array.from(e);return this._array(e,!1!==o.unorderedSets)},_set:function(e){u(\"set:\");e=Array.from(e);return this._array(e,!1!==o.unorderedSets)},_file:function(e){return u(\"file:\"),this.dispatch([e.name,e.size,e.type,e.lastModfied])},_blob:function(){if(o.ignoreUnknown)return u(\"[blob]\");throw Error('Hashing Blob objects is currently not supported\\n(see https://github.com/puleos/object-hash/issues/26)\\nUse \"options.replacer\" or \"options.ignoreUnknown\"\\n')},_domwindow:function(){return u(\"domwindow\")},_bigint:function(e){return u(\"bigint:\"+e.toString())},_process:function(){return u(\"process\")},_timer:function(){return u(\"timer\")},_pipe:function(){return u(\"pipe\")},_tcp:function(){return u(\"tcp\")},_udp:function(){return u(\"udp\")},_tty:function(){return u(\"tty\")},_statwatcher:function(){return u(\"statwatcher\")},_securecontext:function(){return u(\"securecontext\")},_connection:function(){return u(\"connection\")},_zlib:function(){return u(\"zlib\")},_context:function(){return u(\"context\")},_nodescript:function(){return u(\"nodescript\")},_httpparser:function(){return u(\"httpparser\")},_dataview:function(){return u(\"dataview\")},_signal:function(){return u(\"signal\")},_fsevent:function(){return u(\"fsevent\")},_tlswrap:function(){return u(\"tlswrap\")}}}function l(){return{buf:\"\",write:function(e){this.buf+=e},end:function(e){this.buf+=e},read:function(){return this.buf}}}m.writeToStream=function(e,t,n){return void 0===n&&(n=t,t={}),f(t=u(e,t),n).dispatch(e)}}.call(this,w(\"lYpoI2\"),\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{},w(\"buffer\").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],\"/fake_9a5aa49d.js\",\"/\")},{buffer:3,crypto:5,lYpoI2:11}],2:[function(e,t,f){!function(e,t,n,r,o,i,u,s,a){!function(e){\"use strict\";var a=\"undefined\"!=typeof Uint8Array?Uint8Array:Array,t=\"+\".charCodeAt(0),n=\"/\".charCodeAt(0),r=\"0\".charCodeAt(0),o=\"a\".charCodeAt(0),i=\"A\".charCodeAt(0),u=\"-\".charCodeAt(0),s=\"_\".charCodeAt(0);function f(e){e=e.charCodeAt(0);return e===t||e===u?62:e===n||e===s?63:e<r?-1:e<r+10?e-r+26+26:e<i+26?e-i:e<o+26?e-o+26:void 0}e.toByteArray=function(e){var t,n;if(0<e.length%4)throw new Error(\"Invalid string. Length must be a multiple of 4\");var r=e.length,r=\"=\"===e.charAt(r-2)?2:\"=\"===e.charAt(r-1)?1:0,o=new a(3*e.length/4-r),i=0<r?e.length-4:e.length,u=0;function s(e){o[u++]=e}for(t=0;t<i;t+=4,0)s((16711680&(n=f(e.charAt(t))<<18|f(e.charAt(t+1))<<12|f(e.charAt(t+2))<<6|f(e.charAt(t+3))))>>16),s((65280&n)>>8),s(255&n);return 2==r?s(255&(n=f(e.charAt(t))<<2|f(e.charAt(t+1))>>4)):1==r&&(s((n=f(e.charAt(t))<<10|f(e.charAt(t+1))<<4|f(e.charAt(t+2))>>2)>>8&255),s(255&n)),o},e.fromByteArray=function(e){var t,n,r,o,i=e.length%3,u=\"\";function s(e){return\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\".charAt(e)}for(t=0,r=e.length-i;t<r;t+=3)n=(e[t]<<16)+(e[t+1]<<8)+e[t+2],u+=s((o=n)>>18&63)+s(o>>12&63)+s(o>>6&63)+s(63&o);switch(i){case 1:u=(u+=s((n=e[e.length-1])>>2))+s(n<<4&63)+\"==\";break;case 2:u=(u=(u+=s((n=(e[e.length-2]<<8)+e[e.length-1])>>10))+s(n>>4&63))+s(n<<2&63)+\"=\"}return u}}(void 0===f?this.base64js={}:f)}.call(this,e(\"lYpoI2\"),\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{},e(\"buffer\").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],\"/node_modules/gulp-browserify/node_modules/base64-js/lib/b64.js\",\"/node_modules/gulp-browserify/node_modules/base64-js/lib\")},{buffer:3,lYpoI2:11}],3:[function(O,e,H){!function(e,n,f,r,h,p,g,y,w){var a=O(\"base64-js\"),i=O(\"ieee754\");function f(e,t,n){if(!(this instanceof f))return new f(e,t,n);var r,o,i,u,s=typeof e;if(\"base64\"===t&&\"string\"==s)for(e=(u=e).trim?u.trim():u.replace(/^\\s+|\\s+$/g,\"\");e.length%4!=0;)e+=\"=\";if(\"number\"==s)r=j(e);else if(\"string\"==s)r=f.byteLength(e,t);else{if(\"object\"!=s)throw new Error(\"First argument needs to be a number, array or string.\");r=j(e.length)}if(f._useTypedArrays?o=f._augment(new Uint8Array(r)):((o=this).length=r,o._isBuffer=!0),f._useTypedArrays&&\"number\"==typeof e.byteLength)o._set(e);else if(C(u=e)||f.isBuffer(u)||u&&\"object\"==typeof u&&\"number\"==typeof u.length)for(i=0;i<r;i++)f.isBuffer(e)?o[i]=e.readUInt8(i):o[i]=e[i];else if(\"string\"==s)o.write(e,0,t);else if(\"number\"==s&&!f._useTypedArrays&&!n)for(i=0;i<r;i++)o[i]=0;return o}function b(e,t,n,r){return f._charsWritten=c(function(e){for(var t=[],n=0;n<e.length;n++)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function m(e,t,n,r){return f._charsWritten=c(function(e){for(var t,n,r=[],o=0;o<e.length;o++)n=e.charCodeAt(o),t=n>>8,n=n%256,r.push(n),r.push(t);return r}(t),e,n,r)}function v(e,t,n){var r=\"\";n=Math.min(e.length,n);for(var o=t;o<n;o++)r+=String.fromCharCode(e[o]);return r}function o(e,t,n,r){r||(d(\"boolean\"==typeof n,\"missing or invalid endian\"),d(null!=t,\"missing offset\"),d(t+1<e.length,\"Trying to read beyond buffer length\"));var o,r=e.length;if(!(r<=t))return n?(o=e[t],t+1<r&&(o|=e[t+1]<<8)):(o=e[t]<<8,t+1<r&&(o|=e[t+1])),o}function u(e,t,n,r){r||(d(\"boolean\"==typeof n,\"missing or invalid endian\"),d(null!=t,\"missing offset\"),d(t+3<e.length,\"Trying to read beyond buffer length\"));var o,r=e.length;if(!(r<=t))return n?(t+2<r&&(o=e[t+2]<<16),t+1<r&&(o|=e[t+1]<<8),o|=e[t],t+3<r&&(o+=e[t+3]<<24>>>0)):(t+1<r&&(o=e[t+1]<<16),t+2<r&&(o|=e[t+2]<<8),t+3<r&&(o|=e[t+3]),o+=e[t]<<24>>>0),o}function _(e,t,n,r){if(r||(d(\"boolean\"==typeof n,\"missing or invalid endian\"),d(null!=t,\"missing offset\"),d(t+1<e.length,\"Trying to read beyond buffer length\")),!(e.length<=t))return r=o(e,t,n,!0),32768&r?-1*(65535-r+1):r}function E(e,t,n,r){if(r||(d(\"boolean\"==typeof n,\"missing or invalid endian\"),d(null!=t,\"missing offset\"),d(t+3<e.length,\"Trying to read beyond buffer length\")),!(e.length<=t))return r=u(e,t,n,!0),2147483648&r?-1*(4294967295-r+1):r}function I(e,t,n,r){return r||(d(\"boolean\"==typeof n,\"missing or invalid endian\"),d(t+3<e.length,\"Trying to read beyond buffer length\")),i.read(e,t,n,23,4)}function A(e,t,n,r){return r||(d(\"boolean\"==typeof n,\"missing or invalid endian\"),d(t+7<e.length,\"Trying to read beyond buffer length\")),i.read(e,t,n,52,8)}function s(e,t,n,r,o){o||(d(null!=t,\"missing value\"),d(\"boolean\"==typeof r,\"missing or invalid endian\"),d(null!=n,\"missing offset\"),d(n+1<e.length,\"trying to write beyond buffer length\"),Y(t,65535));o=e.length;if(!(o<=n))for(var i=0,u=Math.min(o-n,2);i<u;i++)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function l(e,t,n,r,o){o||(d(null!=t,\"missing value\"),d(\"boolean\"==typeof r,\"missing or invalid endian\"),d(null!=n,\"missing offset\"),d(n+3<e.length,\"trying to write beyond buffer length\"),Y(t,4294967295));o=e.length;if(!(o<=n))for(var i=0,u=Math.min(o-n,4);i<u;i++)e[n+i]=t>>>8*(r?i:3-i)&255}function B(e,t,n,r,o){o||(d(null!=t,\"missing value\"),d(\"boolean\"==typeof r,\"missing or invalid endian\"),d(null!=n,\"missing offset\"),d(n+1<e.length,\"Trying to write beyond buffer length\"),F(t,32767,-32768)),e.length<=n||s(e,0<=t?t:65535+t+1,n,r,o)}function L(e,t,n,r,o){o||(d(null!=t,\"missing value\"),d(\"boolean\"==typeof r,\"missing or invalid endian\"),d(null!=n,\"missing offset\"),d(n+3<e.length,\"Trying to write beyond buffer length\"),F(t,2147483647,-2147483648)),e.length<=n||l(e,0<=t?t:4294967295+t+1,n,r,o)}function U(e,t,n,r,o){o||(d(null!=t,\"missing value\"),d(\"boolean\"==typeof r,\"missing or invalid endian\"),d(null!=n,\"missing offset\"),d(n+3<e.length,\"Trying to write beyond buffer length\"),D(t,34028234663852886e22,-34028234663852886e22)),e.length<=n||i.write(e,t,n,r,23,4)}function x(e,t,n,r,o){o||(d(null!=t,\"missing value\"),d(\"boolean\"==typeof r,\"missing or invalid endian\"),d(null!=n,\"missing offset\"),d(n+7<e.length,\"Trying to write beyond buffer length\"),D(t,17976931348623157e292,-17976931348623157e292)),e.length<=n||i.write(e,t,n,r,52,8)}H.Buffer=f,H.SlowBuffer=f,H.INSPECT_MAX_BYTES=50,f.poolSize=8192,f._useTypedArrays=function(){try{var e=new ArrayBuffer(0),t=new Uint8Array(e);return t.foo=function(){return 42},42===t.foo()&&\"function\"==typeof t.subarray}catch(e){return!1}}(),f.isEncoding=function(e){switch(String(e).toLowerCase()){case\"hex\":case\"utf8\":case\"utf-8\":case\"ascii\":case\"binary\":case\"base64\":case\"raw\":case\"ucs2\":case\"ucs-2\":case\"utf16le\":case\"utf-16le\":return!0;default:return!1}},f.isBuffer=function(e){return!(null==e||!e._isBuffer)},f.byteLength=function(e,t){var n;switch(e+=\"\",t||\"utf8\"){case\"hex\":n=e.length/2;break;case\"utf8\":case\"utf-8\":n=T(e).length;break;case\"ascii\":case\"binary\":case\"raw\":n=e.length;break;case\"base64\":n=M(e).length;break;case\"ucs2\":case\"ucs-2\":case\"utf16le\":case\"utf-16le\":n=2*e.length;break;default:throw new Error(\"Unknown encoding\")}return n},f.concat=function(e,t){if(d(C(e),\"Usage: Buffer.concat(list, [totalLength])\\nlist should be an Array.\"),0===e.length)return new f(0);if(1===e.length)return e[0];if(\"number\"!=typeof t)for(o=t=0;o<e.length;o++)t+=e[o].length;for(var n=new f(t),r=0,o=0;o<e.length;o++){var i=e[o];i.copy(n,r),r+=i.length}return n},f.prototype.write=function(e,t,n,r){isFinite(t)?isFinite(n)||(r=n,n=void 0):(a=r,r=t,t=n,n=a),t=Number(t)||0;var o,i,u,s,a=this.length-t;switch((!n||a<(n=Number(n)))&&(n=a),r=String(r||\"utf8\").toLowerCase()){case\"hex\":o=function(e,t,n,r){n=Number(n)||0;var o=e.length-n;(!r||o<(r=Number(r)))&&(r=o),d((o=t.length)%2==0,\"Invalid hex string\"),o/2<r&&(r=o/2);for(var i=0;i<r;i++){var u=parseInt(t.substr(2*i,2),16);d(!isNaN(u),\"Invalid hex string\"),e[n+i]=u}return f._charsWritten=2*i,i}(this,e,t,n);break;case\"utf8\":case\"utf-8\":i=this,u=t,s=n,o=f._charsWritten=c(T(e),i,u,s);break;case\"ascii\":case\"binary\":o=b(this,e,t,n);break;case\"base64\":i=this,u=t,s=n,o=f._charsWritten=c(M(e),i,u,s);break;case\"ucs2\":case\"ucs-2\":case\"utf16le\":case\"utf-16le\":o=m(this,e,t,n);break;default:throw new Error(\"Unknown encoding\")}return o},f.prototype.toString=function(e,t,n){var r,o,i,u,s=this;if(e=String(e||\"utf8\").toLowerCase(),t=Number(t)||0,(n=void 0!==n?Number(n):s.length)===t)return\"\";switch(e){case\"hex\":r=function(e,t,n){var r=e.length;(!t||t<0)&&(t=0);(!n||n<0||r<n)&&(n=r);for(var o=\"\",i=t;i<n;i++)o+=k(e[i]);return o}(s,t,n);break;case\"utf8\":case\"utf-8\":r=function(e,t,n){var r=\"\",o=\"\";n=Math.min(e.length,n);for(var i=t;i<n;i++)e[i]<=127?(r+=N(o)+String.fromCharCode(e[i]),o=\"\"):o+=\"%\"+e[i].toString(16);return r+N(o)}(s,t,n);break;case\"ascii\":case\"binary\":r=v(s,t,n);break;case\"base64\":o=s,u=n,r=0===(i=t)&&u===o.length?a.fromByteArray(o):a.fromByteArray(o.slice(i,u));break;case\"ucs2\":case\"ucs-2\":case\"utf16le\":case\"utf-16le\":r=function(e,t,n){for(var r=e.slice(t,n),o=\"\",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}(s,t,n);break;default:throw new Error(\"Unknown encoding\")}return r},f.prototype.toJSON=function(){return{type:\"Buffer\",data:Array.prototype.slice.call(this._arr||this,0)}},f.prototype.copy=function(e,t,n,r){if(t=t||0,(r=r||0===r?r:this.length)!==(n=n||0)&&0!==e.length&&0!==this.length){d(n<=r,\"sourceEnd < sourceStart\"),d(0<=t&&t<e.length,\"targetStart out of bounds\"),d(0<=n&&n<this.length,\"sourceStart out of bounds\"),d(0<=r&&r<=this.length,\"sourceEnd out of bounds\"),r>this.length&&(r=this.length);var o=(r=e.length-t<r-n?e.length-t+n:r)-n;if(o<100||!f._useTypedArrays)for(var i=0;i<o;i++)e[i+t]=this[i+n];else e._set(this.subarray(n,n+o),t)}},f.prototype.slice=function(e,t){var n=this.length;if(e=S(e,n,0),t=S(t,n,n),f._useTypedArrays)return f._augment(this.subarray(e,t));for(var r=t-e,o=new f(r,void 0,!0),i=0;i<r;i++)o[i]=this[i+e];return o},f.prototype.get=function(e){return console.log(\".get() is deprecated. Access using array indexes instead.\"),this.readUInt8(e)},f.prototype.set=function(e,t){return console.log(\".set() is deprecated. Access using array indexes instead.\"),this.writeUInt8(e,t)},f.prototype.readUInt8=function(e,t){if(t||(d(null!=e,\"missing offset\"),d(e<this.length,\"Trying to read beyond buffer length\")),!(e>=this.length))return this[e]},f.prototype.readUInt16LE=function(e,t){return o(this,e,!0,t)},f.prototype.readUInt16BE=function(e,t){return o(this,e,!1,t)},f.prototype.readUInt32LE=function(e,t){return u(this,e,!0,t)},f.prototype.readUInt32BE=function(e,t){return u(this,e,!1,t)},f.prototype.readInt8=function(e,t){if(t||(d(null!=e,\"missing offset\"),d(e<this.length,\"Trying to read beyond buffer length\")),!(e>=this.length))return 128&this[e]?-1*(255-this[e]+1):this[e]},f.prototype.readInt16LE=function(e,t){return _(this,e,!0,t)},f.prototype.readInt16BE=function(e,t){return _(this,e,!1,t)},f.prototype.readInt32LE=function(e,t){return E(this,e,!0,t)},f.prototype.readInt32BE=function(e,t){return E(this,e,!1,t)},f.prototype.readFloatLE=function(e,t){return I(this,e,!0,t)},f.prototype.readFloatBE=function(e,t){return I(this,e,!1,t)},f.prototype.readDoubleLE=function(e,t){return A(this,e,!0,t)},f.prototype.readDoubleBE=function(e,t){return A(this,e,!1,t)},f.prototype.writeUInt8=function(e,t,n){n||(d(null!=e,\"missing value\"),d(null!=t,\"missing offset\"),d(t<this.length,\"trying to write beyond buffer length\"),Y(e,255)),t>=this.length||(this[t]=e)},f.prototype.writeUInt16LE=function(e,t,n){s(this,e,t,!0,n)},f.prototype.writeUInt16BE=function(e,t,n){s(this,e,t,!1,n)},f.prototype.writeUInt32LE=function(e,t,n){l(this,e,t,!0,n)},f.prototype.writeUInt32BE=function(e,t,n){l(this,e,t,!1,n)},f.prototype.writeInt8=function(e,t,n){n||(d(null!=e,\"missing value\"),d(null!=t,\"missing offset\"),d(t<this.length,\"Trying to write beyond buffer length\"),F(e,127,-128)),t>=this.length||(0<=e?this.writeUInt8(e,t,n):this.writeUInt8(255+e+1,t,n))},f.prototype.writeInt16LE=function(e,t,n){B(this,e,t,!0,n)},f.prototype.writeInt16BE=function(e,t,n){B(this,e,t,!1,n)},f.prototype.writeInt32LE=function(e,t,n){L(this,e,t,!0,n)},f.prototype.writeInt32BE=function(e,t,n){L(this,e,t,!1,n)},f.prototype.writeFloatLE=function(e,t,n){U(this,e,t,!0,n)},f.prototype.writeFloatBE=function(e,t,n){U(this,e,t,!1,n)},f.prototype.writeDoubleLE=function(e,t,n){x(this,e,t,!0,n)},f.prototype.writeDoubleBE=function(e,t,n){x(this,e,t,!1,n)},f.prototype.fill=function(e,t,n){if(t=t||0,n=n||this.length,d(\"number\"==typeof(e=\"string\"==typeof(e=e||0)?e.charCodeAt(0):e)&&!isNaN(e),\"value is not a number\"),d(t<=n,\"end < start\"),n!==t&&0!==this.length){d(0<=t&&t<this.length,\"start out of bounds\"),d(0<=n&&n<=this.length,\"end out of bounds\");for(var r=t;r<n;r++)this[r]=e}},f.prototype.inspect=function(){for(var e=[],t=this.length,n=0;n<t;n++)if(e[n]=k(this[n]),n===H.INSPECT_MAX_BYTES){e[n+1]=\"...\";break}return\"<Buffer \"+e.join(\" \")+\">\"},f.prototype.toArrayBuffer=function(){if(\"undefined\"==typeof Uint8Array)throw new Error(\"Buffer.toArrayBuffer not supported in this browser\");if(f._useTypedArrays)return new f(this).buffer;for(var e=new Uint8Array(this.length),t=0,n=e.length;t<n;t+=1)e[t]=this[t];return e.buffer};var t=f.prototype;function S(e,t,n){return\"number\"!=typeof e?n:t<=(e=~~e)?t:0<=e||0<=(e+=t)?e:0}function j(e){return(e=~~Math.ceil(+e))<0?0:e}function C(e){return(Array.isArray||function(e){return\"[object Array]\"===Object.prototype.toString.call(e)})(e)}function k(e){return e<16?\"0\"+e.toString(16):e.toString(16)}function T(e){for(var t=[],n=0;n<e.length;n++){var r=e.charCodeAt(n);if(r<=127)t.push(e.charCodeAt(n));else for(var o=n,i=(55296<=r&&r<=57343&&n++,encodeURIComponent(e.slice(o,n+1)).substr(1).split(\"%\")),u=0;u<i.length;u++)t.push(parseInt(i[u],16))}return t}function M(e){return a.toByteArray(e)}function c(e,t,n,r){for(var o=0;o<r&&!(o+n>=t.length||o>=e.length);o++)t[o+n]=e[o];return o}function N(e){try{return decodeURIComponent(e)}catch(e){return String.fromCharCode(65533)}}function Y(e,t){d(\"number\"==typeof e,\"cannot write a non-number as a number\"),d(0<=e,\"specified a negative value for writing an unsigned value\"),d(e<=t,\"value is larger than maximum value for type\"),d(Math.floor(e)===e,\"value has a fractional component\")}function F(e,t,n){d(\"number\"==typeof e,\"cannot write a non-number as a number\"),d(e<=t,\"value larger than maximum allowed value\"),d(n<=e,\"value smaller than minimum allowed value\"),d(Math.floor(e)===e,\"value has a fractional component\")}function D(e,t,n){d(\"number\"==typeof e,\"cannot write a non-number as a number\"),d(e<=t,\"value larger than maximum allowed value\"),d(n<=e,\"value smaller than minimum allowed value\")}function d(e,t){if(!e)throw new Error(t||\"Failed assertion\")}f._augment=function(e){return e._isBuffer=!0,e._get=e.get,e._set=e.set,e.get=t.get,e.set=t.set,e.write=t.write,e.toString=t.toString,e.toLocaleString=t.toString,e.toJSON=t.toJSON,e.copy=t.copy,e.slice=t.slice,e.readUInt8=t.readUInt8,e.readUInt16LE=t.readUInt16LE,e.readUInt16BE=t.readUInt16BE,e.readUInt32LE=t.readUInt32LE,e.readUInt32BE=t.readUInt32BE,e.readInt8=t.readInt8,e.readInt16LE=t.readInt16LE,e.readInt16BE=t.readInt16BE,e.readInt32LE=t.readInt32LE,e.readInt32BE=t.readInt32BE,e.readFloatLE=t.readFloatLE,e.readFloatBE=t.readFloatBE,e.readDoubleLE=t.readDoubleLE,e.readDoubleBE=t.readDoubleBE,e.writeUInt8=t.writeUInt8,e.writeUInt16LE=t.writeUInt16LE,e.writeUInt16BE=t.writeUInt16BE,e.writeUInt32LE=t.writeUInt32LE,e.writeUInt32BE=t.writeUInt32BE,e.writeInt8=t.writeInt8,e.writeInt16LE=t.writeInt16LE,e.writeInt16BE=t.writeInt16BE,e.writeInt32LE=t.writeInt32LE,e.writeInt32BE=t.writeInt32BE,e.writeFloatLE=t.writeFloatLE,e.writeFloatBE=t.writeFloatBE,e.writeDoubleLE=t.writeDoubleLE,e.writeDoubleBE=t.writeDoubleBE,e.fill=t.fill,e.inspect=t.inspect,e.toArrayBuffer=t.toArrayBuffer,e}}.call(this,O(\"lYpoI2\"),\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{},O(\"buffer\").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],\"/node_modules/gulp-browserify/node_modules/buffer/index.js\",\"/node_modules/gulp-browserify/node_modules/buffer\")},{\"base64-js\":2,buffer:3,ieee754:10,lYpoI2:11}],4:[function(c,d,e){!function(e,t,a,n,r,o,i,u,s){var a=c(\"buffer\").Buffer,f=4,l=new a(f);l.fill(0);d.exports={hash:function(e,t,n,r){for(var o=t(function(e,t){e.length%f!=0&&(n=e.length+(f-e.length%f),e=a.concat([e,l],n));for(var n,r=[],o=t?e.readInt32BE:e.readInt32LE,i=0;i<e.length;i+=f)r.push(o.call(e,i));return r}(e=a.isBuffer(e)?e:new a(e),r),8*e.length),t=r,i=new a(n),u=t?i.writeInt32BE:i.writeInt32LE,s=0;s<o.length;s++)u.call(i,o[s],4*s,!0);return i}}}.call(this,c(\"lYpoI2\"),\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{},c(\"buffer\").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],\"/node_modules/gulp-browserify/node_modules/crypto-browserify/helpers.js\",\"/node_modules/gulp-browserify/node_modules/crypto-browserify\")},{buffer:3,lYpoI2:11}],5:[function(v,e,_){!function(l,c,u,d,h,p,g,y,w){var u=v(\"buffer\").Buffer,e=v(\"./sha\"),t=v(\"./sha256\"),n=v(\"./rng\"),b={sha1:e,sha256:t,md5:v(\"./md5\")},s=64,a=new u(s);function r(e,n){var r=b[e=e||\"sha1\"],o=[];return r||i(\"algorithm:\",e,\"is not yet supported\"),{update:function(e){return u.isBuffer(e)||(e=new u(e)),o.push(e),e.length,this},digest:function(e){var t=u.concat(o),t=n?function(e,t,n){u.isBuffer(t)||(t=new u(t)),u.isBuffer(n)||(n=new u(n)),t.length>s?t=e(t):t.length<s&&(t=u.concat([t,a],s));for(var r=new u(s),o=new u(s),i=0;i<s;i++)r[i]=54^t[i],o[i]=92^t[i];return n=e(u.concat([r,n])),e(u.concat([o,n]))}(r,n,t):r(t);return o=null,e?t.toString(e):t}}}function i(){var e=[].slice.call(arguments).join(\" \");throw new Error([e,\"we accept pull requests\",\"http://github.com/dominictarr/crypto-browserify\"].join(\"\\n\"))}a.fill(0),_.createHash=function(e){return r(e)},_.createHmac=r,_.randomBytes=function(e,t){if(!t||!t.call)return new u(n(e));try{t.call(this,void 0,new u(n(e)))}catch(e){t(e)}};var o,f=[\"createCredentials\",\"createCipher\",\"createCipheriv\",\"createDecipher\",\"createDecipheriv\",\"createSign\",\"createVerify\",\"createDiffieHellman\",\"pbkdf2\"],m=function(e){_[e]=function(){i(\"sorry,\",e,\"is not implemented yet\")}};for(o in f)m(f[o],o)}.call(this,v(\"lYpoI2\"),\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{},v(\"buffer\").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],\"/node_modules/gulp-browserify/node_modules/crypto-browserify/index.js\",\"/node_modules/gulp-browserify/node_modules/crypto-browserify\")},{\"./md5\":6,\"./rng\":7,\"./sha\":8,\"./sha256\":9,buffer:3,lYpoI2:11}],6:[function(w,b,e){!function(e,r,o,i,u,a,f,l,y){var t=w(\"./helpers\");function n(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;for(var n=1732584193,r=-271733879,o=-1732584194,i=271733878,u=0;u<e.length;u+=16){var s=n,a=r,f=o,l=i,n=c(n,r,o,i,e[u+0],7,-680876936),i=c(i,n,r,o,e[u+1],12,-389564586),o=c(o,i,n,r,e[u+2],17,606105819),r=c(r,o,i,n,e[u+3],22,-1044525330);n=c(n,r,o,i,e[u+4],7,-176418897),i=c(i,n,r,o,e[u+5],12,1200080426),o=c(o,i,n,r,e[u+6],17,-1473231341),r=c(r,o,i,n,e[u+7],22,-45705983),n=c(n,r,o,i,e[u+8],7,1770035416),i=c(i,n,r,o,e[u+9],12,-1958414417),o=c(o,i,n,r,e[u+10],17,-42063),r=c(r,o,i,n,e[u+11],22,-1990404162),n=c(n,r,o,i,e[u+12],7,1804603682),i=c(i,n,r,o,e[u+13],12,-40341101),o=c(o,i,n,r,e[u+14],17,-1502002290),n=d(n,r=c(r,o,i,n,e[u+15],22,1236535329),o,i,e[u+1],5,-165796510),i=d(i,n,r,o,e[u+6],9,-1069501632),o=d(o,i,n,r,e[u+11],14,643717713),r=d(r,o,i,n,e[u+0],20,-373897302),n=d(n,r,o,i,e[u+5],5,-701558691),i=d(i,n,r,o,e[u+10],9,38016083),o=d(o,i,n,r,e[u+15],14,-660478335),r=d(r,o,i,n,e[u+4],20,-405537848),n=d(n,r,o,i,e[u+9],5,568446438),i=d(i,n,r,o,e[u+14],9,-1019803690),o=d(o,i,n,r,e[u+3],14,-187363961),r=d(r,o,i,n,e[u+8],20,1163531501),n=d(n,r,o,i,e[u+13],5,-1444681467),i=d(i,n,r,o,e[u+2],9,-51403784),o=d(o,i,n,r,e[u+7],14,1735328473),n=h(n,r=d(r,o,i,n,e[u+12],20,-1926607734),o,i,e[u+5],4,-378558),i=h(i,n,r,o,e[u+8],11,-2022574463),o=h(o,i,n,r,e[u+11],16,1839030562),r=h(r,o,i,n,e[u+14],23,-35309556),n=h(n,r,o,i,e[u+1],4,-1530992060),i=h(i,n,r,o,e[u+4],11,1272893353),o=h(o,i,n,r,e[u+7],16,-155497632),r=h(r,o,i,n,e[u+10],23,-1094730640),n=h(n,r,o,i,e[u+13],4,681279174),i=h(i,n,r,o,e[u+0],11,-358537222),o=h(o,i,n,r,e[u+3],16,-722521979),r=h(r,o,i,n,e[u+6],23,76029189),n=h(n,r,o,i,e[u+9],4,-640364487),i=h(i,n,r,o,e[u+12],11,-421815835),o=h(o,i,n,r,e[u+15],16,530742520),n=p(n,r=h(r,o,i,n,e[u+2],23,-995338651),o,i,e[u+0],6,-198630844),i=p(i,n,r,o,e[u+7],10,1126891415),o=p(o,i,n,r,e[u+14],15,-1416354905),r=p(r,o,i,n,e[u+5],21,-57434055),n=p(n,r,o,i,e[u+12],6,1700485571),i=p(i,n,r,o,e[u+3],10,-1894986606),o=p(o,i,n,r,e[u+10],15,-1051523),r=p(r,o,i,n,e[u+1],21,-2054922799),n=p(n,r,o,i,e[u+8],6,1873313359),i=p(i,n,r,o,e[u+15],10,-30611744),o=p(o,i,n,r,e[u+6],15,-1560198380),r=p(r,o,i,n,e[u+13],21,1309151649),n=p(n,r,o,i,e[u+4],6,-145523070),i=p(i,n,r,o,e[u+11],10,-1120210379),o=p(o,i,n,r,e[u+2],15,718787259),r=p(r,o,i,n,e[u+9],21,-343485551),n=g(n,s),r=g(r,a),o=g(o,f),i=g(i,l)}return Array(n,r,o,i)}function s(e,t,n,r,o,i){return g((t=g(g(t,e),g(r,i)))<<o|t>>>32-o,n)}function c(e,t,n,r,o,i,u){return s(t&n|~t&r,e,t,o,i,u)}function d(e,t,n,r,o,i,u){return s(t&r|n&~r,e,t,o,i,u)}function h(e,t,n,r,o,i,u){return s(t^n^r,e,t,o,i,u)}function p(e,t,n,r,o,i,u){return s(n^(t|~r),e,t,o,i,u)}function g(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}b.exports=function(e){return t.hash(e,n,16)}}.call(this,w(\"lYpoI2\"),\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{},w(\"buffer\").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],\"/node_modules/gulp-browserify/node_modules/crypto-browserify/md5.js\",\"/node_modules/gulp-browserify/node_modules/crypto-browserify\")},{\"./helpers\":4,buffer:3,lYpoI2:11}],7:[function(e,l,t){!function(e,t,n,r,o,i,u,s,f){var a;l.exports=a||function(e){for(var t,n=new Array(e),r=0;r<e;r++)0==(3&r)&&(t=4294967296*Math.random()),n[r]=t>>>((3&r)<<3)&255;return n}}.call(this,e(\"lYpoI2\"),\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{},e(\"buffer\").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],\"/node_modules/gulp-browserify/node_modules/crypto-browserify/rng.js\",\"/node_modules/gulp-browserify/node_modules/crypto-browserify\")},{buffer:3,lYpoI2:11}],8:[function(c,d,e){!function(e,t,n,r,o,s,a,f,l){var i=c(\"./helpers\");function u(l,c){l[c>>5]|=128<<24-c%32,l[15+(c+64>>9<<4)]=c;for(var e,t,n,r=Array(80),o=1732584193,i=-271733879,u=-1732584194,s=271733878,d=-1009589776,h=0;h<l.length;h+=16){for(var p=o,g=i,y=u,w=s,b=d,a=0;a<80;a++){r[a]=a<16?l[h+a]:v(r[a-3]^r[a-8]^r[a-14]^r[a-16],1);var f=m(m(v(o,5),(f=i,t=u,n=s,(e=a)<20?f&t|~f&n:!(e<40)&&e<60?f&t|f&n|t&n:f^t^n)),m(m(d,r[a]),(e=a)<20?1518500249:e<40?1859775393:e<60?-1894007588:-899497514)),d=s,s=u,u=v(i,30),i=o,o=f}o=m(o,p),i=m(i,g),u=m(u,y),s=m(s,w),d=m(d,b)}return Array(o,i,u,s,d)}function m(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function v(e,t){return e<<t|e>>>32-t}d.exports=function(e){return i.hash(e,u,20,!0)}}.call(this,c(\"lYpoI2\"),\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{},c(\"buffer\").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],\"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha.js\",\"/node_modules/gulp-browserify/node_modules/crypto-browserify\")},{\"./helpers\":4,buffer:3,lYpoI2:11}],9:[function(c,d,e){!function(e,t,n,r,u,s,a,f,l){function b(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function o(e,l){var c,d=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),t=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),n=new Array(64);e[l>>5]|=128<<24-l%32,e[15+(l+64>>9<<4)]=l;for(var r,o,h=0;h<e.length;h+=16){for(var i=t[0],u=t[1],s=t[2],p=t[3],a=t[4],g=t[5],y=t[6],w=t[7],f=0;f<64;f++)n[f]=f<16?e[f+h]:b(b(b((o=n[f-2],m(o,17)^m(o,19)^v(o,10)),n[f-7]),(o=n[f-15],m(o,7)^m(o,18)^v(o,3))),n[f-16]),c=b(b(b(b(w,m(o=a,6)^m(o,11)^m(o,25)),a&g^~a&y),d[f]),n[f]),r=b(m(r=i,2)^m(r,13)^m(r,22),i&u^i&s^u&s),w=y,y=g,g=a,a=b(p,c),p=s,s=u,u=i,i=b(c,r);t[0]=b(i,t[0]),t[1]=b(u,t[1]),t[2]=b(s,t[2]),t[3]=b(p,t[3]),t[4]=b(a,t[4]),t[5]=b(g,t[5]),t[6]=b(y,t[6]),t[7]=b(w,t[7])}return t}var i=c(\"./helpers\"),m=function(e,t){return e>>>t|e<<32-t},v=function(e,t){return e>>>t};d.exports=function(e){return i.hash(e,o,32,!0)}}.call(this,c(\"lYpoI2\"),\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{},c(\"buffer\").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],\"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha256.js\",\"/node_modules/gulp-browserify/node_modules/crypto-browserify\")},{\"./helpers\":4,buffer:3,lYpoI2:11}],10:[function(e,t,f){!function(e,t,n,r,o,i,u,s,a){f.read=function(e,t,n,r,o){var i,u,l=8*o-r-1,c=(1<<l)-1,d=c>>1,s=-7,a=n?o-1:0,f=n?-1:1,o=e[t+a];for(a+=f,i=o&(1<<-s)-1,o>>=-s,s+=l;0<s;i=256*i+e[t+a],a+=f,s-=8);for(u=i&(1<<-s)-1,i>>=-s,s+=r;0<s;u=256*u+e[t+a],a+=f,s-=8);if(0===i)i=1-d;else{if(i===c)return u?NaN:1/0*(o?-1:1);u+=Math.pow(2,r),i-=d}return(o?-1:1)*u*Math.pow(2,i-r)},f.write=function(e,t,l,n,r,c){var o,i,u=8*c-r-1,s=(1<<u)-1,a=s>>1,d=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,f=n?0:c-1,h=n?1:-1,c=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(i=isNaN(t)?1:0,o=s):(o=Math.floor(Math.log(t)/Math.LN2),t*(n=Math.pow(2,-o))<1&&(o--,n*=2),2<=(t+=1<=o+a?d/n:d*Math.pow(2,1-a))*n&&(o++,n/=2),s<=o+a?(i=0,o=s):1<=o+a?(i=(t*n-1)*Math.pow(2,r),o+=a):(i=t*Math.pow(2,a-1)*Math.pow(2,r),o=0));8<=r;e[l+f]=255&i,f+=h,i/=256,r-=8);for(o=o<<r|i,u+=r;0<u;e[l+f]=255&o,f+=h,o/=256,u-=8);e[l+f-h]|=128*c}}.call(this,e(\"lYpoI2\"),\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{},e(\"buffer\").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],\"/node_modules/gulp-browserify/node_modules/ieee754/index.js\",\"/node_modules/gulp-browserify/node_modules/ieee754\")},{buffer:3,lYpoI2:11}],11:[function(e,h,t){!function(e,t,n,r,o,f,l,c,d){var i,u,s;function a(){}(e=h.exports={}).nextTick=(u=\"undefined\"!=typeof window&&window.setImmediate,s=\"undefined\"!=typeof window&&window.postMessage&&window.addEventListener,u?function(e){return window.setImmediate(e)}:s?(i=[],window.addEventListener(\"message\",function(e){var t=e.source;t!==window&&null!==t||\"process-tick\"!==e.data||(e.stopPropagation(),0<i.length&&i.shift()())},!0),function(e){i.push(e),window.postMessage(\"process-tick\",\"*\")}):function(e){setTimeout(e,0)}),e.title=\"browser\",e.browser=!0,e.env={},e.argv=[],e.on=a,e.addListener=a,e.once=a,e.off=a,e.removeListener=a,e.removeAllListeners=a,e.emit=a,e.binding=function(e){throw new Error(\"process.binding is not supported\")},e.cwd=function(){return\"/\"},e.chdir=function(e){throw new Error(\"process.chdir is not supported\")}}.call(this,e(\"lYpoI2\"),\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{},e(\"buffer\").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],\"/node_modules/gulp-browserify/node_modules/process/browser.js\",\"/node_modules/gulp-browserify/node_modules/process\")},{buffer:3,lYpoI2:11}]},{},[1])(1)});","/**\n * Wrapper for a fast hash function, where we want consistent, unique hashing\n * and are not concerned with the hash being decoded\n * */\nimport { MD5 } from \"object-hash\";\nconst weakHash = MD5;\nexport default weakHash;\n//# sourceMappingURL=weakHash.js.map","function n(n){for(var r=arguments.length,t=Array(r>1?r-1:0),e=1;e<r;e++)t[e-1]=arguments[e];if(\"production\"!==process.env.NODE_ENV){var i=Y[n],o=i?\"function\"==typeof i?i.apply(null,t):i:\"unknown error nr: \"+n;throw Error(\"[Immer] \"+o)}throw Error(\"[Immer] minified error nr: \"+n+(t.length?\" \"+t.map((function(n){return\"'\"+n+\"'\"})).join(\",\"):\"\")+\". Find the full error at: https://bit.ly/3cXEKWf\")}function r(n){return!!n&&!!n[Q]}function t(n){return!!n&&(function(n){if(!n||\"object\"!=typeof n)return!1;var r=Object.getPrototypeOf(n);if(null===r)return!0;var t=Object.hasOwnProperty.call(r,\"constructor\")&&r.constructor;return t===Object||\"function\"==typeof t&&Function.toString.call(t)===Z}(n)||Array.isArray(n)||!!n[L]||!!n.constructor[L]||s(n)||v(n))}function e(t){return r(t)||n(23,t),t[Q].t}function i(n,r,t){void 0===t&&(t=!1),0===o(n)?(t?Object.keys:nn)(n).forEach((function(e){t&&\"symbol\"==typeof e||r(e,n[e],n)})):n.forEach((function(t,e){return r(e,t,n)}))}function o(n){var r=n[Q];return r?r.i>3?r.i-4:r.i:Array.isArray(n)?1:s(n)?2:v(n)?3:0}function u(n,r){return 2===o(n)?n.has(r):Object.prototype.hasOwnProperty.call(n,r)}function a(n,r){return 2===o(n)?n.get(r):n[r]}function f(n,r,t){var e=o(n);2===e?n.set(r,t):3===e?(n.delete(r),n.add(t)):n[r]=t}function c(n,r){return n===r?0!==n||1/n==1/r:n!=n&&r!=r}function s(n){return X&&n instanceof Map}function v(n){return q&&n instanceof Set}function p(n){return n.o||n.t}function l(n){if(Array.isArray(n))return Array.prototype.slice.call(n);var r=rn(n);delete r[Q];for(var t=nn(r),e=0;e<t.length;e++){var i=t[e],o=r[i];!1===o.writable&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(r[i]={configurable:!0,writable:!0,enumerable:o.enumerable,value:n[i]})}return Object.create(Object.getPrototypeOf(n),r)}function d(n,e){return void 0===e&&(e=!1),y(n)||r(n)||!t(n)?n:(o(n)>1&&(n.set=n.add=n.clear=n.delete=h),Object.freeze(n),e&&i(n,(function(n,r){return d(r,!0)}),!0),n)}function h(){n(2)}function y(n){return null==n||\"object\"!=typeof n||Object.isFrozen(n)}function b(r){var t=tn[r];return t||n(18,r),t}function m(n,r){tn[n]||(tn[n]=r)}function _(){return\"production\"===process.env.NODE_ENV||U||n(0),U}function j(n,r){r&&(b(\"Patches\"),n.u=[],n.s=[],n.v=r)}function O(n){g(n),n.p.forEach(S),n.p=null}function g(n){n===U&&(U=n.l)}function w(n){return U={p:[],l:U,h:n,m:!0,_:0}}function S(n){var r=n[Q];0===r.i||1===r.i?r.j():r.O=!0}function P(r,e){e._=e.p.length;var i=e.p[0],o=void 0!==r&&r!==i;return e.h.g||b(\"ES5\").S(e,r,o),o?(i[Q].P&&(O(e),n(4)),t(r)&&(r=M(e,r),e.l||x(e,r)),e.u&&b(\"Patches\").M(i[Q].t,r,e.u,e.s)):r=M(e,i,[]),O(e),e.u&&e.v(e.u,e.s),r!==H?r:void 0}function M(n,r,t){if(y(r))return r;var e=r[Q];if(!e)return i(r,(function(i,o){return A(n,e,r,i,o,t)}),!0),r;if(e.A!==n)return r;if(!e.P)return x(n,e.t,!0),e.t;if(!e.I){e.I=!0,e.A._--;var o=4===e.i||5===e.i?e.o=l(e.k):e.o;i(3===e.i?new Set(o):o,(function(r,i){return A(n,e,o,r,i,t)})),x(n,o,!1),t&&n.u&&b(\"Patches\").R(e,t,n.u,n.s)}return e.o}function A(e,i,o,a,c,s){if(\"production\"!==process.env.NODE_ENV&&c===o&&n(5),r(c)){var v=M(e,c,s&&i&&3!==i.i&&!u(i.D,a)?s.concat(a):void 0);if(f(o,a,v),!r(v))return;e.m=!1}if(t(c)&&!y(c)){if(!e.h.F&&e._<1)return;M(e,c),i&&i.A.l||x(e,c)}}function x(n,r,t){void 0===t&&(t=!1),n.h.F&&n.m&&d(r,t)}function z(n,r){var t=n[Q];return(t?p(t):n)[r]}function I(n,r){if(r in n)for(var t=Object.getPrototypeOf(n);t;){var e=Object.getOwnPropertyDescriptor(t,r);if(e)return e;t=Object.getPrototypeOf(t)}}function k(n){n.P||(n.P=!0,n.l&&k(n.l))}function E(n){n.o||(n.o=l(n.t))}function R(n,r,t){var e=s(r)?b(\"MapSet\").N(r,t):v(r)?b(\"MapSet\").T(r,t):n.g?function(n,r){var t=Array.isArray(n),e={i:t?1:0,A:r?r.A:_(),P:!1,I:!1,D:{},l:r,t:n,k:null,o:null,j:null,C:!1},i=e,o=en;t&&(i=[e],o=on);var u=Proxy.revocable(i,o),a=u.revoke,f=u.proxy;return e.k=f,e.j=a,f}(r,t):b(\"ES5\").J(r,t);return(t?t.A:_()).p.push(e),e}function D(e){return r(e)||n(22,e),function n(r){if(!t(r))return r;var e,u=r[Q],c=o(r);if(u){if(!u.P&&(u.i<4||!b(\"ES5\").K(u)))return u.t;u.I=!0,e=F(r,c),u.I=!1}else e=F(r,c);return i(e,(function(r,t){u&&a(u.t,r)===t||f(e,r,n(t))})),3===c?new Set(e):e}(e)}function F(n,r){switch(r){case 2:return new Map(n);case 3:return Array.from(n)}return l(n)}function N(){function t(n,r){var t=s[n];return t?t.enumerable=r:s[n]=t={configurable:!0,enumerable:r,get:function(){var r=this[Q];return\"production\"!==process.env.NODE_ENV&&f(r),en.get(r,n)},set:function(r){var t=this[Q];\"production\"!==process.env.NODE_ENV&&f(t),en.set(t,n,r)}},t}function e(n){for(var r=n.length-1;r>=0;r--){var t=n[r][Q];if(!t.P)switch(t.i){case 5:a(t)&&k(t);break;case 4:o(t)&&k(t)}}}function o(n){for(var r=n.t,t=n.k,e=nn(t),i=e.length-1;i>=0;i--){var o=e[i];if(o!==Q){var a=r[o];if(void 0===a&&!u(r,o))return!0;var f=t[o],s=f&&f[Q];if(s?s.t!==a:!c(f,a))return!0}}var v=!!r[Q];return e.length!==nn(r).length+(v?0:1)}function a(n){var r=n.k;if(r.length!==n.t.length)return!0;var t=Object.getOwnPropertyDescriptor(r,r.length-1);if(t&&!t.get)return!0;for(var e=0;e<r.length;e++)if(!r.hasOwnProperty(e))return!0;return!1}function f(r){r.O&&n(3,JSON.stringify(p(r)))}var s={};m(\"ES5\",{J:function(n,r){var e=Array.isArray(n),i=function(n,r){if(n){for(var e=Array(r.length),i=0;i<r.length;i++)Object.defineProperty(e,\"\"+i,t(i,!0));return e}var o=rn(r);delete o[Q];for(var u=nn(o),a=0;a<u.length;a++){var f=u[a];o[f]=t(f,n||!!o[f].enumerable)}return Object.create(Object.getPrototypeOf(r),o)}(e,n),o={i:e?5:4,A:r?r.A:_(),P:!1,I:!1,D:{},l:r,t:n,k:i,o:null,O:!1,C:!1};return Object.defineProperty(i,Q,{value:o,writable:!0}),i},S:function(n,t,o){o?r(t)&&t[Q].A===n&&e(n.p):(n.u&&function n(r){if(r&&\"object\"==typeof r){var t=r[Q];if(t){var e=t.t,o=t.k,f=t.D,c=t.i;if(4===c)i(o,(function(r){r!==Q&&(void 0!==e[r]||u(e,r)?f[r]||n(o[r]):(f[r]=!0,k(t)))})),i(e,(function(n){void 0!==o[n]||u(o,n)||(f[n]=!1,k(t))}));else if(5===c){if(a(t)&&(k(t),f.length=!0),o.length<e.length)for(var s=o.length;s<e.length;s++)f[s]=!1;else for(var v=e.length;v<o.length;v++)f[v]=!0;for(var p=Math.min(o.length,e.length),l=0;l<p;l++)o.hasOwnProperty(l)||(f[l]=!0),void 0===f[l]&&n(o[l])}}}}(n.p[0]),e(n.p))},K:function(n){return 4===n.i?o(n):a(n)}})}function T(){function e(n){if(!t(n))return n;if(Array.isArray(n))return n.map(e);if(s(n))return new Map(Array.from(n.entries()).map((function(n){return[n[0],e(n[1])]})));if(v(n))return new Set(Array.from(n).map(e));var r=Object.create(Object.getPrototypeOf(n));for(var i in n)r[i]=e(n[i]);return u(n,L)&&(r[L]=n[L]),r}function f(n){return r(n)?e(n):n}var c=\"add\";m(\"Patches\",{$:function(r,t){return t.forEach((function(t){for(var i=t.path,u=t.op,f=r,s=0;s<i.length-1;s++){var v=o(f),p=\"\"+i[s];0!==v&&1!==v||\"__proto__\"!==p&&\"constructor\"!==p||n(24),\"function\"==typeof f&&\"prototype\"===p&&n(24),\"object\"!=typeof(f=a(f,p))&&n(15,i.join(\"/\"))}var l=o(f),d=e(t.value),h=i[i.length-1];switch(u){case\"replace\":switch(l){case 2:return f.set(h,d);case 3:n(16);default:return f[h]=d}case c:switch(l){case 1:return\"-\"===h?f.push(d):f.splice(h,0,d);case 2:return f.set(h,d);case 3:return f.add(d);default:return f[h]=d}case\"remove\":switch(l){case 1:return f.splice(h,1);case 2:return f.delete(h);case 3:return f.delete(t.value);default:return delete f[h]}default:n(17,u)}})),r},R:function(n,r,t,e){switch(n.i){case 0:case 4:case 2:return function(n,r,t,e){var o=n.t,s=n.o;i(n.D,(function(n,i){var v=a(o,n),p=a(s,n),l=i?u(o,n)?\"replace\":c:\"remove\";if(v!==p||\"replace\"!==l){var d=r.concat(n);t.push(\"remove\"===l?{op:l,path:d}:{op:l,path:d,value:p}),e.push(l===c?{op:\"remove\",path:d}:\"remove\"===l?{op:c,path:d,value:f(v)}:{op:\"replace\",path:d,value:f(v)})}}))}(n,r,t,e);case 5:case 1:return function(n,r,t,e){var i=n.t,o=n.D,u=n.o;if(u.length<i.length){var a=[u,i];i=a[0],u=a[1];var s=[e,t];t=s[0],e=s[1]}for(var v=0;v<i.length;v++)if(o[v]&&u[v]!==i[v]){var p=r.concat([v]);t.push({op:\"replace\",path:p,value:f(u[v])}),e.push({op:\"replace\",path:p,value:f(i[v])})}for(var l=i.length;l<u.length;l++){var d=r.concat([l]);t.push({op:c,path:d,value:f(u[l])})}i.length<u.length&&e.push({op:\"replace\",path:r.concat([\"length\"]),value:i.length})}(n,r,t,e);case 3:return function(n,r,t,e){var i=n.t,o=n.o,u=0;i.forEach((function(n){if(!o.has(n)){var i=r.concat([u]);t.push({op:\"remove\",path:i,value:n}),e.unshift({op:c,path:i,value:n})}u++})),u=0,o.forEach((function(n){if(!i.has(n)){var o=r.concat([u]);t.push({op:c,path:o,value:n}),e.unshift({op:\"remove\",path:o,value:n})}u++}))}(n,r,t,e)}},M:function(n,r,t,e){t.push({op:\"replace\",path:[],value:r===H?void 0:r}),e.push({op:\"replace\",path:[],value:n})}})}function C(){function r(n,r){function t(){this.constructor=n}a(n,r),n.prototype=(t.prototype=r.prototype,new t)}function e(n){n.o||(n.D=new Map,n.o=new Map(n.t))}function o(n){n.o||(n.o=new Set,n.t.forEach((function(r){if(t(r)){var e=R(n.A.h,r,n);n.p.set(r,e),n.o.add(e)}else n.o.add(r)})))}function u(r){r.O&&n(3,JSON.stringify(p(r)))}var a=function(n,r){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var t in r)r.hasOwnProperty(t)&&(n[t]=r[t])})(n,r)},f=function(){function n(n,r){return this[Q]={i:2,l:r,A:r?r.A:_(),P:!1,I:!1,o:void 0,D:void 0,t:n,k:this,C:!1,O:!1},this}r(n,Map);var o=n.prototype;return Object.defineProperty(o,\"size\",{get:function(){return p(this[Q]).size}}),o.has=function(n){return p(this[Q]).has(n)},o.set=function(n,r){var t=this[Q];return u(t),p(t).has(n)&&p(t).get(n)===r||(e(t),k(t),t.D.set(n,!0),t.o.set(n,r),t.D.set(n,!0)),this},o.delete=function(n){if(!this.has(n))return!1;var r=this[Q];return u(r),e(r),k(r),r.t.has(n)?r.D.set(n,!1):r.D.delete(n),r.o.delete(n),!0},o.clear=function(){var n=this[Q];u(n),p(n).size&&(e(n),k(n),n.D=new Map,i(n.t,(function(r){n.D.set(r,!1)})),n.o.clear())},o.forEach=function(n,r){var t=this;p(this[Q]).forEach((function(e,i){n.call(r,t.get(i),i,t)}))},o.get=function(n){var r=this[Q];u(r);var i=p(r).get(n);if(r.I||!t(i))return i;if(i!==r.t.get(n))return i;var o=R(r.A.h,i,r);return e(r),r.o.set(n,o),o},o.keys=function(){return p(this[Q]).keys()},o.values=function(){var n,r=this,t=this.keys();return(n={})[V]=function(){return r.values()},n.next=function(){var n=t.next();return n.done?n:{done:!1,value:r.get(n.value)}},n},o.entries=function(){var n,r=this,t=this.keys();return(n={})[V]=function(){return r.entries()},n.next=function(){var n=t.next();if(n.done)return n;var e=r.get(n.value);return{done:!1,value:[n.value,e]}},n},o[V]=function(){return this.entries()},n}(),c=function(){function n(n,r){return this[Q]={i:3,l:r,A:r?r.A:_(),P:!1,I:!1,o:void 0,t:n,k:this,p:new Map,O:!1,C:!1},this}r(n,Set);var t=n.prototype;return Object.defineProperty(t,\"size\",{get:function(){return p(this[Q]).size}}),t.has=function(n){var r=this[Q];return u(r),r.o?!!r.o.has(n)||!(!r.p.has(n)||!r.o.has(r.p.get(n))):r.t.has(n)},t.add=function(n){var r=this[Q];return u(r),this.has(n)||(o(r),k(r),r.o.add(n)),this},t.delete=function(n){if(!this.has(n))return!1;var r=this[Q];return u(r),o(r),k(r),r.o.delete(n)||!!r.p.has(n)&&r.o.delete(r.p.get(n))},t.clear=function(){var n=this[Q];u(n),p(n).size&&(o(n),k(n),n.o.clear())},t.values=function(){var n=this[Q];return u(n),o(n),n.o.values()},t.entries=function(){var n=this[Q];return u(n),o(n),n.o.entries()},t.keys=function(){return this.values()},t[V]=function(){return this.values()},t.forEach=function(n,r){for(var t=this.values(),e=t.next();!e.done;)n.call(r,e.value,e.value,this),e=t.next()},n}();m(\"MapSet\",{N:function(n,r){return new f(n,r)},T:function(n,r){return new c(n,r)}})}function J(){N(),C(),T()}function K(n){return n}function $(n){return n}var G,U,W=\"undefined\"!=typeof Symbol&&\"symbol\"==typeof Symbol(\"x\"),X=\"undefined\"!=typeof Map,q=\"undefined\"!=typeof Set,B=\"undefined\"!=typeof Proxy&&void 0!==Proxy.revocable&&\"undefined\"!=typeof Reflect,H=W?Symbol.for(\"immer-nothing\"):((G={})[\"immer-nothing\"]=!0,G),L=W?Symbol.for(\"immer-draftable\"):\"__$immer_draftable\",Q=W?Symbol.for(\"immer-state\"):\"__$immer_state\",V=\"undefined\"!=typeof Symbol&&Symbol.iterator||\"@@iterator\",Y={0:\"Illegal state\",1:\"Immer drafts cannot have computed properties\",2:\"This object has been frozen and should not be mutated\",3:function(n){return\"Cannot use a proxy that has been revoked. Did you pass an object from inside an immer function to an async process? \"+n},4:\"An immer producer returned a new value *and* modified its draft. Either return a new value *or* modify the draft.\",5:\"Immer forbids circular references\",6:\"The first or second argument to `produce` must be a function\",7:\"The third argument to `produce` must be a function or undefined\",8:\"First argument to `createDraft` must be a plain object, an array, or an immerable object\",9:\"First argument to `finishDraft` must be a draft returned by `createDraft`\",10:\"The given draft is already finalized\",11:\"Object.defineProperty() cannot be used on an Immer draft\",12:\"Object.setPrototypeOf() cannot be used on an Immer draft\",13:\"Immer only supports deleting array indices\",14:\"Immer only supports setting array indices and the 'length' property\",15:function(n){return\"Cannot apply patch, path doesn't resolve: \"+n},16:'Sets cannot have \"replace\" patches.',17:function(n){return\"Unsupported patch operation: \"+n},18:function(n){return\"The plugin for '\"+n+\"' has not been loaded into Immer. To enable the plugin, import and call `enable\"+n+\"()` when initializing your application.\"},20:\"Cannot use proxies if Proxy, Proxy.revocable or Reflect are not available\",21:function(n){return\"produce can only be called on things that are draftable: plain objects, arrays, Map, Set or classes that are marked with '[immerable]: true'. Got '\"+n+\"'\"},22:function(n){return\"'current' expects a draft, got: \"+n},23:function(n){return\"'original' expects a draft, got: \"+n},24:\"Patching reserved attributes like __proto__, prototype and constructor is not allowed\"},Z=\"\"+Object.prototype.constructor,nn=\"undefined\"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(n){return Object.getOwnPropertyNames(n).concat(Object.getOwnPropertySymbols(n))}:Object.getOwnPropertyNames,rn=Object.getOwnPropertyDescriptors||function(n){var r={};return nn(n).forEach((function(t){r[t]=Object.getOwnPropertyDescriptor(n,t)})),r},tn={},en={get:function(n,r){if(r===Q)return n;var e=p(n);if(!u(e,r))return function(n,r,t){var e,i=I(r,t);return i?\"value\"in i?i.value:null===(e=i.get)||void 0===e?void 0:e.call(n.k):void 0}(n,e,r);var i=e[r];return n.I||!t(i)?i:i===z(n.t,r)?(E(n),n.o[r]=R(n.A.h,i,n)):i},has:function(n,r){return r in p(n)},ownKeys:function(n){return Reflect.ownKeys(p(n))},set:function(n,r,t){var e=I(p(n),r);if(null==e?void 0:e.set)return e.set.call(n.k,t),!0;if(!n.P){var i=z(p(n),r),o=null==i?void 0:i[Q];if(o&&o.t===t)return n.o[r]=t,n.D[r]=!1,!0;if(c(t,i)&&(void 0!==t||u(n.t,r)))return!0;E(n),k(n)}return n.o[r]===t&&\"number\"!=typeof t&&(void 0!==t||r in n.o)||(n.o[r]=t,n.D[r]=!0,!0)},deleteProperty:function(n,r){return void 0!==z(n.t,r)||r in n.t?(n.D[r]=!1,E(n),k(n)):delete n.D[r],n.o&&delete n.o[r],!0},getOwnPropertyDescriptor:function(n,r){var t=p(n),e=Reflect.getOwnPropertyDescriptor(t,r);return e?{writable:!0,configurable:1!==n.i||\"length\"!==r,enumerable:e.enumerable,value:t[r]}:e},defineProperty:function(){n(11)},getPrototypeOf:function(n){return Object.getPrototypeOf(n.t)},setPrototypeOf:function(){n(12)}},on={};i(en,(function(n,r){on[n]=function(){return arguments[0]=arguments[0][0],r.apply(this,arguments)}})),on.deleteProperty=function(r,t){return\"production\"!==process.env.NODE_ENV&&isNaN(parseInt(t))&&n(13),on.set.call(this,r,t,void 0)},on.set=function(r,t,e){return\"production\"!==process.env.NODE_ENV&&\"length\"!==t&&isNaN(parseInt(t))&&n(14),en.set.call(this,r[0],t,e,r[0])};var un=function(){function e(r){var e=this;this.g=B,this.F=!0,this.produce=function(r,i,o){if(\"function\"==typeof r&&\"function\"!=typeof i){var u=i;i=r;var a=e;return function(n){var r=this;void 0===n&&(n=u);for(var t=arguments.length,e=Array(t>1?t-1:0),o=1;o<t;o++)e[o-1]=arguments[o];return a.produce(n,(function(n){var t;return(t=i).call.apply(t,[r,n].concat(e))}))}}var f;if(\"function\"!=typeof i&&n(6),void 0!==o&&\"function\"!=typeof o&&n(7),t(r)){var c=w(e),s=R(e,r,void 0),v=!0;try{f=i(s),v=!1}finally{v?O(c):g(c)}return\"undefined\"!=typeof Promise&&f instanceof Promise?f.then((function(n){return j(c,o),P(n,c)}),(function(n){throw O(c),n})):(j(c,o),P(f,c))}if(!r||\"object\"!=typeof r){if(void 0===(f=i(r))&&(f=r),f===H&&(f=void 0),e.F&&d(f,!0),o){var p=[],l=[];b(\"Patches\").M(r,f,p,l),o(p,l)}return f}n(21,r)},this.produceWithPatches=function(n,r){if(\"function\"==typeof n)return function(r){for(var t=arguments.length,i=Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];return e.produceWithPatches(r,(function(r){return n.apply(void 0,[r].concat(i))}))};var t,i,o=e.produce(n,r,(function(n,r){t=n,i=r}));return\"undefined\"!=typeof Promise&&o instanceof Promise?o.then((function(n){return[n,t,i]})):[o,t,i]},\"boolean\"==typeof(null==r?void 0:r.useProxies)&&this.setUseProxies(r.useProxies),\"boolean\"==typeof(null==r?void 0:r.autoFreeze)&&this.setAutoFreeze(r.autoFreeze)}var i=e.prototype;return i.createDraft=function(e){t(e)||n(8),r(e)&&(e=D(e));var i=w(this),o=R(this,e,void 0);return o[Q].C=!0,g(i),o},i.finishDraft=function(r,t){var e=r&&r[Q];\"production\"!==process.env.NODE_ENV&&(e&&e.C||n(9),e.I&&n(10));var i=e.A;return j(i,t),P(void 0,i)},i.setAutoFreeze=function(n){this.F=n},i.setUseProxies=function(r){r&&!B&&n(20),this.g=r},i.applyPatches=function(n,t){var e;for(e=t.length-1;e>=0;e--){var i=t[e];if(0===i.path.length&&\"replace\"===i.op){n=i.value;break}}e>-1&&(t=t.slice(e+1));var o=b(\"Patches\").$;return r(n)?o(n,t):this.produce(n,(function(n){return o(n,t)}))},e}(),an=new un,fn=an.produce,cn=an.produceWithPatches.bind(an),sn=an.setAutoFreeze.bind(an),vn=an.setUseProxies.bind(an),pn=an.applyPatches.bind(an),ln=an.createDraft.bind(an),dn=an.finishDraft.bind(an);export default fn;export{un as Immer,pn as applyPatches,K as castDraft,$ as castImmutable,ln as createDraft,D as current,J as enableAllPlugins,N as enableES5,C as enableMapSet,T as enablePatches,dn as finishDraft,d as freeze,L as immerable,r as isDraft,t as isDraftable,H as nothing,e as original,fn as produce,cn as produceWithPatches,sn as setAutoFreeze,vn as setUseProxies};\n//# sourceMappingURL=immer.esm.js.map\n","export function areObjectKeysEqual(a, b) {\n    const ak = Object.keys(a);\n    const bk = Object.keys(b);\n    return (ak.length === bk.length && Object.keys(a).every((k) => b.hasOwnProperty(k)));\n}\nexport function areObjectsShallowEqual(obj1, obj2) {\n    return (Object.keys(obj1).length === Object.keys(obj2).length &&\n        Object.keys(obj1).every((key) => obj2.hasOwnProperty(key) && obj1[key] === obj2[key]));\n}\nexport function areObjectsDeepEqual(obj1, obj2) {\n    if (typeof obj1 !== \"object\" ||\n        typeof obj2 !== \"object\" ||\n        obj1 === null ||\n        obj2 === null) {\n        return obj1 === obj2;\n    }\n    if (!areObjectKeysEqual(obj1, obj2)) {\n        return false;\n    }\n    return Object.keys(obj1).every((key) => areObjectsDeepEqual(obj1[key], obj2[key]));\n}\nexport function immutableDeepMerge(target, source) {\n    if (!isObject(target) || !isObject(source)) {\n        return source;\n    }\n    const result = {};\n    for (const key of Object.keys(target)) {\n        result[key] = target[key];\n    }\n    for (const key of Object.keys(source)) {\n        // null acts as a \"delete key\"\n        if (source[key] === null)\n            continue;\n        const areBothObjects = isObject(target[key]) && isObject(source[key]);\n        result[key] = areBothObjects\n            ? immutableDeepMerge(target[key], source[key])\n            : source[key];\n    }\n    return result;\n}\nexport function immutableDeepReplace(target, replaceValue, replacementValue) {\n    if (!isObject(target)) {\n        return target;\n    }\n    const result = {};\n    for (const [key, value] of Object.entries(target)) {\n        result[key] = isObject(value)\n            ? immutableDeepReplace(value, replaceValue, replacementValue)\n            : value === replaceValue\n                ? replacementValue\n                : value;\n    }\n    return result;\n}\nexport function isObject(val) {\n    return typeof val === \"object\" && val !== null && !Array.isArray(val);\n}\n//# sourceMappingURL=object.js.map","import { produce, enableMapSet } from \"immer\";\nimport { immutableDeepMerge } from \"./utils/object\";\n// Makes immer work with maps and sets\nenableMapSet();\nfunction hasEA(attr) {\n    return attr[\"cardinality\"] === \"one\";\n}\nfunction isRef(attr) {\n    return attr[\"value-type\"] === \"ref\";\n}\nfunction isBlob(attr) {\n    return attr[\"value-type\"] === \"blob\";\n}\nfunction getAttr(attrs, attrId) {\n    return attrs[attrId];\n}\nfunction getInMap(obj, path) {\n    return path.reduce((acc, key) => acc && acc.get(key), obj);\n}\nfunction deleteInMap(m, path) {\n    if (path.length === 0)\n        throw new Error(\"path must have at least one element\");\n    if (path.length === 1) {\n        m.delete(path[0]);\n        return;\n    }\n    const [head, ...tail] = path;\n    if (!m.has(head))\n        return;\n    deleteInMap(m.get(head), tail);\n}\nfunction setInMap(m, path, value) {\n    if (path.length === 0)\n        throw new Error(\"path must have at least one element\");\n    if (path.length === 1) {\n        m.set(path[0], value);\n        return;\n    }\n    const [head, ...tail] = path;\n    let nextM = m.get(head);\n    if (!nextM) {\n        nextM = new Map();\n        m.set(head, nextM);\n    }\n    setInMap(nextM, tail, value);\n}\nfunction createIndexMap(attrs, triples) {\n    const eav = new Map();\n    const aev = new Map();\n    const vae = new Map();\n    for (const triple of triples) {\n        const [eid, aid, v, t] = triple;\n        const attr = getAttr(attrs, aid);\n        if (!attr) {\n            console.warn(\"no such attr\", eid, attrs);\n            continue;\n        }\n        if (isRef(attr)) {\n            setInMap(vae, [v, aid, eid], triple);\n        }\n        setInMap(eav, [eid, aid, v], triple);\n        setInMap(aev, [aid, eid, v], triple);\n    }\n    return { eav, aev, vae };\n}\nexport function createStore(attrs, triples) {\n    const store = createIndexMap(attrs, triples);\n    store.attrs = attrs;\n    return store;\n}\n// We may have local triples with lookup refs in them,\n// we need to convert those lookup refs to eids to insert them\n// into the store. If we can't find the lookup ref locally,\n// then we drop the triple and have to wait for the server response\n// to see the optimistic updates.\nfunction resolveLookupRefs(store, triple) {\n    var _a, _b;\n    let eid;\n    // Check if `e` is a lookup ref\n    if (Array.isArray(triple[0])) {\n        const [a, v] = triple[0];\n        const eMaps = store.aev.get(a);\n        if (!eMaps) {\n            // We don't have the attr, so don't try to add the\n            // triple to the store\n            return null;\n        }\n        // This would be a lot more efficient with a ave index\n        const triples = allMapValues(eMaps, 2);\n        eid = (_a = triples.find((x) => x[2] === v)) === null || _a === void 0 ? void 0 : _a[0];\n    }\n    else {\n        eid = triple[0];\n    }\n    if (!eid) {\n        // We don't know the eid that the ref refers to, so\n        // we can't add the triple to the store.\n        return null;\n    }\n    // Check if v is a lookup ref\n    const lookupV = triple[2];\n    if (Array.isArray(lookupV) &&\n        lookupV.length === 2 &&\n        store.aev.get(lookupV[0])) {\n        const [a, v] = lookupV;\n        const eMaps = store.aev.get(a);\n        if (!eMaps) {\n            // We don't have the attr, so don't try to add the\n            // triple to the store\n            return null;\n        }\n        const triples = allMapValues(eMaps, 2);\n        const value = (_b = triples.find((x) => x[2] === v)) === null || _b === void 0 ? void 0 : _b[0];\n        if (!value) {\n            return null;\n        }\n        const [_e, aid, _v, ...rest] = triple;\n        return [eid, aid, value, ...rest];\n    }\n    else {\n        const [_, ...rest] = triple;\n        return [eid, ...rest];\n    }\n}\nfunction retractTriple(store, rawTriple) {\n    const triple = resolveLookupRefs(store, rawTriple);\n    if (!triple) {\n        return;\n    }\n    const [eid, aid, v] = triple;\n    const attr = getAttr(store.attrs, aid);\n    if (!attr) {\n        return;\n    }\n    deleteInMap(store.eav, [eid, aid, v]);\n    deleteInMap(store.aev, [aid, eid, v]);\n    if (isRef(attr)) {\n        deleteInMap(store.vae, [v, aid, eid]);\n    }\n}\nlet _seed = 0;\nfunction getCreatedAt(store, attr, triple) {\n    const [eid, aid, v] = triple;\n    let createdAt;\n    const t = getInMap(store.ea, [eid, aid, v]);\n    if (t) {\n        createdAt = t[3];\n    }\n    /**\n     * (XXX)\n     * Two hacks here, for generating a `createdAt`\n     *\n     * 1. We multiply Date.now() by 10, to make sure that\n     *  `createdAt` is always greater than anything the server\n     *   could return\n     *\n     *   We do this because right now we know we _only_ insert\n     *   triples as optimistic updates.\n     *\n     * 2. We increment by `_seed`, to make sure there are no\n     *    two triples with the same `createdAt`. This is\n     *    done to make tests more predictable.\n     *\n     * We may need to rethink this. Because we * 10, we can't\n     * use this value as an _actual_ `createdAt` timestamp.\n     * Eventually we may want too though; For example, we could\n     * use `createdAt` for each triple, to infer a `createdAt` and\n     * `updatedAt` value for each object.\n     */\n    return createdAt || Date.now() * 10 + _seed++;\n}\nfunction addTriple(store, rawTriple) {\n    const triple = resolveLookupRefs(store, rawTriple);\n    if (!triple) {\n        return;\n    }\n    const [eid, aid, v] = triple;\n    const attr = getAttr(store.attrs, aid);\n    if (!attr) {\n        // (XXX): Due to the way we're handling attrs, it's\n        // possible to enter a state where we receive a triple without an attr.\n        // See: https://github.com/jsventures/instant-local/pull/132 for details.\n        // For now, if we receive a command without an attr, we no-op.\n        return;\n    }\n    const enhancedTriple = [...triple, getCreatedAt(store, attr, triple)];\n    if (hasEA(attr)) {\n        setInMap(store.eav, [eid, aid], new Map([[v, enhancedTriple]]));\n        setInMap(store.aev, [aid, eid], new Map([[v, enhancedTriple]]));\n    }\n    else {\n        setInMap(store.eav, [eid, aid, v], enhancedTriple);\n        setInMap(store.aev, [aid, eid, v], enhancedTriple);\n    }\n    if (isRef(attr)) {\n        setInMap(store.vae, [v, aid, eid], enhancedTriple);\n    }\n}\nfunction mergeTriple(store, rawTriple) {\n    var _a;\n    const triple = resolveLookupRefs(store, rawTriple);\n    if (!triple) {\n        return;\n    }\n    const [eid, aid, update] = triple;\n    const attr = getAttr(store.attrs, aid);\n    if (!attr)\n        return;\n    if (!isBlob(attr))\n        throw new Error(\"merge operation is not supported for links\");\n    const eavValuesMap = getInMap(store.eav, [eid, aid]);\n    if (!eavValuesMap)\n        return;\n    const currentTriple = (_a = eavValuesMap.values().next()) === null || _a === void 0 ? void 0 : _a.value;\n    if (!currentTriple)\n        return;\n    const currentValue = currentTriple[2];\n    const updatedValue = immutableDeepMerge(currentValue, update);\n    const enhancedTriple = [\n        eid,\n        aid,\n        updatedValue,\n        getCreatedAt(store, attr, currentTriple),\n    ];\n    setInMap(store.eav, [eid, aid], new Map([[updatedValue, enhancedTriple]]));\n}\nfunction deleteEntity(store, rawTriple) {\n    const triple = resolveLookupRefs(store, rawTriple);\n    if (!triple) {\n        return;\n    }\n    const [id] = triple;\n    // delete forward links\n    const eMap = store.eav.get(id);\n    if (eMap) {\n        for (const a of eMap.keys()) {\n            deleteInMap(store.aev, [a, id]);\n        }\n    }\n    // delete object attributes + cardinality one links\n    deleteInMap(store.eav, [id]);\n    // delete reverse links\n    const vaeTriples = store.vae.get(id) && allMapValues(store.vae.get(id), 2);\n    if (vaeTriples) {\n        vaeTriples.forEach((triple) => {\n            const [e, a, v] = triple;\n            deleteInMap(store.eav, [e, a, v]);\n            deleteInMap(store.aev, [a, e, v]);\n        });\n    }\n    deleteInMap(store.vae, [id]);\n}\n// (XXX): Whenever we change/delete attrs,\n// We indiscriminately reset the index map.\n// There are lots of opportunities for optimization:\n// * We _only_ need to run this indexes change. We could detect that\n// * We could batch this reset at the end\n// * We could add an ave index for all triples, so removing the\n//   right triples is easy and fast.\nfunction resetIndexMap(store, newTriples) {\n    const newIndexMap = createIndexMap(store.attrs, newTriples);\n    Object.keys(newIndexMap).forEach((key) => {\n        store[key] = newIndexMap[key];\n    });\n}\nfunction addAttr(store, [attr]) {\n    store.attrs[attr.id] = attr;\n}\nfunction getAllTriples(store) {\n    return allMapValues(store.eav, 3);\n}\nfunction deleteAttr(store, [id]) {\n    if (!store.attrs[id])\n        return;\n    const newTriples = getAllTriples(store).filter(([_, aid]) => aid !== id);\n    delete store.attrs[id];\n    resetIndexMap(store, newTriples);\n}\nfunction updateAttr(store, [partialAttr]) {\n    const attr = store.attrs[partialAttr.id];\n    if (!attr)\n        return;\n    store.attrs[partialAttr.id] = Object.assign(Object.assign({}, attr), partialAttr);\n    resetIndexMap(store, getAllTriples(store));\n}\nfunction applyTxStep(store, txStep) {\n    const [action, ...args] = txStep;\n    switch (action) {\n        case \"add-triple\":\n            addTriple(store, args);\n            break;\n        case \"deep-merge-triple\":\n            mergeTriple(store, args);\n            break;\n        case \"retract-triple\":\n            retractTriple(store, args);\n            break;\n        case \"delete-entity\":\n            deleteEntity(store, args);\n            break;\n        case \"add-attr\":\n            addAttr(store, args);\n            break;\n        case \"delete-attr\":\n            deleteAttr(store, args);\n            break;\n        case \"update-attr\":\n            updateAttr(store, args);\n            break;\n        default:\n            throw new Error(`unhandled transaction action: ${action}`);\n    }\n}\nexport function allMapValues(m, level, res = []) {\n    if (!m) {\n        return res;\n    }\n    if (level === 0) {\n        return res;\n    }\n    if (level === 1) {\n        for (const v of m.values()) {\n            res.push(v);\n        }\n        return res;\n    }\n    for (const v of m.values()) {\n        allMapValues(v, level - 1, res);\n    }\n    return res;\n}\nfunction triplesByValue(m, v) {\n    const res = [];\n    const values = v.in ? v.in : [v];\n    for (const value of values) {\n        const triple = m.get(value);\n        if (triple) {\n            res.push(triple);\n        }\n    }\n    return res;\n}\n// A poor man's pattern matching\n// Returns either eav, ea, ev, av, v, or ''\nfunction whichIdx(e, a, v) {\n    let res = \"\";\n    if (e !== undefined) {\n        res += \"e\";\n    }\n    if (a !== undefined) {\n        res += \"a\";\n    }\n    if (v !== undefined) {\n        res += \"v\";\n    }\n    return res;\n}\nexport function getTriples(store, [e, a, v]) {\n    var _a, _b;\n    const idx = whichIdx(e, a, v);\n    switch (idx) {\n        case \"e\": {\n            const eMap = store.eav.get(e);\n            return allMapValues(eMap, 2);\n        }\n        case \"ea\": {\n            const aMap = (_a = store.eav.get(e)) === null || _a === void 0 ? void 0 : _a.get(a);\n            return allMapValues(aMap, 1);\n        }\n        case \"eav\": {\n            const aMap = (_b = store.eav.get(e)) === null || _b === void 0 ? void 0 : _b.get(a);\n            if (!aMap) {\n                return [];\n            }\n            return triplesByValue(aMap, v);\n        }\n        case \"ev\": {\n            const eMap = store.eav.get(e);\n            if (!eMap) {\n                return [];\n            }\n            const res = [];\n            for (const aMap of eMap.values()) {\n                res.push(...triplesByValue(aMap, v));\n            }\n            return res;\n        }\n        case \"av\": {\n            const aMap = store.aev.get(a);\n            if (!aMap) {\n                return [];\n            }\n            const res = [];\n            for (const eMap of aMap.values()) {\n                res.push(...triplesByValue(eMap, v));\n            }\n            return res;\n        }\n        case \"v\": {\n            const res = [];\n            for (const eMap of store.eav.values()) {\n                for (const aMap of eMap.values()) {\n                    res.push(...triplesByValue(aMap, v));\n                }\n            }\n        }\n        default: {\n            return allMapValues(store.eav, 3);\n        }\n    }\n}\nexport function transact(store, txSteps) {\n    return produce(store, (draft) => {\n        txSteps.forEach((txStep) => {\n            applyTxStep(draft, txStep);\n        });\n    });\n}\n//# sourceMappingURL=store.js.map","// 1. patternMatch\nimport { getTriples } from \"./store.js\";\nfunction isVariable(x) {\n    return typeof x === \"string\" && x.startsWith(\"?\");\n}\nfunction matchVariable(variable, triplePart, context) {\n    if (context.hasOwnProperty(variable)) {\n        const bound = context[variable];\n        return matchPart(bound, triplePart, context);\n    }\n    return Object.assign(Object.assign({}, context), { [variable]: triplePart });\n}\nfunction matchExact(patternPart, triplePart, context) {\n    return patternPart === triplePart ? context : null;\n}\nfunction matchWithArgMap(patternPart, triplePart, context) {\n    const { in: inList } = patternPart;\n    if (inList && inList.includes(triplePart)) {\n        return context;\n    }\n    return null;\n}\nfunction matcherForPatternPart(patternPart) {\n    switch (typeof patternPart) {\n        case \"string\":\n            return patternPart.startsWith(\"?\") ? matchVariable : matchExact;\n        case \"object\":\n            return matchWithArgMap;\n        default:\n            return matchExact;\n    }\n}\nfunction matchPart(patternPart, triplePart, context) {\n    if (!context)\n        return null;\n    const matcher = matcherForPatternPart(patternPart);\n    return matcher(patternPart, triplePart, context);\n}\nexport function matchPattern(pattern, triple, context) {\n    return pattern.reduce((context, patternPart, idx) => {\n        const triplePart = triple[idx];\n        return matchPart(patternPart, triplePart, context);\n    }, context);\n}\n// 2. querySingle\nexport function querySingle(store, pattern, context) {\n    return relevantTriples(store, pattern, context)\n        .map((triple) => matchPattern(pattern, triple, context))\n        .filter((x) => x);\n}\n// 3. queryWhere\nfunction queryPattern(store, pattern, contexts) {\n    if (pattern.or) {\n        return pattern.or.patterns.flatMap((patterns) => {\n            return queryWhere(store, patterns, contexts);\n        });\n    }\n    if (pattern.and) {\n        return pattern.and.patterns.reduce((contexts, patterns) => {\n            return queryWhere(store, patterns, contexts);\n        }, contexts);\n    }\n    return contexts.flatMap((context) => querySingle(store, pattern, context));\n}\nexport function queryWhere(store, patterns, contexts = [{}]) {\n    return patterns.reduce((contexts, pattern) => {\n        return queryPattern(store, pattern, contexts);\n    }, contexts);\n}\n// 4. query\nfunction actualize(context, find) {\n    if (Array.isArray(find)) {\n        return find.map((findPart) => actualize(context, findPart));\n    }\n    return isVariable(find) ? context[find] : find;\n}\nexport function query(store, { find, where }) {\n    const contexts = queryWhere(store, where);\n    return contexts.map((context) => actualize(context, find));\n}\n// 5. Index\nfunction relevantTriples(store, pattern, context) {\n    return getTriples(store, actualize(context, pattern));\n}\n//# sourceMappingURL=datalog.js.map","// Unique ID creation requires a high quality random # generator. In the browser we therefore\n// require the crypto API and do not support built-in fallback to lower quality random number\n// generators (like Math.random()).\nlet getRandomValues;\nconst rnds8 = new Uint8Array(16);\nexport default function rng() {\n  // lazy load so that environments that need to polyfill have a chance to do so\n  if (!getRandomValues) {\n    // getRandomValues needs to be invoked in a context where \"this\" is a Crypto implementation.\n    getRandomValues = typeof crypto !== 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto);\n\n    if (!getRandomValues) {\n      throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n    }\n  }\n\n  return getRandomValues(rnds8);\n}","import validate from './validate.js';\n/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\n\nconst byteToHex = [];\n\nfor (let i = 0; i < 256; ++i) {\n  byteToHex.push((i + 0x100).toString(16).slice(1));\n}\n\nexport function unsafeStringify(arr, offset = 0) {\n  // Note: Be careful editing this code!  It's been tuned for performance\n  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434\n  return byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + '-' + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + '-' + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + '-' + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + '-' + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]];\n}\n\nfunction stringify(arr, offset = 0) {\n  const uuid = unsafeStringify(arr, offset); // Consistency check for valid UUID.  If this throws, it's likely due to one\n  // of the following:\n  // - One or more input array values don't map to a hex octet (leading to\n  // \"undefined\" in the uuid)\n  // - Invalid input values for the RFC `version` or `variant` fields\n\n  if (!validate(uuid)) {\n    throw TypeError('Stringified UUID is invalid');\n  }\n\n  return uuid;\n}\n\nexport default stringify;","const randomUUID = typeof crypto !== 'undefined' && crypto.randomUUID && crypto.randomUUID.bind(crypto);\nexport default {\n  randomUUID\n};","import native from './native.js';\nimport rng from './rng.js';\nimport { unsafeStringify } from './stringify.js';\n\nfunction v4(options, buf, offset) {\n  if (native.randomUUID && !buf && !options) {\n    return native.randomUUID();\n  }\n\n  options = options || {};\n  const rnds = options.random || (options.rng || rng)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\n\n  if (buf) {\n    offset = offset || 0;\n\n    for (let i = 0; i < 16; ++i) {\n      buf[offset + i] = rnds[i];\n    }\n\n    return buf;\n  }\n\n  return unsafeStringify(rnds);\n}\n\nexport default v4;","import { v4 } from \"uuid\";\nfunction uuidToByteArray(uuid) {\n    const hex = uuid.replace(/-/g, \"\");\n    const bytes = [];\n    for (let i = 0; i < hex.length; i += 2) {\n        bytes.push(parseInt(hex.substring(i, i + 2), 16));\n    }\n    return bytes;\n}\nfunction compareByteArrays(a, b) {\n    for (let i = 0; i < a.length; i++) {\n        if (a[i] < b[i])\n            return -1;\n        if (a[i] > b[i])\n            return 1;\n    }\n    return 0;\n}\nexport function uuidCompare(uuid_a, uuid_b) {\n    return compareByteArrays(uuidToByteArray(uuid_a), uuidToByteArray(uuid_b));\n}\nexport default v4;\n//# sourceMappingURL=uuid.js.map","import { query as datalogQuery } from \"./datalog\";\nimport { uuidCompare } from \"./utils/uuid\";\n// (XXX) copied\nfunction getAttrByFwdIdentName(attrs, inputEtype, inputIdentName) {\n    return Object.values(attrs).find((attr) => {\n        const [_id, etype, label] = attr[\"forward-identity\"];\n        return etype === inputEtype && label === inputIdentName;\n    });\n}\n// (XXX) copied\nfunction getAttrByReverseIdentName(attrs, inputEtype, inputIdentName) {\n    return Object.values(attrs).find((attr) => {\n        const revIdent = attr[\"reverse-identity\"];\n        if (!revIdent)\n            return false;\n        const [_id, etype, label] = revIdent;\n        return etype === inputEtype && label === inputIdentName;\n    });\n}\n// Pattern variables\n// -----------------\n// (XXX)\n// We shouldn't need to generate wildcards like this.\n// Datalog could understand '?_' as a wildcard\n// Doing this to move fast.\nlet _seed = 0;\nfunction wildcard(friendlyName) {\n    return makeVarImpl(`_${friendlyName}`, _seed++);\n}\nfunction makeVarImpl(x, level) {\n    return `?${x}-${level}`;\n}\n// Where\n// -----------------\nclass AttrNotFoundError extends Error {\n    constructor(message) {\n        super(message);\n        this.name = \"AttrNotFoundError\";\n    }\n}\nfunction getPrimaryKeyAttr(store, ns) {\n    const primary = Object.values(store.attrs).find((a) => { var _a; return a[\"primary?\"] && ((_a = a[\"forward-identity\"]) === null || _a === void 0 ? void 0 : _a[1]) === ns; });\n    if (primary) {\n        return primary;\n    }\n    return getAttrByFwdIdentName(store.attrs, ns, \"id\");\n}\nfunction idAttr(store, ns) {\n    const attr = getPrimaryKeyAttr(store, ns);\n    if (!attr) {\n        throw new AttrNotFoundError(`Could not find id attr for ${ns}`);\n    }\n    return attr;\n}\nfunction defaultWhere(makeVar, store, etype, level) {\n    return [\n        eidWhere(makeVar, store, etype, level),\n        attrWhere(makeVar, etype, level),\n    ];\n}\nfunction eidWhere(makeVar, store, etype, level) {\n    return [\n        makeVar(etype, level),\n        idAttr(store, etype).id,\n        makeVar(etype, level),\n        wildcard(\"time\"),\n    ];\n}\nfunction attrWhere(makeVar, etype, level) {\n    return [\n        makeVar(etype, level),\n        makeVar(\"attr\", level),\n        makeVar(\"val\", level),\n        makeVar(\"time\", level),\n    ];\n}\nfunction replaceInAttrPat(attrPat, needle, v) {\n    return attrPat.map((x) => (x === needle ? v : x));\n}\nfunction refAttrPat(makeVar, store, etype, level, label) {\n    const fwdAttr = getAttrByFwdIdentName(store.attrs, etype, label);\n    const revAttr = getAttrByReverseIdentName(store.attrs, etype, label);\n    const attr = fwdAttr || revAttr;\n    if (!attr) {\n        throw new AttrNotFoundError(`Could not find attr for ${[etype, label]}`);\n    }\n    if (attr[\"value-type\"] !== \"ref\") {\n        throw new Error(`Attr ${attr.id} is not a ref`);\n    }\n    const [_f, fwdEtype] = attr[\"forward-identity\"];\n    const [_r, revEtype] = attr[\"reverse-identity\"];\n    const nextLevel = level + 1;\n    const attrPat = fwdAttr\n        ? [\n            makeVar(fwdEtype, level),\n            attr.id,\n            makeVar(revEtype, nextLevel),\n            wildcard(\"time\"),\n        ]\n        : [\n            makeVar(fwdEtype, nextLevel),\n            attr.id,\n            makeVar(revEtype, level),\n            wildcard(\"time\"),\n        ];\n    const nextEtype = fwdAttr ? revEtype : fwdEtype;\n    return [nextEtype, nextLevel, attrPat];\n}\nfunction valueAttrPat(makeVar, store, valueEtype, valueLevel, valueLabel, v) {\n    const attr = getAttrByFwdIdentName(store.attrs, valueEtype, valueLabel);\n    if (!attr) {\n        throw new AttrNotFoundError(`No attr for etype = ${valueEtype} label = ${valueLabel} value-label`);\n    }\n    return [makeVar(valueEtype, valueLevel), attr.id, v, wildcard(\"time\")];\n}\nfunction refAttrPats(makeVar, store, etype, level, refsPath) {\n    const [lastEtype, lastLevel, attrPats] = refsPath.reduce((acc, label) => {\n        const [etype, level, attrPats] = acc;\n        const [nextEtype, nextLevel, attrPat] = refAttrPat(makeVar, store, etype, level, label);\n        return [nextEtype, nextLevel, [...attrPats, attrPat]];\n    }, [etype, level, []]);\n    return [lastEtype, lastLevel, attrPats];\n}\nfunction whereCondAttrPats(makeVar, store, etype, level, path, v) {\n    const refsPath = path.slice(0, path.length - 1);\n    const valueLabel = path[path.length - 1];\n    const [lastEtype, lastLevel, refPats] = refAttrPats(makeVar, store, etype, level, refsPath);\n    const valuePat = valueAttrPat(makeVar, store, lastEtype, lastLevel, valueLabel, v);\n    return refPats.concat([valuePat]);\n}\nfunction withJoin(where, join) {\n    return join ? [join].concat(where) : where;\n}\nfunction isOrClauses([k, v]) {\n    return k === \"or\" && Array.isArray(v);\n}\nfunction isAndClauses([k, v]) {\n    return k === \"and\" && Array.isArray(v);\n}\n// Creates a makeVar that will namespace symbols for or clauses\n// to prevent conflicts, except for the base etype\nfunction genMakeVar(baseMakeVar, etype, orIdx) {\n    return (x, lvl) => {\n        if (x == etype) {\n            return baseMakeVar(x, lvl);\n        }\n        return `${baseMakeVar(x, lvl)}-${orIdx}`;\n    };\n}\nfunction parseWhereClauses(makeVar, clauseType /* 'or' | 'and' */, store, etype, level, whereValue) {\n    const patterns = whereValue.map((w, i) => {\n        const makeNamespacedVar = genMakeVar(makeVar, etype, i);\n        return parseWhere(makeNamespacedVar, store, etype, level, w);\n    });\n    const joinSym = makeVar(etype, level);\n    return { [clauseType]: { patterns, joinSym } };\n}\nfunction parseWhere(makeVar, store, etype, level, where) {\n    return Object.entries(where).flatMap(([k, v]) => {\n        if (isOrClauses([k, v])) {\n            return parseWhereClauses(makeVar, \"or\", store, etype, level, v);\n        }\n        if (isAndClauses([k, v])) {\n            return parseWhereClauses(makeVar, \"and\", store, etype, level, v);\n        }\n        const path = k.split(\".\");\n        return whereCondAttrPats(makeVar, store, etype, level, path, v);\n    });\n}\nfunction makeWhere(store, etype, level, where) {\n    const makeVar = makeVarImpl;\n    if (!where) {\n        return defaultWhere(makeVar, store, etype, level);\n    }\n    const parsedWhere = parseWhere(makeVar, store, etype, level, where);\n    return parsedWhere.concat(defaultWhere(makeVar, store, etype, level));\n}\n// Find\n// -----------------\nfunction makeFind(makeVar, etype, level) {\n    return [\n        makeVar(etype, level),\n        makeVar(\"attr\", level),\n        makeVar(\"val\", level),\n        makeVar(\"time\", level),\n    ];\n}\n// extendObjects\n// -----------------\nfunction makeJoin(makeVar, store, etype, level, label, eid) {\n    const [nextEtype, nextLevel, pat] = refAttrPat(makeVar, store, etype, level, label);\n    const actualized = replaceInAttrPat(pat, makeVar(etype, level), eid);\n    return [nextEtype, nextLevel, actualized];\n}\nfunction extendObjects(makeVar, store, { etype, level, form }, objects) {\n    const children = Object.keys(form).filter((c) => c !== \"$\");\n    if (!children.length) {\n        return Object.values(objects);\n    }\n    return Object.entries(objects).map(([eid, parent]) => {\n        const childResults = children.map((label) => {\n            try {\n                const [nextEtype, nextLevel, join] = makeJoin(makeVar, store, etype, level, label, eid);\n                const child = queryOne(store, {\n                    etype: nextEtype,\n                    level: nextLevel,\n                    form: form[label],\n                    join,\n                });\n                return { [label]: child };\n            }\n            catch (e) {\n                if (e instanceof AttrNotFoundError) {\n                    return { [label]: [] };\n                }\n                throw e;\n            }\n        });\n        return childResults.reduce((parent, child) => {\n            return Object.assign(Object.assign({}, parent), child);\n        }, parent);\n    });\n}\n// resolveObjects\n// -----------------\nfunction shouldIgnoreAttr(attrs, id) {\n    const attr = attrs[id];\n    return attr[\"value-type\"] === \"ref\" && attr[\"forward-identity\"][2] !== \"id\";\n}\nfunction cursorCompare(direction, typ) {\n    switch (direction) {\n        case \"asc\":\n            switch (typ) {\n                case \"number\":\n                    return (x, y) => x < y;\n                case \"uuid\":\n                    return (x, y) => uuidCompare(x, y) === -1;\n            }\n        case \"desc\":\n            switch (typ) {\n                case \"number\":\n                    return (x, y) => x > y;\n                case \"uuid\":\n                    return (x, y) => uuidCompare(x, y) === 1;\n            }\n    }\n}\nfunction isBefore(startCursor, direction, [e, a, _v, t]) {\n    return (cursorCompare(direction, \"number\")(t, startCursor[3]) ||\n        (t === startCursor[3] &&\n            cursorCompare(direction, \"uuid\")(e, startCursor[0])));\n}\nfunction runDataloadAndReturnObjects(store, etype, direction, pageInfo, dq) {\n    const startCursor = pageInfo === null || pageInfo === void 0 ? void 0 : pageInfo[\"start-cursor\"];\n    const toRemove = [];\n    const res = datalogQuery(store, dq)\n        .sort((tripleA, tripleB) => {\n        const tsA = tripleA[3];\n        const tsB = tripleB[3];\n        return direction === \"desc\" ? tsB - tsA : tsA - tsB;\n    })\n        .reduce((res, triple) => {\n        const [e, a, v] = triple;\n        if (shouldIgnoreAttr(store.attrs, a)) {\n            return res;\n        }\n        const attr = store.attrs[a];\n        const [_, attrEtype, label] = attr[\"forward-identity\"];\n        if (attrEtype !== etype) {\n            return res;\n        }\n        if (startCursor &&\n            a === startCursor[1] &&\n            isBefore(startCursor, direction, triple)) {\n            toRemove.push(e);\n        }\n        res[e] = res[e] || {};\n        res[e][label] = v;\n        return res;\n    }, {});\n    // remove anything before our start cursor\n    for (const e of toRemove) {\n        delete res[e];\n    }\n    return res;\n}\nfunction determineOrder(form) {\n    var _a;\n    const orderOpts = (_a = form.$) === null || _a === void 0 ? void 0 : _a.order;\n    if (!orderOpts) {\n        return \"asc\";\n    }\n    return orderOpts[Object.keys(orderOpts)[0]] || \"asc\";\n}\n/**\n * Given a query like:\n *\n * {\n *   users: {\n *     $: { where: { name: \"Joe\" } },\n *   },\n * };\n *\n * `resolveObjects`, turns where clause: `{ name: \"Joe\" }`\n * into a datalog query. We then run the datalog query,\n * and reduce all the triples into objects.\n */\nfunction resolveObjects(store, { etype, level, form, join, pageInfo }) {\n    var _a, _b, _c, _d, _e, _g, _h;\n    const limit = ((_a = form.$) === null || _a === void 0 ? void 0 : _a.limit) || ((_b = form.$) === null || _b === void 0 ? void 0 : _b.first) || ((_c = form.$) === null || _c === void 0 ? void 0 : _c.last);\n    const offset = (_d = form.$) === null || _d === void 0 ? void 0 : _d.offset;\n    const before = (_e = form.$) === null || _e === void 0 ? void 0 : _e.before;\n    const after = (_g = form.$) === null || _g === void 0 ? void 0 : _g.after;\n    // Wait for server to tell us where we start if we don't start from the beginning\n    if ((offset || before || after) && (!pageInfo || !pageInfo[\"start-cursor\"])) {\n        return [];\n    }\n    const where = withJoin(makeWhere(store, etype, level, (_h = form.$) === null || _h === void 0 ? void 0 : _h.where), join);\n    const find = makeFind(makeVarImpl, etype, level);\n    const objs = runDataloadAndReturnObjects(store, etype, determineOrder(form), pageInfo, { where, find });\n    if (limit != null) {\n        const entries = Object.entries(objs);\n        if (entries.length <= limit) {\n            return objs;\n        }\n        return Object.fromEntries(entries.slice(0, limit));\n    }\n    return objs;\n}\n/**\n * It's possible that we query\n * for an attribute that doesn't exist yet.\n *\n * { users: { $: { where: { nonExistentProperty: \"foo\" } } } }\n *\n * This swallows the missing attr error and returns\n * an empty result instead\n */\nfunction guardedResolveObjects(store, opts) {\n    try {\n        return resolveObjects(store, opts);\n    }\n    catch (e) {\n        if (e instanceof AttrNotFoundError) {\n            return {};\n        }\n        throw e;\n    }\n}\n/**\n * Given a query like:\n *\n * {\n *   users: {\n *     $: { where: { name: \"Joe\" } },\n *     posts: {},\n *   },\n * };\n *\n * `guardResolveObjects` will return the relevant `users` objects\n * `extendObjects` will then extend each `user` object with relevant `posts`.\n */\nfunction queryOne(store, opts) {\n    const objects = guardedResolveObjects(store, opts);\n    return extendObjects(makeVarImpl, store, opts, objects);\n}\nfunction formatPageInfo(pageInfo) {\n    const res = {};\n    for (const [k, v] of Object.entries(pageInfo)) {\n        res[k] = { startCursor: v[\"start-cursor\"], endCursor: v[\"end-cursor\"] };\n    }\n    return res;\n}\nexport default function query({ store, pageInfo, aggregate }, q) {\n    const data = Object.keys(q).reduce((res, k) => {\n        if (aggregate === null || aggregate === void 0 ? void 0 : aggregate[k]) {\n            // Aggregate doesn't return any join rows and has no children,\n            // so don't bother querying further\n            return res;\n        }\n        res[k] = queryOne(store, {\n            etype: k,\n            form: q[k],\n            level: 0,\n            pageInfo: pageInfo === null || pageInfo === void 0 ? void 0 : pageInfo[k],\n        });\n        return res;\n    }, {});\n    const result = { data };\n    if (pageInfo) {\n        result.pageInfo = formatPageInfo(pageInfo);\n    }\n    if (aggregate) {\n        result.aggregate = aggregate;\n    }\n    return result;\n}\n//# sourceMappingURL=instaql.js.map","function transactionChunk(etype, id, prevOps) {\n    return new Proxy({}, {\n        get: (_target, cmd) => {\n            if (cmd === \"__ops\")\n                return prevOps;\n            return (args) => {\n                return transactionChunk(etype, id, [\n                    ...prevOps,\n                    [cmd, etype, id, args],\n                ]);\n            };\n        },\n    });\n}\n/**\n * Creates a lookup to use in place of an id in a transaction\n *\n * @example\n * tx.users[lookup('email', 'lyndon@example.com')].update({name: 'Lyndon'})\n */\nexport function lookup(attribute, value) {\n    return `lookup__${attribute}__${JSON.stringify(value)}`;\n}\nexport function isLookup(k) {\n    return k.startsWith(\"lookup__\");\n}\nexport function parseLookup(k) {\n    const [_, eid, ...vJSON] = k.split(\"__\");\n    return [eid, JSON.parse(vJSON.join(\"__\"))];\n}\nfunction etypeChunk(etype) {\n    return new Proxy({}, {\n        get(_target, id) {\n            if (isLookup(id)) {\n                return transactionChunk(etype, parseLookup(id), []);\n            }\n            return transactionChunk(etype, id, []);\n        },\n    });\n}\nfunction emptyChunk() {\n    return new Proxy({}, {\n        get(_target, ns) {\n            return etypeChunk(ns);\n        },\n    });\n}\n/**\n * A handy builder for changes.\n *\n * You must start with the `namespace` you want to change:\n *\n * @example\n *   tx.goals[goalId].update({title: \"Get fit\"})\n *   // Note: you don't need to create `goals` ahead of time.\n */\nexport const tx = emptyChunk();\nexport function getOps(x) {\n    return x.__ops;\n}\n//# sourceMappingURL=instatx.js.map","import { getOps, isLookup, parseLookup } from \"./instatx\";\nimport { immutableDeepReplace } from \"./utils/object\";\nimport uuid from \"./utils/uuid\";\nexport function getAttrByFwdIdentName(attrs, inputEtype, inputIdentName) {\n    return Object.values(attrs).find((attr) => {\n        const [_id, etype, label] = attr[\"forward-identity\"];\n        return etype === inputEtype && label === inputIdentName;\n    });\n}\nexport function getAttrByReverseIdentName(attrs, inputEtype, inputIdentName) {\n    return Object.values(attrs).find((attr) => {\n        const revIdent = attr[\"reverse-identity\"];\n        if (!revIdent)\n            return false;\n        const [_id, etype, label] = revIdent;\n        return etype === inputEtype && label === inputIdentName;\n    });\n}\nfunction explodeLookupRef(eid) {\n    if (Array.isArray(eid)) {\n        return eid;\n    }\n    const entries = Object.entries(eid);\n    if (entries.length !== 1) {\n        throw new Error(\"lookup must be an object with a single unique attr and value.\");\n    }\n    return entries[0];\n}\nfunction extractLookup(attrs, etype, eid) {\n    if (typeof eid === \"string\" && !isLookup(eid)) {\n        return eid;\n    }\n    const [identName, value] = typeof eid === \"string\" && isLookup(eid)\n        ? parseLookup(eid)\n        : explodeLookupRef(eid);\n    const attr = getAttrByFwdIdentName(attrs, etype, identName);\n    if (!attr || !attr[\"unique?\"]) {\n        throw new Error(`${identName} is not a unique attribute.`);\n    }\n    return [attr.id, value];\n}\nfunction expandLink(attrs, [etype, eidA, obj]) {\n    const addTriples = Object.entries(obj).flatMap(([label, eidOrEids]) => {\n        const eids = Array.isArray(eidOrEids) ? eidOrEids : [eidOrEids];\n        const fwdAttr = getAttrByFwdIdentName(attrs, etype, label);\n        const revAttr = getAttrByReverseIdentName(attrs, etype, label);\n        return eids.map((eidB) => {\n            const txStep = fwdAttr\n                ? [\n                    \"add-triple\",\n                    extractLookup(attrs, etype, eidA),\n                    fwdAttr.id,\n                    extractLookup(attrs, fwdAttr[\"reverse-identity\"][1], eidB),\n                ]\n                : [\n                    \"add-triple\",\n                    extractLookup(attrs, revAttr[\"forward-identity\"][1], eidB),\n                    revAttr.id,\n                    extractLookup(attrs, etype, eidA),\n                ];\n            return txStep;\n        });\n    });\n    return addTriples;\n}\nfunction expandUnlink(attrs, [etype, eidA, obj]) {\n    const retractTriples = Object.entries(obj).flatMap(([label, eidOrEids]) => {\n        const eids = Array.isArray(eidOrEids) ? eidOrEids : [eidOrEids];\n        const fwdAttr = getAttrByFwdIdentName(attrs, etype, label);\n        const revAttr = getAttrByReverseIdentName(attrs, etype, label);\n        return eids.map((eidB) => {\n            const txStep = fwdAttr\n                ? [\n                    \"retract-triple\",\n                    extractLookup(attrs, etype, eidA),\n                    fwdAttr.id,\n                    extractLookup(attrs, fwdAttr[\"reverse-identity\"][1], eidB),\n                ]\n                : [\n                    \"retract-triple\",\n                    extractLookup(attrs, revAttr[\"forward-identity\"][1], eidB),\n                    revAttr.id,\n                    extractLookup(attrs, etype, eidA),\n                ];\n            return txStep;\n        });\n    });\n    return retractTriples;\n}\nfunction expandUpdate(attrs, [etype, eid, obj]) {\n    const lookup = extractLookup(attrs, etype, eid);\n    const attrTuples = Object.entries(obj)\n        .concat([[\"id\", extractLookup(attrs, etype, eid)]])\n        .map(([identName, value]) => {\n        const attr = getAttrByFwdIdentName(attrs, etype, identName);\n        return [\"add-triple\", lookup, attr.id, value];\n    });\n    return attrTuples;\n}\nfunction expandDelete(attrs, [etype, eid]) {\n    const lookup = extractLookup(attrs, etype, eid);\n    return [[\"delete-entity\", lookup]];\n}\nfunction expandDeepMerge(attrs, [etype, eid, obj]) {\n    const lookup = extractLookup(attrs, etype, eid);\n    const attrTuples = Object.entries(obj).map(([identName, value]) => {\n        const attr = getAttrByFwdIdentName(attrs, etype, identName);\n        const coercedValue = immutableDeepReplace(value, undefined, null);\n        return [\"deep-merge-triple\", lookup, attr.id, coercedValue];\n    });\n    const idTuple = [\n        \"add-triple\",\n        lookup,\n        getAttrByFwdIdentName(attrs, etype, \"id\").id,\n        lookup,\n    ];\n    return attrTuples.concat([idTuple]);\n}\nfunction toTxSteps(attrs, [action, ...args]) {\n    switch (action) {\n        case \"merge\":\n            return expandDeepMerge(attrs, args);\n        case \"update\":\n            return expandUpdate(attrs, args);\n        case \"link\":\n            return expandLink(attrs, args);\n        case \"unlink\":\n            return expandUnlink(attrs, args);\n        case \"delete\":\n            return expandDelete(attrs, args);\n        default:\n            throw new Error(`unsupported action ${action}`);\n    }\n}\n// ---------\n// transform\nfunction extractIdents([_action, etype, _eid, obj]) {\n    const ks = new Set(Object.keys(obj).concat(\"id\"));\n    const idents = [...ks].map((label) => [etype, label]);\n    return idents;\n}\nfunction createObjectAttr([etype, label]) {\n    const attrId = uuid();\n    const fwdIdentId = uuid();\n    const fwdIdent = [fwdIdentId, etype, label];\n    return {\n        id: attrId,\n        \"forward-identity\": fwdIdent,\n        \"value-type\": \"blob\",\n        cardinality: \"one\",\n        \"unique?\": false,\n        \"index?\": false,\n    };\n}\nfunction createRefAttr([etype, label]) {\n    const attrId = uuid();\n    const fwdIdentId = uuid();\n    const revIdentId = uuid();\n    const fwdIdent = [fwdIdentId, etype, label];\n    const revIdent = [revIdentId, label, etype];\n    return {\n        id: attrId,\n        \"forward-identity\": fwdIdent,\n        \"reverse-identity\": revIdent,\n        \"value-type\": \"ref\",\n        cardinality: \"many\",\n        \"unique?\": false,\n        \"index?\": false,\n    };\n}\nfunction uniqueIdents(idents) {\n    const seen = new Set();\n    const acc = [];\n    idents.forEach((ident) => {\n        const [etype, label] = ident;\n        const key = `${etype}:${label}`;\n        if (!seen.has(key)) {\n            seen.add(key);\n            acc.push(ident);\n        }\n    });\n    return acc;\n}\nfunction createMissingObjectAttrs(attrs, ops) {\n    const objectOps = ops.filter(([action]) => action === \"update\" || action === \"merge\");\n    const objectIdents = uniqueIdents(objectOps.flatMap(extractIdents));\n    const missingIdents = objectIdents.filter(([etype, label]) => !getAttrByFwdIdentName(attrs, etype, label));\n    const objectAttrs = missingIdents.map(createObjectAttr);\n    const newAttrs = objectAttrs.reduce((acc, attr) => {\n        acc[attr.id] = attr;\n        return acc;\n    }, Object.assign({}, attrs));\n    const attrTxSteps = objectAttrs.map((attr) => [\"add-attr\", attr]);\n    return [newAttrs, attrTxSteps];\n}\nfunction createMissingRefAttrs(attrs, ops) {\n    const objectOps = ops.filter(([action]) => action === \"link\" || action === \"unlink\");\n    const objectIdents = uniqueIdents(objectOps.flatMap(extractIdents));\n    const missingIdents = objectIdents.filter(([etype, label]) => !getAttrByFwdIdentName(attrs, etype, label) &&\n        !getAttrByReverseIdentName(attrs, etype, label));\n    const refAttrs = missingIdents.map(createRefAttr);\n    const newAttrs = refAttrs.reduce((acc, attr) => {\n        acc[attr.id] = attr;\n        return acc;\n    }, Object.assign({}, attrs));\n    const attrTxSteps = refAttrs.map((attr) => [\"add-attr\", attr]);\n    return [newAttrs, attrTxSteps];\n}\nexport function transform(attrs, inputChunks) {\n    const chunks = Array.isArray(inputChunks) ? inputChunks : [inputChunks];\n    const ops = chunks.flatMap((tx) => getOps(tx));\n    const [withNewObjAttrs, addObjAttrTxSteps] = createMissingObjectAttrs(attrs, ops);\n    const [withNewRefAttrs, addRefAttrTxSteps] = createMissingRefAttrs(withNewObjAttrs, ops);\n    const txSteps = ops.flatMap((op) => toTxSteps(withNewRefAttrs, op));\n    return [...addObjAttrTxSteps, ...addRefAttrTxSteps, ...txSteps];\n}\n//# sourceMappingURL=instaml.js.map","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nexport default class IndexedDBStorage {\n    constructor(dbName) {\n        this.dbName = dbName;\n        this._storeName = \"kv\";\n        this._dbPromise = this._init();\n    }\n    _init() {\n        return new Promise((resolve, reject) => {\n            const request = indexedDB.open(this.dbName, 1);\n            request.onerror = (event) => {\n                reject(event);\n            };\n            request.onsuccess = (event) => {\n                resolve(event.target.result);\n            };\n            request.onupgradeneeded = (event) => {\n                const db = event.target.result;\n                db.createObjectStore(this._storeName);\n            };\n        });\n    }\n    getItem(k) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const db = yield this._dbPromise;\n            return new Promise((resolve, reject) => {\n                const transaction = db.transaction([this._storeName], \"readonly\");\n                const objectStore = transaction.objectStore(this._storeName);\n                const request = objectStore.get(k);\n                request.onerror = (event) => {\n                    reject(event);\n                };\n                request.onsuccess = (_event) => {\n                    if (request.result) {\n                        resolve(request.result);\n                    }\n                    else {\n                        resolve(null);\n                    }\n                };\n            });\n        });\n    }\n    setItem(k, v) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const db = yield this._dbPromise;\n            return new Promise((resolve, reject) => {\n                const transaction = db.transaction([this._storeName], \"readwrite\");\n                const objectStore = transaction.objectStore(this._storeName);\n                const request = objectStore.put(v, k);\n                request.onerror = (event) => {\n                    reject(event);\n                };\n                request.onsuccess = (_event) => {\n                    resolve();\n                };\n            });\n        });\n    }\n}\n//# sourceMappingURL=IndexedDBStorage.js.map","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nexport default class WindowNetworkListener {\n    static getIsOnline() {\n        return __awaiter(this, void 0, void 0, function* () {\n            return window.navigator.onLine;\n        });\n    }\n    static listen(f) {\n        const onOnline = () => {\n            f(true);\n        };\n        const onOffline = () => {\n            f(false);\n        };\n        window.addEventListener(\"online\", onOnline);\n        window.addEventListener(\"offline\", onOffline);\n        return () => {\n            window.removeEventListener(\"online\", onOnline);\n            window.removeEventListener(\"offline\", onOffline);\n        };\n    }\n}\n//# sourceMappingURL=WindowNetworkListener.js.map","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nexport function jsonFetch(input, init) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const res = yield fetch(input, init);\n        const json = yield res.json();\n        return res.status === 200\n            ? Promise.resolve(json)\n            : Promise.reject({ status: res.status, body: json });\n    });\n}\n//# sourceMappingURL=fetch.js.map","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { jsonFetch } from \"./utils/fetch\";\nexport function sendMagicCode({ apiURI, appId, email }) {\n    return jsonFetch(`${apiURI}/runtime/auth/send_magic_code`, {\n        method: \"POST\",\n        headers: { \"content-type\": \"application/json\" },\n        body: JSON.stringify({ \"app-id\": appId, email }),\n    });\n}\nexport function verifyMagicCode(_a) {\n    return __awaiter(this, arguments, void 0, function* ({ apiURI, appId, email, code }) {\n        const res = yield jsonFetch(`${apiURI}/runtime/auth/verify_magic_code`, {\n            method: \"POST\",\n            headers: { \"content-type\": \"application/json\" },\n            body: JSON.stringify({ \"app-id\": appId, email, code }),\n        });\n        return res;\n    });\n}\nexport function verifyRefreshToken(_a) {\n    return __awaiter(this, arguments, void 0, function* ({ apiURI, appId, refreshToken }) {\n        const res = yield jsonFetch(`${apiURI}/runtime/auth/verify_refresh_token`, {\n            method: \"POST\",\n            headers: { \"content-type\": \"application/json\" },\n            body: JSON.stringify({\n                \"app-id\": appId,\n                \"refresh-token\": refreshToken,\n            }),\n        });\n        return res;\n    });\n}\n/**\n * @param {Object} params\n * @param {string} params.apiURI\n * @param {string} params.appId\n * @param {string} params.code\n * @param {string | null | undefined} [params.codeVerifier]\n */\nexport function exchangeCodeForToken(_a) {\n    return __awaiter(this, arguments, void 0, function* ({ apiURI, appId, code, codeVerifier, }) {\n        const res = yield jsonFetch(`${apiURI}/runtime/oauth/token`, {\n            method: \"POST\",\n            headers: { \"content-type\": \"application/json\" },\n            body: JSON.stringify({\n                app_id: appId,\n                code: code,\n                code_verifier: codeVerifier,\n            }),\n        });\n        return res;\n    });\n}\n/**\n * @param {Object} params\n * @param {string} params.apiURI\n * @param {string} params.appId\n * @param {string} params.clientName\n * @param {string} params.idToken\n * @param {string | null | undefined} [params.nonce]\n */\nexport function signInWithIdToken(_a) {\n    return __awaiter(this, arguments, void 0, function* ({ apiURI, appId, nonce, idToken, clientName, }) {\n        const res = yield jsonFetch(`${apiURI}/runtime/oauth/id_token`, {\n            method: \"POST\",\n            headers: { \"content-type\": \"application/json\" },\n            body: JSON.stringify({\n                app_id: appId,\n                nonce,\n                id_token: idToken,\n                client_name: clientName,\n            }),\n        });\n        return res;\n    });\n}\n//# sourceMappingURL=authAPI.js.map","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { jsonFetch } from \"./utils/fetch\";\nexport function getSignedUploadUrl(_a) {\n    return __awaiter(this, arguments, void 0, function* ({ apiURI, appId, fileName, refreshToken, metadata = {}, }) {\n        const { data } = yield jsonFetch(`${apiURI}/storage/signed-upload-url`, {\n            method: \"POST\",\n            headers: {\n                \"content-type\": \"application/json\",\n                authorization: `Bearer ${refreshToken}`,\n            },\n            body: JSON.stringify({\n                app_id: appId,\n                filename: fileName,\n            }),\n        });\n        return data;\n    });\n}\nexport function upload(presignedUrl, file) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const response = yield fetch(presignedUrl, {\n            method: \"PUT\",\n            body: file,\n            headers: {\n                \"Content-Type\": file.type,\n            },\n        });\n        return response.ok;\n    });\n}\nexport function getDownloadUrl(_a) {\n    return __awaiter(this, arguments, void 0, function* ({ apiURI, appId, path, refreshToken, }) {\n        const { data } = yield jsonFetch(`${apiURI}/storage/signed-download-url?app_id=${appId}&filename=${path}`, {\n            method: \"GET\",\n            headers: {\n                \"content-type\": \"application/json\",\n                authorization: `Bearer ${refreshToken}`,\n            },\n        });\n        return data;\n    });\n}\n//# sourceMappingURL=StorageAPI.js.map","export function pick(obj, keys) {\n    if (!keys)\n        return obj;\n    const ret = {};\n    keys.forEach((key) => {\n        ret[key] = obj[key];\n    });\n    return ret;\n}\n//# sourceMappingURL=pick.js.map","import { pick } from \"./utils/pick\";\nimport { areObjectsShallowEqual, areObjectKeysEqual } from \"./utils/object\";\nexport function buildPresenceSlice(data, opts) {\n    var _a, _b;\n    const slice = {\n        peers: {},\n    };\n    const includeUser = opts && \"user\" in opts ? opts.user : true;\n    if (includeUser) {\n        const user = pick((_a = data.user) !== null && _a !== void 0 ? _a : {}, opts === null || opts === void 0 ? void 0 : opts.keys);\n        slice.user = user;\n    }\n    for (const id of Object.keys((_b = data.peers) !== null && _b !== void 0 ? _b : {})) {\n        const shouldIncludeAllPeers = (opts === null || opts === void 0 ? void 0 : opts.peers) === undefined;\n        const isPeerIncluded = Array.isArray(opts === null || opts === void 0 ? void 0 : opts.peers) && (opts === null || opts === void 0 ? void 0 : opts.peers.includes(id));\n        if (shouldIncludeAllPeers || isPeerIncluded) {\n            const peer = pick(data.peers[id], opts === null || opts === void 0 ? void 0 : opts.keys);\n            slice.peers[id] = peer;\n        }\n    }\n    return slice;\n}\n/**\n * Compare two presence slices\n * 0. compare isLoading and error\n * 1. shallow compare user\n * 2. compare peers keys\n * 3. shallow compare each peer\n */\nexport function hasPresenceResponseChanged(a, b) {\n    if (a.isLoading !== b.isLoading)\n        return true;\n    if (a.error !== b.error)\n        return true;\n    if (a.user || b.user) {\n        if (!a.user || !b.user)\n            return true;\n        const same = areObjectsShallowEqual(a.user, b.user);\n        if (!same)\n            return true;\n    }\n    const sameKeys = areObjectKeysEqual(a.peers, b.peers);\n    if (!sameKeys)\n        return true;\n    for (const id of Object.keys(a.peers)) {\n        const same = areObjectsShallowEqual(a.peers[id], b.peers[id]);\n        if (!same)\n            return true;\n    }\n    return false;\n}\n//# sourceMappingURL=presence.js.map","export class Deferred {\n    constructor() {\n        this.promise = new Promise((resolve, reject) => {\n            this._resolve = resolve;\n            this._reject = reject;\n        });\n    }\n    resolve(value) {\n        this._resolve(value);\n    }\n    reject(reason) {\n        this._reject(reason);\n    }\n}\n//# sourceMappingURL=Deferred.js.map","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\n// PersistedObjects save data outside of memory\n// When we load a persisted object, it's possible we call `set`\n// before we finish loading. To address we handle set in two ways:\n//\n// 1. Before load\n// We simply update currentValue in memory\n//\n// 2. After load\n// We update currentValue in memory and in storage\n//\n// Each PersistedObject provides it's own `onMerge`\n// function to handle the merge of data from storage and memory\n// on load\nexport class PersistedObject {\n    constructor(persister, key, defaultValue, onMerge, toJSON = (x) => {\n        return JSON.stringify(x);\n    }, fromJSON = (x) => {\n        return JSON.parse(x);\n    }) {\n        this._persister = persister;\n        this._key = key;\n        // Consumers don't await and can directly access `currentValue`\n        // before the data is loaded from storage. We address this by providing\n        // a _onMerge that coalesces the data\n        // (XXX): This is a bit sketch, when a users gets `currentValue` it's opaque\n        // whether this is a fully loaded value or a partial loaded value. We want\n        // consumers to have the fully view w/o literring our code with `await`\n        this._onMerge = onMerge;\n        this._loadedCbs = [];\n        this._isLoading = true;\n        this.currentValue = defaultValue;\n        this.toJSON = toJSON;\n        this.fromJSON = fromJSON;\n        this._load();\n    }\n    _load() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const fromStorage = this.fromJSON(yield this._persister.getItem(this._key));\n            this._isLoading = false;\n            this._onMerge(fromStorage, this.currentValue);\n            for (const cb of this._loadedCbs) {\n                cb();\n            }\n        });\n    }\n    waitForLoaded() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this._isLoading) {\n                return;\n            }\n            const loadedPromise = new Promise((resolve) => {\n                this._loadedCbs.push(resolve);\n            });\n            yield loadedPromise;\n        });\n    }\n    set(f, cb) {\n        this.currentValue = f(this.currentValue);\n        if (!this._isLoading) {\n            // (XXX): This could fail, we should handle this\n            setTimeout(() => {\n                this._persister.setItem(this._key, this.toJSON(this.currentValue));\n                if (cb) {\n                    cb();\n                }\n            }, 0);\n        }\n    }\n}\n//# sourceMappingURL=PersistedObject.js.map","function _extractTriplesHelper(idNodes, acc = []) {\n    idNodes.forEach((idNode) => {\n        const { data } = idNode;\n        const { \"datalog-result\": datalogResult } = data;\n        const { \"join-rows\": joinRows } = datalogResult;\n        for (const rows of joinRows) {\n            for (const triple of rows) {\n                acc.push(triple);\n            }\n        }\n        _extractTriplesHelper(idNode[\"child-nodes\"], acc);\n    });\n}\n/**\n * Marshall instaql-result into list of triples. Instaql-result may have\n * multiple datalog-results, each datalog-result may have multiple join-rows\n * and each join-row may have triples.The union of these triples may have\n * duplicates, so we dedup them.\n */\nexport function extractTriples(idNodes) {\n    const triples = [];\n    _extractTriplesHelper(idNodes, triples);\n    return triples;\n}\n//# sourceMappingURL=instaqlResult.js.map","/*\n  Stores maps in JSON as custom objects with key __type = 'm'\n  used to identify them as maps.\n  Stores values as an array of entries. If we tried to use an\n  object instead, all of our keys would be converted to strings.\n */\nfunction jsonReplacer(_k, value) {\n    if (value instanceof Map) {\n        return {\n            __type: \"m\",\n            entries: [...value.entries()],\n        };\n    }\n    return value;\n}\nfunction jsonReviver(_k, value) {\n    if (value && typeof value === \"object\" && value.__type === \"m\") {\n        return new Map(value.entries);\n    }\n    return value;\n}\n/*\n  Converts data that might contain Map values to JSON.\n  Data should be converted back from json with fromJSONWithMaps\n*/\nexport function toJSONWithMaps(x) {\n    return JSON.stringify(x, jsonReplacer);\n}\n/*\n  Parses JSON that was formatted with toJSONWithMaps\n*/\nexport function fromJSONWithMaps(s) {\n    return JSON.parse(s, jsonReviver);\n}\n//# sourceMappingURL=json.js.map","// @ts-check\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport log from \"./utils/log\";\nimport weakHash from \"./utils/weakHash\";\nimport instaql from \"./instaql\";\nimport * as instaml from \"./instaml\";\nimport * as s from \"./store\";\nimport uuid from \"./utils/uuid\";\nimport IndexedDBStorage from \"./IndexedDBStorage\";\nimport WindowNetworkListener from \"./WindowNetworkListener\";\nimport * as authAPI from \"./authAPI\";\nimport * as StorageApi from \"./StorageAPI\";\nimport { buildPresenceSlice, hasPresenceResponseChanged } from \"./presence\";\nimport { Deferred } from \"./utils/Deferred\";\nimport { PersistedObject } from \"./utils/PersistedObject\";\nimport { extractTriples } from \"./model/instaqlResult\";\nimport { areObjectsDeepEqual } from \"./utils/object\";\nimport { fromJSONWithMaps, toJSONWithMaps } from \"./utils/json\";\nconst STATUS = {\n    CONNECTING: \"connecting\",\n    OPENED: \"opened\",\n    AUTHENTICATED: \"authenticated\",\n    CLOSED: \"closed\",\n    ERRORED: \"errored\",\n};\nconst WS_OPEN_STATUS = 1;\nconst defaultConfig = {\n    apiURI: \"https://api.instantdb.com\",\n    websocketURI: \"wss://api.instantdb.com/runtime/session\",\n};\n// Param that the backend adds if this is an oauth redirect\nconst OAUTH_REDIRECT_PARAM = \"_instant_oauth_redirect\";\nconst currentUserKey = `currentUser`;\n/**\n * @template {import('./presence').RoomSchemaShape} [RoomSchema = {}]\n */\nexport default class Reactor {\n    constructor(config, Storage = IndexedDBStorage, NetworkListener = WindowNetworkListener) {\n        this._isOnline = true;\n        this._isShutdown = false;\n        this.status = STATUS.CONNECTING;\n        this.queryCbs = {};\n        this.authCbs = [];\n        this.attrsCbs = [];\n        this.mutationErrorCbs = [];\n        this.mutationDeferredStore = new Map();\n        this._reconnectTimeoutId = null;\n        this._reconnectTimeoutMs = 0;\n        this._localIdPromises = {};\n        this._errorMessage = null;\n        /** @type {Promise<null | {error: {message: string}}>}**/\n        this._oauthCallbackResponse = null;\n        // (XXX-EPH): Keeping track of roomId -> { result, cbs } here\n        this._presence = {};\n        this._broadcastSubs = {};\n        /**\n         *  merge querySubs from storage and in memory. Has the following side\n         *  effects:\n         *  - We notify all queryCbs because results may been added during merge\n         */\n        this._onMergeQuerySubs = (_storageSubs, inMemorySubs) => {\n            const storageSubs = _storageSubs || {};\n            const ret = Object.assign({}, inMemorySubs);\n            // Consider an inMemorySub with no result;\n            // If we have a result from storageSubs, let's add it\n            Object.entries(inMemorySubs).forEach(([hash, querySub]) => {\n                var _a;\n                const storageResult = (_a = storageSubs === null || storageSubs === void 0 ? void 0 : storageSubs[hash]) === null || _a === void 0 ? void 0 : _a.result;\n                const memoryResult = querySub.result;\n                if (storageResult && !memoryResult) {\n                    ret[hash].result = storageResult;\n                }\n            });\n            // Consider a storageSub with no corresponding inMemorySub\n            // This means that at least at this point,\n            // the user has not asked to subscribe to the query.\n            // We may _still_ want to add it, because in just a\n            // few milliseconds, the user will ask to subscribe to the\n            // query.\n            // For now, we can't really tell if the user will ask to subscribe\n            // or not. So for now let's just add the first 10 queries from storage.\n            // Eventually, we could be smarter about this. For example,\n            // we can keep usage information about which queries are popular.\n            const storageKsToAdd = Object.keys(storageSubs)\n                .filter((k) => !inMemorySubs[k])\n                .slice(0, 10);\n            storageKsToAdd.forEach((k) => {\n                ret[k] = storageSubs[k];\n            });\n            // Okay, now we have merged our querySubs\n            this.querySubs.set((_) => ret);\n            this.notifyAll();\n        };\n        /**\n         * merge pendingMutations from storage and in memory. Has a side effect of\n         * sending mutations that were stored but not acked\n         */\n        this._onMergePendingMutations = (storageMuts, inMemoryMuts) => {\n            const ret = new Map([...storageMuts.entries(), ...inMemoryMuts.entries()]);\n            this.pendingMutations.set((_) => ret);\n            const rewrittenStorageMuts = this._rewriteMutations(this.attrs, storageMuts);\n            rewrittenStorageMuts.forEach((mut, k) => {\n                if (!inMemoryMuts.has(k) && !mut[\"tx-id\"]) {\n                    this._sendMutation(k, mut);\n                }\n            });\n        };\n        /** Re-run instaql and call all callbacks with new data */\n        this.notifyOne = (hash) => {\n            const cbs = this.queryCbs[hash] || [];\n            if (!cbs)\n                return;\n            const errorMessage = this._errorMessage;\n            if (errorMessage) {\n                cbs.forEach((cb) => cb({ error: errorMessage }));\n                return;\n            }\n            const { q, result, iqlResult } = this.querySubs.currentValue[hash] || {};\n            if (!result)\n                return; // No store data, no need to notify\n            const resp = this.dataForResult(q, result);\n            if (areObjectsDeepEqual(resp.data, iqlResult))\n                return; // No change, no need to notify\n            this.querySubs.currentValue[hash].iqlResult = result.data;\n            cbs.forEach((cb) => cb(resp));\n        };\n        this.notifyQueryError = (hash, msg) => {\n            const cbs = this.queryCbs[hash] || [];\n            cbs.forEach((cb) => cb({ error: msg }));\n        };\n        /** Applies transactions locally and sends transact message to server */\n        this.pushTx = (chunks) => {\n            const txSteps = instaml.transform(this.optimisticAttrs(), chunks);\n            return this.pushOps(txSteps);\n        };\n        this.pushOps = (txSteps) => {\n            const eventId = uuid();\n            const mutation = {\n                op: \"transact\",\n                \"tx-steps\": txSteps,\n            };\n            this.pendingMutations.set((prev) => {\n                prev.set(eventId, mutation);\n                return prev;\n            });\n            const dfd = new Deferred();\n            this.mutationDeferredStore.set(eventId, dfd);\n            this._sendMutation(eventId, mutation);\n            this.notifyAll();\n            return dfd.promise;\n        };\n        this._wsOnOpen = () => {\n            log.info(\"[socket] connected\");\n            this._setStatus(STATUS.OPENED);\n            this.getCurrentUser().then((resp) => {\n                var _a;\n                this._trySend(uuid(), {\n                    op: \"init\",\n                    \"app-id\": this.config.appId,\n                    \"refresh-token\": (_a = resp.user) === null || _a === void 0 ? void 0 : _a[\"refresh_token\"],\n                    // If an admin token is provided for an app, we will\n                    // skip all permission checks. This is an advanced feature,\n                    // to let users write internal tools\n                    // This option is not exposed in `Config`, as it's\n                    // not ready for prme time\n                    \"__admin-token\": this.config.__adminToken,\n                });\n            });\n        };\n        this._wsOnMessage = (e) => {\n            this._handleReceive(JSON.parse(e.data.toString()));\n        };\n        this._wsOnError = (e) => {\n            log.error(\"[socket] error: \", e);\n        };\n        this._wsOnClose = () => {\n            this._setStatus(STATUS.CLOSED);\n            if (this._isShutdown) {\n                log.info(\"[socket-close] socket has been shut down and will not reconnect\");\n                return;\n            }\n            log.info(\"[socket-close] scheduling reconnect\", this._reconnectTimeoutMs);\n            setTimeout(() => {\n                this._reconnectTimeoutMs = Math.min(this._reconnectTimeoutMs + 1000, 10000);\n                if (!this._isOnline) {\n                    log.info(\"[socket-close] we are offline, no need to start socket\");\n                    return;\n                }\n                this._startSocket();\n            }, this._reconnectTimeoutMs);\n        };\n        this.config = Object.assign(Object.assign({}, defaultConfig), config);\n        // This is to protect us against running\n        // server-side.\n        // Incidentally, window is defined in react-native\n        // so this check won't pass, giving us the behavior\n        // we want. It would be nicer if we had a better\n        // check for server-side.\n        if (typeof window === \"undefined\") {\n            return;\n        }\n        if (\"BroadcastChannel\" in window &&\n            typeof BroadcastChannel === \"function\") {\n            this._broadcastChannel = new BroadcastChannel(\"@instantdb\");\n            this._broadcastChannel.addEventListener(\"message\", (e) => __awaiter(this, void 0, void 0, function* () {\n                var _a;\n                if (((_a = e.data) === null || _a === void 0 ? void 0 : _a.type) === \"auth\") {\n                    const res = yield this.getCurrentUser();\n                    this.updateUser(res.user);\n                }\n            }));\n        }\n        this._oauthCallbackResponse = this._oauthLoginInit();\n        this._initStorage(Storage);\n        NetworkListener.getIsOnline().then((isOnline) => {\n            this._isOnline = isOnline;\n            this._startSocket();\n            NetworkListener.listen((isOnline) => {\n                // We do this because react native's NetInfo\n                // fires multiple online events.\n                // We only want to handle one state change\n                if (isOnline === this._isOnline) {\n                    return;\n                }\n                this._isOnline = isOnline;\n                if (this._isOnline) {\n                    this._startSocket();\n                }\n            });\n        });\n    }\n    _initStorage(Storage) {\n        this._persister = new Storage(`instant_${this.config.appId}_4`);\n        this.querySubs = new PersistedObject(this._persister, \"querySubs\", {}, this._onMergeQuerySubs, toJSONWithMaps, fromJSONWithMaps);\n        this.pendingMutations = new PersistedObject(this._persister, \"pendingMutations\", new Map(), this._onMergePendingMutations, (x) => {\n            return JSON.stringify([...x.entries()]);\n        }, (x) => {\n            return new Map(JSON.parse(x));\n        });\n    }\n    _finishTransaction(ok, status, clientId, errDetails) {\n        const dfd = this.mutationDeferredStore.get(clientId);\n        this.mutationDeferredStore.delete(clientId);\n        if (!dfd && !ok) {\n            // console.erroring here, as there are no listeners to let know\n            console.error(\"Mutation failed\", Object.assign({ status, clientId }, errDetails));\n        }\n        if (!dfd) {\n            return;\n        }\n        if (ok) {\n            dfd.resolve({ status, clientId });\n        }\n        else {\n            dfd.reject(Object.assign({ status, clientId }, errDetails));\n        }\n    }\n    _setStatus(status, err) {\n        this.status = status;\n        this._errorMessage = err;\n    }\n    /**\n     * On refresh we clear out pending mutations that we know have been applied\n     * by the server and thus those mutations are applied in the instaql result\n     * returned by the server\n     */\n    _cleanPendingMutations(txId) {\n        this.pendingMutations.set((prev) => {\n            const copy = new Map(prev);\n            [...prev.entries()].forEach(([eventId, mut]) => {\n                if (mut[\"tx-id\"] <= txId) {\n                    copy.delete(eventId);\n                }\n            });\n            return copy;\n        });\n    }\n    _handleReceive(msg) {\n        var _a, _b, _c, _d;\n        switch (msg.op) {\n            case \"init-ok\":\n                this._setStatus(STATUS.AUTHENTICATED);\n                this._reconnectTimeoutMs = 0;\n                this._setAttrs(msg.attrs);\n                this._flushPendingMessages();\n                // (EPH): set session-id, so we know\n                // which item is us\n                this._sessionId = msg[\"session-id\"];\n                break;\n            case \"add-query-ok\":\n                const { q, result, \"processed-tx-id\": addQueryTxId } = msg;\n                this._cleanPendingMutations(addQueryTxId);\n                const hash = weakHash(q);\n                const pageInfo = (_b = (_a = result === null || result === void 0 ? void 0 : result[0]) === null || _a === void 0 ? void 0 : _a.data) === null || _b === void 0 ? void 0 : _b[\"page-info\"];\n                const aggregate = (_d = (_c = result === null || result === void 0 ? void 0 : result[0]) === null || _c === void 0 ? void 0 : _c.data) === null || _d === void 0 ? void 0 : _d[\"aggregate\"];\n                const triples = extractTriples(result);\n                const store = s.createStore(this.attrs, triples);\n                this.querySubs.set((prev) => {\n                    prev[hash].result = { store, pageInfo, aggregate };\n                    return prev;\n                });\n                this.notifyOne(hash);\n                break;\n            case \"refresh-ok\":\n                const { computations, attrs, \"processed-tx-id\": refreshOkTxId } = msg;\n                this._cleanPendingMutations(refreshOkTxId);\n                this._setAttrs(attrs);\n                const updates = computations.map((x) => {\n                    var _a, _b, _c, _d;\n                    const q = x[\"instaql-query\"];\n                    const result = x[\"instaql-result\"];\n                    const hash = weakHash(q);\n                    const triples = extractTriples(result);\n                    const store = s.createStore(this.attrs, triples);\n                    const pageInfo = (_b = (_a = result === null || result === void 0 ? void 0 : result[0]) === null || _a === void 0 ? void 0 : _a.data) === null || _b === void 0 ? void 0 : _b[\"page-info\"];\n                    const aggregate = (_d = (_c = result === null || result === void 0 ? void 0 : result[0]) === null || _c === void 0 ? void 0 : _c.data) === null || _d === void 0 ? void 0 : _d[\"aggregate\"];\n                    return { hash, store, pageInfo, aggregate };\n                });\n                updates.forEach(({ hash, store, pageInfo, aggregate }) => {\n                    this.querySubs.set((prev) => {\n                        prev[hash].result = { store, pageInfo, aggregate };\n                        return prev;\n                    });\n                });\n                updates.forEach(({ hash }) => {\n                    this.notifyOne(hash);\n                });\n                break;\n            case \"transact-ok\":\n                const { \"client-event-id\": eventId, \"tx-id\": txId } = msg;\n                const muts = this._rewriteMutations(this.attrs, this.pendingMutations.currentValue);\n                const prevMutation = muts.get(eventId);\n                if (!prevMutation) {\n                    break;\n                }\n                const mut = Object.assign(Object.assign({}, prevMutation), { \"tx-id\": txId });\n                this.pendingMutations.set((prev) => {\n                    prev.set(eventId, mut);\n                    return prev;\n                });\n                this._finishTransaction(true, \"synced\", eventId);\n                const newAttrs = prevMutation[\"tx-steps\"]\n                    .filter(([action, ..._args]) => action === \"add-attr\")\n                    .map(([_action, attr]) => attr)\n                    .concat(Object.values(this.attrs));\n                this._setAttrs(newAttrs);\n                break;\n            case \"refresh-presence\":\n                const roomId = msg[\"room-id\"];\n                this._setPresencePeers(roomId, msg.data);\n                this._notifyPresenceSubs(roomId);\n                break;\n            case \"server-broadcast\":\n                // (XXX-EPH): TODO: Include peer id in msg and call cb with the associated peer's presence\n                const room = msg[\"room-id\"];\n                const topic = msg.topic;\n                this._notifyBroadcastSubs(room, topic, msg);\n                break;\n            case \"join-room-ok\":\n                const loadingRoomId = msg[\"room-id\"];\n                const loadingRoom = this._presence[loadingRoomId];\n                if (loadingRoom) {\n                    loadingRoom.isLoading = false;\n                }\n                this._notifyPresenceSubs(loadingRoomId);\n                break;\n            case \"join-room-error\":\n                const errorRoomId = msg[\"room-id\"];\n                const errorRoom = this._presence[errorRoomId];\n                if (errorRoom) {\n                    errorRoom.error = msg[\"error\"];\n                }\n                this._notifyPresenceSubs(errorRoomId);\n                break;\n            case \"error\":\n                this._handleReceiveError(msg);\n                break;\n            default:\n                break;\n        }\n    }\n    _handleReceiveError(msg) {\n        var _a, _b;\n        const eventId = msg[\"client-event-id\"];\n        const prevMutation = this.pendingMutations.currentValue.get(eventId);\n        if (prevMutation) {\n            // This must be a transaction error\n            this.pendingMutations.set((prev) => {\n                prev.delete(eventId);\n                return prev;\n            });\n            this.notifyAll();\n            this.notifyAttrsSubs();\n            this.notifyMutationErrorSubs(msg);\n            const errDetails = {\n                message: msg.message,\n                hint: msg.hint,\n            };\n            this._finishTransaction(false, \"error\", eventId, errDetails);\n            return;\n        }\n        const q = msg.q || ((_a = msg[\"original-event\"]) === null || _a === void 0 ? void 0 : _a.q);\n        if (q) {\n            // This must be a query error\n            this.querySubs.set((prev) => {\n                const hash = weakHash(q);\n                delete prev[hash];\n                return prev;\n            });\n            this.notifyQueryError(weakHash(q), {\n                message: msg.message || \"Uh-oh, something went wrong. Ping Joe & Stopa.\",\n            });\n            return;\n        }\n        const isInitError = ((_b = msg[\"original-event\"]) === null || _b === void 0 ? void 0 : _b.op) === \"init\";\n        if (isInitError) {\n            // We failed to init\n            const errorMessage = {\n                message: msg.message || \"Uh-oh, something went wrong. Ping Joe & Stopa.\",\n            };\n            this._setStatus(STATUS.ERRORED, errorMessage);\n            this.notifyAll();\n            return;\n        }\n        // We've caught some error which has no corresponding listener.\n        // Let's console.error to let the user know.\n        const errorObj = Object.assign({}, msg);\n        delete errorObj.message;\n        delete errorObj.hint;\n        console.error(msg.message, errorObj);\n        if (msg.hint) {\n            console.error(\"This error comes with some debugging information. Here it is: \\n\", msg.hint);\n        }\n    }\n    _setAttrs(attrs) {\n        this.attrs = attrs.reduce((acc, attr) => {\n            acc[attr.id] = attr;\n            return acc;\n        }, {});\n        this.notifyAttrsSubs();\n    }\n    // ---------------------------\n    // Queries\n    /**\n     *  When a user subscribes to a query the following side effects occur:\n     *\n     *  - We update querySubs to include the new query\n     *  - We update queryCbs to include the new cb\n     *  - If we already have a result for the query we call cb immediately\n     *  - We send the server an `add-query` message\n     *\n     *  Returns an unsubscribe function\n     */\n    subscribeQuery(q, cb) {\n        var _a, _b;\n        const eventId = uuid();\n        const hash = weakHash(q);\n        this.queryCbs[hash] = this.queryCbs[hash] || [];\n        this.queryCbs[hash].push(cb);\n        this.querySubs.set((prev) => {\n            prev[hash] = prev[hash] || { q, result: null, eventId };\n            return prev;\n        });\n        this._trySendAuthed(eventId, { op: \"add-query\", q });\n        const errorMessage = this._errorMessage;\n        const prevResult = (_b = (_a = this.querySubs.currentValue) === null || _a === void 0 ? void 0 : _a[hash]) === null || _b === void 0 ? void 0 : _b.result;\n        if (errorMessage) {\n            cb({ error: errorMessage });\n        }\n        else if (prevResult) {\n            cb(this.dataForResult(q, prevResult));\n        }\n        return () => {\n            this.queryCbs[hash] = this.queryCbs[hash].filter((x) => x !== cb);\n        };\n    }\n    // When we `pushTx`, it's possible that we don't yet have `this.attrs`\n    // This means that `tx-steps` in `pendingMutations` will include `add-attr`\n    // commands for attrs that already exist.\n    //\n    // This will also affect `add-triple` and `retract-triple` which\n    // reference attr-ids that do not match the server.\n    //\n    // We fix this by rewriting `tx-steps` in each `pendingMutation`.\n    // We remove `add-attr` commands for attrs that already exist.\n    // We update `add-triple` and `retract-triple` commands to use the\n    // server attr-ids.\n    _rewriteMutations(attrs, muts) {\n        if (!attrs)\n            return muts;\n        const findExistingAttr = ([action, attr]) => {\n            if (action !== \"add-attr\") {\n                return;\n            }\n            const [_, etype, label] = attr[\"forward-identity\"];\n            const existing = instaml.getAttrByFwdIdentName(attrs, etype, label);\n            return existing;\n        };\n        const rewriteTxSteps = (mapping, txSteps) => {\n            return txSteps.reduce(([mapping, retTxSteps], txStep) => {\n                // Handles add-attr\n                // If existing, we drop it, and track it\n                // to update add/retract triples\n                const existing = findExistingAttr(txStep);\n                if (existing) {\n                    const [_action, attr] = txStep;\n                    mapping[attr.id] = existing.id;\n                    return [mapping, retTxSteps];\n                }\n                // Handles add-triple|retract-triple\n                // If in mapping, we update the attr-id\n                const [action, eid, attrId, ...rest] = txStep;\n                const newTxStep = mapping[attrId]\n                    ? [action, eid, mapping[attrId], ...rest]\n                    : txStep;\n                retTxSteps.push(newTxStep);\n                return [mapping, retTxSteps];\n            }, [mapping, []]);\n        };\n        const [_, __, rewritten] = [...muts.entries()].reduce(([attrs, mapping, newMuts], [k, mut]) => {\n            const [newMapping, newTxSteps] = rewriteTxSteps(mapping, mut[\"tx-steps\"]);\n            newMuts.set(k, Object.assign(Object.assign({}, mut), { \"tx-steps\": newTxSteps }));\n            return [attrs, newMapping, newMuts];\n        }, [attrs, {}, new Map()]);\n        return rewritten;\n    }\n    // ---------------------------\n    // Transact\n    optimisticAttrs() {\n        var _a;\n        const pendingMutationSteps = [\n            ...this.pendingMutations.currentValue.values(),\n        ] // hack due to Map()\n            .flatMap((x) => x[\"tx-steps\"]);\n        const deletedAttrIds = new Set(pendingMutationSteps\n            .filter(([action, _attr]) => action === \"delete-attr\")\n            .map(([_action, id]) => id));\n        const pendingAttrs = [];\n        for (const [_action, attr] of pendingMutationSteps) {\n            if (_action === \"add-attr\") {\n                pendingAttrs.push(attr);\n            }\n            else if (_action === \"update-attr\" &&\n                attr.id &&\n                ((_a = this.attrs) === null || _a === void 0 ? void 0 : _a[attr.id])) {\n                const fullAttr = Object.assign(Object.assign({}, this.attrs[attr.id]), attr);\n                pendingAttrs.push(fullAttr);\n            }\n        }\n        const attrsWithoutDeleted = [\n            ...Object.values(this.attrs || {}),\n            ...pendingAttrs,\n        ].filter((a) => !deletedAttrIds.has(a.id));\n        const attrsRecord = Object.fromEntries(attrsWithoutDeleted.map((a) => [a.id, a]));\n        return attrsRecord;\n    }\n    /** Runs instaql on a query and a store */\n    dataForResult(q, { store, pageInfo, aggregate }) {\n        const muts = this._rewriteMutations(store.attrs, this.pendingMutations.currentValue);\n        const txSteps = [...muts.values()].flatMap((x) => x[\"tx-steps\"]);\n        const newStore = s.transact(store, txSteps);\n        const resp = instaql({ store: newStore, pageInfo, aggregate }, q);\n        return resp;\n    }\n    /** Re-compute all subscriptions */\n    notifyAll() {\n        Object.keys(this.queryCbs).forEach((hash) => {\n            this.notifyOne(hash);\n        });\n    }\n    shutdown() {\n        this._isShutdown = true;\n        this._ws.close();\n    }\n    /**\n     * Sends mutation to server and schedules a timeout to cancel it if\n     * we don't hear back in time.\n     * Note: If we're offline we don't schedule a timeout, we'll schedule it\n     * later once we're back online and send the mutation again\n     *\n     */\n    _sendMutation(eventId, mutation) {\n        if (this.status !== STATUS.AUTHENTICATED) {\n            this._finishTransaction(true, \"enqueued\", eventId);\n            return;\n        }\n        const timeoutMs = Math.max(5000, this.pendingMutations.currentValue.size * 5000);\n        if (!this._isOnline) {\n            this._finishTransaction(true, \"enqueued\", eventId);\n        }\n        else {\n            this._trySend(eventId, mutation);\n            // If a transaction is pending for over 3 seconds,\n            // we want to unblock the UX, so mark it as pending\n            // and keep trying to process the transaction in the background\n            window.setTimeout(() => {\n                this._finishTransaction(true, \"pending\", eventId);\n            }, 3000);\n            window.setTimeout(() => {\n                if (!this._isOnline) {\n                    return;\n                }\n                // If we are here, this means that we have sent this mutation, we are online\n                // but we have not received a response. If it's this long, something must be worng,\n                // so we error with a timeout.\n                const mut = this.pendingMutations.currentValue.get(eventId);\n                if (mut && !mut[\"tx-id\"]) {\n                    this.pendingMutations.set((prev) => {\n                        prev.delete(eventId);\n                        return prev;\n                    });\n                    this._finishTransaction(false, \"timeout\", eventId);\n                    console.error(\"mutation timed out\", mut);\n                }\n            }, timeoutMs);\n        }\n    }\n    // ---------------------------\n    // Websocket\n    /** Send messages we accumulated while we were connecting */\n    _flushPendingMessages() {\n        const subs = Object.keys(this.queryCbs).map((hash) => {\n            return this.querySubs.currentValue[hash];\n        });\n        // Note: we should not have any nulls in subs, but we're\n        // doing this defensively just in case.\n        const safeSubs = subs.filter((x) => x);\n        safeSubs.forEach(({ eventId, q }) => {\n            this._trySendAuthed(eventId, { op: \"add-query\", q });\n        });\n        const muts = this._rewriteMutations(this.attrs, this.pendingMutations.currentValue);\n        muts.forEach((mut, eventId) => {\n            if (!mut[\"tx-id\"]) {\n                this._sendMutation(eventId, mut);\n            }\n        });\n        const roomIds = Object.keys(this._presence);\n        roomIds.forEach((roomId) => {\n            this._trySendAuthed(uuid(), { op: \"join-room\", \"room-id\": roomId });\n        });\n        const presence = Object.entries(this._presence);\n        presence.forEach(([roomId, { result }]) => {\n            const user = result === null || result === void 0 ? void 0 : result.user;\n            if (!user)\n                return;\n            this._trySendAuthed(uuid(), {\n                op: \"set-presence\",\n                \"room-id\": roomId,\n                data: user,\n            });\n        });\n    }\n    _trySendAuthed(eventId, msg) {\n        if (this.status !== STATUS.AUTHENTICATED) {\n            return;\n        }\n        this._trySend(eventId, msg);\n    }\n    _trySend(eventId, msg) {\n        if (this._ws.readyState !== WS_OPEN_STATUS) {\n            return;\n        }\n        this._ws.send(JSON.stringify(Object.assign({ \"client-event-id\": eventId }, msg)));\n    }\n    _startSocket() {\n        this._ws = new WebSocket(`${this.config.websocketURI}?app_id=${this.config.appId}`);\n        this._ws.onopen = this._wsOnOpen;\n        this._ws.onmessage = this._wsOnMessage;\n        this._ws.onclose = this._wsOnClose;\n    }\n    /**\n     * Given a key, returns a stable local id, unique to this device and app.\n     *\n     * This can be useful if you want to create guest ids for example.\n     *\n     * Note: If the user deletes their local storage, this id will change.\n     *\n     * We use this._localIdPromises to ensure that we only generate a local\n     * id once, even if multiple callers call this function concurrently.\n     */\n    getLocalId(name) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const k = `localToken_${name}`;\n            const id = yield this._persister.getItem(k);\n            if (id)\n                return id;\n            if (this._localIdPromises[k]) {\n                return this._localIdPromises[k];\n            }\n            const newId = uuid();\n            this._localIdPromises[k] = this._persister\n                .setItem(k, newId)\n                .then(() => newId);\n            return this._localIdPromises[k];\n        });\n    }\n    // ----\n    // Auth\n    _replaceUrlAfterOAuth() {\n        if (typeof URL === \"undefined\") {\n            return;\n        }\n        const url = new URL(window.location.href);\n        if (url.searchParams.get(OAUTH_REDIRECT_PARAM)) {\n            const startUrl = url.toString();\n            url.searchParams.delete(OAUTH_REDIRECT_PARAM);\n            url.searchParams.delete(\"code\");\n            url.searchParams.delete(\"error\");\n            const newPath = url.pathname +\n                (url.searchParams.size ? \"?\" + url.searchParams : \"\") +\n                url.hash;\n            // Note: In next.js, this will revert to the old state if user navigates\n            //       back. We would need to allow framework specific routing to work\n            //       around that problem.\n            history.replaceState(history.state, \"\", newPath);\n            // navigation is part of the HTML spec, but not supported by Safari\n            // or Firefox yet:\n            // https://developer.mozilla.org/en-US/docs/Web/API/Navigation_API#browser_compatibility\n            if (\n            // @ts-ignore (waiting for ts support)\n            typeof navigation === \"object\" &&\n                // @ts-ignore (waiting for ts support)\n                typeof navigation.addEventListener === \"function\" &&\n                // @ts-ignore (waiting for ts support)\n                typeof navigation.removeEventListener === \"function\") {\n                let ran = false;\n                // The next.js app router will reset the URL when the router loads.\n                // This puts it back after the router loads.\n                const listener = (e) => {\n                    var _a;\n                    if (!ran) {\n                        ran = true;\n                        // @ts-ignore (waiting for ts support)\n                        navigation.removeEventListener(\"navigate\", listener);\n                        if (!e.userInitiated &&\n                            e.navigationType === \"replace\" &&\n                            ((_a = e.destination) === null || _a === void 0 ? void 0 : _a.url) === startUrl) {\n                            history.replaceState(history.state, \"\", newPath);\n                        }\n                    }\n                };\n                // @ts-ignore (waiting for ts support)\n                navigation.addEventListener(\"navigate\", listener);\n            }\n        }\n    }\n    /**\n     *\n     * @returns Promise<null | {error: {message: string}}>\n     */\n    _oauthLoginInit() {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a, _b, _c, _d;\n            if (typeof window === \"undefined\" ||\n                typeof window.location === \"undefined\" ||\n                typeof URLSearchParams === \"undefined\") {\n                return null;\n            }\n            const params = new URLSearchParams(window.location.search);\n            if (!params.get(OAUTH_REDIRECT_PARAM)) {\n                return null;\n            }\n            const error = params.get(\"error\");\n            if (error) {\n                this._replaceUrlAfterOAuth();\n                return { error: { message: error } };\n            }\n            const code = params.get(\"code\");\n            if (!code) {\n                return null;\n            }\n            this._replaceUrlAfterOAuth();\n            try {\n                const { user } = yield authAPI.exchangeCodeForToken({\n                    apiURI: this.config.apiURI,\n                    appId: this.config.appId,\n                    code,\n                });\n                this.setCurrentUser(user);\n                return null;\n            }\n            catch (e) {\n                if (((_a = e === null || e === void 0 ? void 0 : e.body) === null || _a === void 0 ? void 0 : _a.type) === \"record-not-found\" &&\n                    ((_c = (_b = e === null || e === void 0 ? void 0 : e.body) === null || _b === void 0 ? void 0 : _b.hint) === null || _c === void 0 ? void 0 : _c[\"record-type\"]) === \"app-oauth-code\" &&\n                    (yield this._hasCurrentUser())) {\n                    // We probably just weren't able to clean up the URL, so\n                    // let's just ignore this error\n                    return null;\n                }\n                const message = ((_d = e === null || e === void 0 ? void 0 : e.body) === null || _d === void 0 ? void 0 : _d.message) || \"Error logging in.\";\n                return { error: { message } };\n            }\n        });\n    }\n    _waitForOAuthCallbackResponse() {\n        return __awaiter(this, void 0, void 0, function* () {\n            return yield this._oauthCallbackResponse;\n        });\n    }\n    __subscribeMutationErrors(cb) {\n        this.mutationErrorCbs.push(cb);\n        return () => {\n            this.mutationErrorCbs = this.mutationErrorCbs.filter((x) => x !== cb);\n        };\n    }\n    subscribeAuth(cb) {\n        this.authCbs.push(cb);\n        let unsubbed = false;\n        this.getCurrentUser().then((resp) => {\n            if (unsubbed)\n                return;\n            cb(resp);\n        });\n        return () => {\n            unsubbed = true;\n            this.authCbs = this.authCbs.filter((x) => x !== cb);\n        };\n    }\n    subscribeAttrs(cb) {\n        this.attrsCbs.push(cb);\n        if (this.attrs) {\n            cb(this.attrs);\n        }\n        return () => {\n            this.attrsCbs = this.attrsCbs.filter((x) => x !== cb);\n        };\n    }\n    notifyAuthSubs(user) {\n        this.authCbs.forEach((cb) => cb(user));\n    }\n    notifyMutationErrorSubs(error) {\n        this.mutationErrorCbs.forEach((cb) => cb(error));\n    }\n    notifyAttrsSubs() {\n        if (!this.attrs)\n            return;\n        const oas = this.optimisticAttrs();\n        this.attrsCbs.forEach((cb) => cb(oas));\n    }\n    setCurrentUser(user) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this._persister.setItem(currentUserKey, JSON.stringify(user));\n        });\n    }\n    getCurrentUser() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const oauthResp = yield this._waitForOAuthCallbackResponse();\n            if (oauthResp === null || oauthResp === void 0 ? void 0 : oauthResp.error) {\n                return { error: oauthResp.error };\n            }\n            const user = yield this._persister.getItem(currentUserKey);\n            return { user: JSON.parse(user) };\n        });\n    }\n    _hasCurrentUser() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const user = yield this._persister.getItem(currentUserKey);\n            return JSON.parse(user) != null;\n        });\n    }\n    changeCurrentUser(newUser) {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            yield this.setCurrentUser(newUser);\n            // We need to remove all `result` from querySubs,\n            // as they are no longer valid for the new user\n            this.updateUser(newUser);\n            try {\n                (_a = this._broadcastChannel) === null || _a === void 0 ? void 0 : _a.postMessage({ type: \"auth\" });\n            }\n            catch (error) {\n                console.error(\"Error posting message to broadcast channel\", error);\n            }\n        });\n    }\n    updateUser(newUser) {\n        this.querySubs.set((prev) => {\n            Object.keys(prev).forEach((k) => {\n                delete prev[k].result;\n            });\n            return prev;\n        });\n        this._reconnectTimeoutMs = 0;\n        this._ws.close();\n        this._oauthCallbackResponse = null;\n        this.notifyAuthSubs({ user: newUser });\n    }\n    sendMagicCode({ email }) {\n        return authAPI.sendMagicCode({\n            apiURI: this.config.apiURI,\n            appId: this.config.appId,\n            email: email,\n        });\n    }\n    signInWithMagicCode(_a) {\n        return __awaiter(this, arguments, void 0, function* ({ email, code }) {\n            const res = yield authAPI.verifyMagicCode({\n                apiURI: this.config.apiURI,\n                appId: this.config.appId,\n                email,\n                code,\n            });\n            this.changeCurrentUser(res.user);\n            return res;\n        });\n    }\n    signInWithCustomToken(authToken) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const res = yield authAPI.verifyRefreshToken({\n                apiURI: this.config.apiURI,\n                appId: this.config.appId,\n                refreshToken: authToken,\n            });\n            this.changeCurrentUser(res.user);\n        });\n    }\n    signOut() {\n        this.changeCurrentUser(null);\n    }\n    /**\n     * Creates an OAuth authorization URL.\n     * @param {Object} params - The parameters to create the authorization URL.\n     * @param {string} params.clientName - The name of the client requesting authorization.\n     * @param {string} params.redirectURL - The URL to redirect users to after authorization.\n     * @returns {string} The created authorization URL.\n     */\n    createAuthorizationURL({ clientName, redirectURL }) {\n        const { apiURI, appId } = this.config;\n        return `${apiURI}/runtime/oauth/start?app_id=${appId}&client_name=${clientName}&redirect_uri=${redirectURL}`;\n    }\n    exchangeCodeForToken(_a) {\n        return __awaiter(this, arguments, void 0, function* ({ code, codeVerifier }) {\n            const res = yield authAPI.exchangeCodeForToken({\n                apiURI: this.config.apiURI,\n                appId: this.config.appId,\n                code: code,\n                codeVerifier,\n            });\n            this.changeCurrentUser(res.user);\n            return res;\n        });\n    }\n    issuerURI() {\n        const { apiURI, appId } = this.config;\n        return `${apiURI}/runtime/${appId}`;\n    }\n    /**\n     * @param {Object} params\n     * @param {string} params.clientName - The name of the client requesting authorization.\n     * @param {string} params.idToken - The id_token from the external service\n     * @param {string | null | undefined} params.nonce - The nonce used when requesting the id_token from the external service\n     */\n    signInWithIdToken(_a) {\n        return __awaiter(this, arguments, void 0, function* ({ idToken, clientName, nonce }) {\n            const res = yield authAPI.signInWithIdToken({\n                apiURI: this.config.apiURI,\n                appId: this.config.appId,\n                idToken,\n                clientName,\n                nonce,\n            });\n            this.changeCurrentUser(res.user);\n            return res;\n        });\n    }\n    // --------\n    // Rooms\n    joinRoom(roomId) {\n        this._trySendAuthed(uuid(), { op: \"join-room\", \"room-id\": roomId });\n        return () => {\n            this._cleanupRoom(roomId);\n        };\n    }\n    _cleanupRoom(roomId) {\n        var _a, _b, _c;\n        if (!((_b = (_a = this._presence[roomId]) === null || _a === void 0 ? void 0 : _a.handlers) === null || _b === void 0 ? void 0 : _b.length) &&\n            !Object.keys((_c = this._broadcastSubs[roomId]) !== null && _c !== void 0 ? _c : {}).length) {\n            delete this._presence[roomId];\n            delete this._broadcastSubs[roomId];\n            this._trySendAuthed(uuid(), { op: \"leave-room\", \"room-id\": roomId });\n        }\n    }\n    // --------\n    // Presence\n    /**\n     * @template {keyof RoomSchema} RoomType\n     * @template {keyof RoomSchema[RoomType]['presence']} Keys\n     * @param {RoomType} roomType\n     * @param {string | number} roomId\n     * @param {import('./presence').PresenceOpts<RoomSchema[RoomType]['presence'], Keys>} opts\n     * @returns {import('./presence').PresenceResponse<RoomSchema[RoomType]['presence'], Keys>}\n     */\n    getPresence(roomType, roomId, opts = {}) {\n        const room = this._presence[roomId];\n        if (!room || !room.result)\n            return null;\n        return Object.assign(Object.assign({}, buildPresenceSlice(room.result, opts)), { isLoading: room.isLoading, error: room.error });\n    }\n    /**\n     * @template {keyof RoomSchema} RoomType\n     * @param {RoomType} roomType\n     * @param {string | number} roomId\n     * @param {Partial<RoomSchema[RoomType]['presence']>} partialData\n     */\n    publishPresence(roomType, roomId, partialData) {\n        var _a, _b;\n        const data = Object.assign(Object.assign({}, (_b = (_a = this._presence[roomId]) === null || _a === void 0 ? void 0 : _a.result) === null || _b === void 0 ? void 0 : _b.user), partialData);\n        this._trySendAuthed(uuid(), {\n            op: \"set-presence\",\n            \"room-id\": roomId,\n            data,\n        });\n        this._presence[roomId] = this._presence[roomId] || {};\n        this._presence[roomId].result = this._presence[roomId].result || {};\n        this._presence[roomId].result.user = data;\n        this._notifyPresenceSubs(roomId);\n    }\n    /**\n     * @template {keyof RoomSchema} RoomType\n     * @template {keyof RoomSchema[RoomType]['presence']} Keys\n     * @param {RoomType} roomType\n     * @param {string | number} roomId\n     * @param {import('./presence').PresenceOpts<RoomSchema[RoomType]['presence'], Keys>} opts\n     * @param {(slice: import('./presence').PresenceResponse<RoomSchema[RoomType]['presence'], Keys>) => void} cb\n     * @returns {() => void}\n     */\n    subscribePresence(roomType, roomId, opts, cb) {\n        const leaveRoom = this.joinRoom(roomId);\n        const handler = Object.assign(Object.assign({}, opts), { roomId, cb, prev: null });\n        this._presence[roomId] = this._presence[roomId] || {};\n        this._presence[roomId].isLoading = true;\n        this._presence[roomId].handlers = this._presence[roomId].handlers || [];\n        this._presence[roomId].handlers.push(handler);\n        this._notifyPresenceSub(roomId, handler);\n        return () => {\n            var _a, _b, _c;\n            this._presence[roomId].handlers =\n                (_c = (_b = (_a = this._presence[roomId]) === null || _a === void 0 ? void 0 : _a.handlers) === null || _b === void 0 ? void 0 : _b.filter((x) => x !== handler)) !== null && _c !== void 0 ? _c : [];\n            leaveRoom();\n        };\n    }\n    _notifyPresenceSubs(roomId) {\n        var _a, _b;\n        (_b = (_a = this._presence[roomId]) === null || _a === void 0 ? void 0 : _a.handlers) === null || _b === void 0 ? void 0 : _b.forEach((handler) => {\n            this._notifyPresenceSub(roomId, handler);\n        });\n    }\n    _notifyPresenceSub(roomId, handler) {\n        const slice = this.getPresence(\"\", roomId, handler);\n        if (!slice) {\n            return;\n        }\n        if (handler.prev && !hasPresenceResponseChanged(slice, handler.prev)) {\n            return;\n        }\n        handler.prev = slice;\n        handler.cb(slice);\n    }\n    _setPresencePeers(roomId, data) {\n        const sessions = Object.assign({}, data);\n        // no need to keep track of `user`\n        delete sessions[this._sessionId];\n        const peers = Object.fromEntries(Object.entries(sessions).map(([k, v]) => [k, v.data]));\n        this._presence[roomId] = this._presence[roomId] || {};\n        this._presence[roomId].result = this._presence[roomId].result || {};\n        this._presence[roomId].result.peers = peers;\n    }\n    // --------\n    // Broadcast\n    publishTopic({ roomType, roomId, topic, data }) {\n        this._trySendAuthed(uuid(), {\n            op: \"client-broadcast\",\n            \"room-id\": roomId,\n            roomType,\n            topic,\n            data,\n        });\n    }\n    subscribeTopic(roomId, topic, cb) {\n        const leaveRoom = this.joinRoom(roomId);\n        this._broadcastSubs[roomId] = this._broadcastSubs[roomId] || {};\n        this._broadcastSubs[roomId][topic] =\n            this._broadcastSubs[roomId][topic] || [];\n        this._broadcastSubs[roomId][topic].push(cb);\n        this._presence[roomId] = this._presence[roomId] || {};\n        // (XXX-EPH)\n        // TODO: if we're already in the room, we shouldn't be re-joining (this will clear presence data)\n        return () => {\n            this._broadcastSubs[roomId][topic] = this._broadcastSubs[roomId][topic].filter((x) => x !== cb);\n            if (!this._broadcastSubs[roomId][topic].length) {\n                delete this._broadcastSubs[roomId][topic];\n            }\n            leaveRoom();\n        };\n    }\n    _notifyBroadcastSubs(room, topic, msg) {\n        var _a, _b, _c;\n        (_c = (_b = (_a = this._broadcastSubs) === null || _a === void 0 ? void 0 : _a[room]) === null || _b === void 0 ? void 0 : _b[topic]) === null || _c === void 0 ? void 0 : _c.forEach((cb) => {\n            var _a, _b, _c, _d, _e, _f;\n            const data = (_a = msg.data) === null || _a === void 0 ? void 0 : _a.data;\n            const peer = msg.data[\"peer-id\"] === this._sessionId\n                ? (_c = (_b = this._presence[room]) === null || _b === void 0 ? void 0 : _b.result) === null || _c === void 0 ? void 0 : _c.user\n                : (_f = (_e = (_d = this._presence[room]) === null || _d === void 0 ? void 0 : _d.result) === null || _e === void 0 ? void 0 : _e.peers) === null || _f === void 0 ? void 0 : _f[msg.data[\"peer-id\"]];\n            return cb(data, peer);\n        });\n    }\n    // --------\n    // Storage\n    upload(path, file) {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            const currentUser = yield this.getCurrentUser();\n            const refreshToken = (_a = currentUser === null || currentUser === void 0 ? void 0 : currentUser.user) === null || _a === void 0 ? void 0 : _a.refresh_token;\n            const fileName = path || file.name;\n            const url = yield StorageApi.getSignedUploadUrl({\n                apiURI: this.config.apiURI,\n                appId: this.config.appId,\n                fileName: fileName,\n                refreshToken: refreshToken,\n            });\n            const success = yield StorageApi.upload(url, file);\n            return this.getDownloadUrl(fileName);\n        });\n    }\n    getDownloadUrl(path) {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            const currentUser = yield this.getCurrentUser();\n            const refreshToken = (_a = currentUser === null || currentUser === void 0 ? void 0 : currentUser.user) === null || _a === void 0 ? void 0 : _a.refresh_token;\n            const url = yield StorageApi.getDownloadUrl({\n                apiURI: this.config.apiURI,\n                appId: this.config.appId,\n                path: path,\n                refreshToken: refreshToken,\n            });\n            return url;\n        });\n    }\n}\n//# sourceMappingURL=Reactor.js.map","let currentDevtool;\nexport function createDevtool(appId) {\n    currentDevtool === null || currentDevtool === void 0 ? void 0 : currentDevtool.dispose();\n    const container = createContainer();\n    const toggler = createToggler(toggleView);\n    const iframe = createIframe(getSrc(appId));\n    function onPostMessage(event) {\n        var _a;\n        if (event.source !== iframe.element.contentWindow)\n            return;\n        if (((_a = event.data) === null || _a === void 0 ? void 0 : _a.type) === \"close\" && container.isVisible()) {\n            toggleView();\n        }\n    }\n    function onKeyDown(event) {\n        const isToggleShortcut = event.shiftKey && event.ctrlKey && event.key === \"0\";\n        const isEsc = event.key === \"Escape\" || event.key === \"Esc\";\n        if (isToggleShortcut || isEsc) {\n            toggleView();\n        }\n    }\n    function toggleView() {\n        if (container.isVisible()) {\n            container.element.style.display = \"none\";\n        }\n        else {\n            container.element.style.display = \"block\";\n            // lazily render iframe on first open\n            if (!container.element.contains(iframe.element)) {\n                container.element.appendChild(iframe.element);\n            }\n        }\n    }\n    function dispose() {\n        container.element.remove();\n        toggler.element.remove();\n        removeEventListener(\"keydown\", onKeyDown);\n        removeEventListener(\"message\", onPostMessage);\n    }\n    function create() {\n        document.body.appendChild(container.element);\n        document.body.appendChild(toggler.element);\n        addEventListener(\"keydown\", onKeyDown);\n        addEventListener(\"message\", onPostMessage);\n        currentDevtool = {\n            dispose,\n        };\n    }\n    return create();\n}\nfunction getSrc(appId) {\n    const isDev = window.DEV_DEVTOOL;\n    const src = `${isDev ? \"http://localhost:3000\" : \"https://instantdb.com\"}/_devtool?appId=${appId}`;\n    return src;\n}\nfunction createIframe(src) {\n    const element = document.createElement(\"iframe\");\n    element.src = src;\n    Object.assign(element.style, {\n        width: \"100%\",\n        height: \"100%\",\n        borderRadius: \"4px\",\n        backgroundColor: \"white\",\n    });\n    return { element };\n}\nfunction createToggler(onClick) {\n    const element = document.createElement(\"button\");\n    element.innerText = \"Î»\";\n    Object.assign(element.style, {\n        // pos\n        position: \"fixed\",\n        bottom: \"24px\",\n        left: \"24px\",\n        height: \"32px\",\n        width: \"32px\",\n        // layout\n        display: \"flex\",\n        alignItems: \"center\",\n        justifyContent: \"center\",\n        // hardcode look and feel defaults\n        color: \"#fff\",\n        backgroundColor: \"#444\",\n        fontSize: \"16px\",\n        fontFamily: \"sans-serif\",\n        fontStyle: \"normal\",\n        border: \"1px white solid\",\n        borderRadius: \"8px\",\n        zIndex: \"999991\",\n    });\n    element.addEventListener(\"click\", onClick);\n    return { element };\n}\nfunction createContainer() {\n    const element = document.createElement(\"div\");\n    Object.assign(element.style, {\n        position: \"fixed\",\n        bottom: \"24px\",\n        right: \"24px\",\n        left: \"60px\",\n        top: \"72px\",\n        display: \"block\",\n        borderRadius: \"4px\",\n        border: \"1px #ccc solid\",\n        boxShadow: \"0px 0px 8px #00000044\",\n        backgroundColor: \"#eee\",\n        zIndex: \"999990\",\n    });\n    element.style.display = \"none\";\n    function isVisible() {\n        return element.style.display !== \"none\";\n    }\n    return { element, isVisible };\n}\n//# sourceMappingURL=devtool.js.map","import Reactor from \"./Reactor\";\nimport { tx, lookup, getOps } from \"./instatx\";\nimport weakHash from \"./utils/weakHash\";\nimport id from \"./utils/uuid\";\nimport IndexedDBStorage from \"./IndexedDBStorage\";\nimport WindowNetworkListener from \"./WindowNetworkListener\";\nimport * as i from \"./schema\";\nimport { createDevtool } from \"./devtool\";\nconst defaultOpenDevtool = false;\n// consts\nconst defaultConfig = {\n    apiURI: \"https://api.instantdb.com\",\n    websocketURI: \"wss://api.instantdb.com/runtime/session\",\n};\n// hmr\nfunction initGlobalInstantCoreStore() {\n    var _a;\n    if (typeof window !== \"undefined\") {\n        // @ts-expect-error\n        window.__instantDbStore = (_a = window.__instantDbStore) !== null && _a !== void 0 ? _a : {};\n        // @ts-expect-error\n        return window.__instantDbStore;\n    }\n    return {};\n}\nconst globalInstantCoreStore = initGlobalInstantCoreStore();\n// main\n/**\n *\n * The first step: init your application!\n *\n * Visit https://instantdb.com/dash to get your `appId` :)\n *\n * @example\n *  const db = init({ appId: \"my-app-id\" })\n *\n * // You can also provide a a schema for type safety and editor autocomplete!\n *\n *  type Schema = {\n *    goals: {\n *      title: string\n *    }\n *  }\n *\n *  const db = init<Schema>({ appId: \"my-app-id\" })\n *\n */\nfunction init(config, Storage, NetworkListener) {\n    const existingClient = globalInstantCoreStore[config.appId];\n    if (existingClient) {\n        return existingClient;\n    }\n    const reactor = new Reactor(Object.assign(Object.assign({}, defaultConfig), config), Storage || IndexedDBStorage, NetworkListener || WindowNetworkListener);\n    const client = new InstantCore(reactor);\n    globalInstantCoreStore[config.appId] = client;\n    if (typeof window !== \"undefined\") {\n        const showDevtool = \n        // show widget by deafult?\n        (\"devtool\" in config ? Boolean(config.devtool) : defaultOpenDevtool) &&\n            // only run on localhost (dev env)\n            location.hostname === \"localhost\" &&\n            // used by dash and other internal consumers\n            !Boolean(globalThis._nodevtool);\n        if (showDevtool) {\n            createDevtool(config.appId);\n        }\n    }\n    return client;\n}\nclass InstantCore {\n    constructor(reactor) {\n        this._reactor = reactor;\n        this.auth = new Auth(this._reactor);\n        this.storage = new Storage(this._reactor);\n    }\n    /**\n     * Use this to write data! You can create, update, delete, and link objects\n     *\n     * @see https://docs.instantdb.com/docs/instaml\n     *\n     * @example\n     *   // Create a new object in the `goals` namespace\n     *   const goalId = id();\n     *   db.transact(tx.goals[goalId].update({title: \"Get fit\"}))\n     *\n     *   // Update the title\n     *   db.transact(tx.goals[goalId].update({title: \"Get super fit\"}))\n     *\n     *   // Delete it\n     *   db.transact(tx.goals[goalId].delete())\n     *\n     *   // Or create an association:\n     *   todoId = id();\n     *   db.transact([\n     *    tx.todos[todoId].update({ title: 'Go on a run' }),\n     *    tx.goals[goalId].link({todos: todoId}),\n     *  ])\n     */\n    transact(chunks) {\n        return this._reactor.pushTx(chunks);\n    }\n    getLocalId(name) {\n        return this._reactor.getLocalId(name);\n    }\n    /**\n     * Use this to query your data!\n     *\n     * @see https://docs.instantdb.com/docs/instaql\n     *\n     * @example\n     *  // listen to all goals\n     *  db.subscribeQuery({ goals: {} }, (resp) => {\n     *    console.log(resp.data.goals)\n     *  })\n     *\n     *  // goals where the title is \"Get Fit\"\n     *  db.subscribeQuery(\n     *    { goals: { $: { where: { title: \"Get Fit\" } } } },\n     *    (resp) => {\n     *      console.log(resp.data.goals)\n     *    }\n     *  )\n     *\n     *  // all goals, _alongside_ their todos\n     *  db.subscribeQuery({ goals: { todos: {} } }, (resp) => {\n     *    console.log(resp.data.goals)\n     *  });\n     */\n    subscribeQuery(query, cb) {\n        return this._reactor.subscribeQuery(query, cb);\n    }\n    /**\n     * Listen for the logged in state. This is useful\n     * for deciding when to show a login screen.\n     *\n     * @see https://docs.instantdb.com/docs/auth\n     * @example\n     *   const unsub = db.subscribeAuth((auth) => {\n     *     if (auth.user) {\n     *     console.log('logged in as', auth.user.email)\n     *    } else {\n     *      console.log('logged out')\n     *    }\n     *  })\n     */\n    subscribeAuth(cb) {\n        return this._reactor.subscribeAuth(cb);\n    }\n    /**\n     * Join a room to publish and subscribe to topics and presence.\n     *\n     * @see https://docs.instantdb.com/docs/presence-and-topics\n     * @example\n     * // init\n     * const db = init();\n     * const room = db.joinRoom(roomType, roomId);\n     * // usage\n     * const unsubscribeTopic = room.subscribeTopic(\"foo\", console.log);\n     * const unsubscribePresence = room.subscribePresence({}, console.log);\n     * room.publishTopic(\"hello\", { message: \"hello world!\" });\n     * room.publishPresence({ name: \"joe\" });\n     * // later\n     * unsubscribePresence();\n     * unsubscribeTopic();\n     * room.leaveRoom();\n     */\n    joinRoom(roomType = \"_defaultRoomType\", roomId = \"_defaultRoomId\") {\n        const leaveRoom = this._reactor.joinRoom(roomId);\n        return {\n            leaveRoom,\n            subscribeTopic: (topic, onEvent) => this._reactor.subscribeTopic(roomId, topic, onEvent),\n            subscribePresence: (opts, onChange) => this._reactor.subscribePresence(roomType, roomId, opts, onChange),\n            publishTopic: (topic, data) => this._reactor.publishTopic({ roomType, roomId, topic, data }),\n            publishPresence: (data) => this._reactor.publishPresence(roomType, roomId, data),\n            getPresence: (opts) => this._reactor.getPresence(roomType, roomId, opts),\n        };\n    }\n    shutdown() {\n        delete globalInstantCoreStore[this._reactor.config.appId];\n        this._reactor.shutdown();\n    }\n}\n/**\n * Functions to log users in and out.\n *\n * @see https://docs.instantdb.com/docs/auth\n */\nclass Auth {\n    constructor(db) {\n        this.db = db;\n        /**\n         * Sends a magic code to the user's email address.\n         *\n         * Once you send the magic code, see {@link auth.signInWithMagicCode} to let the\n         * user verify.\n         *\n         * @see https://docs.instantdb.com/docs/auth\n         * @example\n         *  db.auth.sendMagicCode({email: \"example@gmail.com\"})\n         *    .catch((err) => console.error(err.body?.message))\n         */\n        this.sendMagicCode = (params) => {\n            return this.db.sendMagicCode(params);\n        };\n        /**\n         * Verify a magic code that was sent to the user's email address.\n         *\n         * @see https://docs.instantdb.com/docs/auth\n         *\n         * @example\n         *  db.auth.signInWithMagicCode({email: \"example@gmail.com\", code: \"123456\"})\n         *       .catch((err) => console.error(err.body?.message))\n         */\n        this.signInWithMagicCode = (params) => {\n            return this.db.signInWithMagicCode(params);\n        };\n        /**\n         * Sign in a user with a refresh toke\n         *\n         * @see https://docs.instantdb.com/docs/backend#frontend-auth-sign-in-with-token\n         *\n         * @example\n         *   // Get the token from your backend\n         *   const token = await fetch('/signin', ...);\n         *   //Sign in\n         *   db.auth.signInWithToken(token);\n         */\n        this.signInWithToken = (token) => {\n            return this.db.signInWithCustomToken(token);\n        };\n        /**\n         * Create an authorization url to sign in with an external provider\n         *\n         * @see https://docs.instantdb.com/docs/auth\n         *\n         * @example\n         *   // Get the authorization url from your backend\n         *   const url = db.auth.createAuthorizationUrl({\n         *     clientName: \"google\",\n         *     redirectURL: window.location.href,\n         *   });\n         *\n         *   // Put it in a sign in link\n         *   <a href={url}>Log in with Google</a>\n         */\n        this.createAuthorizationURL = (params) => {\n            return this.db.createAuthorizationURL(params);\n        };\n        /**\n         * Sign in with the id_token from an external provider like Google\n         *\n         * @see https://docs.instantdb.com/docs/auth\n         * @example\n         *   db.auth\n         *  .signInWithIdToken({\n         *    // Token from external service\n         *    idToken: id_token,\n         *    // The name you gave the client when you registered it with Instant\n         *    clientName: \"google\",\n         *    // The nonce, if any, that you used when you initiated the auth flow\n         *    // with the external service.\n         *    nonce: your_nonce\n         *  })\n         *  .catch((err) => console.error(err.body?.message));\n         *\n         */\n        this.signInWithIdToken = (params) => {\n            return this.db.signInWithIdToken(params);\n        };\n        /**\n         * Sign in with the id_token from an external provider like Google\n         *\n         * @see https://docs.instantdb.com/docs/auth\n         * @example\n         *   db.auth\n         *  .exchangeOAuthCode({\n         *    // code received in redirect from OAuth callback\n         *    code: code\n         *    // The PKCE code_verifier, if any, that you used when you\n         *    // initiated the auth flow\n         *    codeVerifier: your_code_verifier\n         *  })\n         *  .catch((err) => console.error(err.body?.message));\n         *\n         */\n        this.exchangeOAuthCode = (params) => {\n            return this.db.exchangeCodeForToken(params);\n        };\n        /**\n         * OpenID Discovery path for use with tools like\n         * expo-auth-session that use auto-discovery of\n         * OAuth parameters.\n         *\n         * @see https://docs.instantdb.com/docs/auth\n         * @example\n         *   const discovery = useAutoDiscovery(\n         *     db.auth.issuerURI()\n         *   );\n         */\n        this.issuerURI = () => {\n            return this.db.issuerURI();\n        };\n        /**\n         * Sign out the current user\n         */\n        this.signOut = () => {\n            this.db.signOut();\n        };\n    }\n}\n/**\n * Functions to manage file storage.\n */\nclass Storage {\n    constructor(db) {\n        this.db = db;\n        /**\n         * Uploads file at the provided path.\n         *\n         * @see https://docs.instantdb.com/docs/storage\n         * @example\n         *   const [file] = e.target.files; // result of file input\n         *   const url = await db.storage.put('photos/demo.png', file);\n         */\n        this.put = (pathname, file) => {\n            return this.db.upload(pathname, file);\n        };\n        /**\n         * Retrieves a download URL for the provided path.\n         *\n         * @see https://docs.instantdb.com/docs/storage\n         * @example\n         *   const url = await db.storage.getDownloadUrl('photos/demo.png');\n         */\n        this.getDownloadUrl = (pathname) => {\n            return this.db.getDownloadUrl(pathname);\n        };\n    }\n}\n// util\nfunction coerceQuery(o) {\n    // stringify and parse to remove undefined values\n    return JSON.parse(JSON.stringify(o));\n}\n// dev\nexport { \n// bada bing bada boom\ninit, id, tx, lookup, \n// cli\ni, \n// util\ngetOps, coerceQuery, weakHash, IndexedDBStorage, WindowNetworkListener, InstantCore as InstantClient, Auth, Storage, };\n//# sourceMappingURL=index.js.map","import { weakHash, coerceQuery, } from \"@instantdb/core\";\nimport { useEffect, useState } from \"react\";\nexport function useQuery(_core, _query) {\n    const query = coerceQuery(_query);\n    // (XXX): Don't set `isLoading` true if we already have data, would\n    // be better to immediately show loaded data\n    const [state, setState] = useState({\n        isLoading: true,\n        data: undefined,\n        pageInfo: undefined,\n        error: undefined,\n    });\n    useEffect(() => {\n        setState({\n            isLoading: true,\n            data: undefined,\n            error: undefined,\n            pageInfo: undefined,\n        });\n        const unsub = _core.subscribeQuery(query, (resp) => {\n            setState(Object.assign({ isLoading: false }, resp));\n        });\n        return unsub;\n    }, [weakHash(query)]);\n    return { state, query };\n}\n//# sourceMappingURL=useQuery.js.map","import { useEffect, useRef } from \"react\";\nexport function useTimeout() {\n    const timeoutRef = useRef(null);\n    useEffect(() => {\n        clear();\n    }, []);\n    function set(delay, fn) {\n        clearTimeout(timeoutRef.current);\n        timeoutRef.current = setTimeout(fn, delay);\n    }\n    function clear() {\n        clearTimeout(timeoutRef.current);\n    }\n    return { set, clear };\n}\n//# sourceMappingURL=useTimeout.js.map","import { init as initCore, } from \"@instantdb/core\";\nimport { useCallback, useEffect, useMemo, useState, } from \"react\";\nimport { useQuery } from \"./useQuery\";\nimport { useTimeout } from \"./useTimeout\";\nexport const defaultActivityStopTimeout = 1000;\nexport class InstantReactRoom {\n    constructor(_core, type, id) {\n        /**\n         * Listen for broadcasted events given a room and topic.\n         *\n         * @see https://docs.instantdb.com/docs/presence-and-topics\n         * @example\n         *  function App({ roomId }) {\n         *    db.room(roomType, roomId).useTopicEffect(\"chat\", (message, peer) => {\n         *      console.log(\"New message\", message, 'from', peer.name);\n         *    });\n         *\n         *    // ...\n         *  }\n         */\n        this.useTopicEffect = (topic, onEvent) => {\n            useEffect(() => {\n                const unsub = this._core._reactor.subscribeTopic(this.id, topic, (event, peer) => {\n                    onEvent(event, peer);\n                });\n                return unsub;\n            }, [this.id, topic]);\n        };\n        /**\n         * Broadcast an event to a room.\n         *\n         * @see https://docs.instantdb.com/docs/presence-and-topics\n         * @example\n         * function App({ roomId }) {\n         *   const publishTopic = db.room(roomType, roomId).usePublishTopic(\"clicks\");\n         *\n         *   return (\n         *     <button onClick={() => publishTopic({ ts: Date.now() })}>Click me</button>\n         *   );\n         * }\n         *\n         */\n        this.usePublishTopic = (topic) => {\n            useEffect(() => this._core._reactor.joinRoom(this.id), [this.id]);\n            const publishTopic = useCallback((data) => {\n                this._core._reactor.publishTopic({\n                    roomType: this.type,\n                    roomId: this.id,\n                    topic,\n                    data,\n                });\n            }, [this.id, topic]);\n            return publishTopic;\n        };\n        /**\n         * Listen for peer's presence data in a room, and publish the current user's presence.\n         *\n         * @see https://docs.instantdb.com/docs/presence-and-topics\n         * @example\n         *  function App({ roomId }) {\n         *    const {\n         *      peers,\n         *      publishPresence\n         *    } = db.room(roomType, roomId).usePresence({ keys: [\"name\", \"avatar\"] });\n         *\n         *    // ...\n         *  }\n         */\n        this.usePresence = (opts = {}) => {\n            var _a, _b;\n            const [state, setState] = useState(() => {\n                var _a;\n                return ((_a = this._core._reactor.getPresence(this.type, this.id, opts)) !== null && _a !== void 0 ? _a : {\n                    peers: {},\n                    isLoading: true,\n                });\n            });\n            useEffect(() => {\n                const unsub = this._core._reactor.subscribePresence(this.type, this.id, opts, (data) => {\n                    setState(data);\n                });\n                return unsub;\n            }, [this.id, opts.user, (_a = opts.peers) === null || _a === void 0 ? void 0 : _a.join(), (_b = opts.keys) === null || _b === void 0 ? void 0 : _b.join()]);\n            return Object.assign(Object.assign({}, state), { publishPresence: (data) => {\n                    this._core._reactor.publishPresence(this.type, this.id, data);\n                } });\n        };\n        /**\n         * Publishes presence data to a room\n         *\n         * @see https://docs.instantdb.com/docs/presence-and-topics\n         * @example\n         *  function App({ roomId }) {\n         *    db.room(roomType, roomId).useSyncPresence({ name, avatar, color });\n         *\n         *    // ...\n         *  }\n         */\n        this.useSyncPresence = (data, deps) => {\n            useEffect(() => {\n                return this._core._reactor.publishPresence(this.type, this.id, data);\n            }, [this.type, this.id, deps !== null && deps !== void 0 ? deps : JSON.stringify(data)]);\n        };\n        /**\n         * Manage typing indicator state\n         *\n         * @see https://docs.instantdb.com/docs/presence-and-topics\n         * @example\n         *  function App({ roomId }) {\n         *    const {\n         *      active,\n         *      setActive,\n         *      inputProps,\n         *    } = db.room(roomType, roomId).useTypingIndicator(\"chat-input\", opts);\n         *\n         *    return <input {...inputProps} />;\n         *  }\n         */\n        this.useTypingIndicator = (inputName, opts = {}) => {\n            const timeout = useTimeout();\n            const onservedPresence = this.usePresence({\n                keys: [inputName],\n            });\n            const active = useMemo(() => {\n                var _a;\n                const presenceSnapshot = this._core._reactor.getPresence(this.type, this.id);\n                return (opts === null || opts === void 0 ? void 0 : opts.writeOnly)\n                    ? []\n                    : Object.values((_a = presenceSnapshot === null || presenceSnapshot === void 0 ? void 0 : presenceSnapshot.peers) !== null && _a !== void 0 ? _a : {}).filter((p) => p[inputName] === true);\n            }, [opts === null || opts === void 0 ? void 0 : opts.writeOnly, onservedPresence]);\n            const setActive = (isActive) => {\n                var _a;\n                this._core._reactor.publishPresence(this.type, this.id, {\n                    [inputName]: isActive,\n                });\n                if (!isActive)\n                    return;\n                if ((opts === null || opts === void 0 ? void 0 : opts.timeout) === null || (opts === null || opts === void 0 ? void 0 : opts.timeout) === 0)\n                    return;\n                timeout.set((_a = opts === null || opts === void 0 ? void 0 : opts.timeout) !== null && _a !== void 0 ? _a : defaultActivityStopTimeout, () => {\n                    this._core._reactor.publishPresence(this.type, this.id, {\n                        [inputName]: null,\n                    });\n                });\n            };\n            return {\n                active,\n                setActive: (a) => {\n                    setActive(a);\n                },\n                inputProps: {\n                    onKeyDown: (e) => {\n                        const isEnter = (opts === null || opts === void 0 ? void 0 : opts.stopOnEnter) && e.key === \"Enter\";\n                        const isActive = !isEnter;\n                        setActive(isActive);\n                    },\n                    onBlur: () => {\n                        setActive(false);\n                    },\n                },\n            };\n        };\n        this._core = _core;\n        this.type = type;\n        this.id = id;\n    }\n}\nexport class InstantReact {\n    constructor(config) {\n        this.getLocalId = (name) => {\n            return this._core.getLocalId(name);\n        };\n        /**\n         * Use this to write data! You can create, update, delete, and link objects\n         *\n         * @see https://docs.instantdb.com/docs/instaml\n         *\n         * @example\n         *   // Create a new object in the `goals` namespace\n         *   const goalId = id();\n         *   db.transact(tx.goals[goalId].update({title: \"Get fit\"}))\n         *\n         *   // Update the title\n         *   db.transact(tx.goals[goalId].update({title: \"Get super fit\"}))\n         *\n         *   // Delete it\n         *   db.transact(tx.goals[goalId].delete())\n         *\n         *   // Or create an association:\n         *   todoId = id();\n         *   db.transact([\n         *    tx.todos[todoId].update({ title: 'Go on a run' }),\n         *    tx.goals[goalId].link({todos: todoId}),\n         *  ])\n         */\n        this.transact = (chunks) => {\n            return this._core.transact(chunks);\n        };\n        /**\n         * Use this to query your data!\n         *\n         * @see https://docs.instantdb.com/docs/instaql\n         *\n         * @example\n         *  // listen to all goals\n         *  db.useQuery({ goals: {} })\n         *\n         *  // goals where the title is \"Get Fit\"\n         *  db.useQuery({ goals: { $: { where: { title: \"Get Fit\" } } } })\n         *\n         *  // all goals, _alongside_ their todos\n         *  db.useQuery({ goals: { todos: {} } })\n         */\n        this.useQuery = (_query) => {\n            return useQuery(this._core, _query).state;\n        };\n        /**\n         * Listen for the logged in state. This is useful\n         * for deciding when to show a login screen.\n         *\n         * Check out the docs for an example `Login` component too!\n         *\n         * @see https://docs.instantdb.com/docs/auth\n         * @example\n         *  function App() {\n         *    const { isLoading, user, error } = db.useAuth()\n         *    if (isLoading) {\n         *      return <div>Loading...</div>\n         *    }\n         *    if (error) {\n         *      return <div>Uh oh! {error.message}</div>\n         *    }\n         *    if (user) {\n         *      return <Main user={user} />\n         *    }\n         *    return <Login />\n         *  }\n         *\n         */\n        this.useAuth = () => {\n            // (XXX): Don't set `isLoading` true if we already have data, would\n            // be better to immediately show loaded data\n            const [state, setState] = useState({\n                isLoading: true,\n                user: undefined,\n                error: undefined,\n            });\n            useEffect(() => {\n                const unsub = this._core._reactor.subscribeAuth((resp) => {\n                    setState(Object.assign({ isLoading: false }, resp));\n                });\n                return unsub;\n            }, []);\n            return state;\n        };\n        this._core = initCore(config, \n        // @ts-expect-error because TS can't resolve subclass statics\n        this.constructor.Storage, \n        // @ts-expect-error because TS can't resolve subclass statics\n        this.constructor.NetworkListener);\n        this.auth = this._core.auth;\n        this.storage = this._core.storage;\n    }\n    /**\n     * Obtain a handle to a room, which allows you to listen to topics and presence data\n     *\n     * If you don't provide a `type` or `id`, Instant will default to `_defaultRoomType` and `_defaultRoomId`\n     * as the room type and id, respectively.\n     *\n     * @see https://docs.instantdb.com/docs/presence-and-topics\n     *\n     * @example\n     *  const {\n     *   useTopicEffect,\n     *   usePublishTopic,\n     *   useSyncPresence,\n     *   useTypingIndicator,\n     * } = db.room(roomType, roomId);\n     */\n    room(type = \"_defaultRoomType\", id = \"_defaultRoomId\") {\n        return new InstantReactRoom(this._core, type, id);\n    }\n}\n//# sourceMappingURL=InstantReact.js.map","import { InstantReact } from \"./InstantReact\";\nexport class InstantReactWeb extends InstantReact {\n}\n//# sourceMappingURL=InstantReactWeb.js.map","import { InstantReactWeb } from \"./InstantReactWeb\";\n/**\n *\n * The first step: init your application!\n *\n * Visit https://instantdb.com/dash to get your `appId` :)\n *\n * @example\n *  const db = init({ appId: \"my-app-id\" })\n *\n * // You can also provide a a schema for type safety and editor autocomplete!\n *\n *  type Schema = {\n *    goals: {\n *      title: string\n *    }\n *  }\n *\n *  const db = init<Schema>({ appId: \"my-app-id\" })\n *\n */\nexport function init(config) {\n    return new InstantReactWeb(config);\n}\n//# sourceMappingURL=init.js.map","import { init, tx, id } from \"@instantdb/react\";\n\nconst processEnv = typeof globalThis !== \"undefined\" && globalThis.process ? globalThis.process.env ?? {} : {};\n\nconst APP_ID =\n  import.meta.env?.VITE_INSTANTDB_APP_ID ??\n  processEnv.NEXT_PUBLIC_INSTANTDB_APP_ID ??\n  processEnv.VITE_INSTANTDB_APP_ID;\n\nconst db = APP_ID\n  ? init({\n      appId: APP_ID,\n      schema: {\n        liveSessions: {\n          classId: { type: \"string\", indexed: true },\n          lessonId: { type: \"string\", indexed: true },\n          lessonKey: { type: \"string\" },\n          deckId: { type: \"string\", indexed: true },\n          status: { type: \"string\" },\n          pointer: {\n            currentSlideId: { type: \"string\" },\n            currentIndex: { type: \"number\" },\n            maxUnlockedIndex: { type: \"number\" },\n            timestamp: { type: \"number\" },\n          },\n          slideHistory: { type: \"array\" },\n          activeAssessments: { type: \"array\" },\n          startedAt: { type: \"number\" },\n          attendance: { type: \"object\" },\n        },\n        studentStates: {\n          sessionId: { type: \"string\", indexed: true },\n          studentId: { type: \"string\", indexed: true },\n          classId: { type: \"string\", indexed: true },\n          currentPosition: { type: \"number\" },\n          currentSlideId: { type: \"string\" },\n          viewedSlides: { type: \"array\" },\n          timePerSlide: { type: \"object\" },\n          isActive: { type: \"boolean\" },\n          isBehind: { type: \"boolean\" },\n          lastHeartbeat: { type: \"number\" },\n        },\n        assessmentResponses: {\n          sessionId: { type: \"string\", indexed: true },\n          studentId: { type: \"string\", indexed: true },\n          assessmentId: { type: \"string\", indexed: true },\n          attempts: { type: \"array\" },\n          isComplete: { type: \"boolean\" },\n          score: { type: \"number\" },\n          lastUpdated: { type: \"number\" },\n        },\n        analytics: {\n          type: { type: \"string\", indexed: true },\n          sessionId: { type: \"string\", indexed: true },\n          classId: { type: \"string\", indexed: true },\n          studentId: { type: \"string\", indexed: true },\n          slideId: { type: \"string\" },\n          timestamp: { type: \"number\" },\n          payload: { type: \"object\" },\n        },\n        slideMetrics: {\n          slideId: { type: \"string\", indexed: true },\n          averageViewTime: { type: \"number\" },\n          totalViews: { type: \"number\" },\n        },\n      },\n    })\n  : null;\n\nexport { db, tx, id };\n\nexport function assertDb() {\n  if (!db) {\n    throw new Error(\n      \"InstantDB app id is not configured. Set VITE_INSTANTDB_APP_ID (or NEXT_PUBLIC_INSTANTDB_APP_ID) before using realtime features.\",\n    );\n  }\n  return db;\n}\n\n","import { createElement, Component } from 'react';\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nfunction __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nvar __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\n\r\nfunction __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)\r\n            t[p[i]] = s[p[i]];\r\n    return t;\r\n}\n\nvar VIEWBOX_WIDTH = 100;\r\nvar VIEWBOX_HEIGHT = 100;\r\nvar VIEWBOX_HEIGHT_HALF = 50;\r\nvar VIEWBOX_CENTER_X = 50;\r\nvar VIEWBOX_CENTER_Y = 50;\n\nfunction Path(_a) {\r\n    var className = _a.className, counterClockwise = _a.counterClockwise, dashRatio = _a.dashRatio, pathRadius = _a.pathRadius, strokeWidth = _a.strokeWidth, style = _a.style;\r\n    return (createElement(\"path\", { className: className, style: Object.assign({}, style, getDashStyle({ pathRadius: pathRadius, dashRatio: dashRatio, counterClockwise: counterClockwise })), d: getPathDescription({\r\n            pathRadius: pathRadius,\r\n            counterClockwise: counterClockwise,\r\n        }), strokeWidth: strokeWidth, fillOpacity: 0 }));\r\n}\r\nfunction getPathDescription(_a) {\r\n    var pathRadius = _a.pathRadius, counterClockwise = _a.counterClockwise;\r\n    var radius = pathRadius;\r\n    var rotation = counterClockwise ? 1 : 0;\r\n    return \"\\n      M \" + VIEWBOX_CENTER_X + \",\" + VIEWBOX_CENTER_Y + \"\\n      m 0,-\" + radius + \"\\n      a \" + radius + \",\" + radius + \" \" + rotation + \" 1 1 0,\" + 2 * radius + \"\\n      a \" + radius + \",\" + radius + \" \" + rotation + \" 1 1 0,-\" + 2 * radius + \"\\n    \";\r\n}\r\nfunction getDashStyle(_a) {\r\n    var counterClockwise = _a.counterClockwise, dashRatio = _a.dashRatio, pathRadius = _a.pathRadius;\r\n    var diameter = Math.PI * 2 * pathRadius;\r\n    var gapLength = (1 - dashRatio) * diameter;\r\n    return {\r\n        strokeDasharray: diameter + \"px \" + diameter + \"px\",\r\n        strokeDashoffset: (counterClockwise ? -gapLength : gapLength) + \"px\",\r\n    };\r\n}\n\nvar CircularProgressbar = (function (_super) {\r\n    __extends(CircularProgressbar, _super);\r\n    function CircularProgressbar() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    CircularProgressbar.prototype.getBackgroundPadding = function () {\r\n        if (!this.props.background) {\r\n            return 0;\r\n        }\r\n        return this.props.backgroundPadding;\r\n    };\r\n    CircularProgressbar.prototype.getPathRadius = function () {\r\n        return VIEWBOX_HEIGHT_HALF - this.props.strokeWidth / 2 - this.getBackgroundPadding();\r\n    };\r\n    CircularProgressbar.prototype.getPathRatio = function () {\r\n        var _a = this.props, value = _a.value, minValue = _a.minValue, maxValue = _a.maxValue;\r\n        var boundedValue = Math.min(Math.max(value, minValue), maxValue);\r\n        return (boundedValue - minValue) / (maxValue - minValue);\r\n    };\r\n    CircularProgressbar.prototype.render = function () {\r\n        var _a = this.props, circleRatio = _a.circleRatio, className = _a.className, classes = _a.classes, counterClockwise = _a.counterClockwise, styles = _a.styles, strokeWidth = _a.strokeWidth, text = _a.text;\r\n        var pathRadius = this.getPathRadius();\r\n        var pathRatio = this.getPathRatio();\r\n        return (createElement(\"svg\", { className: classes.root + \" \" + className, style: styles.root, viewBox: \"0 0 \" + VIEWBOX_WIDTH + \" \" + VIEWBOX_HEIGHT, \"data-test-id\": \"CircularProgressbar\" },\r\n            this.props.background ? (createElement(\"circle\", { className: classes.background, style: styles.background, cx: VIEWBOX_CENTER_X, cy: VIEWBOX_CENTER_Y, r: VIEWBOX_HEIGHT_HALF })) : null,\r\n            createElement(Path, { className: classes.trail, counterClockwise: counterClockwise, dashRatio: circleRatio, pathRadius: pathRadius, strokeWidth: strokeWidth, style: styles.trail }),\r\n            createElement(Path, { className: classes.path, counterClockwise: counterClockwise, dashRatio: pathRatio * circleRatio, pathRadius: pathRadius, strokeWidth: strokeWidth, style: styles.path }),\r\n            text ? (createElement(\"text\", { className: classes.text, style: styles.text, x: VIEWBOX_CENTER_X, y: VIEWBOX_CENTER_Y }, text)) : null));\r\n    };\r\n    CircularProgressbar.defaultProps = {\r\n        background: false,\r\n        backgroundPadding: 0,\r\n        circleRatio: 1,\r\n        classes: {\r\n            root: 'CircularProgressbar',\r\n            trail: 'CircularProgressbar-trail',\r\n            path: 'CircularProgressbar-path',\r\n            text: 'CircularProgressbar-text',\r\n            background: 'CircularProgressbar-background',\r\n        },\r\n        counterClockwise: false,\r\n        className: '',\r\n        maxValue: 100,\r\n        minValue: 0,\r\n        strokeWidth: 8,\r\n        styles: {\r\n            root: {},\r\n            trail: {},\r\n            path: {},\r\n            text: {},\r\n            background: {},\r\n        },\r\n        text: '',\r\n    };\r\n    return CircularProgressbar;\r\n}(Component));\n\nfunction CircularProgressbarWithChildren(props) {\r\n    var children = props.children, circularProgressbarProps = __rest(props, [\"children\"]);\r\n    return (createElement(\"div\", { \"data-test-id\": \"CircularProgressbarWithChildren\" },\r\n        createElement(\"div\", { style: { position: 'relative', width: '100%', height: '100%' } },\r\n            createElement(CircularProgressbar, __assign({}, circularProgressbarProps)),\r\n            props.children ? (createElement(\"div\", { \"data-test-id\": \"CircularProgressbarWithChildren__children\", style: {\r\n                    position: 'absolute',\r\n                    width: '100%',\r\n                    height: '100%',\r\n                    marginTop: '-100%',\r\n                    display: 'flex',\r\n                    flexDirection: 'column',\r\n                    justifyContent: 'center',\r\n                    alignItems: 'center',\r\n                } }, props.children)) : null)));\r\n}\n\nfunction buildStyles(_a) {\r\n    var rotation = _a.rotation, strokeLinecap = _a.strokeLinecap, textColor = _a.textColor, textSize = _a.textSize, pathColor = _a.pathColor, pathTransition = _a.pathTransition, pathTransitionDuration = _a.pathTransitionDuration, trailColor = _a.trailColor, backgroundColor = _a.backgroundColor;\r\n    var rotationTransform = rotation == null ? undefined : \"rotate(\" + rotation + \"turn)\";\r\n    var rotationTransformOrigin = rotation == null ? undefined : 'center center';\r\n    return {\r\n        root: {},\r\n        path: removeUndefinedValues({\r\n            stroke: pathColor,\r\n            strokeLinecap: strokeLinecap,\r\n            transform: rotationTransform,\r\n            transformOrigin: rotationTransformOrigin,\r\n            transition: pathTransition,\r\n            transitionDuration: pathTransitionDuration == null ? undefined : pathTransitionDuration + \"s\",\r\n        }),\r\n        trail: removeUndefinedValues({\r\n            stroke: trailColor,\r\n            strokeLinecap: strokeLinecap,\r\n            transform: rotationTransform,\r\n            transformOrigin: rotationTransformOrigin,\r\n        }),\r\n        text: removeUndefinedValues({\r\n            fill: textColor,\r\n            fontSize: textSize,\r\n        }),\r\n        background: removeUndefinedValues({\r\n            fill: backgroundColor,\r\n        }),\r\n    };\r\n}\r\nfunction removeUndefinedValues(obj) {\r\n    Object.keys(obj).forEach(function (key) {\r\n        if (obj[key] == null) {\r\n            delete obj[key];\r\n        }\r\n    });\r\n    return obj;\r\n}\n\nexport { CircularProgressbar, CircularProgressbarWithChildren, buildStyles };\n//# sourceMappingURL=index.esm.js.map\n","import { useEffect, useMemo, useState } from \"react\";\nimport { db } from \"../../lib/instantdb/schema.js\";\nimport { CircularProgressbar, buildStyles } from \"react-circular-progressbar\";\nimport \"react-circular-progressbar/dist/styles.css\";\nimport classNames from \"../../utils/classNames.js\";\nimport ProgressBar from \"../ui/ProgressBar.jsx\";\n\nimport \"./LiveDashboard.css\";\n\nfunction tileTone(state) {\n  if (!state?.isActive) return \"live-dashboard__tile--idle\";\n  if (state.isBehind) return \"live-dashboard__tile--behind\";\n  return \"live-dashboard__tile--on-time\";\n}\n\nexport default function LiveDashboard({ sessionId, classSize = 0 }) {\n  const [studentStates, setStudentStates] = useState([]);\n  const [assessmentProgress, setAssessmentProgress] = useState({});\n\n  const engagementScore = useMemo(() => {\n    if (studentStates.length === 0) return 0;\n    const active = studentStates.filter((state) => state.isActive).length;\n    const onTrack = studentStates.filter((state) => !state.isBehind).length;\n    return Math.round(((active + onTrack) / (studentStates.length * 2)) * 100);\n  }, [studentStates]);\n\n  useEffect(() => {\n    if (!sessionId || !db) return undefined;\n\n    const unsubscribeStates = db.subscribeQuery(db.studentStates.where(\"sessionId\", sessionId), (states) => {\n      setStudentStates(states);\n    });\n\n    const unsubscribeAssessments = db.subscribeQuery(db.assessmentResponses.where(\"sessionId\", sessionId), (responses) => {\n      const summary = {};\n      responses.forEach((response) => {\n        if (!summary[response.assessmentId]) {\n          summary[response.assessmentId] = { completed: 0, inProgress: 0, notStarted: classSize };\n        }\n        if (response.isComplete) {\n          summary[response.assessmentId].completed += 1;\n          summary[response.assessmentId].notStarted -= 1;\n        } else {\n          summary[response.assessmentId].inProgress += 1;\n          summary[response.assessmentId].notStarted -= 1;\n        }\n      });\n      setAssessmentProgress(summary);\n    });\n\n    return () => {\n      unsubscribeStates?.();\n      unsubscribeAssessments?.();\n    };\n  }, [sessionId, classSize]);\n\n  return (\n    <div className=\"live-dashboard\">\n      <header className=\"live-dashboard__header\">\n        <h2>Live class dashboard</h2>\n        <p>Monitor engagement and assessment progress in real time.</p>\n      </header>\n\n      <div className=\"live-dashboard__metrics\">\n        <div className=\"live-dashboard__card\">\n          <h3>Class engagement</h3>\n          <div className=\"live-dashboard__gauge\">\n            <CircularProgressbar\n              value={engagementScore}\n              text={`${engagementScore}%`}\n              styles={buildStyles({\n                pathColor: engagementScore > 70 ? \"#10b981\" : engagementScore > 40 ? \"#f59e0b\" : \"#ef4444\",\n                textColor: \"#0f172a\",\n                trailColor: \"#e2e8f0\",\n              })}\n            />\n          </div>\n        </div>\n\n        <div className=\"live-dashboard__card\">\n          <h3>Active students</h3>\n          <p className=\"live-dashboard__value\">\n            {studentStates.filter((state) => state.isActive).length} / {classSize}\n          </p>\n          <p className=\"live-dashboard__note\">{studentStates.filter((state) => state.isBehind).length} behind pointer</p>\n        </div>\n\n        <div className=\"live-dashboard__card\">\n          <h3>Assessment status</h3>\n          {Object.keys(assessmentProgress).length === 0 ? (\n            <p className=\"live-dashboard__note\">No active assessments</p>\n          ) : (\n            <ul className=\"live-dashboard__assessment-list\">\n              {Object.entries(assessmentProgress).map(([assessmentId, summary]) => (\n                <li key={assessmentId}>\n                  <div className=\"live-dashboard__assessment-row\">\n            <span className=\"live-dashboard__chip live-dashboard__chip--success\">âœ“ {summary.completed}</span>\n            <span className=\"live-dashboard__chip live-dashboard__chip--warning\">âŸ³ {summary.inProgress}</span>\n            <span className=\"live-dashboard__chip live-dashboard__chip--muted\">â—‹ {summary.notStarted}</span>\n                  </div>\n                  <div className=\"live-dashboard__progress\">\n                    <ProgressBar\n                      className=\"live-dashboard__progress-bar\"\n                      value={summary.completed}\n                      max={classSize || 1}\n                      tone=\"success\"\n                      size=\"xs\"\n                      ariaLabel={`Assessment ${assessmentId} completion`}\n                    />\n                  </div>\n                </li>\n              ))}\n            </ul>\n          )}\n        </div>\n      </div>\n\n      <section className=\"live-dashboard__grid\">\n        <header>\n          <h3>Student status</h3>\n        </header>\n        <div className=\"live-dashboard__grid-body\">\n          {studentStates.length === 0 ? (\n            <p className=\"live-dashboard__note\">Waiting for students to joinâ€¦</p>\n          ) : (\n            studentStates.map((state) => (\n              <div\n                key={state.studentId}\n                className={classNames(\"live-dashboard__tile\", tileTone(state))}\n              >\n                <span>{state.studentId?.slice(-4)}</span>\n                <strong>Slide {state.currentPosition ?? 0}</strong>\n              </div>\n            ))\n          )}\n        </div>\n      </section>\n    </div>\n  );\n}\n\n","import { db, tx, id } from \"../instantdb/schema.js\";\n\nfunction safeNumber(value, fallback = 0) {\n  if (typeof value === \"number\" && Number.isFinite(value)) {\n    return value;\n  }\n  return fallback;\n}\n\nclass AnalyticsService {\n  constructor() {\n    this.enabled = Boolean(db);\n  }\n\n  isEnabled() {\n    return this.enabled && Boolean(db);\n  }\n\n  async trackEvent(eventType, data = {}) {\n    if (!this.isEnabled() || !eventType) return null;\n\n    const timestamp = Date.now();\n    const event = {\n      type: eventType,\n      timestamp,\n      ...data,\n    };\n\n    try {\n      const eventId = id();\n      await db.transact([\n        tx.analytics[eventId].update({\n          ...event,\n          payload: event.payload ?? null,\n        }),\n      ]);\n\n      this.processForMetrics({ id: eventId, ...event });\n      return eventId;\n    } catch (error) {\n      console.warn(\"Analytics event failed\", eventType, error);\n      return null;\n    }\n  }\n\n  async processForMetrics(event) {\n    if (!event?.type) return;\n\n    switch (event.type) {\n      case \"slide_view\":\n        await this.updateSlideMetrics(event);\n        break;\n      default:\n        break;\n    }\n  }\n\n  async updateSlideMetrics(event) {\n    if (!this.isEnabled() || !event?.slideId) return;\n\n    try {\n      const records = await db.analytics\n        .where(\"type\", \"slide_view\")\n        .where(\"slideId\", event.slideId)\n        .get();\n\n      if (!Array.isArray(records) || records.length === 0) return;\n\n      const totalViews = records.length;\n      const totalDuration = records.reduce((acc, row) => acc + safeNumber(row.payload?.durationMs, 0), 0);\n      const averageViewTime = totalViews === 0 ? 0 : Math.round(totalDuration / totalViews);\n\n      const metricId = id();\n      const existing = await db.slideMetrics.where(\"slideId\", event.slideId).get();\n      const targetId = existing?.[0]?.id ?? metricId;\n\n      await db.transact([\n        tx.slideMetrics[targetId].update({\n          slideId: event.slideId,\n          averageViewTime,\n          totalViews,\n        }),\n      ]);\n    } catch (error) {\n      console.warn(\"Failed to update slide metrics\", error);\n    }\n  }\n}\n\nconst analyticsService = new AnalyticsService();\n\nexport default analyticsService;\nexport { AnalyticsService };\n\n","import { db, tx, id } from \"../instantdb/schema.js\";\n\nfunction toNumber(value, fallback = 0) {\n  if (typeof value === \"number\" && Number.isFinite(value)) return value;\n  return fallback;\n}\n\nclass GamificationService {\n  constructor() {\n    this.enabled = Boolean(db);\n    this.experienceTable = {\n      slide_complete: 5,\n      assessment_attempt: 10,\n      assessment_perfect: 35,\n      interactive_complete: 25,\n    };\n  }\n\n  isEnabled() {\n    return this.enabled && Boolean(db);\n  }\n\n  calculateLevel(xp) {\n    const safeXp = toNumber(xp, 0);\n    return Math.max(1, Math.floor(safeXp / 150) + 1);\n  }\n\n  async fetchStudentRecord(studentId) {\n    if (!this.isEnabled() || !studentId) return null;\n    try {\n      const existing = await db.studentGamification.where(\"studentId\", studentId).get();\n      return existing?.[0] ?? null;\n    } catch (error) {\n      console.warn(\"Failed to fetch gamification record\", error);\n      return null;\n    }\n  }\n\n  async awardExperience(studentId, action, context = {}) {\n    if (!this.isEnabled() || !studentId) {\n      return { awarded: 0, total: null, level: null, achievements: [] };\n    }\n\n    const base = toNumber(this.experienceTable[action], 0);\n    let totalAward = base;\n\n    if (context.correct && action !== \"assessment_perfect\") {\n      totalAward += 5;\n    }\n\n    if (context.firstAttempt && action === \"assessment_perfect\") {\n      totalAward += 10;\n    }\n\n    if (totalAward <= 0) {\n      return { awarded: 0, total: null, level: null, achievements: [] };\n    }\n\n    try {\n      const record = await this.fetchStudentRecord(studentId);\n      const recordId = record?.id ?? id();\n      const previousXp = toNumber(record?.xp, 0);\n      const previousCorrect = toNumber(record?.totalCorrect, 0);\n      const previousAttempts = toNumber(record?.totalAttempts, 0);\n      const previousStreak = toNumber(record?.streak, 0);\n\n      const total = previousXp + totalAward;\n      const level = this.calculateLevel(total);\n      const correctIncrement = context.correct ? 1 : 0;\n      const attemptsIncrement = context.attempts ? toNumber(context.attempts, 1) : 1;\n      const streak = context.correct ? previousStreak + 1 : 0;\n\n      await db.transact([\n        tx.studentGamification[recordId].update({\n          studentId,\n          xp: total,\n          level,\n          streak,\n          totalCorrect: previousCorrect + correctIncrement,\n          totalAttempts: previousAttempts + attemptsIncrement,\n          lastUpdated: new Date().toISOString(),\n        }),\n      ]);\n\n      return {\n        awarded: totalAward,\n        total,\n        level,\n        achievements: [],\n      };\n    } catch (error) {\n      console.warn(\"Gamification award failed\", error);\n      return { awarded: 0, total: null, level: null, achievements: [] };\n    }\n  }\n}\n\nconst gamificationService = new GamificationService();\n\nexport default gamificationService;\nexport { GamificationService };\n\n","import { useCallback, useEffect, useMemo, useRef, useState } from \"react\";\nimport { useSearchParams } from \"react-router-dom\";\nimport {\n  getTeacherDashboard,\n  getClassPacing,\n  updateClassPacing,\n  getStudentDashboard,\n  getStudentClassPacing,\n  joinLiveSession,\n  getLiveAssessmentStatus,\n  updateLiveAssessmentStatus,\n} from \"../lib/api.js\";\nimport { useSession } from \"../hooks/useSession.js\";\nimport {\n  getDeckSummary,\n  listSlidesForDeck,\n  getSlideById,\n  describeSlide,\n  YEAR7_UNITS,\n  YEAR7_CURRICULUM,\n} from \"../../../shared/liveDecks.js\";\nimport SlideRenderer from \"../components/slides/SlideRenderer.jsx\";\nimport LiveDashboard from \"../components/teacher/LiveDashboard.jsx\";\nimport StatCard from \"../components/ui/StatCard.jsx\";\nimport analyticsService from \"../lib/services/AnalyticsService.js\";\nimport gamificationService from \"../lib/services/GamificationService.js\";\nimport { useGamification } from \"../context/GamificationContext.jsx\";\nimport \"./Year7LiveSessionPage.css\";\n\nconst POLL_INTERVAL_MS = 4000;\n\nfunction normaliseAccessible(value) {\n  if (!value) return null;\n  if (typeof value === \"string\") return value;\n  if (typeof value === \"object\" && value.slideId) return value.slideId;\n  if (typeof value === \"object\" && value.id) return value.id;\n  return null;\n}\n\nfunction buildLiveSnapshot(payload) {\n  if (!payload) return null;\n  const pacing = payload.pacing ?? payload;\n  const lessonId = payload.lesson?.id || pacing?.lessonId || pacing?.slideId || null;\n  const lesson = lessonId ? describeSlide(lessonId) : null;\n  const accessibleSource = payload.accessibleSlides ?? pacing?.accessibleSlides ?? [];\n  const accessible = new Set(\n    accessibleSource\n      .map((entry) => normaliseAccessible(entry))\n      .filter(Boolean),\n  );\n  if (lesson?.slideId) {\n    accessible.add(lesson.slideId);\n  }\n  return {\n    classDoc: payload.class ?? null,\n    pacing,\n    lesson,\n    accessible,\n    sessionCode: pacing?.sessionCode ?? null,\n    sessionStatus: pacing?.sessionStatus ?? (lesson ? \"live\" : \"idle\"),\n    updatedAt: pacing?.updatedAt ?? null,\n  };\n}\n\nfunction formatTimestamp(value) {\n  if (!value) return null;\n  const date = new Date(value);\n  if (Number.isNaN(date.getTime())) return null;\n  return date.toLocaleString();\n}\n\nfunction getDefaultDeckId() {\n  return YEAR7_CURRICULUM[0]?.id ?? YEAR7_UNITS.find((unit) => unit.deckId)?.deckId ?? null;\n}\n\nfunction getUnitByDeckId(deckId) {\n  return YEAR7_UNITS.find((unit) => unit.deckId === deckId) ?? YEAR7_UNITS[0];\n}\n\nfunction statusLabel(status) {\n  switch ((status || \"idle\").toLowerCase()) {\n    case \"live\":\n      return \"Live\";\n    case \"paused\":\n      return \"Paused\";\n    case \"idle\":\n    default:\n      return \"Not started\";\n  }\n}\n\nfunction useArrowNavigation(callbacks) {\n  useEffect(() => {\n    const handleKey = (event) => {\n      if (event.defaultPrevented) return;\n      if (event.target && [\"INPUT\", \"TEXTAREA\"].includes(event.target.tagName)) {\n        return;\n      }\n      if (event.key === \"ArrowRight\") {\n        callbacks.onNext?.();\n      }\n      if (event.key === \"ArrowLeft\") {\n        callbacks.onPrev?.();\n      }\n    };\n    window.addEventListener(\"keydown\", handleKey);\n    return () => window.removeEventListener(\"keydown\", handleKey);\n  }, [callbacks]);\n}\n\nfunction SlideTimeline({ slides, pointerId, activeId, accessibleSet, onSelect, disableFuture, label }) {\n  const labelMap = {\n    content: \"Content\",\n    checkpoint: \"Checkpoint\",\n    assessment: \"Assessment\",\n    summative: \"Summative\",\n    interactive: \"Interactive\",\n  };\n  return (\n    <div className=\"y7-live-timeline\" aria-label={label}>\n      {slides.map((slide) => {\n        const status = pointerId === slide.id ? \"current\" : accessibleSet.has(slide.id) ? \"available\" : \"locked\";\n        const isActive = activeId === slide.id;\n        const isDisabled = disableFuture && status === \"locked\";\n        return (\n          <button\n            key={slide.id}\n            type=\"button\"\n            className={`y7-live-timeline__item y7-live-timeline__item--${status} ${isActive ? \"is-active\" : \"\"}`}\n            onClick={() => onSelect(slide.id, status)}\n            disabled={isDisabled}\n          >\n            <span className=\"y7-live-timeline__order\">{slide.order}</span>\n            <div className=\"y7-live-timeline__text\">\n              <strong>{slide.title}</strong>\n              <span>{labelMap[slide.type] || \"Slide\"}</span>\n            </div>\n          </button>\n        );\n      })}\n    </div>\n  );\n}\n\nfunction TeacherPanel({ classes, selectedClassId, onSelectClass, onStart, onAdvance, onPause, onReset, onRefresh, deckSummary, liveState, controlBusy }) {\n  const classOptions = classes?.filter((clazz) => !clazz.archivedAt) ?? [];\n  const pointer = liveState?.lesson;\n  const sessionStatus = statusLabel(liveState?.sessionStatus);\n  const statusTone = liveState?.sessionStatus === \"live\" ? \"brand\" : undefined;\n  const sessionMeta = [\n    liveState?.sessionCode ? `Join code ${liveState.sessionCode}` : null,\n    liveState?.updatedAt ? `Updated ${formatTimestamp(liveState.updatedAt)}` : null,\n  ]\n    .filter(Boolean)\n    .join(\" â€¢ \") || null;\n  const actionsDisabled = controlBusy || !selectedClassId;\n  return (\n    <section className=\"y7-live-panel\">\n      <header className=\"y7-live-panel__header\">\n        <div>\n          <h2>Class controls</h2>\n          <p>Launch and pace the live deck for your Year 7 class.</p>\n        </div>\n        <button type=\"button\" className=\"y7-btn y7-btn--ghost\" onClick={onRefresh}>\n          Refresh\n        </button>\n      </header>\n      <label className=\"y7-live-field\">\n        <span>Choose a class</span>\n        <select value={selectedClassId} onChange={(event) => onSelectClass(event.target.value)}>\n          <option value=\"\">Preview without a class</option>\n          {classOptions.map((clazz) => (\n            <option key={clazz.id} value={clazz.id}>\n              {clazz.className}\n            </option>\n          ))}\n        </select>\n      </label>\n      <StatCard tone={statusTone} label=\"Session status\" value={sessionStatus} meta={sessionMeta} compact />\n      <div className=\"y7-live-actions\">\n        <button type=\"button\" className=\"y7-btn y7-btn--primary\" disabled={actionsDisabled} onClick={onStart}>\n          Start / resume\n        </button>\n        <button type=\"button\" className=\"y7-btn\" disabled={actionsDisabled} onClick={onAdvance}>\n          Advance\n        </button>\n        <button type=\"button\" className=\"y7-btn\" disabled={actionsDisabled} onClick={onPause}>\n          Pause\n        </button>\n        <button type=\"button\" className=\"y7-btn y7-btn--ghost\" disabled={actionsDisabled} onClick={onReset}>\n          Reset to slide 1\n        </button>\n      </div>\n      <footer className=\"y7-live-panel__footer\">\n        {pointer ? (\n          <>\n            <p>\n              Live on <strong>{pointer.slideTitle}</strong>\n              {typeof pointer.index === \"number\" && deckSummary?.slideCount ? (\n                <span>\n                  {\" \"}(slide {pointer.index + 1} of {deckSummary.slideCount})\n                </span>\n              ) : null}\n            </p>\n          </>\n        ) : (\n          <p>No active pointer yet. Start the session to project the first slide.</p>\n        )}\n      </footer>\n    </section>\n  );\n}\n\nfunction StudentPanel({ deckSummary, liveState, onReturnToLive, canReturn, onJoinByCode, joinMessage, joinCodeInput, setJoinCodeInput }) {\n  const pointer = liveState?.lesson;\n  const sessionStatus = statusLabel(liveState?.sessionStatus);\n  const statusTone = liveState?.sessionStatus === \"live\" ? \"brand\" : undefined;\n  const sessionMeta = [\n    liveState?.sessionCode ? `Join code ${liveState.sessionCode}` : null,\n    liveState?.updatedAt ? `Updated ${formatTimestamp(liveState.updatedAt)}` : null,\n  ]\n    .filter(Boolean)\n    .join(\" â€¢ \") || null;\n  return (\n    <section className=\"y7-live-panel\">\n      <header className=\"y7-live-panel__header\">\n        <div>\n          <h2>Lesson navigation</h2>\n          <p>Stay in sync with your teacher and revisit earlier slides.</p>\n        </div>\n      </header>\n      <StatCard tone={statusTone} label=\"Session status\" value={sessionStatus} meta={sessionMeta} compact />\n      <div className=\"y7-live-panel__body\">\n        {pointer ? (\n          <p>\n            Live pointer: <strong>{pointer.slideTitle}</strong>\n            {typeof pointer.index === \"number\" && deckSummary?.slideCount ? (\n              <span>\n                {\" \"}(slide {pointer.index + 1} of {deckSummary.slideCount})\n              </span>\n            ) : null}\n          </p>\n        ) : (\n          <p>Your teacher hasnâ€™t started the live deck yet. You can still review previous slides once the session begins.</p>\n        )}\n        {canReturn && (\n          <button type=\"button\" className=\"y7-btn y7-btn--primary\" onClick={onReturnToLive}>\n            Jump to live slide\n          </button>\n        )}\n      </div>\n      <form\n        className=\"y7-live-join\"\n        onSubmit={(event) => {\n          event.preventDefault();\n          onJoinByCode?.();\n        }}\n      >\n        <label className=\"y7-live-field\">\n          <span>Join with a code</span>\n          <input\n            type=\"text\"\n            value={joinCodeInput}\n            placeholder=\"e.g. H4X8Q\"\n            onChange={(event) => setJoinCodeInput(event.target.value.toUpperCase())}\n            maxLength={8}\n          />\n        </label>\n        <button type=\"submit\" className=\"y7-btn\">\n          Join session\n        </button>\n        {joinMessage && <p className={`y7-live-join__status y7-live-join__status--${joinMessage.kind}`}>{joinMessage.text}</p>}\n      </form>\n    </section>\n  );\n}\n\nfunction LiveAssessmentPanel({ assessment, isVisible }) {\n  if (!isVisible) return null;\n  const students = assessment?.students ?? [];\n  const summary = assessment?.summary ?? {};\n  return (\n    <section className=\"y7-live-panel\">\n      <header className=\"y7-live-panel__header\">\n        <div>\n          <h2>Checkpoint dashboard</h2>\n          <p>Monitor progress as students complete the formative task.</p>\n        </div>\n      </header>\n      <div className=\"y7-live-summary\">\n        <div>\n          <span>Completed</span>\n          <strong>{summary.completed ?? 0}</strong>\n        </div>\n        <div>\n          <span>In progress</span>\n          <strong>{summary[\"in-progress\"] ?? 0}</strong>\n        </div>\n        <div>\n          <span>Not started</span>\n          <strong>{summary[\"not-started\"] ?? 0}</strong>\n        </div>\n      </div>\n      <div className=\"y7-live-table\">\n        <table>\n          <thead>\n            <tr>\n              <th>Student</th>\n              <th>Status</th>\n              <th>Attempts</th>\n              <th>Score</th>\n            </tr>\n          </thead>\n          <tbody>\n            {students.length === 0 ? (\n              <tr>\n                <td colSpan={4}>Waiting for students to beginâ€¦</td>\n              </tr>\n            ) : (\n              students.map((row) => (\n                <tr key={row.id}>\n                  <td>{row.displayName || row.username || \"â€”\"}</td>\n                  <td className={`status status--${row.status}`}>{row.status.replace(\"-\", \" \")}</td>\n                  <td>{row.attempts ?? 0}</td>\n                  <td>{typeof row.score === \"number\" ? `${Math.round(row.score * 100)}%` : \"â€”\"}</td>\n                </tr>\n              ))\n            )}\n          </tbody>\n        </table>\n      </div>\n    </section>\n  );\n}\n\nexport default function Year7LiveSessionPage() {\n  const { session, ready } = useSession();\n  const token = session?.token ?? null;\n  const role = session?.user?.role ?? null;\n  const isTeacher = role === \"teacher\";\n  const isStudent = role === \"student\";\n  const [searchParams] = useSearchParams();\n  const { awardXp, resetStreak } = useGamification();\n\n  const deckIdFromQuery = searchParams.get(\"deckId\") || getDefaultDeckId();\n  const [deckId, setDeckId] = useState(deckIdFromQuery);\n  const deckSummary = useMemo(() => (deckId ? getDeckSummary(deckId) : null), [deckId]);\n  const slides = useMemo(() => listSlidesForDeck(deckSummary?.id ?? getDefaultDeckId()), [deckSummary?.id]);\n  const unit = useMemo(() => (deckSummary ? getUnitByDeckId(deckSummary.id) : YEAR7_UNITS[0]), [deckSummary]);\n\n  const [teacherData, setTeacherData] = useState(null);\n  const [selectedClassId, setSelectedClassId] = useState(() => searchParams.get(\"classId\") || \"\");\n  const [classSnapshot, setClassSnapshot] = useState(null);\n  const [studentInfo, setStudentInfo] = useState(null);\n  const [studentSnapshot, setStudentSnapshot] = useState(null);\n  const [activeSlideId, setActiveSlideId] = useState(null);\n  const [controlBusy, setControlBusy] = useState(false);\n  const [assessmentState, setAssessmentState] = useState({ summary: null, students: [] });\n  const [joinMessage, setJoinMessage] = useState(null);\n  const [joinCodeInput, setJoinCodeInput] = useState(\"\");\n  const [error, setError] = useState(null);\n  const [loading, setLoading] = useState(true);\n\n  const sessionId = useMemo(() => {\n    if (isTeacher) {\n      return classSnapshot?.pacing?.sessionId || classSnapshot?.sessionId || selectedClassId || null;\n    }\n    return studentSnapshot?.pacing?.sessionId || studentSnapshot?.sessionId || studentInfo?.class?.id || null;\n  }, [\n    isTeacher,\n    classSnapshot?.pacing?.sessionId,\n    classSnapshot?.sessionId,\n    selectedClassId,\n    studentSnapshot?.pacing?.sessionId,\n    studentSnapshot?.sessionId,\n    studentInfo?.class?.id,\n  ]);\n\n  const classId = useMemo(() => {\n    if (isTeacher) return selectedClassId || null;\n    return studentInfo?.class?.id || studentSnapshot?.classDoc?.id || null;\n  }, [isTeacher, selectedClassId, studentInfo?.class?.id, studentSnapshot?.classDoc?.id]);\n\n  const studentId = useMemo(() => (isStudent ? studentInfo?.student?.id || null : null), [isStudent, studentInfo?.student?.id]);\n\n  const lastSlideRef = useRef(null);\n  const slideStartRef = useRef(Date.now());\n  const lastPointerRef = useRef(null);\n\n  const logSlideView = useCallback(\n    (slideId, durationMs) => {\n      if (!isStudent || !slideId) return;\n      analyticsService.trackEvent(\"slide_view\", {\n        sessionId,\n        classId,\n        studentId,\n        slideId,\n        payload: {\n          durationMs: Math.max(0, durationMs ?? 0),\n        },\n      });\n    },\n    [isStudent, sessionId, classId, studentId],\n  );\n\n  const classStudents = useMemo(() => {\n    if (!teacherData?.students || !selectedClassId) return [];\n    return teacherData.students.filter((student) => student.classId === selectedClassId);\n  }, [teacherData?.students, selectedClassId]);\n\n  const liveState = isTeacher ? classSnapshot : studentSnapshot;\n  const pointerSlideId = liveState?.lesson?.slideId || liveState?.lesson?.id || null;\n  const accessibleSet = liveState?.accessible ?? new Set(pointerSlideId ? [pointerSlideId] : []);\n  const pointerSlideMeta = pointerSlideId ? getSlideById(pointerSlideId) : null;\n  const activeSlideMeta = useMemo(() => (activeSlideId ? getSlideById(activeSlideId) : pointerSlideId ? getSlideById(pointerSlideId) : slides[0] ? getSlideById(slides[0].id) : null), [activeSlideId, pointerSlideId, slides]);\n  const canReturnToLive = isStudent && pointerSlideId && activeSlideId && pointerSlideId !== activeSlideId;\n\n  useEffect(() => {\n    const deckFromQuery = searchParams.get(\"deckId\") || getDefaultDeckId();\n    if (deckFromQuery !== deckId) {\n      setDeckId(deckFromQuery);\n      setActiveSlideId(null);\n    }\n  }, [searchParams, deckId]);\n\n  const applySnapshot = useCallback(\n    (payload, { forceActive } = {}) => {\n      const snapshot = buildLiveSnapshot(payload);\n      if (!snapshot) return;\n      if (isTeacher) setClassSnapshot(snapshot);\n      else setStudentSnapshot(snapshot);\n      const pointerId = snapshot.lesson?.slideId || null;\n      if (forceActive || !activeSlideId) {\n        setActiveSlideId(pointerId || slides[0]?.id || null);\n      } else if (activeSlideId && !snapshot.accessible.has(activeSlideId)) {\n        setActiveSlideId(pointerId || activeSlideId);\n      }\n    },\n    [isTeacher, activeSlideId, slides],\n  );\n\n  const refreshClassSnapshot = useCallback(\n    async (classId) => {\n      if (!token || !classId) {\n        setClassSnapshot(null);\n        return;\n      }\n      try {\n        const response = await getClassPacing(token, classId);\n        applySnapshot(response, { forceActive: !activeSlideId });\n      } catch (err) {\n        console.error(\"Failed to load class pacing\", err);\n        setClassSnapshot(null);\n      }\n    },\n    [token, applySnapshot, activeSlideId],\n  );\n\n  const refreshStudentSnapshot = useCallback(\n    async (classId) => {\n      if (!token || !classId) {\n        setStudentSnapshot(null);\n        return;\n      }\n      try {\n        const response = await getStudentClassPacing(token, classId);\n        applySnapshot(response, { forceActive: !activeSlideId });\n      } catch (err) {\n        console.error(\"Failed to load student pacing\", err);\n        setStudentSnapshot(null);\n      }\n    },\n    [token, applySnapshot, activeSlideId],\n  );\n\n  useEffect(() => {\n    if (!ready || !token) return;\n    const run = async () => {\n      setLoading(true);\n      try {\n        if (isTeacher) {\n          const data = await getTeacherDashboard(token);\n          setTeacherData(data);\n          const year7Classes = (data.classes || []).filter((clazz) => {\n            const label = String(clazz?.yearGroup || \"\").toLowerCase();\n            return label.includes(\"year 7\") || label.includes(\"ks3\");\n          });\n          const initialClass = selectedClassId && year7Classes.some((clazz) => clazz.id === selectedClassId) ? selectedClassId : year7Classes[0]?.id || \"\";\n          setSelectedClassId(initialClass);\n          if (initialClass) await refreshClassSnapshot(initialClass);\n        } else if (isStudent) {\n          const dashboard = await getStudentDashboard(token);\n          setStudentInfo(dashboard);\n          const classId = dashboard.class?.id || dashboard.student?.classId || \"\";\n          if (classId) await refreshStudentSnapshot(classId);\n        }\n        setError(null);\n      } catch (err) {\n        console.error(err);\n        setError(err);\n      } finally {\n        setLoading(false);\n      }\n    };\n    run();\n  }, [ready, token, isTeacher, isStudent, selectedClassId, refreshClassSnapshot, refreshStudentSnapshot]);\n\n  useEffect(() => {\n    if (!activeSlideId && slides[0]) {\n      setActiveSlideId(pointerSlideId || slides[0].id);\n    }\n  }, [slides, pointerSlideId, activeSlideId]);\n\n  useEffect(() => {\n    if (!isStudent || !activeSlideId) return;\n    const now = Date.now();\n    const previous = lastSlideRef.current;\n    if (previous && previous !== activeSlideId) {\n      logSlideView(previous, now - slideStartRef.current);\n    }\n    lastSlideRef.current = activeSlideId;\n    slideStartRef.current = now;\n  }, [isStudent, activeSlideId, logSlideView]);\n\n  useEffect(() => {\n    return () => {\n      if (!isStudent) return;\n      const previous = lastSlideRef.current;\n      if (previous) {\n        const duration = Date.now() - slideStartRef.current;\n        logSlideView(previous, duration);\n      }\n    };\n  }, [isStudent, logSlideView]);\n\n  useEffect(() => {\n    if (!isTeacher || !pointerSlideId) {\n      lastPointerRef.current = null;\n      return;\n    }\n    if (lastPointerRef.current === pointerSlideId) return;\n    lastPointerRef.current = pointerSlideId;\n    analyticsService.trackEvent(\"pointer_update\", {\n      sessionId,\n      classId,\n      slideId: pointerSlideId,\n      payload: { role: \"teacher\" },\n    });\n  }, [isTeacher, pointerSlideId, sessionId, classId]);\n\n  useEffect(() => {\n    if (!isTeacher || !selectedClassId || !token || !pointerSlideId || pointerSlideMeta?.slide?.type !== \"checkpoint\") {\n      setAssessmentState({ summary: null, students: [] });\n      return undefined;\n    }\n    let cancelled = false;\n    const fetchStatus = async () => {\n      try {\n        const response = await getLiveAssessmentStatus(token, selectedClassId, {\n          unitId: deckSummary?.id,\n          segmentId: pointerSlideId,\n        });\n        if (!cancelled) {\n          setAssessmentState({ summary: response.summary ?? null, students: response.students ?? [] });\n        }\n      } catch (err) {\n        if (!cancelled) console.error(\"Failed to fetch live assessment status\", err);\n      }\n    };\n    fetchStatus();\n    const interval = setInterval(fetchStatus, POLL_INTERVAL_MS);\n    return () => {\n      cancelled = true;\n      clearInterval(interval);\n    };\n  }, [isTeacher, selectedClassId, token, pointerSlideId, pointerSlideMeta?.slide?.type, deckSummary?.id]);\n\n  const goToNextSlide = useCallback(async () => {\n    const currentIndex = slides.findIndex((slide) => slide.id === (isTeacher ? pointerSlideId : activeSlideId));\n    const target = slides[currentIndex + 1];\n    if (!target) return;\n    if (isTeacher && selectedClassId) {\n      setControlBusy(true);\n      try {\n        const response = await updateClassPacing(token, selectedClassId, { command: \"advance\" });\n        applySnapshot(response, { forceActive: true });\n      } catch (err) {\n        console.error(err);\n      } finally {\n        setControlBusy(false);\n      }\n    } else {\n      setActiveSlideId(target.id);\n    }\n  }, [slides, isTeacher, pointerSlideId, activeSlideId, selectedClassId, token, applySnapshot]);\n\n  const goToPrevSlide = useCallback(async () => {\n    const currentIndex = slides.findIndex((slide) => slide.id === (isTeacher ? pointerSlideId : activeSlideId));\n    const target = slides[currentIndex - 1];\n    if (!target) return;\n    if (isTeacher && selectedClassId) {\n      setControlBusy(true);\n      try {\n        const response = await updateClassPacing(token, selectedClassId, {\n          lessonId: target.id,\n          unitId: deckSummary?.id,\n        });\n        applySnapshot(response, { forceActive: true });\n      } catch (err) {\n        console.error(err);\n      } finally {\n        setControlBusy(false);\n      }\n    } else {\n      setActiveSlideId(target.id);\n    }\n  }, [slides, isTeacher, pointerSlideId, activeSlideId, selectedClassId, token, deckSummary?.id, applySnapshot]);\n\n  useArrowNavigation({ onNext: goToNextSlide, onPrev: goToPrevSlide });\n\n  const handleTimelineSelect = useCallback(\n    async (slideId, status) => {\n      if (isTeacher && selectedClassId) {\n        setControlBusy(true);\n        try {\n          const response = await updateClassPacing(token, selectedClassId, {\n            lessonId: slideId,\n            unitId: deckSummary?.id,\n          });\n          applySnapshot(response, { forceActive: true });\n        } catch (err) {\n          console.error(err);\n        } finally {\n          setControlBusy(false);\n        }\n      } else if (status !== \"locked\") {\n        setActiveSlideId(slideId);\n      }\n    },\n    [isTeacher, selectedClassId, token, deckSummary?.id, applySnapshot],\n  );\n\n  const handleStart = useCallback(async () => {\n    if (!isTeacher || !selectedClassId) return;\n    setControlBusy(true);\n    try {\n      const response = await updateClassPacing(token, selectedClassId, {\n        command: \"start\",\n        unitId: deckSummary?.id,\n        resume: true,\n      });\n      applySnapshot(response, { forceActive: true });\n    } catch (err) {\n      console.error(err);\n    } finally {\n      setControlBusy(false);\n    }\n  }, [isTeacher, selectedClassId, token, deckSummary?.id, applySnapshot]);\n\n  const handlePause = useCallback(async () => {\n    if (!isTeacher || !selectedClassId) return;\n    setControlBusy(true);\n    try {\n      const response = await updateClassPacing(token, selectedClassId, { command: \"stop\" });\n      applySnapshot(response, { forceActive: true });\n    } catch (err) {\n      console.error(err);\n    } finally {\n      setControlBusy(false);\n    }\n  }, [isTeacher, selectedClassId, token, applySnapshot]);\n\n  const handleReset = useCallback(async () => {\n    if (!isTeacher || !selectedClassId) return;\n    setControlBusy(true);\n    try {\n      const response = await updateClassPacing(token, selectedClassId, {\n        command: \"reset\",\n        unitId: deckSummary?.id,\n        resetHistory: true,\n      });\n      applySnapshot(response, { forceActive: true });\n    } catch (err) {\n      console.error(err);\n    } finally {\n      setControlBusy(false);\n    }\n  }, [isTeacher, selectedClassId, token, deckSummary?.id, applySnapshot]);\n\n  const handleCheckpointSubmit = useCallback(\n    async (result) => {\n      if (!isStudent || !classId || !token || !activeSlideId) return;\n\n      const baseAttempts = typeof result === \"object\" && result !== null && Number.isFinite(result.attempts) ? Number(result.attempts) : 1;\n      const attempts = Math.max(1, baseAttempts);\n\n      const success = (() => {\n        if (typeof result === \"boolean\") return result;\n        if (result && typeof result === \"object\") {\n          if (typeof result.success === \"boolean\") return result.success;\n          if (typeof result.status === \"string\") return result.status === \"completed\";\n          if (typeof result.score === \"number\") return result.score > 0;\n        }\n        return false;\n      })();\n\n      const rawScore = typeof result === \"object\" && result !== null && Number.isFinite(result.score) ? Number(result.score) : null;\n      const normalizedScore = rawScore === null ? (success ? 1 : null) : rawScore <= 1 ? Math.max(0, rawScore) : 1;\n\n      const payload = {\n        status: success ? \"completed\" : \"in-progress\",\n        score: normalizedScore,\n        attempts,\n      };\n\n      let synced = false;\n      try {\n        await updateLiveAssessmentStatus(token, {\n          classId,\n          unitId: deckSummary?.id,\n          segmentId: activeSlideId,\n          status: payload.status,\n          score: payload.score,\n          attempts: payload.attempts,\n        });\n        synced = true;\n      } catch (err) {\n        console.error(\"Failed to sync checkpoint status\", err);\n      }\n\n      if (!synced) return;\n\n      analyticsService.trackEvent(\"assessment_complete\", {\n        sessionId,\n        classId,\n        studentId,\n        slideId: activeSlideId,\n        payload: {\n          score: payload.score,\n          attempts: payload.attempts,\n          success,\n        },\n      });\n\n      if (success) {\n        const action = payload.score === 1 ? \"assessment_perfect\" : \"assessment_attempt\";\n        try {\n          const award = await gamificationService.awardExperience(studentId, action, {\n            firstAttempt: attempts === 1,\n            correct: success,\n            attempts,\n          });\n          if (award?.awarded > 0 && typeof awardXp === \"function\") {\n            awardXp({ xpGained: award.awarded, correct: 1, attempts, spriteUnlocks: [] });\n          }\n        } catch (err) {\n          console.warn(\"Failed to award experience\", err);\n        }\n      } else if (typeof resetStreak === \"function\") {\n        resetStreak();\n      }\n    },\n    [\n      isStudent,\n      classId,\n      token,\n      activeSlideId,\n      deckSummary?.id,\n      sessionId,\n      studentId,\n      awardXp,\n      resetStreak,\n    ],\n  );\n\n  const handleJoinByCode = useCallback(async () => {\n    if (!isStudent || !joinCodeInput || !token) return;\n    setJoinMessage({ kind: \"info\", text: \"Joiningâ€¦\" });\n    try {\n      const response = await joinLiveSession(token, joinCodeInput.trim());\n      applySnapshot(response, { forceActive: true });\n      setJoinMessage({ kind: \"success\", text: \"Joined the live session\" });\n    } catch (err) {\n      console.error(err);\n      setJoinMessage({ kind: \"error\", text: err.message || \"Unable to join. Check the code and try again.\" });\n    }\n  }, [isStudent, joinCodeInput, token, applySnapshot]);\n\n  const handleSelectClass = useCallback(\n    (classId) => {\n      setSelectedClassId(classId);\n      if (classId) refreshClassSnapshot(classId);\n      else setClassSnapshot(null);\n    },\n    [refreshClassSnapshot],\n  );\n\n  const deckTitle = deckSummary?.title || \"Live deck\";\n\n  return (\n    <div className=\"y7-live-shell\">\n      <header className=\"y7-live-header\">\n        <div>\n          <span className=\"y7-live-eyebrow\">Year 7 Â· {unit?.title || \"Live deck\"}</span>\n          <h1>{deckTitle}</h1>\n          <p>{unit?.summary || \"Teacher-paced live lesson with checkpoints and classroom guidance.\"}</p>\n        </div>\n        <dl className=\"y7-live-meta\">\n          <div>\n            <dt>Focus</dt>\n            <dd>{unit?.focus || \"Live deck\"}</dd>\n          </div>\n          {unit?.estimatedHours && (\n            <div>\n              <dt>Estimated time</dt>\n              <dd>{unit.estimatedHours}</dd>\n            </div>\n          )}\n          <div>\n            <dt>Slides</dt>\n            <dd>{slides.length}</dd>\n          </div>\n        </dl>\n      </header>\n\n      {error && <div className=\"y7-live-alert\">{error.message || \"Something went wrong.\"}</div>}\n\n      <div className=\"y7-live-layout\">\n        <main className=\"y7-live-stage\">\n          {loading ? (\n            <div className=\"y7-live-loading\">\n              <span className=\"y7-live-spinner\" aria-hidden=\"true\" />\n              <p>Loading live sessionâ€¦</p>\n            </div>\n          ) : (\n            <>\n              <div className=\"y7-live-stage__card\">\n                <SlideRenderer\n                  slideData={activeSlideMeta?.slide ?? activeSlideMeta}\n                  isTeacher={isTeacher}\n                  sessionId={classSnapshot?.pacing?.sessionId || classSnapshot?.sessionId || selectedClassId || null}\n                  studentId={studentInfo?.student?.id || studentSnapshot?.student?.id || null}\n                  canProgress={isTeacher || accessibleSet.has(activeSlideId)}\n                  onAssessmentComplete={isStudent ? handleCheckpointSubmit : undefined}\n                />\n              </div>\n              <div className=\"y7-live-controls\">\n                <button type=\"button\" className=\"y7-btn\" onClick={goToPrevSlide} disabled={controlBusy || slides.length === 0}>\n                  Previous\n                </button>\n                <div className=\"y7-live-controls__middle\">\n                  <span>\n                    Slide {slides.findIndex((slide) => slide.id === activeSlideId) + 1} of {slides.length}\n                  </span>\n                  {pointerSlideId && pointerSlideId !== activeSlideId && !isTeacher && (\n                    <button type=\"button\" className=\"y7-btn y7-btn--ghost\" onClick={() => setActiveSlideId(pointerSlideId)}>\n                      Jump to live\n                    </button>\n                  )}\n                </div>\n                <button type=\"button\" className=\"y7-btn\" onClick={goToNextSlide} disabled={controlBusy || slides.length === 0}>\n                  Next\n                </button>\n              </div>\n              <SlideTimeline\n                slides={slides}\n                pointerId={pointerSlideId}\n                activeId={activeSlideId}\n                accessibleSet={accessibleSet}\n                onSelect={handleTimelineSelect}\n                disableFuture={!isTeacher}\n                label=\"Live deck timeline\"\n              />\n            </>\n          )}\n        </main>\n        <aside className=\"y7-live-sidebar\">\n          {isTeacher ? (\n            <>\n              <TeacherPanel\n                classes={teacherData?.classes || []}\n                selectedClassId={selectedClassId}\n                onSelectClass={handleSelectClass}\n                onStart={handleStart}\n                onAdvance={goToNextSlide}\n                onPause={handlePause}\n                onReset={handleReset}\n                onRefresh={() => refreshClassSnapshot(selectedClassId)}\n                deckSummary={{ ...deckSummary, slideCount: slides.length }}\n                liveState={classSnapshot}\n                controlBusy={controlBusy}\n              />\n              <LiveDashboard\n                sessionId={classSnapshot?.pacing?.sessionId || classSnapshot?.sessionId || selectedClassId || null}\n                classSize={classStudents.length}\n              />\n            </>\n          ) : (\n            <StudentPanel\n              deckSummary={{ ...deckSummary, slideCount: slides.length }}\n              liveState={studentSnapshot}\n              onReturnToLive={() => setActiveSlideId(pointerSlideId)}\n              canReturn={canReturnToLive}\n              onJoinByCode={handleJoinByCode}\n              joinMessage={joinMessage}\n              joinCodeInput={joinCodeInput}\n              setJoinCodeInput={setJoinCodeInput}\n            />\n          )}\n\n          <LiveAssessmentPanel\n            assessment={assessmentState}\n            isVisible={\n              isTeacher &&\n              [\"checkpoint\", \"assessment\"].includes(pointerSlideMeta?.slide?.type) &&\n              Boolean(selectedClassId)\n            }\n          />\n        </aside>\n      </div>\n    </div>\n  );\n}","import { Routes, Route, Navigate, useLocation } from \"react-router-dom\";\nimport LoginPage from \"./pages/LoginPage.jsx\";\nimport TeacherDashboardPage from \"./pages/TeacherDashboardPage.jsx\";\nimport TeacherStudentDashboardPage from \"./pages/TeacherStudentDashboardPage.jsx\";\nimport StudentDashboardPage from \"./pages/StudentDashboardPage.jsx\";\nimport CurriculumMapPage from \"./pages/CurriculumMapPage.jsx\";\nimport IBCurriculumPage from \"./pages/IBCurriculumPage.jsx\";\nimport IGCSECurriculumPage from \"./pages/IGCSECurriculumPage.jsx\";\nimport TopicPage from \"./pages/TopicPage.jsx\";\nimport LessonPage from \"./pages/LessonPage.jsx\";\nimport AdminDashboardPage from \"./pages/AdminDashboardPage.jsx\";\nimport AccountPage from \"./pages/AccountPage.jsx\";\nimport Layout from \"./components/Layout.jsx\";\nimport B1ModulePage from \"./pages/B1ModulePage.jsx\";\nimport B2ModulePage from \"./pages/B2ModulePage.jsx\";\nimport Year7MapPage from \"./pages/Year7MapPage.jsx\";\nimport Year7LiveSessionPage from \"./pages/Year7LiveSessionPage.jsx\";\nimport { useSession } from \"./hooks/useSession.js\";\nimport { TeacherModeProvider } from \"./context/TeacherModeContext.jsx\";\n\nfunction roleToHome(role) {\n  if (role === \"teacher\") return \"/dashboard\";\n  if (role === \"student\") return \"/student\";\n  if (role === \"admin\") return \"/admin\";\n  return null;\n}\n\nfunction LandingRoute() {\n  const { session, ready } = useSession();\n  if (!ready) return null;\n  const role = session?.user?.role ?? null;\n  const destination = roleToHome(role);\n  if (destination) {\n    return <Navigate to={destination} replace />;\n  }\n  return <LoginPage />;\n}\n\nfunction RequireAuth({ children, roles }) {\n  const { session, ready } = useSession();\n  const location = useLocation();\n\n  if (!ready) {\n    return null;\n  }\n\n  const role = session?.user?.role ?? null;\n\n  if (!role) {\n    return <Navigate to=\"/\" replace state={{ from: location.pathname }} />;\n  }\n\n  if (Array.isArray(roles) && roles.length > 0 && !roles.includes(role)) {\n    const fallback = roleToHome(role) ?? \"/\";\n    return <Navigate to={fallback} replace />;\n  }\n\n  return children;\n}\n\nfunction App() {\n  return (\n    <Layout>\n      <TeacherModeProvider>\n        <Routes>\n          <Route path=\"/\" element={<LandingRoute />} />\n          <Route\n            path=\"/dashboard\"\n            element={\n              <RequireAuth roles={[\"teacher\"]}>\n                <TeacherDashboardPage />\n              </RequireAuth>\n            }\n          />\n          <Route\n            path=\"/dashboard/student/:studentId\"\n            element={\n              <RequireAuth roles={[\"teacher\"]}>\n                <TeacherStudentDashboardPage />\n              </RequireAuth>\n            }\n          />\n          <Route path=\"/teacher\" element={<Navigate to=\"/dashboard\" replace />} />\n          <Route\n            path=\"/student\"\n            element={\n              <RequireAuth roles={[\"student\"]}>\n                <StudentDashboardPage />\n              </RequireAuth>\n            }\n          />\n          <Route\n            path=\"/admin\"\n            element={\n              <RequireAuth roles={[\"admin\"]}>\n                <AdminDashboardPage />\n              </RequireAuth>\n            }\n          />\n          <Route path=\"/admin/dashboard\" element={<Navigate to=\"/admin\" replace />} />\n          <Route\n            path=\"/account\"\n            element={\n              <RequireAuth>\n                <AccountPage />\n              </RequireAuth>\n            }\n          />\n          <Route\n            path=\"/curriculum\"\n            element={\n              <RequireAuth>\n                <CurriculumMapPage />\n              </RequireAuth>\n            }\n          />\n          <Route\n            path=\"/curriculum/ib\"\n            element={\n              <RequireAuth>\n                <IBCurriculumPage />\n              </RequireAuth>\n            }\n          />\n          <Route\n            path=\"/curriculum/igcse\"\n            element={\n              <RequireAuth>\n                <IGCSECurriculumPage />\n              </RequireAuth>\n            }\n          />\n          <Route\n            path=\"/curriculum/year7\"\n            element={\n              <RequireAuth>\n                <Year7MapPage />\n              </RequireAuth>\n            }\n          />\n          <Route\n            path=\"/curriculum/year7/live\"\n            element={\n              <RequireAuth>\n                <Year7LiveSessionPage />\n              </RequireAuth>\n            }\n          />\n          <Route\n            path=\"/curriculum/ib/b1\"\n            element={\n              <RequireAuth>\n                <B1ModulePage />\n              </RequireAuth>\n            }\n          />\n          <Route\n            path=\"/curriculum/ib/b2\"\n            element={\n              <RequireAuth>\n                <B2ModulePage />\n              </RequireAuth>\n            }\n          />\n          <Route\n            path=\"/topic/:id\"\n            element={\n              <RequireAuth>\n                <TopicPage />\n              </RequireAuth>\n            }\n          />\n          <Route\n            path=\"/lesson/:lessonId\"\n            element={\n              <RequireAuth>\n                <LessonPage />\n              </RequireAuth>\n            }\n          />\n        </Routes>\n      </TeacherModeProvider>\n    </Layout>\n  );\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom/client\";\nimport { BrowserRouter } from \"react-router-dom\";\nimport App from \"./App.jsx\";\nimport { SessionProvider, useSession } from \"./hooks/useSession.js\";\nimport { GamificationProvider } from \"./context/GamificationContext.jsx\";\nimport \"./styles/global.css\";\n\nconst basename = import.meta.env.BASE_URL?.replace(/\\/$/, \"\") || \"\";\n\nfunction SessionAwareGamification({ children }) {\n  const { session } = useSession();\n  const profileKey = session?.user?.username?.toLowerCase() || \"anonymous\";\n  const isStudent = session?.user?.role === \"student\";\n  const syncToken = session?.token || null;\n  return (\n    <GamificationProvider profileKey={profileKey} syncToken={syncToken} isStudent={isStudent}>\n      {children}\n    </GamificationProvider>\n  );\n}\n\nReactDOM.createRoot(document.getElementById(\"root\")).render(\n  <React.StrictMode>\n    <SessionProvider>\n      <SessionAwareGamification>\n        <BrowserRouter basename={basename}>\n          <App />\n        </BrowserRouter>\n      </SessionAwareGamification>\n    </SessionProvider>\n  </React.StrictMode>,\n);\n"],"names":["m","require$$0","client","CONFIG_URL","configPromise","loadConfig","inline","response","data","request","path","method","token","body","headers","apiBase","url","init","text","message","error","login","role","username","password","verify","getTeacherDashboard","createClass","className","description","yearGroup","createStudent","payload","bulkCreateStudents","archiveStudent","getClassPacing","classId","getStudentClassPacing","joinLiveSession","joinCode","regenerateClassCredentials","options","getTeacherStudentDashboard","studentId","updateClassPacing","getStudentDashboard","syncStudentGamification","gamificationData","syncStudentProgress","progressData","updateLiveAssessmentStatus","statusData","getLiveAssessmentStatus","unitId","segmentId","params","query","getAdminDashboard","createTeacher","deleteTeacher","STORAGE_KEY","SessionContext","createContext","readSession","raw","parsed","writeSession","value","SessionProvider","children","session","setSessionState","useState","ready","setReady","mergeUsers","useCallback","prevUser","nextUser","useEffect","cancelled","checkSession","prev","mergedUser","nextSession","setSession","clear","contextValue","useMemo","createElement","useSession","context","useContext","FeedbackPanel","tone","animated","panelRef","useRef","timer","classes","jsx","logo","initialState","LoginPage","setRole","status","setStatus","navigate","useNavigate","roleLabel","handleSubmit","event","form","loginRequest","jsxs","PASSWORD_WORDS","PASSWORD_SYMBOLS","selectRandom","list","randomSource","index","generatePassword","word","number","symbol","classNames","inputs","process","key","condition","VARIANT_CLASS","ContentContainer","variant","props","variantClass","normalizeUnit","ResponsiveGrid","columns","minColumnWidth","style","resolvedStyle","base","clampProgress","progress","resolveNode","content","fallbackClassName","StatCard","label","badge","icon","meta","actions","progressLabel","compact","clampedProgress","progressPercentage","badgeNode","metaNode","TONES","StatusBanner","title","onDismiss","Component","normalizedTone","Modal","isOpen","onClose","size","closeOnBackdropClick","closeOnEscape","modalRef","titleRef","previouslyFocusedElement","firstFocusable","handleTab","e","focusableElements","firstElement","lastElement","handleEscape","titleId","IntroToCSLesson","buildTeacherMeta","slide","buildStudentMeta","_a","_b","transformSlide","baseType","KS3_DECK","LIVE_DECKS","deckIndex","slideIndex","deck","position","getDefaultLiveDeck","getLiveDeckById","deckId","getSlideById","slideId","listSlidesForDeck","describeSlide","getDeckSummary","DEFAULT_DECK","DEFAULT_DECK_ID","YEAR7_CURRICULUM","getYear7LessonById","lessonId","described","getYear7LessonIndex","YEAR7_UNITS","STAGE_CONFIG","cohort","group","CSV_TEMPLATE","PASSWORD_STORAGE_KEY","upsertClassPacingRecords","pacing","item","isYear7ClassRecord","classRecord","readStoredPasswords","writeStoredPasswords","map","usernameKey","rememberPasswords","entries","next","entry","resolveStoredPassword","student","byId","getStageConfig","stageId","padCohort","digits","defaultCohort","offsetYears","generateClassCode","config","cleanedGroup","cleanedCohort","deriveProgramme","deriveYearGroupLabel","parseClassMeta","classItem","match","programme","yearGroupLabel","extractPlainPassword","candidates","candidate","trimmed","parseCsvStudents","rows","line","header","h","firstNameIndex","lastNameIndex","usernameIndex","row","cells","downloadTemplate","blob","link","TeacherDashboardPage","isTeacher","dashboard","setDashboard","loading","setLoading","selectedClassId","setSelectedClassId","classModalOpen","setClassModalOpen","studentModal","setStudentModal","pacingState","setPacingState","classForm","setClassForm","stage","studentForm","setStudentForm","bulkCsv","setBulkCsv","bulkStatus","setBulkStatus","passwordLookup","setPasswordLookupState","visiblePasswords","setVisiblePasswords","updatePasswordLookup","updater","result","loadDashboard","plain","a","b","clazz","studentsByClass","classPacingMap","selectedClass","selectedStudents","selectedClassMeta","selectedPacing","selectedPacingLesson","numberFormatter","classSummaryCards","totalLessons","availableLessons","lockedLessons","formattedStudents","formattedAvailable","formattedLocked","formattedTotalLessons","selectedPacingInfo","isYear7Selected","clearPacingMessage","current","handleStartPacing","lessonTitle","handleAdvancePacing","handleStopPacing","handleOpenYear7Map","teacherName","_c","_d","overallStudentCount","_e","_f","_g","formativeComplete","_h","summativeComplete","_i","summaryCards","studentLookup","studentProgressSummary","summaries","record","summary","statusValue","updatedAt","studentsNeedingAttention","recentProgress","handleClassStageChange","openClassModal","submitClass","created","openStudentModal","mode","handleStudentFormChange","field","first","last","submitStudent","firstName","lastName","submitBulkStudents","prepared","sanitizedStudents","copy","passwordEntries","togglePassword","handleArchive","handleCopyCredentials","storedEntries","missingStudents","fallbackName","name","credentialEntries","generatedCount","generated","lines","handleViewStudentDashboard","card","students","isSelected","Fragment","storedPassword","plainPassword","isVisible","option","manifestUrl","manifestCache","manifestPromise","cloneManifest","loadManifest","fallbackManifest","useCurriculumManifest","state","setState","resetCurriculumManifestCache","getTrackLabel","manifest","track","LEGACY_STORAGE_KEY","SYNC_DEBOUNCE_MS","sanitizeProfile","storageKey","profileKey","safe","readStoredState","DEFAULT_STATE","GamificationContext","computeLevel","xp","reducer","action","merged","xpGained","correct","attempts","spriteUnlocks","totalCorrect","totalAttempts","level","streak","spritesUnlocked","GamificationProvider","syncToken","isStudent","normalizedProfile","syncTimeoutRef","dispatch","useReducer","defaultState","stored","profileRef","targetKey","awardXp","resetStreak","updateFromRemote","useGamification","LEGACY_SUFFIX","sanitize","fallback","progressStorageKey","safeUnit","safeUser","legacyProgressKey","readUnitProgress","scopedKey","legacyKey","legacyRaw","writeUnitProgress","KeywordCard","term","definition","Callout","type","iconMap","EnhancedTable","caption","column","rowIndex","cell","cellIndex","keyVocabulary","overviewAim","b1Unit","systemArchitecture","keyVocabularyList","learningOutcomes","typeComparisonRows","stringMethodRows","exceptionScenarios","debuggingTechniqueItems","b2Unit","clampPercent","max","safeMax","percent","ProgressBar","showValue","ariaLabel","rest","rounded","rootClass","VARIANTS","SIZES","StatusPill","normalizedVariant","normalizedSize","normaliseStatus","isLessonComplete","progressTone","buildAttemptRows","unit","insights","segment","stats","count","describeTrack","createUnitSummaries","lessonStatusMap","chapters","lessons","chapter","lesson","total","completed","unlocked","inProgress","locked","percentage","nextLesson","createRecentUpdates","aTime","StudentDashboardLayout","studentName","trackDisplayName","curriculumLink","curriculumCtaLabel","overallPercentage","totalCompleted","classInfo","activeStage","pointerLesson","pointerUpdatedAt","pointerHeadline","pointerCta","gamification","unitSummaries","interactiveAttemptSections","recentUpdates","isIBTrack","selectedUnitId","setSelectedUnitId","activeInsightId","setActiveInsightId","section","selectedUnit","breakdown","breakdownTotal","sum","activeInsight","focusSegments","aRate","bRate","nextLessonIsUnlocked","gamificationLevel","gamificationXp","gamificationStreak","xpToNextLevel","remaining","computedAccuracy","levelMessage","xpMessage","streakMessage","attemptsLogged","accuracyMessage","Link","CircularProgress","lessonLink","resolveLessonLink","actionLabel","strokeWidth","numericValue","clamped","radius","circumference","dashOffset","StudentDashboardPage","studentSession","dashboardData","setDashboardData","localUnitProgress","setLocalUnitProgress","setError","active","intervalId","backendGamification","studentProgress","progressMap","p","progressOwner","createInterval","clearIntervalFn","StudentDashboardRenderer","localProgress","gamificationState","classPacing","trackRaw","buildLessonStatusMap","pointerLessonId","createYear7Summaries","totals","computeOverallTotals","formatTimestamp","resolvePointerAction","curriculumCta","createCurriculumLink","buildInteractiveSections","unlocks","unlock","existing","pointerIndex","lessonIndex","totalCount","completedCount","unlockedCount","inProgressCount","lockedCount","units","acc","timestamp","mapState","baseState","sequence","seen","TeacherStudentDashboardPage","useParams","setPayload","date","gamificationSummary","tracks","CurriculumMapPage","IB_UNIT_METADATA","SUBTOPIC_DESCRIPTIONS","getTrackOptions","resolveInitialTrack","sessionTrack","trackOptions","normalized","computeLessonStatus","subtopic","canViewAll","unitAvailable","subtopicAvailable","hlOnly","IBCurriculumPage","location","useLocation","staffBadgeLabel","selectedTrack","findFirstAccessibleUnit","defaultUnit","activeUnit","focusUnit","baseTrackLabel","trackBadgeText","unitMeta","metadata","isActive","isTrackAvailable","B1LearningPreview","B2LearningPreview","trackAllowsChapter","isUnitAvailable","isChapterAvailable","lessonHref","canLaunchLesson","IGCSE_CURRICULUM","LessonList","IGCSECurriculumPage","TopicPage","id","setMessage","sub","userProgramme","trackLabel","chapterAccessible","unitAccess","subtopicAccess","lessonsWithStatus","isUnlocked","isLocked","isHLOnly","teacherUnlocked","isAccessible","handleClick","MODULE_LINKS","LessonPage","isStaff","lessonMeta","isHlOnly","unlockedBySequence","canViewLesson","accessible","moduleLink","availabilityMessage","AdminDashboardPage","isAdmin","adminName","handleCreateTeacher","createTeacherRequest","handleDeleteTeacher","teacher","formatLabel","part","AccountPage","user","details","Layout","menuOpen","setMenuOpen","sidebarCollapsed","setSidebarCollapsed","sidebarMobileOpen","setSidebarMobileOpen","displayName","greetingName","initials","parts","dashboardLink","studentTrack","navSections","sections","ensureSection","overview","pathname","handleSignOut","menuItems","items","handleAccountBlur","isAuthenticated","AttemptBadge","attemptStats","clears","lastCorrect","lastTotal","lastSuccess","evaluateQuestion","question","expected","provided","sortedExpected","sortedProvided","getOptionState","evaluation","optionValue","selected","MicroQuizSegment","onBack","onComplete","onAttempt","responses","setResponses","setLocked","evaluations","setEvaluations","feedback","setFeedback","totalQuestions","unanswered","perQuestion","correctCount","passed","checked","shuffle","array","i","j","ButtonGroup","layout","align","MatchingActivity","pair","answers","setAnswers","resolved","setResolved","answer","OrderingActivity","baseItems","cards","setCards","draggingId","setDraggingId","dragOverId","setDragOverId","moveCard","sourceId","targetId","fromIndex","toIndex","moved","moveToEnd","moveByOffset","delta","targetIndex","isCorrectSpot","isDropTarget","allowInteraction","DragDropActivity","assignments","setAssignments","target","selectedToken","setSelectedToken","assignedTokenIds","handleAssign","targetMap","picked","assignment","assignedToken","isCorrect","PLACEHOLDER_REGEX","GapFillActivity","blanks","blank","pendingToken","setPendingToken","draggingToken","setDraggingToken","chunks","lastIndex","placeholderId","interactionMode","useTokenMode","tokens","unique","activateToken","tokenId","blankId","assignTokenToBlank","clearBlank","isAssigned","assignedId","isIncorrect","ImageHotspotActivity","setSelected","toggleHotspot","correctSet","selectedSet","hotspot","shouldSelect","didSelect","PlannerActivity","plannerValues","onPlannerSave","panels","panel","handleChange","panelId","submitSuccess","handleTeacherComplete","ClassificationActivity","categories","placedTokenIds","unplacedTokens","assignToken","categoryId","removeToken","tokensByCategory","category","placed","CodeCompletionActivity","placeholders","placeholderMap","placeholder","code","evaluateResponse","trimmedValue","nextValue","SpotTheErrorActivity","errorIds","toggleItem","correctSelections","userSelected","stateClass","DiagramLabelActivity","targets","availableTokens","assignToTarget","removeFromTarget","tokenFromDrag","ActivitySegment","SegmentNav","completeLabel","completeDisabled","renderBody","ContentSegment","DemoSegment","Demo","builtinRead","x","files","Sk","parseFillSnippet","task","regex","PythonPlaygroundSegment","setCode","output","setOutput","running","setRunning","hasRun","setHasRun","outputRef","fillResponses","setFillResponses","fillFeedback","setFillFeedback","fillResolved","setFillResolved","fillTasks","parsedTasks","handleRun","handleInsertExample","exampleCode","snippet","needsPadding","handleReset","handleFillCheck","totalBlanks","example","successMessages","tryAgainMessages","pickMessage","success","pool","AssessmentResultsModal","xpAward","onContinue","handleKey","ReflectionSegment","onSave","initialValue","setValue","handleSave","POLL_INTERVAL_MS","formatStatusLabel","LiveAssessmentDashboard","isLastStage","nextStageTitle","advanceState","advanceError","onShowAssessment","onAdvancePacing","setRows","setSummary","fetchStatus","initial","fetchError","totalStudents","notStarted","sortedRows","left","right","unlockButtonLabel","isAdvancing","segmentTitle","stageTitle","statusClass","score","lastUpdated","TeacherModeContext","TeacherModeProvider","isPresentationMode","setIsPresentationMode","currentPacing","setCurrentPacing","togglePresentationMode","useTeacherMode","STORAGE_VERSION","ASSESSMENT_STAGE_ID","normalizeAssessment","AUTO_ASSESSMENT_ATTEMPTS_KEY","getSegmentAudience","isSegmentVisibleForRole","audience","evaluateAutoQuestion","getAutoOptionState","AutoMarkingAssessment","assessment","normalizedState","onResponseChange","onMarkChange","onStatusChange","assessmentQuestions","questions","marks","attemptCount","instructions","totalPoints","awardedPoints","numeric","evaluationByQuestion","allAnswered","perfect","totalAwarded","points","awarded","handleRetake","resetValue","buildInitialState","nextIndex","prevStage","nextStage","updated","questionId","GamifiedModulePage","teacherClassId","paceStatus","setPaceStatus","setClassPacing","hasAssessment","stages","assessmentStage","initialUnit","initialProfile","programmeLabel","fetchPacing","pacingData","interval","unitRef","nextState","activeStageIndex","setActiveStageIndex","resultModal","setResultModal","headerCollapsed","setHeaderCollapsed","levelUpModal","setLevelUpModal","previousLevelRef","pointerIndexRef","firstIncomplete","overallXp","xpToNext","currentLevelFloor","levelProgress","xpFormatter","formattedXp","formattedNextLevel","handleSegmentAdvance","handleReflectionSave","handlePlannerSave","handleAttempt","resolvedTotal","nextAttemptCount","studentClassId","scoreValue","baseXp","streakBonus","handleAssessmentResponseChange","handleAssessmentMarkChange","handleAssessmentNoteChange","handleAssessmentStatusChange","overallCompletion","regularStagesComplete","pointerForUnit","previousPointer","assessmentUnlocked","handleSetPace","handleTeacherAdvancePacingToStage","targetStage","ok","handleStopClassPace","isPointerStage","currentPaceStatus","StagePlayer","LevelUpModal","assessmentState","onAssessmentResponseChange","onAssessmentMarkChange","onAssessmentNoteChange","onAssessmentStatusChange","onAdvance","onReflectionSave","onAdvanceClassPace","onStopClassPace","stopStatus","isAssessmentStage","segments","stageProgress","initialIndex","currentIndex","setCurrentIndex","teacherAssessmentView","setTeacherAssessmentView","setAdvanceState","setAdvanceError","stageContainerRef","advanceTimeoutRef","transitionDirection","setTransitionDirection","assessmentStatus","node","prefersReducedMotion","currentSegment","isFormativeAssessment","currentStageIndex","stopButtonDisabled","handleComplete","stageComplete","handleBack","handleAdvancePacingForClass","AssessmentPanel","panelKey","panelClassName","SegmentRenderer","onTeacherNoteChange","completionPercentage","expanded","setExpanded","handleExport","oldLevel","newLevel","confettiPieces","_","piece","reflections","planner","sharedProps","B1ModulePage","B2ModulePage","normaliseAccessible","buildSnapshot","accessibleSource","statusBadge","statusLabel","Year7MapPage","teacherData","setTeacherData","classSnapshot","setClassSnapshot","studentInfo","setStudentInfo","studentSnapshot","setStudentSnapshot","unitDeckSlides","year7Classes","defaultClass","previous","err","handleTeachUnit","handlePreviewUnit","handleStudentContinue","module","main","global","isWorker","workerSize","canUseWorker","canUsePaths","canDrawBitmap","canvas","ctx","bitmap","noop","promise","func","ModulePromise","Prom","bitmapMapper","skipTransform","raf","TIME","frame","cancel","frames","lastFrameTime","cb","onFrame","time","getWorker","worker","prom","resolves","decorate","execute","callback","offscreen","done","resolve","workerDone","msg","defaults","convert","val","transform","isOk","prop","onlyPositiveInt","randomInt","min","toDecimal","str","colorsToRgb","colors","hexToRgb","getOrigin","origin","setCanvasWindowSize","setCanvasRectSize","rect","getCanvas","zIndex","ellipse","y","radiusX","radiusY","rotation","startAngle","endAngle","antiClockwise","randomPhysics","opts","radAngle","radSpread","updateFetti","fetti","x1","y1","x2","y2","transformPath2D","scaleX","scaleY","width","height","matrix","pattern","rot","innerRadius","outerRadius","spikes","step","animate","fettis","resizer","animatingFettis","animationFrame","destroy","onDone","update","confettiCannon","globalOpts","isLibCanvas","allowResize","hasResizeEventRegistered","globalDisableForReducedMotion","shouldUseWorker","initialized","preferLessMotion","animationObj","fireLocal","particleCount","angle","spread","startVelocity","decay","gravity","drift","ticks","shapes","scalar","flat","temp","startX","startY","fire","disableForReducedMotion","onResize","obj","defaultFire","getDefaultFire","pathString","pathMatrix","path2d","t1","t2","shapeFromPath","pathData","tempCanvas","tempCtx","maxSize","minX","minY","maxX","maxY","maxDesiredSize","scale","shapeFromText","textData","color","fontFamily","fontSize","font","padding","confetti","SortableRow","attributes","listeners","setNodeRef","transition","isDragging","useSortable","CSS","motion","MultipleChoice","onSubmit","allowRetry","disabled","evaluate","reset","promptId","OrderingAssessment","setItems","setAttempts","activeId","setActiveId","handleDragEnd","over","oldIndex","newIndex","arrayMove","nextAttempts","submittedIds","DndContext","closestCenter","SortableContext","verticalListSortingStrategy","DragOverlay","ClassificationAssessment","fieldId","FormativeAssessment","resolvedVariant","BinaryLightBulbs","levels","levelIndex","setLevelIndex","states","setStates","setScore","bulbs","toggle","decimalValue","handleCheck","nextLevel","RobotMaze","commands","setCommands","isRunning","setIsRunning","setPosition","findStart","turnRight","turnLeft","moveForward","pos","dir","runProgram","command","cmd","LiveCodeEditor","initialCode","language","Sandpack","ThinkPairShare","prompt","duration","phase","setPhase","timeLeft","setTimeLeft","phases","INTERACTIVE_COMPONENTS","HeadingBlock","Tag","ParagraphBlock","BulletedList","ObjectivesBlock","objectives","objective","CalloutBlock","ReflectionBlock","prompts","submitTo","BadgeAwardBlock","InteractiveComponent","component","renderBlock","block","sessionId","onAssessmentComplete","handleCompletion","ContentSlide","blocks","InteractiveSlide","activity","normalise","AssessmentSlide","SlideRenderer","slideData","canProgress","AnimatePresence","log","isEnabled","makeLogger","fnName","args","r","o","u","s","n","t","require","w","c","d","l","f","O","H","g","C","v","E","I","A","Y","B","F","L","U","D","T","M","k","N","S","weakHash","MD5","Q","Z","nn","X","q","rn","tn","P","z","R","en","on","V","G","W","un","an","fn","areObjectKeysEqual","ak","bk","areObjectsShallowEqual","obj1","obj2","areObjectsDeepEqual","immutableDeepMerge","source","isObject","areBothObjects","immutableDeepReplace","replaceValue","replacementValue","enableMapSet","hasEA","attr","isRef","isBlob","getAttr","attrs","attrId","getInMap","deleteInMap","head","tail","setInMap","nextM","createIndexMap","triples","eav","aev","vae","triple","eid","aid","createStore","store","resolveLookupRefs","eMaps","allMapValues","lookupV","_v","retractTriple","rawTriple","_seed","getCreatedAt","createdAt","addTriple","enhancedTriple","mergeTriple","eavValuesMap","currentTriple","currentValue","updatedValue","deleteEntity","eMap","vaeTriples","resetIndexMap","newTriples","newIndexMap","addAttr","getAllTriples","deleteAttr","updateAttr","partialAttr","applyTxStep","txStep","res","triplesByValue","values","whichIdx","getTriples","aMap","transact","txSteps","produce","draft","isVariable","matchVariable","variable","triplePart","bound","matchPart","matchExact","patternPart","matchWithArgMap","inList","matcherForPatternPart","matchPattern","idx","querySingle","relevantTriples","queryPattern","contexts","patterns","queryWhere","actualize","find","findPart","where","getRandomValues","rnds8","rng","byteToHex","unsafeStringify","arr","offset","randomUUID","native","v4","buf","rnds","uuidToByteArray","uuid","hex","bytes","compareByteArrays","uuidCompare","uuid_a","uuid_b","getAttrByFwdIdentName","inputEtype","inputIdentName","_id","etype","getAttrByReverseIdentName","revIdent","wildcard","friendlyName","makeVarImpl","AttrNotFoundError","getPrimaryKeyAttr","ns","primary","idAttr","defaultWhere","makeVar","eidWhere","attrWhere","replaceInAttrPat","attrPat","needle","refAttrPat","fwdAttr","revAttr","fwdEtype","_r","revEtype","valueAttrPat","valueEtype","valueLevel","valueLabel","refAttrPats","refsPath","lastEtype","lastLevel","attrPats","nextEtype","whereCondAttrPats","refPats","valuePat","withJoin","join","isOrClauses","isAndClauses","genMakeVar","baseMakeVar","orIdx","lvl","parseWhereClauses","clauseType","whereValue","makeNamespacedVar","parseWhere","joinSym","makeWhere","makeFind","makeJoin","pat","actualized","extendObjects","objects","parent","child","queryOne","shouldIgnoreAttr","cursorCompare","direction","typ","isBefore","startCursor","runDataloadAndReturnObjects","pageInfo","dq","toRemove","datalogQuery","tripleA","tripleB","tsA","tsB","attrEtype","determineOrder","orderOpts","resolveObjects","limit","before","after","objs","guardedResolveObjects","formatPageInfo","aggregate","transactionChunk","prevOps","_target","isLookup","parseLookup","vJSON","etypeChunk","emptyChunk","tx","getOps","explodeLookupRef","extractLookup","identName","expandLink","eidA","eidOrEids","eids","eidB","expandUnlink","expandUpdate","lookup","expandDelete","expandDeepMerge","attrTuples","coercedValue","idTuple","toTxSteps","extractIdents","_action","_eid","createObjectAttr","fwdIdent","createRefAttr","fwdIdentId","revIdentId","uniqueIdents","idents","ident","createMissingObjectAttrs","ops","objectOps","objectAttrs","newAttrs","attrTxSteps","createMissingRefAttrs","refAttrs","inputChunks","withNewObjAttrs","addObjAttrTxSteps","withNewRefAttrs","addRefAttrTxSteps","op","__awaiter","thisArg","_arguments","generator","adopt","reject","fulfilled","rejected","IndexedDBStorage","dbName","db","_event","WindowNetworkListener","onOnline","onOffline","jsonFetch","input","json","sendMagicCode","apiURI","appId","email","verifyMagicCode","verifyRefreshToken","refreshToken","exchangeCodeForToken","codeVerifier","signInWithIdToken","nonce","idToken","clientName","getSignedUploadUrl","fileName","upload","presignedUrl","file","getDownloadUrl","pick","keys","ret","buildPresenceSlice","slice","shouldIncludeAllPeers","isPeerIncluded","peer","hasPresenceResponseChanged","Deferred","reason","PersistedObject","persister","defaultValue","onMerge","toJSON","fromJSON","fromStorage","_extractTriplesHelper","idNodes","idNode","datalogResult","joinRows","extractTriples","jsonReplacer","_k","jsonReviver","toJSONWithMaps","fromJSONWithMaps","STATUS","WS_OPEN_STATUS","defaultConfig","OAUTH_REDIRECT_PARAM","currentUserKey","Reactor","Storage","NetworkListener","_storageSubs","inMemorySubs","storageSubs","hash","querySub","storageResult","memoryResult","storageMuts","inMemoryMuts","mut","cbs","errorMessage","iqlResult","resp","instaml.transform","eventId","mutation","dfd","isOnline","clientId","errDetails","txId","addQueryTxId","s.createStore","computations","refreshOkTxId","updates","prevMutation","_args","roomId","room","topic","loadingRoomId","loadingRoom","errorRoomId","errorRoom","errorObj","prevResult","muts","findExistingAttr","instaml.getAttrByFwdIdentName","rewriteTxSteps","mapping","retTxSteps","newTxStep","__","rewritten","newMuts","newMapping","newTxSteps","pendingMutationSteps","deletedAttrIds","_attr","pendingAttrs","fullAttr","attrsWithoutDeleted","newStore","s.transact","instaql","timeoutMs","newId","startUrl","newPath","ran","listener","authAPI.exchangeCodeForToken","unsubbed","oas","oauthResp","newUser","authAPI.sendMagicCode","authAPI.verifyMagicCode","authToken","authAPI.verifyRefreshToken","redirectURL","authAPI.signInWithIdToken","roomType","partialData","leaveRoom","handler","sessions","peers","currentUser","StorageApi.getSignedUploadUrl","StorageApi.upload","StorageApi.getDownloadUrl","currentDevtool","createDevtool","container","createContainer","toggler","createToggler","toggleView","iframe","createIframe","getSrc","onPostMessage","onKeyDown","isToggleShortcut","isEsc","dispose","create","src","element","onClick","defaultOpenDevtool","initGlobalInstantCoreStore","globalInstantCoreStore","existingClient","reactor","InstantCore","Auth","onEvent","onChange","coerceQuery","useQuery","_core","_query","useTimeout","timeoutRef","set","delay","defaultActivityStopTimeout","InstantReactRoom","deps","inputName","timeout","onservedPresence","presenceSnapshot","setActive","InstantReact","initCore","InstantReactWeb","processEnv","define_globalThis_process_env_default","APP_ID","__vite_import_meta_env__","extendStatics","__extends","VIEWBOX_WIDTH","VIEWBOX_HEIGHT","VIEWBOX_HEIGHT_HALF","VIEWBOX_CENTER_X","VIEWBOX_CENTER_Y","Path","counterClockwise","dashRatio","pathRadius","getDashStyle","getPathDescription","diameter","gapLength","CircularProgressbar","_super","minValue","maxValue","boundedValue","circleRatio","styles","pathRatio","buildStyles","strokeLinecap","textColor","textSize","pathColor","pathTransition","pathTransitionDuration","trailColor","backgroundColor","rotationTransform","rotationTransformOrigin","removeUndefinedValues","tileTone","LiveDashboard","classSize","studentStates","setStudentStates","assessmentProgress","setAssessmentProgress","engagementScore","onTrack","unsubscribeStates","unsubscribeAssessments","assessmentId","safeNumber","AnalyticsService","eventType","records","totalViews","totalDuration","averageViewTime","metricId","analyticsService","toNumber","GamificationService","safeXp","totalAward","recordId","previousXp","previousCorrect","previousAttempts","previousStreak","correctIncrement","attemptsIncrement","gamificationService","buildLiveSnapshot","getDefaultDeckId","getUnitByDeckId","useArrowNavigation","callbacks","SlideTimeline","slides","pointerId","accessibleSet","onSelect","disableFuture","labelMap","isDisabled","TeacherPanel","onSelectClass","onStart","onPause","onReset","onRefresh","deckSummary","liveState","controlBusy","classOptions","pointer","sessionStatus","statusTone","sessionMeta","actionsDisabled","StudentPanel","onReturnToLive","canReturn","onJoinByCode","joinMessage","joinCodeInput","setJoinCodeInput","LiveAssessmentPanel","Year7LiveSessionPage","searchParams","useSearchParams","deckIdFromQuery","setDeckId","activeSlideId","setActiveSlideId","setControlBusy","setAssessmentState","setJoinMessage","lastSlideRef","slideStartRef","lastPointerRef","logSlideView","durationMs","classStudents","pointerSlideId","pointerSlideMeta","activeSlideMeta","canReturnToLive","deckFromQuery","applySnapshot","forceActive","snapshot","refreshClassSnapshot","refreshStudentSnapshot","initialClass","now","_j","goToNextSlide","goToPrevSlide","handleTimelineSelect","handleStart","handlePause","handleCheckpointSubmit","baseAttempts","rawScore","normalizedScore","synced","award","handleJoinByCode","handleSelectClass","deckTitle","_l","_m","_n","_o","roleToHome","LandingRoute","destination","Navigate","RequireAuth","roles","App","Routes","Route","basename","SessionAwareGamification","ReactDOM","React","BrowserRouter"],"mappings":"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","x_google_ignoreList":[0,66,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,105]}